

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>numpy.lib.function_base</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Scipy API
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">1. SciPy Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/general.html">1.1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/general.html#scipy-organization">1.1.1. SciPy Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/general.html#finding-documentation">1.1.2. Finding Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/basic.html">1.2. Basic functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/basic.html#interaction-with-numpy">1.2.1. Interaction with Numpy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#index-tricks">1.2.1.1. Index Tricks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#shape-manipulation">1.2.1.2. Shape manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#polynomials">1.2.1.3. Polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#vectorizing-functions-vectorize">1.2.1.4. Vectorizing functions (vectorize)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#type-handling">1.2.1.5. Type handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#other-useful-functions">1.2.1.6. Other useful functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/special.html">1.3. Special functions (<code class="docutils literal"><span class="pre">scipy.special</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/special.html#bessel-functions-of-real-order-jn-jn-zeros">1.3.1. Bessel functions of real order(<code class="docutils literal"><span class="pre">jn()</span></code>, <code class="docutils literal"><span class="pre">jn_zeros()</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/integrate.html">1.4. Integration (<code class="docutils literal"><span class="pre">scipy.integrate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#general-integration-quad">1.4.1. General integration (<code class="docutils literal"><span class="pre">quad()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#general-multiple-integration-dblquad-tplquad-nquad">1.4.2. General multiple integration (<code class="docutils literal"><span class="pre">dblquad()</span></code>, <code class="docutils literal"><span class="pre">tplquad()</span></code>, <code class="docutils literal"><span class="pre">nquad()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#gaussian-quadrature">1.4.3. Gaussian quadrature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#romberg-integration">1.4.4. Romberg Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#integrating-using-samples">1.4.5. Integrating using Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#faster-integration-using-ctypes">1.4.6. Faster integration using Ctypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#ordinary-differential-equations-odeint">1.4.7. Ordinary differential equations (<code class="docutils literal"><span class="pre">odeint()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/integrate.html#references">1.4.7.1. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/optimize.html">1.5. Optimization (<code class="docutils literal"><span class="pre">scipy.optimize</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#unconstrained-minimization-of-multivariate-scalar-functions-minimize">1.5.1. Unconstrained minimization of multivariate scalar functions (<code class="docutils literal"><span class="pre">minimize()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#nelder-mead-simplex-algorithm-method-nelder-mead">1.5.1.1. Nelder-Mead Simplex algorithm (<code class="docutils literal"><span class="pre">method='Nelder-Mead'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#broyden-fletcher-goldfarb-shanno-algorithm-method-bfgs">1.5.1.2. Broyden-Fletcher-Goldfarb-Shanno algorithm (<code class="docutils literal"><span class="pre">method='BFGS'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#newton-conjugate-gradient-algorithm-method-newton-cg">1.5.1.3. Newton-Conjugate-Gradient algorithm (<code class="docutils literal"><span class="pre">method='Newton-CG'</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#constrained-minimization-of-multivariate-scalar-functions-minimize">1.5.2. Constrained minimization of multivariate scalar functions (<code class="docutils literal"><span class="pre">minimize()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#least-squares-minimization-least-squares">1.5.3. Least-squares minimization (<code class="docutils literal"><span class="pre">least_squares()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#example-of-solving-a-fitting-problem">1.5.3.1. Example of solving a fitting problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#further-examples">1.5.3.2. Further examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#univariate-function-minimizers-minimize-scalar">1.5.4. Univariate function minimizers (<code class="docutils literal"><span class="pre">minimize_scalar()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#unconstrained-minimization-method-brent">1.5.4.1. Unconstrained minimization (<code class="docutils literal"><span class="pre">method='brent'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#bounded-minimization-method-bounded">1.5.4.2. Bounded minimization (<code class="docutils literal"><span class="pre">method='bounded'</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#custom-minimizers">1.5.5. Custom minimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#root-finding">1.5.6. Root finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#scalar-functions">1.5.6.1. Scalar functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#fixed-point-solving">1.5.6.2. Fixed-point solving</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#sets-of-equations">1.5.6.3. Sets of equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#root-finding-for-large-problems">1.5.6.4. Root finding for large problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#still-too-slow-preconditioning">1.5.6.5. Still too slow? Preconditioning.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/interpolate.html">1.6. Interpolation (<code class="docutils literal"><span class="pre">scipy.interpolate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#d-interpolation-interp1d">1.6.1. 1-D interpolation (<code class="docutils literal"><span class="pre">interp1d</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#multivariate-data-interpolation-griddata">1.6.2. Multivariate data interpolation (<code class="docutils literal"><span class="pre">griddata()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation">1.6.3. Spline interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation-in-1-d-procedural-interpolate-splxxx">1.6.3.1. Spline interpolation in 1-d: Procedural (interpolate.splXXX)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation-in-1-d-object-oriented-univariatespline">1.6.3.2. Spline interpolation in 1-d: Object-oriented (<code class="docutils literal"><span class="pre">UnivariateSpline</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#two-dimensional-spline-representation-procedural-bisplrep">1.6.3.3. Two-dimensional spline representation: Procedural (<code class="docutils literal"><span class="pre">bisplrep()</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#two-dimensional-spline-representation-object-oriented-bivariatespline">1.6.3.4. Two-dimensional spline representation: Object-oriented (<code class="docutils literal"><span class="pre">BivariateSpline</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#using-radial-basis-functions-for-smoothing-interpolation">1.6.4. Using radial basis functions for smoothing/interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#d-example">1.6.4.1. 1-d Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#id1">1.6.4.2. 2-d Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/fftpack.html">1.7. Fourier Transforms (<code class="docutils literal"><span class="pre">scipy.fftpack</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#fast-fourier-transforms">1.7.1. Fast Fourier transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#one-dimensional-discrete-fourier-transforms">1.7.1.1. One dimensional discrete Fourier transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#two-and-n-dimensional-discrete-fourier-transforms">1.7.1.2. Two and n-dimensional discrete Fourier transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#fft-convolution">1.7.1.3. FFT convolution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#discrete-cosine-transforms">1.7.2. Discrete Cosine Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-i-dct">1.7.2.1. Type I DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-ii-dct">1.7.2.2. Type II DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-iii-dct">1.7.2.3. Type III DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#dct-and-idct">1.7.2.4. DCT and IDCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#example">1.7.2.5. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#discrete-sine-transforms">1.7.3. Discrete Sine Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-i-dst">1.7.3.1. Type I DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-ii-dst">1.7.3.2. Type II DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-iii-dst">1.7.3.3. Type III DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#dst-and-idst">1.7.3.4. DST and IDST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#cache-destruction">1.7.4. Cache Destruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#references">1.7.5. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/signal.html">1.8. Signal Processing (<cite>scipy.signal</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#b-splines">1.8.1. B-splines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#filtering">1.8.2. Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#convolution-correlation">1.8.2.1. Convolution/Correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#difference-equation-filtering">1.8.2.2. Difference-equation filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#filter-design">1.8.2.3. Filter Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#other-filters">1.8.2.4. Other filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#analog-filter-design">1.8.2.5. Analog Filter Design</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#spectral-analysis">1.8.3. Spectral Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#periodogram-measurements">1.8.3.1. Periodogram Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#spectral-analysis-using-welch-s-method">1.8.3.2. Spectral Analysis using Welch&#8217;s Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#lomb-scargle-periodograms-lombscargle">1.8.3.3. Lomb-Scargle Periodograms (<code class="docutils literal"><span class="pre">lombscargle()</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#detrend">1.8.4. Detrend</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/linalg.html">1.9. Linear Algebra (<cite>scipy.linalg</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#scipy-linalg-vs-numpy-linalg">1.9.1. scipy.linalg vs numpy.linalg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#numpy-matrix-vs-2d-numpy-ndarray">1.9.2. numpy.matrix vs 2D numpy.ndarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#basic-routines">1.9.3. Basic routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#finding-inverse">1.9.3.1. Finding Inverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#solving-linear-system">1.9.3.2. Solving linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#finding-determinant">1.9.3.3. Finding Determinant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#computing-norms">1.9.3.4. Computing norms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#solving-linear-least-squares-problems-and-pseudo-inverses">1.9.3.5. Solving linear least-squares problems and pseudo-inverses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#generalized-inverse">1.9.3.6. Generalized inverse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#decompositions">1.9.4. Decompositions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#eigenvalues-and-eigenvectors">1.9.4.1. Eigenvalues and eigenvectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#singular-value-decomposition">1.9.4.2. Singular value decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#lu-decomposition">1.9.4.3. LU decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#cholesky-decomposition">1.9.4.4. Cholesky decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#qr-decomposition">1.9.4.5. QR decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#schur-decomposition">1.9.4.6. Schur decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#interpolative-decomposition">1.9.4.7. Interpolative Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#matrix-functions">1.9.5. Matrix Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#exponential-and-logarithm-functions">1.9.5.1. Exponential and logarithm functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#trigonometric-functions">1.9.5.2. Trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#hyperbolic-trigonometric-functions">1.9.5.3. Hyperbolic trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#arbitrary-function">1.9.5.4. Arbitrary function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#special-matrices">1.9.6. Special matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/arpack.html">1.10. Sparse Eigenvalue Problems with ARPACK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#introduction">1.10.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#basic-functionality">1.10.2. Basic Functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#shift-invert-mode">1.10.3. Shift-Invert Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#examples">1.10.4. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#references">1.10.5. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/csgraph.html">1.11. Compressed Sparse Graph Routines (<cite>scipy.sparse.csgraph</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/csgraph.html#example-word-ladders">1.11.1. Example: Word Ladders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/spatial.html">1.12. Spatial data structures and algorithms (<cite>scipy.spatial</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#delaunay-triangulations">1.12.1. Delaunay triangulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/spatial.html#coplanar-points">1.12.1.1. Coplanar points</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#convex-hulls">1.12.2. Convex hulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#voronoi-diagrams">1.12.3. Voronoi diagrams</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/stats.html">1.13. Statistics (<cite>scipy.stats</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#introduction">1.13.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#random-variables">1.13.2. Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#getting-help">1.13.2.1. Getting Help</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#common-methods">1.13.2.2. Common Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#shifting-and-scaling">1.13.2.3. Shifting and Scaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#shape-parameters">1.13.2.4. Shape Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#freezing-a-distribution">1.13.2.5. Freezing a Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#broadcasting">1.13.2.6. Broadcasting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#specific-points-for-discrete-distributions">1.13.2.7. Specific Points for Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#fitting-distributions">1.13.2.8. Fitting Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#performance-issues-and-cautionary-remarks">1.13.2.9. Performance Issues and Cautionary Remarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#remaining-issues">1.13.2.10. Remaining Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#building-specific-distributions">1.13.3. Building Specific Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#making-a-continuous-distribution-i-e-subclassing-rv-continuous">1.13.3.1. Making a Continuous Distribution, i.e., Subclassing <code class="docutils literal"><span class="pre">rv_continuous</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#subclassing-rv-discrete">1.13.3.2. Subclassing <code class="docutils literal"><span class="pre">rv_discrete</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#analysing-one-sample">1.13.4. Analysing One Sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#descriptive-statistics">1.13.4.1. Descriptive Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#t-test-and-ks-test">1.13.4.2. T-test and KS-test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#tails-of-the-distribution">1.13.4.3. Tails of the distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#special-tests-for-normal-distributions">1.13.4.4. Special tests for normal distributions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#comparing-two-samples">1.13.5. Comparing two samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#comparing-means">1.13.5.1. Comparing means</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#kolmogorov-smirnov-test-for-two-samples-ks-2samp">1.13.5.2. Kolmogorov-Smirnov test for two samples ks_2samp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#kernel-density-estimation">1.13.6. Kernel Density Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#univariate-estimation">1.13.6.1. Univariate estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#multivariate-estimation">1.13.6.2. Multivariate estimation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/ndimage.html">1.14. Multidimensional image processing (<cite>scipy.ndimage</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#introduction">1.14.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#properties-shared-by-all-functions">1.14.2. Properties shared by all functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#filter-functions">1.14.3. Filter functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#correlation-and-convolution">1.14.3.1. Correlation and convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#smoothing-filters">1.14.3.2. Smoothing filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#filters-based-on-order-statistics">1.14.3.3. Filters based on order statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#derivatives">1.14.3.4. Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#generic-filter-functions">1.14.3.5. Generic filter functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#fourier-domain-filters">1.14.3.6. Fourier domain filters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#interpolation-functions">1.14.4. Interpolation functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#spline-pre-filters">1.14.4.1. Spline pre-filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#id8">1.14.4.2. Interpolation functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#morphology">1.14.5. Morphology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#binary-morphology">1.14.5.1. Binary morphology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#grey-scale-morphology">1.14.5.2. Grey-scale morphology</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#distance-transforms">1.14.6. Distance transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#segmentation-and-labeling">1.14.7. Segmentation and labeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#object-measurements">1.14.8. Object measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#extending-scipy-ndimage-in-c">1.14.9. Extending <code class="docutils literal"><span class="pre">scipy.ndimage</span></code> in C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#functions-that-support-c-callback-functions">1.14.10. Functions that support C callback functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/io.html">1.15. File IO (<code class="docutils literal"><span class="pre">scipy.io</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#matlab-files">1.15.1. MATLAB files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#the-basic-functions">1.15.1.1. The basic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#how-do-i-start">1.15.1.2. How do I start?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#matlab-structs">1.15.1.3. MATLAB structs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#matlab-cell-arrays">1.15.1.4. MATLAB cell arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#idl-files">1.15.2. IDL files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#matrix-market-files">1.15.3. Matrix Market files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.wavfile">1.15.4. Wav sound files (<code class="docutils literal"><span class="pre">scipy.io.wavfile</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.arff">1.15.5. Arff files (<code class="docutils literal"><span class="pre">scipy.io.arff</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.netcdf">1.15.6. Netcdf (<code class="docutils literal"><span class="pre">scipy.io.netcdf</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/weave.html">1.16. Weave (<cite>scipy.weave</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#outline">1.16.1. Outline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#introduction">1.16.2. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#requirements">1.16.3. Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#installation">1.16.4. Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#testing">1.16.5. Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#testing-notes">1.16.5.1. Testing Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#benchmarks">1.16.6. Benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#inline">1.16.7. Inline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#more-with-printf">1.16.7.1. More with printf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#more-examples">1.16.7.2. More examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#keyword-option">1.16.7.3. Keyword Option</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#inline-arguments">1.16.7.4. Inline Arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#distutils-keywords">1.16.7.5. Distutils keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#technical-details">1.16.7.6. Technical Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#passing-variables-in-out-of-the-c-c-code">1.16.7.7. Passing Variables in/out of the C/C++ code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#type-conversions">1.16.7.8. Type Conversions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#the-catalog">1.16.7.9. The Catalog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#blitz">1.16.8. Blitz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#id1">1.16.8.1. Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#limitations">1.16.8.2. Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#numpy-efficiency-issues-what-compilation-buys-you">1.16.8.3. NumPy efficiency issues: What compilation buys you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#the-tools">1.16.8.4. The Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#type-definitions-and-coercion">1.16.8.5. Type definitions and coercion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#cataloging-compiled-functions">1.16.8.6. Cataloging Compiled Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#checking-array-sizes">1.16.8.7. Checking Array Sizes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#creating-the-extension-module">1.16.8.8. Creating the Extension Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#extension-modules">1.16.9. Extension Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#a-simple-example">1.16.9.1. A Simple Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#fibonacci-example">1.16.9.2. Fibonacci Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#customizing-type-conversions-type-factories">1.16.10. Customizing Type Conversions &#8211; Type Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#things-i-wish-weave-did">1.16.11. Things I wish <code class="docutils literal"><span class="pre">weave</span></code> did</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../API.html">2. API - importing from Scipy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../API.html#guidelines-for-importing-functions-from-scipy">2.1. Guidelines for importing functions from Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../API.html#api-definition">2.2. API definition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_c_to_i.html">3. API (<code class="docutils literal"><span class="pre">c-i</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cluster.html">3.1. <code class="docutils literal"><span class="pre">scipy.cluster</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.html#clustering-package-scipy-cluster">3.1.1. Clustering package (<code class="docutils literal"><span class="pre">scipy.cluster</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.vq.html">3.1.2. K-means clustering and vector quantization (<code class="docutils literal"><span class="pre">scipy.cluster.vq</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.whiten.html">3.1.2.1. scipy.cluster.vq.whiten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.vq.html">3.1.2.2. scipy.cluster.vq.vq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.kmeans.html">3.1.2.3. scipy.cluster.vq.kmeans</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.kmeans2.html">3.1.2.4. scipy.cluster.vq.kmeans2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cluster.vq.html#background-information">3.1.2.5. Background information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.hierarchy.html">3.1.3. Hierarchical clustering (<code class="docutils literal"><span class="pre">scipy.cluster.hierarchy</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.fcluster.html">3.1.3.1. scipy.cluster.hierarchy.fcluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.fclusterdata.html">3.1.3.2. scipy.cluster.hierarchy.fclusterdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.leaders.html">3.1.3.3. scipy.cluster.hierarchy.leaders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.linkage.html">3.1.3.4. scipy.cluster.hierarchy.linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.single.html">3.1.3.5. scipy.cluster.hierarchy.single</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.complete.html">3.1.3.6. scipy.cluster.hierarchy.complete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.average.html">3.1.3.7. scipy.cluster.hierarchy.average</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.weighted.html">3.1.3.8. scipy.cluster.hierarchy.weighted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.centroid.html">3.1.3.9. scipy.cluster.hierarchy.centroid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.median.html">3.1.3.10. scipy.cluster.hierarchy.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.ward.html">3.1.3.11. scipy.cluster.hierarchy.ward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.cophenet.html">3.1.3.12. scipy.cluster.hierarchy.cophenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.from_mlab_linkage.html">3.1.3.13. scipy.cluster.hierarchy.from_mlab_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.inconsistent.html">3.1.3.14. scipy.cluster.hierarchy.inconsistent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxinconsts.html">3.1.3.15. scipy.cluster.hierarchy.maxinconsts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxdists.html">3.1.3.16. scipy.cluster.hierarchy.maxdists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxRstat.html">3.1.3.17. scipy.cluster.hierarchy.maxRstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.to_mlab_linkage.html">3.1.3.18. scipy.cluster.hierarchy.to_mlab_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.dendrogram.html">3.1.3.19. scipy.cluster.hierarchy.dendrogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.ClusterNode.html">3.1.3.20. scipy.cluster.hierarchy.ClusterNode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.leaves_list.html">3.1.3.21. scipy.cluster.hierarchy.leaves_list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.to_tree.html">3.1.3.22. scipy.cluster.hierarchy.to_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.cut_tree.html">3.1.3.23. scipy.cluster.hierarchy.cut_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_valid_im.html">3.1.3.24. scipy.cluster.hierarchy.is_valid_im</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_valid_linkage.html">3.1.3.25. scipy.cluster.hierarchy.is_valid_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_isomorphic.html">3.1.3.26. scipy.cluster.hierarchy.is_isomorphic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_monotonic.html">3.1.3.27. scipy.cluster.hierarchy.is_monotonic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.correspond.html">3.1.3.28. scipy.cluster.hierarchy.correspond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.num_obs_linkage.html">3.1.3.29. scipy.cluster.hierarchy.num_obs_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.set_link_color_palette.html">3.1.3.30. scipy.cluster.hierarchy.set_link_color_palette</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cluster.hierarchy.html#references">3.1.3.31. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../constants.html">3.2. Constants (<code class="docutils literal"><span class="pre">scipy.constants</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#mathematical-constants">3.2.1. Mathematical constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#physical-constants">3.2.2. Physical constants</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#constants-database">3.2.2.1. Constants database</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#units">3.2.3. Units</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#si-prefixes">3.2.3.1. SI prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#binary-prefixes">3.2.3.2. Binary prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#weight">3.2.3.3. Weight</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#angle">3.2.3.4. Angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#time">3.2.3.5. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#length">3.2.3.6. Length</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#pressure">3.2.3.7. Pressure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#area">3.2.3.8. Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#volume">3.2.3.9. Volume</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#speed">3.2.3.10. Speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#temperature">3.2.3.11. Temperature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#energy">3.2.3.12. Energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#power">3.2.3.13. Power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#force">3.2.3.14. Force</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#optics">3.2.3.15. Optics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#references">3.2.4. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../fftpack.html">3.3. Discrete Fourier transforms (<code class="docutils literal"><span class="pre">scipy.fftpack</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#fast-fourier-transforms-ffts">3.3.1. Fast Fourier Transforms (FFTs)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fft.html">3.3.1.1. scipy.fftpack.fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifft.html">3.3.1.2. scipy.fftpack.ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fft2.html">3.3.1.3. scipy.fftpack.fft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifft2.html">3.3.1.4. scipy.fftpack.ifft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftn.html">3.3.1.5. scipy.fftpack.fftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifftn.html">3.3.1.6. scipy.fftpack.ifftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.rfft.html">3.3.1.7. scipy.fftpack.rfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.irfft.html">3.3.1.8. scipy.fftpack.irfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.dct.html">3.3.1.9. scipy.fftpack.dct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.idct.html">3.3.1.10. scipy.fftpack.idct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.dst.html">3.3.1.11. scipy.fftpack.dst</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.idst.html">3.3.1.12. scipy.fftpack.idst</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#differential-and-pseudo-differential-operators">3.3.2. Differential and pseudo-differential operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.diff.html">3.3.2.1. scipy.fftpack.diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.tilbert.html">3.3.2.2. scipy.fftpack.tilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.itilbert.html">3.3.2.3. scipy.fftpack.itilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.hilbert.html">3.3.2.4. scipy.fftpack.hilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ihilbert.html">3.3.2.5. scipy.fftpack.ihilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.cs_diff.html">3.3.2.6. scipy.fftpack.cs_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.sc_diff.html">3.3.2.7. scipy.fftpack.sc_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ss_diff.html">3.3.2.8. scipy.fftpack.ss_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.cc_diff.html">3.3.2.9. scipy.fftpack.cc_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.shift.html">3.3.2.10. scipy.fftpack.shift</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#helper-functions">3.3.3. Helper functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftshift.html">3.3.3.1. scipy.fftpack.fftshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifftshift.html">3.3.3.2. scipy.fftpack.ifftshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftfreq.html">3.3.3.3. scipy.fftpack.fftfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.rfftfreq.html">3.3.3.4. scipy.fftpack.rfftfreq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#module-scipy.fftpack.convolve">3.3.4. Convolutions (<code class="docutils literal"><span class="pre">scipy.fftpack.convolve</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.convolve.html">3.3.4.1. scipy.fftpack.convolve.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.convolve_z.html">3.3.4.2. scipy.fftpack.convolve.convolve_z</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.init_convolution_kernel.html">3.3.4.3. scipy.fftpack.convolve.init_convolution_kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.destroy_convolve_cache.html">3.3.4.4. scipy.fftpack.convolve.destroy_convolve_cache</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../integrate.html">3.4. Integration and ODEs (<code class="docutils literal"><span class="pre">scipy.integrate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrating-functions-given-function-object">3.4.1. Integrating functions, given function object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quad.html">3.4.1.1. scipy.integrate.quad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.dblquad.html">3.4.1.2. scipy.integrate.dblquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.tplquad.html">3.4.1.3. scipy.integrate.tplquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.nquad.html">3.4.1.4. scipy.integrate.nquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.fixed_quad.html">3.4.1.5. scipy.integrate.fixed_quad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quadrature.html">3.4.1.6. scipy.integrate.quadrature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.romberg.html">3.4.1.7. scipy.integrate.romberg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quad_explain.html">3.4.1.8. scipy.integrate.quad_explain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.newton_cotes.html">3.4.1.9. scipy.integrate.newton_cotes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.IntegrationWarning.html">3.4.1.10. scipy.integrate.IntegrationWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrating-functions-given-fixed-samples">3.4.2. Integrating functions, given fixed samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.trapz.html">3.4.2.1. scipy.integrate.trapz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.cumtrapz.html">3.4.2.2. scipy.integrate.cumtrapz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.simps.html">3.4.2.3. scipy.integrate.simps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.romb.html">3.4.2.4. scipy.integrate.romb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrators-of-ode-systems">3.4.3. Integrators of ODE systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.odeint.html">3.4.3.1. scipy.integrate.odeint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.ode.html">3.4.3.2. scipy.integrate.ode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.complex_ode.html">3.4.3.3. scipy.integrate.complex_ode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../interpolate.html">3.5. Interpolation (<code class="docutils literal"><span class="pre">scipy.interpolate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#univariate-interpolation">3.5.1. Univariate interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interp1d.html">3.5.1.1. scipy.interpolate.interp1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BarycentricInterpolator.html">3.5.1.2. scipy.interpolate.BarycentricInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.KroghInterpolator.html">3.5.1.3. scipy.interpolate.KroghInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PiecewisePolynomial.html">3.5.1.4. scipy.interpolate.PiecewisePolynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PchipInterpolator.html">3.5.1.5. scipy.interpolate.PchipInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.barycentric_interpolate.html">3.5.1.6. scipy.interpolate.barycentric_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.krogh_interpolate.html">3.5.1.7. scipy.interpolate.krogh_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.piecewise_polynomial_interpolate.html">3.5.1.8. scipy.interpolate.piecewise_polynomial_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.pchip_interpolate.html">3.5.1.9. scipy.interpolate.pchip_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.Akima1DInterpolator.html">3.5.1.10. scipy.interpolate.Akima1DInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PPoly.html">3.5.1.11. scipy.interpolate.PPoly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BPoly.html">3.5.1.12. scipy.interpolate.BPoly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#multivariate-interpolation">3.5.2. Multivariate interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.griddata.html">3.5.2.1. scipy.interpolate.griddata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LinearNDInterpolator.html">3.5.2.2. scipy.interpolate.LinearNDInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.NearestNDInterpolator.html">3.5.2.3. scipy.interpolate.NearestNDInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.CloughTocher2DInterpolator.html">3.5.2.4. scipy.interpolate.CloughTocher2DInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.Rbf.html">3.5.2.5. scipy.interpolate.Rbf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interp2d.html">3.5.2.6. scipy.interpolate.interp2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interpn.html">3.5.2.7. scipy.interpolate.interpn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RegularGridInterpolator.html">3.5.2.8. scipy.interpolate.RegularGridInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectBivariateSpline.html">3.5.2.9. scipy.interpolate.RectBivariateSpline</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#d-splines">3.5.3. 1-D Splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.UnivariateSpline.html">3.5.3.1. scipy.interpolate.UnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.InterpolatedUnivariateSpline.html">3.5.3.2. scipy.interpolate.InterpolatedUnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQUnivariateSpline.html">3.5.3.3. scipy.interpolate.LSQUnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splrep.html">3.5.3.4. scipy.interpolate.splrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splprep.html">3.5.3.5. scipy.interpolate.splprep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splev.html">3.5.3.6. scipy.interpolate.splev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splint.html">3.5.3.7. scipy.interpolate.splint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.sproot.html">3.5.3.8. scipy.interpolate.sproot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spalde.html">3.5.3.9. scipy.interpolate.spalde</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splder.html">3.5.3.10. scipy.interpolate.splder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splantider.html">3.5.3.11. scipy.interpolate.splantider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.insert.html">3.5.3.12. scipy.interpolate.insert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#id1">3.5.4. 2-D Splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectBivariateSpline.html">3.5.2.9. scipy.interpolate.RectBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectSphereBivariateSpline.html">3.5.4.1. scipy.interpolate.RectSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BivariateSpline.html">3.5.4.2. scipy.interpolate.BivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.SmoothBivariateSpline.html">3.5.4.3. scipy.interpolate.SmoothBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.SmoothSphereBivariateSpline.html">3.5.4.4. scipy.interpolate.SmoothSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQBivariateSpline.html">3.5.4.5. scipy.interpolate.LSQBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQSphereBivariateSpline.html">3.5.4.6. scipy.interpolate.LSQSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.bisplrep.html">3.5.4.7. scipy.interpolate.bisplrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.bisplev.html">3.5.4.8. scipy.interpolate.bisplev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#additional-tools">3.5.5. Additional tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.lagrange.html">3.5.5.1. scipy.interpolate.lagrange</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.approximate_taylor_polynomial.html">3.5.5.2. scipy.interpolate.approximate_taylor_polynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.ppform.html">3.5.5.3. scipy.interpolate.ppform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spleval.html">3.5.5.4. scipy.interpolate.spleval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spline.html">3.5.5.5. scipy.interpolate.spline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splmake.html">3.5.5.6. scipy.interpolate.splmake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spltopp.html">3.5.5.7. scipy.interpolate.spltopp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.pchip.html">3.5.5.8. scipy.interpolate.pchip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../io.html">3.6. Input and output (<code class="docutils literal"><span class="pre">scipy.io</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#matlab-files">3.6.1. MATLAB® files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.loadmat.html">3.6.1.1. scipy.io.loadmat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.savemat.html">3.6.1.2. scipy.io.savemat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.whosmat.html">3.6.1.3. scipy.io.whosmat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#idl-files">3.6.2. IDL® files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.readsav.html">3.6.2.1. scipy.io.readsav</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#matrix-market-files">3.6.3. Matrix Market files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mminfo.html">3.6.3.1. scipy.io.mminfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mmread.html">3.6.3.2. scipy.io.mmread</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mmwrite.html">3.6.3.3. scipy.io.mmwrite</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#unformatted-fortran-files">3.6.4. Unformatted Fortran files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.FortranFile.html">3.6.4.1. scipy.io.FortranFile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#netcdf">3.6.5. Netcdf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.netcdf_file.html">3.6.5.1. scipy.io.netcdf_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.netcdf_variable.html">3.6.5.2. scipy.io.netcdf_variable</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#harwell-boeing-files">3.6.6. Harwell-Boeing files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.hb_read.html">3.6.6.1. scipy.io.hb_read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.hb_write.html">3.6.6.2. scipy.io.hb_write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#module-scipy.io.wavfile">3.6.7. Wav sound files (<code class="docutils literal"><span class="pre">scipy.io.wavfile</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.read.html">3.6.7.1. scipy.io.wavfile.read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.write.html">3.6.7.2. scipy.io.wavfile.write</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.WavFileWarning.html">3.6.7.3. scipy.io.wavfile.WavFileWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#module-scipy.io.arff">3.6.8. Arff files (<code class="docutils literal"><span class="pre">scipy.io.arff</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.loadarff.html">3.6.8.1. scipy.io.arff.loadarff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.MetaData.html">3.6.8.2. scipy.io.arff.MetaData</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.ArffError.html">3.6.8.3. scipy.io.arff.ArffError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.ParseArffError.html">3.6.8.4. scipy.io.arff.ParseArffError</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_l_to_o.html">4. API (<code class="docutils literal"><span class="pre">l-o</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg.html">4.1. Linear Algebra scipy.linalg</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.html#id1">4.1.1. Linear algebra (<code class="docutils literal"><span class="pre">scipy.linalg</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#basics">4.1.1.1. Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#eigenvalue-problems">4.1.1.2. Eigenvalue Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#decompositions">4.1.1.3. Decompositions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#matrix-functions">4.1.1.4. Matrix Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#matrix-equation-solvers">4.1.1.5. Matrix Equation Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#special-matrices">4.1.1.6. Special Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#low-level-routines">4.1.1.7. Low-level routines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.blas.html">4.1.2. Low-level BLAS functions (<code class="docutils literal"><span class="pre">scipy.linalg.blas</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#finding-functions">4.1.2.1. Finding functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-1-functions">4.1.2.2. BLAS Level 1 functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-2-functions">4.1.2.3. BLAS Level 2 functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-3-functions">4.1.2.4. BLAS Level 3 functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.lapack.html">4.1.3. Low-level LAPACK functions (<code class="docutils literal"><span class="pre">scipy.linalg.lapack</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.lapack.html#finding-functions">4.1.3.1. Finding functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.lapack.html#all-functions">4.1.3.2. All functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.cython_blas.html">4.1.4. BLAS Functions for Cython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.cython_lapack.html">4.1.5. LAPACK functions for Cython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.interpolative.html">4.1.6. Interpolative matrix decomposition (<code class="docutils literal"><span class="pre">scipy.linalg.interpolative</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#routines">4.1.6.1. Routines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#references">4.1.6.2. References</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#tutorial">4.1.6.3. Tutorial</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc.html">4.2. Miscellaneous routines (<code class="docutils literal"><span class="pre">scipy.misc</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.ascent.html">4.2.1. scipy.misc.ascent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.bytescale.html">4.2.2. scipy.misc.bytescale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.central_diff_weights.html">4.2.3. scipy.misc.central_diff_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.comb.html">4.2.4. scipy.misc.comb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.derivative.html">4.2.5. scipy.misc.derivative</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.face.html">4.2.6. scipy.misc.face</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorial.html">4.2.7. scipy.misc.factorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorial2.html">4.2.8. scipy.misc.factorial2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorialk.html">4.2.9. scipy.misc.factorialk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.fromimage.html">4.2.10. scipy.misc.fromimage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imfilter.html">4.2.11. scipy.misc.imfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imread.html">4.2.12. scipy.misc.imread</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imresize.html">4.2.13. scipy.misc.imresize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imrotate.html">4.2.14. scipy.misc.imrotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imsave.html">4.2.15. scipy.misc.imsave</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imshow.html">4.2.16. scipy.misc.imshow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.info.html">4.2.17. scipy.misc.info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.lena.html">4.2.18. scipy.misc.lena</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.logsumexp.html">4.2.19. scipy.misc.logsumexp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.pade.html">4.2.20. scipy.misc.pade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.toimage.html">4.2.21. scipy.misc.toimage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.source.html">4.2.22. scipy.misc.source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.who.html">4.2.23. scipy.misc.who</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../ndimage.html">4.3. Multi-dimensional image processing (<code class="docutils literal"><span class="pre">scipy.ndimage</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#filters">4.3.1. Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.convolve.html">4.3.1.1. scipy.ndimage.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.convolve1d.html">4.3.1.2. scipy.ndimage.convolve1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.correlate.html">4.3.1.3. scipy.ndimage.correlate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.correlate1d.html">4.3.1.4. scipy.ndimage.correlate1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_filter.html">4.3.1.5. scipy.ndimage.gaussian_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_filter1d.html">4.3.1.6. scipy.ndimage.gaussian_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_gradient_magnitude.html">4.3.1.7. scipy.ndimage.gaussian_gradient_magnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_laplace.html">4.3.1.8. scipy.ndimage.gaussian_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_filter.html">4.3.1.9. scipy.ndimage.generic_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_filter1d.html">4.3.1.10. scipy.ndimage.generic_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_gradient_magnitude.html">4.3.1.11. scipy.ndimage.generic_gradient_magnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_laplace.html">4.3.1.12. scipy.ndimage.generic_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.laplace.html">4.3.1.13. scipy.ndimage.laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_filter.html">4.3.1.14. scipy.ndimage.maximum_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_filter1d.html">4.3.1.15. scipy.ndimage.maximum_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.median_filter.html">4.3.1.16. scipy.ndimage.median_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_filter.html">4.3.1.17. scipy.ndimage.minimum_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_filter1d.html">4.3.1.18. scipy.ndimage.minimum_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.percentile_filter.html">4.3.1.19. scipy.ndimage.percentile_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.prewitt.html">4.3.1.20. scipy.ndimage.prewitt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.rank_filter.html">4.3.1.21. scipy.ndimage.rank_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.sobel.html">4.3.1.22. scipy.ndimage.sobel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.uniform_filter.html">4.3.1.23. scipy.ndimage.uniform_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.uniform_filter1d.html">4.3.1.24. scipy.ndimage.uniform_filter1d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#fourier-filters">4.3.2. Fourier filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_ellipsoid.html">4.3.2.1. scipy.ndimage.fourier_ellipsoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_gaussian.html">4.3.2.2. scipy.ndimage.fourier_gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_shift.html">4.3.2.3. scipy.ndimage.fourier_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_uniform.html">4.3.2.4. scipy.ndimage.fourier_uniform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#interpolation">4.3.3. Interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.affine_transform.html">4.3.3.1. scipy.ndimage.affine_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.geometric_transform.html">4.3.3.2. scipy.ndimage.geometric_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.map_coordinates.html">4.3.3.3. scipy.ndimage.map_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.rotate.html">4.3.3.4. scipy.ndimage.rotate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.shift.html">4.3.3.5. scipy.ndimage.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.spline_filter.html">4.3.3.6. scipy.ndimage.spline_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.spline_filter1d.html">4.3.3.7. scipy.ndimage.spline_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.zoom.html">4.3.3.8. scipy.ndimage.zoom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#measurements">4.3.4. Measurements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.center_of_mass.html">4.3.4.1. scipy.ndimage.center_of_mass</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.extrema.html">4.3.4.2. scipy.ndimage.extrema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.find_objects.html">4.3.4.3. scipy.ndimage.find_objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.histogram.html">4.3.4.4. scipy.ndimage.histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.label.html">4.3.4.5. scipy.ndimage.label</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.labeled_comprehension.html">4.3.4.6. scipy.ndimage.labeled_comprehension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum.html">4.3.4.7. scipy.ndimage.maximum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_position.html">4.3.4.8. scipy.ndimage.maximum_position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.mean.html">4.3.4.9. scipy.ndimage.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.median.html">4.3.4.10. scipy.ndimage.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum.html">4.3.4.11. scipy.ndimage.minimum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_position.html">4.3.4.12. scipy.ndimage.minimum_position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.standard_deviation.html">4.3.4.13. scipy.ndimage.standard_deviation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.sum.html">4.3.4.14. scipy.ndimage.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.variance.html">4.3.4.15. scipy.ndimage.variance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.watershed_ift.html">4.3.4.16. scipy.ndimage.watershed_ift</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#morphology">4.3.5. Morphology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_closing.html">4.3.5.1. scipy.ndimage.binary_closing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_dilation.html">4.3.5.2. scipy.ndimage.binary_dilation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_erosion.html">4.3.5.3. scipy.ndimage.binary_erosion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_fill_holes.html">4.3.5.4. scipy.ndimage.binary_fill_holes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_hit_or_miss.html">4.3.5.5. scipy.ndimage.binary_hit_or_miss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_opening.html">4.3.5.6. scipy.ndimage.binary_opening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_propagation.html">4.3.5.7. scipy.ndimage.binary_propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.black_tophat.html">4.3.5.8. scipy.ndimage.black_tophat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_bf.html">4.3.5.9. scipy.ndimage.distance_transform_bf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_cdt.html">4.3.5.10. scipy.ndimage.distance_transform_cdt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_edt.html">4.3.5.11. scipy.ndimage.distance_transform_edt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generate_binary_structure.html">4.3.5.12. scipy.ndimage.generate_binary_structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_closing.html">4.3.5.13. scipy.ndimage.grey_closing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_dilation.html">4.3.5.14. scipy.ndimage.grey_dilation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_erosion.html">4.3.5.15. scipy.ndimage.grey_erosion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_opening.html">4.3.5.16. scipy.ndimage.grey_opening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.iterate_structure.html">4.3.5.17. scipy.ndimage.iterate_structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.morphological_gradient.html">4.3.5.18. scipy.ndimage.morphological_gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.morphological_laplace.html">4.3.5.19. scipy.ndimage.morphological_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.white_tophat.html">4.3.5.20. scipy.ndimage.white_tophat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#utility">4.3.6. Utility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.imread.html">4.3.6.1. scipy.ndimage.imread</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../odr.html">4.4. Orthogonal distance regression (<code class="docutils literal"><span class="pre">scipy.odr</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../odr.html#package-content">4.4.1. Package Content</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Data.html">4.4.1.1. scipy.odr.Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.RealData.html">4.4.1.2. scipy.odr.RealData</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Model.html">4.4.1.3. scipy.odr.Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.ODR.html">4.4.1.4. scipy.odr.ODR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Output.html">4.4.1.5. scipy.odr.Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr.html">4.4.1.6. scipy.odr.odr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr_error.html">4.4.1.7. scipy.odr.odr_error</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr_stop.html">4.4.1.8. scipy.odr.odr_stop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.polynomial.html">4.4.1.9. scipy.odr.polynomial</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../odr.html#usage-information">4.4.2. Usage information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#introduction">4.4.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#basic-usage">4.4.2.2. Basic usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#references">4.4.2.3. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimize.html">4.5. Optimization and root finding (<code class="docutils literal"><span class="pre">scipy.optimize</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#optimization">4.5.1. Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#local-optimization">4.5.1.1. Local Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#equation-local-minimizers">4.5.1.2. Equation (Local) Minimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#global-optimization">4.5.1.3. Global Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#rosenbrock-function">4.5.1.4. Rosenbrock function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#fitting">4.5.2. Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.curve_fit.html">4.5.2.1. scipy.optimize.curve_fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#root-finding">4.5.3. Root finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#scalar-functions">4.5.3.1. Scalar functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#multidimensional">4.5.3.2. Multidimensional</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#linear-programming">4.5.4. Linear Programming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linprog.html">4.5.4.1. scipy.optimize.linprog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linprog_verbose_callback.html">4.5.4.2. scipy.optimize.linprog_verbose_callback</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.linprog-simplex.html">4.5.4.3. linprog(method=&#8217;Simplex&#8217;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linear_sum_assignment.html">4.5.4.4. scipy.optimize.linear_sum_assignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#utilities">4.5.5. Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.approx_fprime.html">4.5.5.1. scipy.optimize.approx_fprime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.bracket.html">4.5.5.2. scipy.optimize.bracket</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.check_grad.html">4.5.5.3. scipy.optimize.check_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.line_search.html">4.5.5.4. scipy.optimize.line_search</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.show_options.html">4.5.5.5. scipy.optimize.show_options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.LbfgsInvHessProduct.html">4.5.5.6. scipy.optimize.LbfgsInvHessProduct</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimize.nonlin.html">4.6. Nonlinear solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.nonlin.html#routines">4.6.1. Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.nonlin.html#examples">4.6.2. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_s_to_w.html">5. API (<code class="docutils literal"><span class="pre">s-w</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../signal.html">5.1. Signal processing (<code class="docutils literal"><span class="pre">scipy.signal</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#convolution">5.1.1. Convolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.convolve.html">5.1.1.1. scipy.signal.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.correlate.html">5.1.1.2. scipy.signal.correlate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.fftconvolve.html">5.1.1.3. scipy.signal.fftconvolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.convolve2d.html">5.1.1.4. scipy.signal.convolve2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.correlate2d.html">5.1.1.5. scipy.signal.correlate2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sepfir2d.html">5.1.1.6. scipy.signal.sepfir2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#b-splines">5.1.2. B-splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bspline.html">5.1.2.1. scipy.signal.bspline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cubic.html">5.1.2.2. scipy.signal.cubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.quadratic.html">5.1.2.3. scipy.signal.quadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gauss_spline.html">5.1.2.4. scipy.signal.gauss_spline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline1d.html">5.1.2.5. scipy.signal.cspline1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline1d.html">5.1.2.6. scipy.signal.qspline1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline2d.html">5.1.2.7. scipy.signal.cspline2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline2d.html">5.1.2.8. scipy.signal.qspline2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline1d_eval.html">5.1.2.9. scipy.signal.cspline1d_eval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline1d_eval.html">5.1.2.10. scipy.signal.qspline1d_eval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.spline_filter.html">5.1.2.11. scipy.signal.spline_filter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#filtering">5.1.3. Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.order_filter.html">5.1.3.1. scipy.signal.order_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.medfilt.html">5.1.3.2. scipy.signal.medfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.medfilt2d.html">5.1.3.3. scipy.signal.medfilt2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.wiener.html">5.1.3.4. scipy.signal.wiener</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.symiirorder1.html">5.1.3.5. scipy.signal.symiirorder1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.symiirorder2.html">5.1.3.6. scipy.signal.symiirorder2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfilter.html">5.1.3.7. scipy.signal.lfilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfiltic.html">5.1.3.8. scipy.signal.lfiltic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfilter_zi.html">5.1.3.9. scipy.signal.lfilter_zi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.filtfilt.html">5.1.3.10. scipy.signal.filtfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.savgol_filter.html">5.1.3.11. scipy.signal.savgol_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.deconvolve.html">5.1.3.12. scipy.signal.deconvolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sosfilt.html">5.1.3.13. scipy.signal.sosfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sosfilt_zi.html">5.1.3.14. scipy.signal.sosfilt_zi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hilbert.html">5.1.3.15. scipy.signal.hilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hilbert2.html">5.1.3.16. scipy.signal.hilbert2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.decimate.html">5.1.3.17. scipy.signal.decimate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.detrend.html">5.1.3.18. scipy.signal.detrend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.resample.html">5.1.3.19. scipy.signal.resample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#filter-design">5.1.4. Filter design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bilinear.html">5.1.4.1. scipy.signal.bilinear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.findfreqs.html">5.1.4.2. scipy.signal.findfreqs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.firwin.html">5.1.4.3. scipy.signal.firwin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.firwin2.html">5.1.4.4. scipy.signal.firwin2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqs.html">5.1.4.5. scipy.signal.freqs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqz.html">5.1.4.6. scipy.signal.freqz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.group_delay.html">5.1.4.7. scipy.signal.group_delay</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.iirdesign.html">5.1.4.8. scipy.signal.iirdesign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.iirfilter.html">5.1.4.9. scipy.signal.iirfilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser_atten.html">5.1.4.10. scipy.signal.kaiser_atten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser_beta.html">5.1.4.11. scipy.signal.kaiser_beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiserord.html">5.1.4.12. scipy.signal.kaiserord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.savgol_coeffs.html">5.1.4.13. scipy.signal.savgol_coeffs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.remez.html">5.1.4.14. scipy.signal.remez</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.unique_roots.html">5.1.4.15. scipy.signal.unique_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.residue.html">5.1.4.16. scipy.signal.residue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.residuez.html">5.1.4.17. scipy.signal.residuez</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.invres.html">5.1.4.18. scipy.signal.invres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.invresz.html">5.1.4.19. scipy.signal.invresz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.BadCoefficients.html">5.1.4.20. scipy.signal.BadCoefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.abcd_normalize.html">5.1.4.21. scipy.signal.abcd_normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.band_stop_obj.html">5.1.4.22. scipy.signal.band_stop_obj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.besselap.html">5.1.4.23. scipy.signal.besselap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.buttap.html">5.1.4.24. scipy.signal.buttap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb1ap.html">5.1.4.25. scipy.signal.cheb1ap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb2ap.html">5.1.4.26. scipy.signal.cheb2ap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cmplx_sort.html">5.1.4.27. scipy.signal.cmplx_sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellipap.html">5.1.4.28. scipy.signal.ellipap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2bp.html">5.1.4.29. scipy.signal.lp2bp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2bs.html">5.1.4.30. scipy.signal.lp2bs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2hp.html">5.1.4.31. scipy.signal.lp2hp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2lp.html">5.1.4.32. scipy.signal.lp2lp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.normalize.html">5.1.4.33. scipy.signal.normalize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#matlab-style-iir-filter-design">5.1.5. Matlab-style IIR filter design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.butter.html">5.1.5.1. scipy.signal.butter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.buttord.html">5.1.5.2. scipy.signal.buttord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheby1.html">5.1.5.3. scipy.signal.cheby1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb1ord.html">5.1.5.4. scipy.signal.cheb1ord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheby2.html">5.1.5.5. scipy.signal.cheby2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb2ord.html">5.1.5.6. scipy.signal.cheb2ord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellip.html">5.1.5.7. scipy.signal.ellip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellipord.html">5.1.5.8. scipy.signal.ellipord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bessel.html">5.1.5.9. scipy.signal.bessel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#continuous-time-linear-systems">5.1.6. Continuous-Time Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqresp.html">5.1.6.1. scipy.signal.freqresp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lti.html">5.1.6.2. scipy.signal.lti</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.StateSpace.html">5.1.6.3. scipy.signal.StateSpace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.TransferFunction.html">5.1.6.4. scipy.signal.TransferFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ZerosPolesGain.html">5.1.6.5. scipy.signal.ZerosPolesGain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lsim.html">5.1.6.6. scipy.signal.lsim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lsim2.html">5.1.6.7. scipy.signal.lsim2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.impulse.html">5.1.6.8. scipy.signal.impulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.impulse2.html">5.1.6.9. scipy.signal.impulse2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.step.html">5.1.6.10. scipy.signal.step</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.step2.html">5.1.6.11. scipy.signal.step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bode.html">5.1.6.12. scipy.signal.bode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#discrete-time-linear-systems">5.1.7. Discrete-Time Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dlsim.html">5.1.7.1. scipy.signal.dlsim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dimpulse.html">5.1.7.2. scipy.signal.dimpulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dstep.html">5.1.7.3. scipy.signal.dstep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#lti-representations">5.1.8. LTI Representations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2zpk.html">5.1.8.1. scipy.signal.tf2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2sos.html">5.1.8.2. scipy.signal.tf2sos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2ss.html">5.1.8.3. scipy.signal.tf2ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2tf.html">5.1.8.4. scipy.signal.zpk2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2sos.html">5.1.8.5. scipy.signal.zpk2sos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2ss.html">5.1.8.6. scipy.signal.zpk2ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ss2tf.html">5.1.8.7. scipy.signal.ss2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ss2zpk.html">5.1.8.8. scipy.signal.ss2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sos2zpk.html">5.1.8.9. scipy.signal.sos2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sos2tf.html">5.1.8.10. scipy.signal.sos2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cont2discrete.html">5.1.8.11. scipy.signal.cont2discrete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.place_poles.html">5.1.8.12. scipy.signal.place_poles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#waveforms">5.1.9. Waveforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.chirp.html">5.1.9.1. scipy.signal.chirp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gausspulse.html">5.1.9.2. scipy.signal.gausspulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.max_len_seq.html">5.1.9.3. scipy.signal.max_len_seq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sawtooth.html">5.1.9.4. scipy.signal.sawtooth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.square.html">5.1.9.5. scipy.signal.square</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sweep_poly.html">5.1.9.6. scipy.signal.sweep_poly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#window-functions">5.1.10. Window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.get_window.html">5.1.10.1. scipy.signal.get_window</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.barthann.html">5.1.10.2. scipy.signal.barthann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bartlett.html">5.1.10.3. scipy.signal.bartlett</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.blackman.html">5.1.10.4. scipy.signal.blackman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.blackmanharris.html">5.1.10.5. scipy.signal.blackmanharris</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bohman.html">5.1.10.6. scipy.signal.bohman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.boxcar.html">5.1.10.7. scipy.signal.boxcar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.chebwin.html">5.1.10.8. scipy.signal.chebwin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cosine.html">5.1.10.9. scipy.signal.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.exponential.html">5.1.10.10. scipy.signal.exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.flattop.html">5.1.10.11. scipy.signal.flattop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gaussian.html">5.1.10.12. scipy.signal.gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.general_gaussian.html">5.1.10.13. scipy.signal.general_gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hamming.html">5.1.10.14. scipy.signal.hamming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hann.html">5.1.10.15. scipy.signal.hann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hanning.html">5.1.10.16. scipy.signal.hanning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser.html">5.1.10.17. scipy.signal.kaiser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.nuttall.html">5.1.10.18. scipy.signal.nuttall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.parzen.html">5.1.10.19. scipy.signal.parzen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.slepian.html">5.1.10.20. scipy.signal.slepian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.triang.html">5.1.10.21. scipy.signal.triang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tukey.html">5.1.10.22. scipy.signal.tukey</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#wavelets">5.1.11. Wavelets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cascade.html">5.1.11.1. scipy.signal.cascade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.daub.html">5.1.11.2. scipy.signal.daub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.morlet.html">5.1.11.3. scipy.signal.morlet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qmf.html">5.1.11.4. scipy.signal.qmf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ricker.html">5.1.11.5. scipy.signal.ricker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cwt.html">5.1.11.6. scipy.signal.cwt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#peak-finding">5.1.12. Peak finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.find_peaks_cwt.html">5.1.12.1. scipy.signal.find_peaks_cwt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelmin.html">5.1.12.2. scipy.signal.argrelmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelmax.html">5.1.12.3. scipy.signal.argrelmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelextrema.html">5.1.12.4. scipy.signal.argrelextrema</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#spectral-analysis">5.1.13. Spectral Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.periodogram.html">5.1.13.1. scipy.signal.periodogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.welch.html">5.1.13.2. scipy.signal.welch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.csd.html">5.1.13.3. scipy.signal.csd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.coherence.html">5.1.13.4. scipy.signal.coherence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.spectrogram.html">5.1.13.5. scipy.signal.spectrogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lombscargle.html">5.1.13.6. scipy.signal.lombscargle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.vectorstrength.html">5.1.13.7. scipy.signal.vectorstrength</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.html">5.2. Sparse matrices (<code class="docutils literal"><span class="pre">scipy.sparse</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.html#contents">5.2.1. Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#sparse-matrix-classes">5.2.1.1. Sparse matrix classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#functions">5.2.1.2. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#submodules">5.2.1.3. Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#exceptions">5.2.1.4. Exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.html#usage-information">5.2.2. Usage information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#matrix-vector-product">5.2.2.1. Matrix vector product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#example-1">5.2.2.2. Example 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#example-2">5.2.2.3. Example 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#further-details">5.2.2.4. Further Details</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.linalg.html">5.3. Sparse linear algebra (<code class="docutils literal"><span class="pre">scipy.sparse.linalg</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#abstract-linear-operators">5.3.1. Abstract linear operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.LinearOperator.html">5.3.1.1. scipy.sparse.linalg.LinearOperator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.aslinearoperator.html">5.3.1.2. scipy.sparse.linalg.aslinearoperator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-operations">5.3.2. Matrix Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.inv.html">5.3.2.1. scipy.sparse.linalg.inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.expm.html">5.3.2.2. scipy.sparse.linalg.expm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.expm_multiply.html">5.3.2.3. scipy.sparse.linalg.expm_multiply</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-norms">5.3.3. Matrix norms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.norm.html">5.3.3.1. scipy.sparse.linalg.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.onenormest.html">5.3.3.2. scipy.sparse.linalg.onenormest</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#solving-linear-problems">5.3.4. Solving linear problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.spsolve.html">5.3.4.1. scipy.sparse.linalg.spsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.factorized.html">5.3.4.2. scipy.sparse.linalg.factorized</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.MatrixRankWarning.html">5.3.4.3. scipy.sparse.linalg.MatrixRankWarning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.use_solver.html">5.3.4.4. scipy.sparse.linalg.use_solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.bicg.html">5.3.4.5. scipy.sparse.linalg.bicg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.bicgstab.html">5.3.4.6. scipy.sparse.linalg.bicgstab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.cg.html">5.3.4.7. scipy.sparse.linalg.cg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.cgs.html">5.3.4.8. scipy.sparse.linalg.cgs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.gmres.html">5.3.4.9. scipy.sparse.linalg.gmres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lgmres.html">5.3.4.10. scipy.sparse.linalg.lgmres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.minres.html">5.3.4.11. scipy.sparse.linalg.minres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.qmr.html">5.3.4.12. scipy.sparse.linalg.qmr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lsqr.html">5.3.4.13. scipy.sparse.linalg.lsqr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lsmr.html">5.3.4.14. scipy.sparse.linalg.lsmr</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-factorizations">5.3.5. Matrix factorizations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.eigs.html">5.3.5.1. scipy.sparse.linalg.eigs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.eigsh.html">5.3.5.2. scipy.sparse.linalg.eigsh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lobpcg.html">5.3.5.3. scipy.sparse.linalg.lobpcg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.svds.html">5.3.5.4. scipy.sparse.linalg.svds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.splu.html">5.3.5.5. scipy.sparse.linalg.splu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.spilu.html">5.3.5.6. scipy.sparse.linalg.spilu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.SuperLU.html">5.3.5.7. scipy.sparse.linalg.SuperLU</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#exceptions">5.3.6. Exceptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.ArpackNoConvergence.html">5.3.6.1. scipy.sparse.linalg.ArpackNoConvergence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.ArpackError.html">5.3.6.2. scipy.sparse.linalg.ArpackError</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.csgraph.html">5.4. Compressed Sparse Graph Routines (<code class="docutils literal"><span class="pre">scipy.sparse.csgraph</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.csgraph.html#contents">5.4.1. Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.connected_components.html">5.4.1.1. scipy.sparse.csgraph.connected_components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.laplacian.html">5.4.1.2. scipy.sparse.csgraph.laplacian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.shortest_path.html">5.4.1.3. scipy.sparse.csgraph.shortest_path</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.dijkstra.html">5.4.1.4. scipy.sparse.csgraph.dijkstra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.floyd_warshall.html">5.4.1.5. scipy.sparse.csgraph.floyd_warshall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.bellman_ford.html">5.4.1.6. scipy.sparse.csgraph.bellman_ford</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.johnson.html">5.4.1.7. scipy.sparse.csgraph.johnson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.breadth_first_order.html">5.4.1.8. scipy.sparse.csgraph.breadth_first_order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.depth_first_order.html">5.4.1.9. scipy.sparse.csgraph.depth_first_order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.breadth_first_tree.html">5.4.1.10. scipy.sparse.csgraph.breadth_first_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.depth_first_tree.html">5.4.1.11. scipy.sparse.csgraph.depth_first_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.minimum_spanning_tree.html">5.4.1.12. scipy.sparse.csgraph.minimum_spanning_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.reverse_cuthill_mckee.html">5.4.1.13. scipy.sparse.csgraph.reverse_cuthill_mckee</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.maximum_bipartite_matching.html">5.4.1.14. scipy.sparse.csgraph.maximum_bipartite_matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.NegativeCycleError.html">5.4.1.15. scipy.sparse.csgraph.NegativeCycleError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.construct_dist_matrix.html">5.4.1.16. scipy.sparse.csgraph.construct_dist_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_from_dense.html">5.4.1.17. scipy.sparse.csgraph.csgraph_from_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_from_masked.html">5.4.1.18. scipy.sparse.csgraph.csgraph_from_masked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_masked_from_dense.html">5.4.1.19. scipy.sparse.csgraph.csgraph_masked_from_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_to_dense.html">5.4.1.20. scipy.sparse.csgraph.csgraph_to_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_to_masked.html">5.4.1.21. scipy.sparse.csgraph.csgraph_to_masked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.reconstruct_path.html">5.4.1.22. scipy.sparse.csgraph.reconstruct_path</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.csgraph.html#graph-representations">5.4.2. Graph Representations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.csgraph.html#directed-vs-undirected">5.4.2.1. Directed vs. Undirected</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../spatial.html">5.5. Spatial algorithms and data structures (<code class="docutils literal"><span class="pre">scipy.spatial</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#nearest-neighbor-queries">5.5.1. Nearest-neighbor Queries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.KDTree.html">5.5.1.1. scipy.spatial.KDTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.cKDTree.html">5.5.1.2. scipy.spatial.cKDTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.html">5.5.1.3. scipy.spatial.distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Rectangle.html">5.5.1.4. scipy.spatial.Rectangle</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#delaunay-triangulation-convex-hulls-and-voronoi-diagrams">5.5.2. Delaunay Triangulation, Convex Hulls and Voronoi Diagrams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Delaunay.html">5.5.2.1. scipy.spatial.Delaunay</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.ConvexHull.html">5.5.2.2. scipy.spatial.ConvexHull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Voronoi.html">5.5.2.3. scipy.spatial.Voronoi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#plotting-helpers">5.5.3. Plotting Helpers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.delaunay_plot_2d.html">5.5.3.1. scipy.spatial.delaunay_plot_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.convex_hull_plot_2d.html">5.5.3.2. scipy.spatial.convex_hull_plot_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.voronoi_plot_2d.html">5.5.3.3. scipy.spatial.voronoi_plot_2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#simplex-representation">5.5.4. Simplex representation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../spatial.html#functions">5.5.4.1. Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../spatial.distance.html">5.6. Distance computations (<code class="docutils literal"><span class="pre">scipy.spatial.distance</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.distance.html#function-reference">5.6.1. Function Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.pdist.html">5.6.1.1. scipy.spatial.distance.pdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cdist.html">5.6.1.2. scipy.spatial.distance.cdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.squareform.html">5.6.1.3. scipy.spatial.distance.squareform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.is_valid_dm.html">5.6.1.4. scipy.spatial.distance.is_valid_dm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.is_valid_y.html">5.6.1.5. scipy.spatial.distance.is_valid_y</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.num_obs_dm.html">5.6.1.6. scipy.spatial.distance.num_obs_dm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.num_obs_y.html">5.6.1.7. scipy.spatial.distance.num_obs_y</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.braycurtis.html">5.6.1.8. scipy.spatial.distance.braycurtis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.canberra.html">5.6.1.9. scipy.spatial.distance.canberra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.chebyshev.html">5.6.1.10. scipy.spatial.distance.chebyshev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cityblock.html">5.6.1.11. scipy.spatial.distance.cityblock</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.correlation.html">5.6.1.12. scipy.spatial.distance.correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cosine.html">5.6.1.13. scipy.spatial.distance.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.dice.html">5.6.1.14. scipy.spatial.distance.dice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.euclidean.html">5.6.1.15. scipy.spatial.distance.euclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.hamming.html">5.6.1.16. scipy.spatial.distance.hamming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.jaccard.html">5.6.1.17. scipy.spatial.distance.jaccard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.kulsinski.html">5.6.1.18. scipy.spatial.distance.kulsinski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.mahalanobis.html">5.6.1.19. scipy.spatial.distance.mahalanobis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.matching.html">5.6.1.20. scipy.spatial.distance.matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.minkowski.html">5.6.1.21. scipy.spatial.distance.minkowski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.rogerstanimoto.html">5.6.1.22. scipy.spatial.distance.rogerstanimoto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.russellrao.html">5.6.1.23. scipy.spatial.distance.russellrao</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.seuclidean.html">5.6.1.24. scipy.spatial.distance.seuclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sokalmichener.html">5.6.1.25. scipy.spatial.distance.sokalmichener</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sokalsneath.html">5.6.1.26. scipy.spatial.distance.sokalsneath</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sqeuclidean.html">5.6.1.27. scipy.spatial.distance.sqeuclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.wminkowski.html">5.6.1.28. scipy.spatial.distance.wminkowski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.yule.html">5.6.1.29. scipy.spatial.distance.yule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../special.html">5.7. Special functions (<code class="docutils literal"><span class="pre">scipy.special</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../special.html#error-handling">5.7.1. Error handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.special.errprint.html">5.7.1.1. scipy.special.errprint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.special.SpecialFunctionWarning.html">5.7.1.2. scipy.special.SpecialFunctionWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../special.html#available-functions">5.7.2. Available functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#airy-functions">5.7.2.1. Airy functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#elliptic-functions-and-integrals">5.7.2.2. Elliptic Functions and Integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#bessel-functions">5.7.2.3. Bessel Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#struve-functions">5.7.2.4. Struve Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#raw-statistical-functions">5.7.2.5. Raw Statistical Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#information-theory-functions">5.7.2.6. Information Theory Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#gamma-and-related-functions">5.7.2.7. Gamma and Related Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#error-function-and-fresnel-integrals">5.7.2.8. Error Function and Fresnel Integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#legendre-functions">5.7.2.9. Legendre Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#ellipsoidal-harmonics">5.7.2.10. Ellipsoidal Harmonics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#orthogonal-polynomials">5.7.2.11. Orthogonal polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#hypergeometric-functions">5.7.2.12. Hypergeometric Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#parabolic-cylinder-functions">5.7.2.13. Parabolic Cylinder Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#mathieu-and-related-functions">5.7.2.14. Mathieu and Related Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#spheroidal-wave-functions">5.7.2.15. Spheroidal Wave Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#kelvin-functions">5.7.2.16. Kelvin Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#combinatorics">5.7.2.17. Combinatorics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#other-special-functions">5.7.2.18. Other Special Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#convenience-functions">5.7.2.19. Convenience Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../stats.html">5.8. Statistical functions (<code class="docutils literal"><span class="pre">scipy.stats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.rv_continuous.html">5.8.1. scipy.stats.rv_continuous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.rv_discrete.html">5.8.2. scipy.stats.rv_discrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#continuous-distributions">5.8.3. Continuous distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.alpha.html">5.8.3.1. scipy.stats.alpha</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anglit.html">5.8.3.2. scipy.stats.anglit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.arcsine.html">5.8.3.3. scipy.stats.arcsine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.beta.html">5.8.3.4. scipy.stats.beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.betaprime.html">5.8.3.5. scipy.stats.betaprime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bradford.html">5.8.3.6. scipy.stats.bradford</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.burr.html">5.8.3.7. scipy.stats.burr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cauchy.html">5.8.3.8. scipy.stats.cauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi.html">5.8.3.9. scipy.stats.chi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi2.html">5.8.3.10. scipy.stats.chi2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cosine.html">5.8.3.11. scipy.stats.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dgamma.html">5.8.3.12. scipy.stats.dgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dweibull.html">5.8.3.13. scipy.stats.dweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.erlang.html">5.8.3.14. scipy.stats.erlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.expon.html">5.8.3.15. scipy.stats.expon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponnorm.html">5.8.3.16. scipy.stats.exponnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponweib.html">5.8.3.17. scipy.stats.exponweib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponpow.html">5.8.3.18. scipy.stats.exponpow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f.html">5.8.3.19. scipy.stats.f</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fatiguelife.html">5.8.3.20. scipy.stats.fatiguelife</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fisk.html">5.8.3.21. scipy.stats.fisk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.foldcauchy.html">5.8.3.22. scipy.stats.foldcauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.foldnorm.html">5.8.3.23. scipy.stats.foldnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.frechet_r.html">5.8.3.24. scipy.stats.frechet_r</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.frechet_l.html">5.8.3.25. scipy.stats.frechet_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genlogistic.html">5.8.3.26. scipy.stats.genlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gennorm.html">5.8.3.27. scipy.stats.gennorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genpareto.html">5.8.3.28. scipy.stats.genpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genexpon.html">5.8.3.29. scipy.stats.genexpon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genextreme.html">5.8.3.30. scipy.stats.genextreme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gausshyper.html">5.8.3.31. scipy.stats.gausshyper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gamma.html">5.8.3.32. scipy.stats.gamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gengamma.html">5.8.3.33. scipy.stats.gengamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genhalflogistic.html">5.8.3.34. scipy.stats.genhalflogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gilbrat.html">5.8.3.35. scipy.stats.gilbrat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gompertz.html">5.8.3.36. scipy.stats.gompertz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gumbel_r.html">5.8.3.37. scipy.stats.gumbel_r</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gumbel_l.html">5.8.3.38. scipy.stats.gumbel_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfcauchy.html">5.8.3.39. scipy.stats.halfcauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halflogistic.html">5.8.3.40. scipy.stats.halflogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfnorm.html">5.8.3.41. scipy.stats.halfnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfgennorm.html">5.8.3.42. scipy.stats.halfgennorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hypsecant.html">5.8.3.43. scipy.stats.hypsecant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invgamma.html">5.8.3.44. scipy.stats.invgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invgauss.html">5.8.3.45. scipy.stats.invgauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invweibull.html">5.8.3.46. scipy.stats.invweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.johnsonsb.html">5.8.3.47. scipy.stats.johnsonsb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.johnsonsu.html">5.8.3.48. scipy.stats.johnsonsu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ksone.html">5.8.3.49. scipy.stats.ksone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstwobign.html">5.8.3.50. scipy.stats.kstwobign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.laplace.html">5.8.3.51. scipy.stats.laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy.html">5.8.3.52. scipy.stats.levy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy_l.html">5.8.3.53. scipy.stats.levy_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy_stable.html">5.8.3.54. scipy.stats.levy_stable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.logistic.html">5.8.3.55. scipy.stats.logistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.loggamma.html">5.8.3.56. scipy.stats.loggamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.loglaplace.html">5.8.3.57. scipy.stats.loglaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.lognorm.html">5.8.3.58. scipy.stats.lognorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.lomax.html">5.8.3.59. scipy.stats.lomax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.maxwell.html">5.8.3.60. scipy.stats.maxwell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mielke.html">5.8.3.61. scipy.stats.mielke</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nakagami.html">5.8.3.62. scipy.stats.nakagami</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ncx2.html">5.8.3.63. scipy.stats.ncx2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ncf.html">5.8.3.64. scipy.stats.ncf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nct.html">5.8.3.65. scipy.stats.nct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.norm.html">5.8.3.66. scipy.stats.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pareto.html">5.8.3.67. scipy.stats.pareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pearson3.html">5.8.3.68. scipy.stats.pearson3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powerlaw.html">5.8.3.69. scipy.stats.powerlaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powerlognorm.html">5.8.3.70. scipy.stats.powerlognorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powernorm.html">5.8.3.71. scipy.stats.powernorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rdist.html">5.8.3.72. scipy.stats.rdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.reciprocal.html">5.8.3.73. scipy.stats.reciprocal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rayleigh.html">5.8.3.74. scipy.stats.rayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rice.html">5.8.3.75. scipy.stats.rice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.recipinvgauss.html">5.8.3.76. scipy.stats.recipinvgauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.semicircular.html">5.8.3.77. scipy.stats.semicircular</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.t.html">5.8.3.78. scipy.stats.t</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.triang.html">5.8.3.79. scipy.stats.triang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.truncexpon.html">5.8.3.80. scipy.stats.truncexpon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.truncnorm.html">5.8.3.81. scipy.stats.truncnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tukeylambda.html">5.8.3.82. scipy.stats.tukeylambda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.uniform.html">5.8.3.83. scipy.stats.uniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.vonmises.html">5.8.3.84. scipy.stats.vonmises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.vonmises_line.html">5.8.3.85. scipy.stats.vonmises_line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wald.html">5.8.3.86. scipy.stats.wald</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.weibull_min.html">5.8.3.87. scipy.stats.weibull_min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.weibull_max.html">5.8.3.88. scipy.stats.weibull_max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wrapcauchy.html">5.8.3.89. scipy.stats.wrapcauchy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#multivariate-distributions">5.8.4. Multivariate distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.multivariate_normal.html">5.8.4.1. scipy.stats.multivariate_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.matrix_normal.html">5.8.4.2. scipy.stats.matrix_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dirichlet.html">5.8.4.3. scipy.stats.dirichlet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wishart.html">5.8.4.4. scipy.stats.wishart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invwishart.html">5.8.4.5. scipy.stats.invwishart</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#discrete-distributions">5.8.5. Discrete distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bernoulli.html">5.8.5.1. scipy.stats.bernoulli</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binom.html">5.8.5.2. scipy.stats.binom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boltzmann.html">5.8.5.3. scipy.stats.boltzmann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dlaplace.html">5.8.5.4. scipy.stats.dlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.geom.html">5.8.5.5. scipy.stats.geom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hypergeom.html">5.8.5.6. scipy.stats.hypergeom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.logser.html">5.8.5.7. scipy.stats.logser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nbinom.html">5.8.5.8. scipy.stats.nbinom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.planck.html">5.8.5.9. scipy.stats.planck</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.poisson.html">5.8.5.10. scipy.stats.poisson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.randint.html">5.8.5.11. scipy.stats.randint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skellam.html">5.8.5.12. scipy.stats.skellam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zipf.html">5.8.5.13. scipy.stats.zipf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#statistical-functions">5.8.6. Statistical functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.describe.html">5.8.6.1. scipy.stats.describe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gmean.html">5.8.6.2. scipy.stats.gmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hmean.html">5.8.6.3. scipy.stats.hmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kurtosis.html">5.8.6.4. scipy.stats.kurtosis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kurtosistest.html">5.8.6.5. scipy.stats.kurtosistest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mode.html">5.8.6.6. scipy.stats.mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.moment.html">5.8.6.7. scipy.stats.moment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.normaltest.html">5.8.6.8. scipy.stats.normaltest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skew.html">5.8.6.9. scipy.stats.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skewtest.html">5.8.6.10. scipy.stats.skewtest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstat.html">5.8.6.11. scipy.stats.kstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstatvar.html">5.8.6.12. scipy.stats.kstatvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmean.html">5.8.6.13. scipy.stats.tmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tvar.html">5.8.6.14. scipy.stats.tvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmin.html">5.8.6.15. scipy.stats.tmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmax.html">5.8.6.16. scipy.stats.tmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tstd.html">5.8.6.17. scipy.stats.tstd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tsem.html">5.8.6.18. scipy.stats.tsem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanmean.html">5.8.6.19. scipy.stats.nanmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanstd.html">5.8.6.20. scipy.stats.nanstd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanmedian.html">5.8.6.21. scipy.stats.nanmedian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.variation.html">5.8.6.22. scipy.stats.variation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.find_repeats.html">5.8.6.23. scipy.stats.find_repeats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trim_mean.html">5.8.6.24. scipy.stats.trim_mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cumfreq.html">5.8.6.25. scipy.stats.cumfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.histogram2.html">5.8.6.26. scipy.stats.histogram2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.histogram.html">5.8.6.27. scipy.stats.histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.itemfreq.html">5.8.6.28. scipy.stats.itemfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.percentileofscore.html">5.8.6.29. scipy.stats.percentileofscore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.scoreatpercentile.html">5.8.6.30. scipy.stats.scoreatpercentile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.relfreq.html">5.8.6.31. scipy.stats.relfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic.html">5.8.6.32. scipy.stats.binned_statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic_2d.html">5.8.6.33. scipy.stats.binned_statistic_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic_dd.html">5.8.6.34. scipy.stats.binned_statistic_dd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.obrientransform.html">5.8.6.35. scipy.stats.obrientransform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.signaltonoise.html">5.8.6.36. scipy.stats.signaltonoise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bayes_mvs.html">5.8.6.37. scipy.stats.bayes_mvs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mvsdist.html">5.8.6.38. scipy.stats.mvsdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.sem.html">5.8.6.39. scipy.stats.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zmap.html">5.8.6.40. scipy.stats.zmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zscore.html">5.8.6.41. scipy.stats.zscore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.sigmaclip.html">5.8.6.42. scipy.stats.sigmaclip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.threshold.html">5.8.6.43. scipy.stats.threshold</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trimboth.html">5.8.6.44. scipy.stats.trimboth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trim1.html">5.8.6.45. scipy.stats.trim1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f_oneway.html">5.8.6.46. scipy.stats.f_oneway</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pearsonr.html">5.8.6.47. scipy.stats.pearsonr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.spearmanr.html">5.8.6.48. scipy.stats.spearmanr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pointbiserialr.html">5.8.6.49. scipy.stats.pointbiserialr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kendalltau.html">5.8.6.50. scipy.stats.kendalltau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.linregress.html">5.8.6.51. scipy.stats.linregress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.theilslopes.html">5.8.6.52. scipy.stats.theilslopes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f_value.html">5.8.6.53. scipy.stats.f_value</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_1samp.html">5.8.6.54. scipy.stats.ttest_1samp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_ind.html">5.8.6.55. scipy.stats.ttest_ind</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_ind_from_stats.html">5.8.6.56. scipy.stats.ttest_ind_from_stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_rel.html">5.8.6.57. scipy.stats.ttest_rel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstest.html">5.8.6.58. scipy.stats.kstest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chisquare.html">5.8.6.59. scipy.stats.chisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.power_divergence.html">5.8.6.60. scipy.stats.power_divergence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ks_2samp.html">5.8.6.61. scipy.stats.ks_2samp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mannwhitneyu.html">5.8.6.62. scipy.stats.mannwhitneyu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tiecorrect.html">5.8.6.63. scipy.stats.tiecorrect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rankdata.html">5.8.6.64. scipy.stats.rankdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ranksums.html">5.8.6.65. scipy.stats.ranksums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wilcoxon.html">5.8.6.66. scipy.stats.wilcoxon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kruskal.html">5.8.6.67. scipy.stats.kruskal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.friedmanchisquare.html">5.8.6.68. scipy.stats.friedmanchisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.combine_pvalues.html">5.8.6.69. scipy.stats.combine_pvalues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ss.html">5.8.6.70. scipy.stats.ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.square_of_sums.html">5.8.6.71. scipy.stats.square_of_sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.jarque_bera.html">5.8.6.72. scipy.stats.jarque_bera</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ansari.html">5.8.6.73. scipy.stats.ansari</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bartlett.html">5.8.6.74. scipy.stats.bartlett</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levene.html">5.8.6.75. scipy.stats.levene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.shapiro.html">5.8.6.76. scipy.stats.shapiro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anderson.html">5.8.6.77. scipy.stats.anderson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anderson_ksamp.html">5.8.6.78. scipy.stats.anderson_ksamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binom_test.html">5.8.6.79. scipy.stats.binom_test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fligner.html">5.8.6.80. scipy.stats.fligner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.median_test.html">5.8.6.81. scipy.stats.median_test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mood.html">5.8.6.82. scipy.stats.mood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox.html">5.8.6.83. scipy.stats.boxcox</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_normmax.html">5.8.6.84. scipy.stats.boxcox_normmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_llf.html">5.8.6.85. scipy.stats.boxcox_llf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.entropy.html">5.8.6.86. scipy.stats.entropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chisqprob.html">5.8.6.87. scipy.stats.chisqprob</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.betai.html">5.8.6.88. scipy.stats.betai</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#circular-statistical-functions">5.8.7. Circular statistical functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circmean.html">5.8.7.1. scipy.stats.circmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circvar.html">5.8.7.2. scipy.stats.circvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circstd.html">5.8.7.3. scipy.stats.circstd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#contingency-table-functions">5.8.8. Contingency table functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi2_contingency.html">5.8.8.1. scipy.stats.chi2_contingency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.contingency.expected_freq.html">5.8.8.2. scipy.stats.contingency.expected_freq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.contingency.margins.html">5.8.8.3. scipy.stats.contingency.margins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fisher_exact.html">5.8.8.4. scipy.stats.fisher_exact</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#plot-tests">5.8.9. Plot-tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ppcc_max.html">5.8.9.1. scipy.stats.ppcc_max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ppcc_plot.html">5.8.9.2. scipy.stats.ppcc_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.probplot.html">5.8.9.3. scipy.stats.probplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_normplot.html">5.8.9.4. scipy.stats.boxcox_normplot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#masked-statistics-functions">5.8.10. Masked statistics functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../stats.mstats.html">5.8.10.1. Statistical functions for masked arrays (<code class="docutils literal"><span class="pre">scipy.stats.mstats</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#univariate-and-multivariate-kernel-density-estimation-scipy-stats-kde">5.8.11. Univariate and multivariate kernel density estimation (<code class="docutils literal"><span class="pre">scipy.stats.kde</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gaussian_kde.html">5.8.11.1. scipy.stats.gaussian_kde</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../stats.mstats.html">5.8.10.1. Statistical functions for masked arrays (<code class="docutils literal"><span class="pre">scipy.stats.mstats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.argstoarray.html">5.8.10.1.1. scipy.stats.mstats.argstoarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.betai.html">5.8.10.1.2. scipy.stats.mstats.betai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.chisquare.html">5.8.10.1.3. scipy.stats.mstats.chisquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.count_tied_groups.html">5.8.10.1.4. scipy.stats.mstats.count_tied_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.describe.html">5.8.10.1.5. scipy.stats.mstats.describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.f_oneway.html">5.8.10.1.6. scipy.stats.mstats.f_oneway</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.f_value_wilks_lambda.html">5.8.10.1.7. scipy.stats.mstats.f_value_wilks_lambda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.find_repeats.html">5.8.10.1.8. scipy.stats.mstats.find_repeats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.friedmanchisquare.html">5.8.10.1.9. scipy.stats.mstats.friedmanchisquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kendalltau.html">5.8.10.1.10. scipy.stats.mstats.kendalltau</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kendalltau_seasonal.html">5.8.10.1.11. scipy.stats.mstats.kendalltau_seasonal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kruskalwallis.html">5.8.10.1.12. scipy.stats.mstats.kruskalwallis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ks_twosamp.html">5.8.10.1.13. scipy.stats.mstats.ks_twosamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kurtosis.html">5.8.10.1.14. scipy.stats.mstats.kurtosis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kurtosistest.html">5.8.10.1.15. scipy.stats.mstats.kurtosistest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.linregress.html">5.8.10.1.16. scipy.stats.mstats.linregress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mannwhitneyu.html">5.8.10.1.17. scipy.stats.mstats.mannwhitneyu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.plotting_positions.html">5.8.10.1.18. scipy.stats.mstats.plotting_positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mode.html">5.8.10.1.19. scipy.stats.mstats.mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.moment.html">5.8.10.1.20. scipy.stats.mstats.moment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mquantiles.html">5.8.10.1.21. scipy.stats.mstats.mquantiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.msign.html">5.8.10.1.22. scipy.stats.mstats.msign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.normaltest.html">5.8.10.1.23. scipy.stats.mstats.normaltest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.obrientransform.html">5.8.10.1.24. scipy.stats.mstats.obrientransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.pearsonr.html">5.8.10.1.25. scipy.stats.mstats.pearsonr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.plotting_positions.html">5.8.10.1.18. scipy.stats.mstats.plotting_positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.pointbiserialr.html">5.8.10.1.26. scipy.stats.mstats.pointbiserialr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.rankdata.html">5.8.10.1.27. scipy.stats.mstats.rankdata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.scoreatpercentile.html">5.8.10.1.28. scipy.stats.mstats.scoreatpercentile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.sem.html">5.8.10.1.29. scipy.stats.mstats.sem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.signaltonoise.html">5.8.10.1.30. scipy.stats.mstats.signaltonoise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.skew.html">5.8.10.1.31. scipy.stats.mstats.skew</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.skewtest.html">5.8.10.1.32. scipy.stats.mstats.skewtest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.spearmanr.html">5.8.10.1.33. scipy.stats.mstats.spearmanr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.theilslopes.html">5.8.10.1.34. scipy.stats.mstats.theilslopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.threshold.html">5.8.10.1.35. scipy.stats.mstats.threshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmax.html">5.8.10.1.36. scipy.stats.mstats.tmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmean.html">5.8.10.1.37. scipy.stats.mstats.tmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmin.html">5.8.10.1.38. scipy.stats.mstats.tmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trim.html">5.8.10.1.39. scipy.stats.mstats.trim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trima.html">5.8.10.1.40. scipy.stats.mstats.trima</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimboth.html">5.8.10.1.41. scipy.stats.mstats.trimboth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_stde.html">5.8.10.1.42. scipy.stats.mstats.trimmed_stde</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimr.html">5.8.10.1.43. scipy.stats.mstats.trimr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimtail.html">5.8.10.1.44. scipy.stats.mstats.trimtail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tsem.html">5.8.10.1.45. scipy.stats.mstats.tsem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_onesamp.html">5.8.10.1.46. scipy.stats.mstats.ttest_onesamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_ind.html">5.8.10.1.47. scipy.stats.mstats.ttest_ind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_onesamp.html">5.8.10.1.46. scipy.stats.mstats.ttest_onesamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_rel.html">5.8.10.1.48. scipy.stats.mstats.ttest_rel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tvar.html">5.8.10.1.49. scipy.stats.mstats.tvar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.variation.html">5.8.10.1.50. scipy.stats.mstats.variation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.winsorize.html">5.8.10.1.51. scipy.stats.mstats.winsorize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.zmap.html">5.8.10.1.52. scipy.stats.mstats.zmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.zscore.html">5.8.10.1.53. scipy.stats.mstats.zscore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.compare_medians_ms.html">5.8.10.1.54. scipy.stats.mstats.compare_medians_ms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.gmean.html">5.8.10.1.55. scipy.stats.mstats.gmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdmedian.html">5.8.10.1.56. scipy.stats.mstats.hdmedian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdquantiles.html">5.8.10.1.57. scipy.stats.mstats.hdquantiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdquantiles_sd.html">5.8.10.1.58. scipy.stats.mstats.hdquantiles_sd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hmean.html">5.8.10.1.59. scipy.stats.mstats.hmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.idealfourths.html">5.8.10.1.60. scipy.stats.mstats.idealfourths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kruskal.html">5.8.10.1.61. scipy.stats.mstats.kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ks_2samp.html">5.8.10.1.62. scipy.stats.mstats.ks_2samp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.median_cihs.html">5.8.10.1.63. scipy.stats.mstats.median_cihs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.meppf.html">5.8.10.1.64. scipy.stats.mstats.meppf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mjci.html">5.8.10.1.65. scipy.stats.mstats.mjci</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mquantiles_cimj.html">5.8.10.1.66. scipy.stats.mstats.mquantiles_cimj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.rsh.html">5.8.10.1.67. scipy.stats.mstats.rsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.sen_seasonal_slopes.html">5.8.10.1.68. scipy.stats.mstats.sen_seasonal_slopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_mean.html">5.8.10.1.69. scipy.stats.mstats.trimmed_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_mean_ci.html">5.8.10.1.70. scipy.stats.mstats.trimmed_mean_ci</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_std.html">5.8.10.1.71. scipy.stats.mstats.trimmed_std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_var.html">5.8.10.1.72. scipy.stats.mstats.trimmed_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_1samp.html">5.8.10.1.73. scipy.stats.mstats.ttest_1samp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../weave.html">5.9. C/C++ integration (<code class="docutils literal"><span class="pre">scipy.weave</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../weave.html#c-c-integration">5.9.1. C/C++ integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.inline.html">5.9.2. scipy.weave.inline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.blitz.html">5.9.3. scipy.weave.blitz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.ext_tools.html">5.9.4. scipy.weave.ext_tools</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Scipy API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>numpy.lib.function_base</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for numpy.lib.function_base</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">operator</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.core.numeric</span> <span class="kn">as</span> <span class="nn">_nx</span>
<span class="kn">from</span> <span class="nn">numpy.core</span> <span class="kn">import</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="p">,</span> <span class="n">atleast_2d</span>
<span class="kn">from</span> <span class="nn">numpy.core.numeric</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ones</span><span class="p">,</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">arange</span><span class="p">,</span> <span class="n">concatenate</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">asarray</span><span class="p">,</span> <span class="n">asanyarray</span><span class="p">,</span> <span class="n">empty</span><span class="p">,</span>
    <span class="n">empty_like</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">around</span><span class="p">,</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">take</span><span class="p">,</span> <span class="n">dot</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="n">intp</span><span class="p">,</span>
    <span class="n">integer</span><span class="p">,</span> <span class="n">isscalar</span>
    <span class="p">)</span>
<span class="kn">from</span> <span class="nn">numpy.core.umath</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">pi</span><span class="p">,</span> <span class="n">multiply</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">arctan2</span><span class="p">,</span> <span class="n">frompyfunc</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">less_equal</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span>
    <span class="n">mod</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log10</span>
    <span class="p">)</span>
<span class="kn">from</span> <span class="nn">numpy.core.fromnumeric</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ravel</span><span class="p">,</span> <span class="n">nonzero</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="n">partition</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="nb">any</span><span class="p">,</span> <span class="nb">sum</span>
    <span class="p">)</span>
<span class="kn">from</span> <span class="nn">numpy.core.numerictypes</span> <span class="kn">import</span> <span class="n">typecodes</span><span class="p">,</span> <span class="n">number</span>
<span class="kn">from</span> <span class="nn">numpy.lib.twodim_base</span> <span class="kn">import</span> <span class="n">diag</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">deprecate</span>
<span class="kn">from</span> <span class="nn">numpy.core.multiarray</span> <span class="kn">import</span> <span class="n">_insert</span><span class="p">,</span> <span class="n">add_docstring</span>
<span class="kn">from</span> <span class="nn">numpy.core.multiarray</span> <span class="kn">import</span> <span class="n">digitize</span><span class="p">,</span> <span class="n">bincount</span><span class="p">,</span> <span class="n">interp</span> <span class="k">as</span> <span class="n">compiled_interp</span>
<span class="kn">from</span> <span class="nn">numpy.core.umath</span> <span class="kn">import</span> <span class="n">_add_newdoc_ufunc</span> <span class="k">as</span> <span class="n">add_newdoc_ufunc</span>
<span class="kn">from</span> <span class="nn">numpy.compat</span> <span class="kn">import</span> <span class="nb">long</span>

<span class="c1"># Force range to be a generator, for np.delete&#39;s usage.</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="nb">range</span> <span class="o">=</span> <span class="nb">xrange</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="s1">&#39;piecewise&#39;</span><span class="p">,</span> <span class="s1">&#39;trim_zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;copy&#39;</span><span class="p">,</span> <span class="s1">&#39;iterable&#39;</span><span class="p">,</span> <span class="s1">&#39;percentile&#39;</span><span class="p">,</span>
    <span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;gradient&#39;</span><span class="p">,</span> <span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="s1">&#39;unwrap&#39;</span><span class="p">,</span> <span class="s1">&#39;sort_complex&#39;</span><span class="p">,</span> <span class="s1">&#39;disp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;extract&#39;</span><span class="p">,</span> <span class="s1">&#39;place&#39;</span><span class="p">,</span> <span class="s1">&#39;vectorize&#39;</span><span class="p">,</span> <span class="s1">&#39;asarray_chkfinite&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span>
    <span class="s1">&#39;histogram&#39;</span><span class="p">,</span> <span class="s1">&#39;histogramdd&#39;</span><span class="p">,</span> <span class="s1">&#39;bincount&#39;</span><span class="p">,</span> <span class="s1">&#39;digitize&#39;</span><span class="p">,</span> <span class="s1">&#39;cov&#39;</span><span class="p">,</span> <span class="s1">&#39;corrcoef&#39;</span><span class="p">,</span>
    <span class="s1">&#39;msort&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;sinc&#39;</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;hanning&#39;</span><span class="p">,</span> <span class="s1">&#39;bartlett&#39;</span><span class="p">,</span>
    <span class="s1">&#39;blackman&#39;</span><span class="p">,</span> <span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="s1">&#39;trapz&#39;</span><span class="p">,</span> <span class="s1">&#39;i0&#39;</span><span class="p">,</span> <span class="s1">&#39;add_newdoc&#39;</span><span class="p">,</span> <span class="s1">&#39;add_docstring&#39;</span><span class="p">,</span>
    <span class="s1">&#39;meshgrid&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="s1">&#39;append&#39;</span><span class="p">,</span> <span class="s1">&#39;interp&#39;</span><span class="p">,</span> <span class="s1">&#39;add_newdoc_ufunc&#39;</span>
    <span class="p">]</span>


<span class="k">def</span> <span class="nf">iterable</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check whether or not an object can be iterated over.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : object</span>
<span class="sd">      Input object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    b : {0, 1}</span>
<span class="sd">      Return 1 if the object has an iterator method or is a sequence,</span>
<span class="sd">      and 0 otherwise.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.iterable([1, 2, 3])</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; np.iterable(2)</span>
<span class="sd">    0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">iter</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
              <span class="n">density</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the histogram of a set of data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input data. The histogram is computed over the flattened array.</span>
<span class="sd">    bins : int or sequence of scalars, optional</span>
<span class="sd">        If `bins` is an int, it defines the number of equal-width</span>
<span class="sd">        bins in the given range (10, by default). If `bins` is a sequence,</span>
<span class="sd">        it defines the bin edges, including the rightmost edge, allowing</span>
<span class="sd">        for non-uniform bin widths.</span>
<span class="sd">    range : (float, float), optional</span>
<span class="sd">        The lower and upper range of the bins.  If not provided, range</span>
<span class="sd">        is simply ``(a.min(), a.max())``.  Values outside the range are</span>
<span class="sd">        ignored.</span>
<span class="sd">    normed : bool, optional</span>
<span class="sd">        This keyword is deprecated in Numpy 1.6 due to confusing/buggy</span>
<span class="sd">        behavior. It will be removed in Numpy 2.0. Use the density keyword</span>
<span class="sd">        instead.</span>
<span class="sd">        If False, the result will contain the number of samples</span>
<span class="sd">        in each bin.  If True, the result is the value of the</span>
<span class="sd">        probability *density* function at the bin, normalized such that</span>
<span class="sd">        the *integral* over the range is 1. Note that this latter behavior is</span>
<span class="sd">        known to be buggy with unequal bin widths; use `density` instead.</span>
<span class="sd">    weights : array_like, optional</span>
<span class="sd">        An array of weights, of the same shape as `a`.  Each value in `a`</span>
<span class="sd">        only contributes its associated weight towards the bin count</span>
<span class="sd">        (instead of 1).  If `normed` is True, the weights are normalized,</span>
<span class="sd">        so that the integral of the density over the range remains 1</span>
<span class="sd">    density : bool, optional</span>
<span class="sd">        If False, the result will contain the number of samples</span>
<span class="sd">        in each bin.  If True, the result is the value of the</span>
<span class="sd">        probability *density* function at the bin, normalized such that</span>
<span class="sd">        the *integral* over the range is 1. Note that the sum of the</span>
<span class="sd">        histogram values will not be equal to 1 unless bins of unity</span>
<span class="sd">        width are chosen; it is not a probability *mass* function.</span>
<span class="sd">        Overrides the `normed` keyword if given.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hist : array</span>
<span class="sd">        The values of the histogram. See `normed` and `weights` for a</span>
<span class="sd">        description of the possible semantics.</span>
<span class="sd">    bin_edges : array of dtype float</span>
<span class="sd">        Return the bin edges ``(length(hist)+1)``.</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    histogramdd, bincount, searchsorted, digitize</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    All but the last (righthand-most) bin is half-open.  In other words, if</span>
<span class="sd">    `bins` is::</span>

<span class="sd">      [1, 2, 3, 4]</span>

<span class="sd">    then the first bin is ``[1, 2)`` (including 1, but excluding 2) and the</span>
<span class="sd">    second ``[2, 3)``.  The last bin, however, is ``[3, 4]``, which *includes*</span>
<span class="sd">    4.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.histogram([1, 2, 1], bins=[0, 1, 2, 3])</span>
<span class="sd">    (array([0, 2, 1]), array([0, 1, 2, 3]))</span>
<span class="sd">    &gt;&gt;&gt; np.histogram(np.arange(4), bins=np.arange(5), density=True)</span>
<span class="sd">    (array([ 0.25,  0.25,  0.25,  0.25]), array([0, 1, 2, 3, 4]))</span>
<span class="sd">    &gt;&gt;&gt; np.histogram([[1, 2, 1], [1, 0, 1]], bins=[0,1,2,3])</span>
<span class="sd">    (array([1, 4, 1]), array([0, 1, 2, 3]))</span>

<span class="sd">    &gt;&gt;&gt; a = np.arange(5)</span>
<span class="sd">    &gt;&gt;&gt; hist, bin_edges = np.histogram(a, density=True)</span>
<span class="sd">    &gt;&gt;&gt; hist</span>
<span class="sd">    array([ 0.5,  0. ,  0.5,  0. ,  0. ,  0.5,  0. ,  0.5,  0. ,  0.5])</span>
<span class="sd">    &gt;&gt;&gt; hist.sum()</span>
<span class="sd">    2.4999999999999996</span>
<span class="sd">    &gt;&gt;&gt; np.sum(hist*np.diff(bin_edges))</span>
<span class="sd">    1.0</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;weights should have the same shape as a.&#39;</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">mn</span><span class="p">,</span> <span class="n">mx</span> <span class="o">=</span> <span class="nb">range</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">mn</span> <span class="o">&gt;</span> <span class="n">mx</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s1">&#39;max must be larger than min in range parameter.&#39;</span><span class="p">)</span>

    <span class="c1"># Histogram is an integer or a float array depending on the weights.</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ntype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ntype</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">dtype</span>

    <span class="c1"># We set a block size, as this allows us to iterate over chunks when</span>
    <span class="c1"># computing histograms, to minimize memory usage.</span>
    <span class="n">BLOCK</span> <span class="o">=</span> <span class="mi">65536</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="ow">and</span> <span class="n">bins</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;`bins` should be a positive integer.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">range</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># handle empty arrays. Can&#39;t determine range, so use 0-1.</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">mn</span><span class="p">,</span> <span class="n">mx</span> <span class="o">=</span> <span class="p">[</span><span class="n">mi</span> <span class="o">+</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">mn</span> <span class="o">==</span> <span class="n">mx</span><span class="p">:</span>
            <span class="n">mn</span> <span class="o">-=</span> <span class="mf">0.5</span>
            <span class="n">mx</span> <span class="o">+=</span> <span class="mf">0.5</span>
        <span class="c1"># At this point, if the weights are not integer, floating point, or</span>
        <span class="c1"># complex, we have to use the slow algorithm.</span>
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">can_cast</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span> <span class="ow">or</span>
                                        <span class="n">np</span><span class="o">.</span><span class="n">can_cast</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)):</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
        <span class="c1"># We now convert values of a to bin indices, under the assumption of</span>
        <span class="c1"># equal bin widths (which is valid here).</span>

        <span class="c1"># Initialize empty histogram</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">ntype</span><span class="p">)</span>
        <span class="c1"># Pre-compute histogram scaling factor</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">bins</span> <span class="o">/</span> <span class="p">(</span><span class="n">mx</span> <span class="o">-</span> <span class="n">mn</span><span class="p">)</span>

        <span class="c1"># We iterate over blocks here for two reasons: the first is that for</span>
        <span class="c1"># large arrays, it is actually faster (for example for a 10^8 array it</span>
        <span class="c1"># is 2x as fast) and it results in a memory footprint 3x lower in the</span>
        <span class="c1"># limit of large arrays.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">BLOCK</span><span class="p">):</span>
            <span class="n">tmp_a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">tmp_w</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp_w</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">BLOCK</span><span class="p">]</span>

            <span class="c1"># Only include values in the right range</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmp_a</span> <span class="o">&gt;=</span> <span class="n">mn</span><span class="p">)</span>
            <span class="n">keep</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">tmp_a</span> <span class="o">&lt;=</span> <span class="n">mx</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">keep</span><span class="p">):</span>
                <span class="n">tmp_a</span> <span class="o">=</span> <span class="n">tmp_a</span><span class="p">[</span><span class="n">keep</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">tmp_w</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">tmp_w</span> <span class="o">=</span> <span class="n">tmp_w</span><span class="p">[</span><span class="n">keep</span><span class="p">]</span>
            <span class="n">tmp_a</span> <span class="o">=</span> <span class="n">tmp_a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">tmp_a</span> <span class="o">-=</span> <span class="n">mn</span>
            <span class="n">tmp_a</span> <span class="o">*=</span> <span class="n">norm</span>

            <span class="c1"># Compute the bin indices, and for values that lie exactly on mx we</span>
            <span class="c1"># need to subtract one</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">tmp_a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>
            <span class="n">indices</span><span class="p">[</span><span class="n">indices</span> <span class="o">==</span> <span class="n">bins</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="c1"># We now compute the histogram using bincount</span>
            <span class="k">if</span> <span class="n">ntype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
                <span class="n">n</span><span class="o">.</span><span class="n">real</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">tmp_w</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
                <span class="n">n</span><span class="o">.</span><span class="n">imag</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">tmp_w</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">tmp_w</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">ntype</span><span class="p">)</span>

        <span class="c1"># We now compute the bin edges since these are returned</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s1">&#39;bins must increase monotonically.&#39;</span><span class="p">)</span>

        <span class="c1"># Initialize empty histogram</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bins</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ntype</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">BLOCK</span><span class="p">):</span>
                <span class="n">sa</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">])</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">sa</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;left&#39;</span><span class="p">),</span>
                           <span class="n">sa</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;right&#39;</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zero</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ntype</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">BLOCK</span><span class="p">):</span>
                <span class="n">tmp_a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">]</span>
                <span class="n">tmp_w</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">]</span>
                <span class="n">sorting_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">tmp_a</span><span class="p">)</span>
                <span class="n">sa</span> <span class="o">=</span> <span class="n">tmp_a</span><span class="p">[</span><span class="n">sorting_index</span><span class="p">]</span>
                <span class="n">sw</span> <span class="o">=</span> <span class="n">tmp_w</span><span class="p">[</span><span class="n">sorting_index</span><span class="p">]</span>
                <span class="n">cw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">zero</span><span class="p">,</span> <span class="p">],</span> <span class="n">sw</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()))</span>
                <span class="n">bin_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">sa</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;left&#39;</span><span class="p">),</span>
                                  <span class="n">sa</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;right&#39;</span><span class="p">)]</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="n">cw</span><span class="p">[</span><span class="n">bin_index</span><span class="p">]</span>


        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">density</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">density</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span> <span class="nb">float</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">n</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">bins</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">bins</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># deprecated, buggy behavior. Remove for Numpy 2.0</span>
        <span class="k">if</span> <span class="n">normed</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span> <span class="nb">float</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">db</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">bins</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">bins</span>


<span class="k">def</span> <span class="nf">histogramdd</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the multidimensional histogram of some data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sample : array_like</span>
<span class="sd">        The data to be histogrammed. It must be an (N,D) array or data</span>
<span class="sd">        that can be converted to such. The rows of the resulting array</span>
<span class="sd">        are the coordinates of points in a D dimensional polytope.</span>
<span class="sd">    bins : sequence or int, optional</span>
<span class="sd">        The bin specification:</span>

<span class="sd">        * A sequence of arrays describing the bin edges along each dimension.</span>
<span class="sd">        * The number of bins for each dimension (nx, ny, ... =bins)</span>
<span class="sd">        * The number of bins for all dimensions (nx=ny=...=bins).</span>

<span class="sd">    range : sequence, optional</span>
<span class="sd">        A sequence of lower and upper bin edges to be used if the edges are</span>
<span class="sd">        not given explicitly in `bins`. Defaults to the minimum and maximum</span>
<span class="sd">        values along each dimension.</span>
<span class="sd">    normed : bool, optional</span>
<span class="sd">        If False, returns the number of samples in each bin. If True,</span>
<span class="sd">        returns the bin density ``bin_count / sample_count / bin_volume``.</span>
<span class="sd">    weights : (N,) array_like, optional</span>
<span class="sd">        An array of values `w_i` weighing each sample `(x_i, y_i, z_i, ...)`.</span>
<span class="sd">        Weights are normalized to 1 if normed is True. If normed is False,</span>
<span class="sd">        the values of the returned histogram are equal to the sum of the</span>
<span class="sd">        weights belonging to the samples falling into each bin.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H : ndarray</span>
<span class="sd">        The multidimensional histogram of sample x. See normed and weights</span>
<span class="sd">        for the different possible semantics.</span>
<span class="sd">    edges : list</span>
<span class="sd">        A list of D arrays describing the bin edges for each dimension.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    histogram: 1-D histogram</span>
<span class="sd">    histogram2d: 2-D histogram</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; r = np.random.randn(100,3)</span>
<span class="sd">    &gt;&gt;&gt; H, edges = np.histogramdd(r, bins = (5, 8, 4))</span>
<span class="sd">    &gt;&gt;&gt; H.shape, edges[0].size, edges[1].size, edges[2].size</span>
<span class="sd">    ((5, 8, 4), 6, 9, 5)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Sample is an ND-array.</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="c1"># Sample is a sequence of 1D arrays.</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">nbin</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span>
    <span class="n">dedges</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">!=</span> <span class="n">D</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s1">&#39;The dimension of bins must be equal to the dimension of the &#39;</span>
                <span class="s1">&#39; sample x.&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1"># bins is an integer</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="p">[</span><span class="n">bins</span><span class="p">]</span>

    <span class="c1"># Select range for each dimension</span>
    <span class="c1"># Used only if number of bins is given.</span>
    <span class="k">if</span> <span class="nb">range</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Handle empty input. Range can&#39;t be determined in that case, use 0-1.</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">smin</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
            <span class="n">smax</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">smin</span> <span class="o">=</span> <span class="n">atleast_1d</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">float</span><span class="p">))</span>
            <span class="n">smax</span> <span class="o">=</span> <span class="n">atleast_1d</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">float</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">smin</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="n">smax</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="n">smin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">smax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Make sure the bins have a finite width.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">smin</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">smin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">smax</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">smin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">smin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span>
            <span class="n">smax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">smax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span>

    <span class="c1"># avoid rounding issues for comparisons when dealing with inexact types</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>
        <span class="n">edge_dt</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">dtype</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">edge_dt</span> <span class="o">=</span> <span class="nb">float</span>
    <span class="c1"># Create edge arrays</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">isscalar</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Element at index </span><span class="si">%s</span><span class="s2"> in `bins` should be a positive &quot;</span>
                    <span class="s2">&quot;integer.&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">nbin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>  <span class="c1"># +2 for outlier bins</span>
            <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">smin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">smax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nbin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">edge_dt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">edge_dt</span><span class="p">)</span>
            <span class="n">nbin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># +1 for outlier bins</span>
        <span class="n">dedges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dedges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Found bin edge of size &lt;= 0. Did you specify `bins` with&quot;</span>
                <span class="s2">&quot;non-monotonic sequence?&quot;</span><span class="p">)</span>

    <span class="n">nbin</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">nbin</span><span class="p">)</span>

    <span class="c1"># Handle empty input.</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nbin</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">edges</span>

    <span class="c1"># Compute the bin number each sample falls into.</span>
    <span class="n">Ncount</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
        <span class="n">Ncount</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">digitize</span><span class="p">(</span><span class="n">sample</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># Using digitize, values that fall on an edge are put in the right bin.</span>
    <span class="c1"># For the rightmost bin, we want values equal to the right edge to be</span>
    <span class="c1"># counted in the last bin, and not as an outlier.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
        <span class="c1"># Rounding precision</span>
        <span class="n">mindiff</span> <span class="o">=</span> <span class="n">dedges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">mindiff</span><span class="p">):</span>
            <span class="n">decimal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">log10</span><span class="p">(</span><span class="n">mindiff</span><span class="p">))</span> <span class="o">+</span> <span class="mi">6</span>
            <span class="c1"># Find which points are on the rightmost edge.</span>
            <span class="n">not_smaller_than_edge</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">on_edge</span> <span class="o">=</span> <span class="p">(</span><span class="n">around</span><span class="p">(</span><span class="n">sample</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">decimal</span><span class="p">)</span> <span class="o">==</span>
                       <span class="n">around</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">decimal</span><span class="p">))</span>
            <span class="c1"># Shift these points one bin to the left.</span>
            <span class="n">Ncount</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">where</span><span class="p">(</span><span class="n">on_edge</span> <span class="o">&amp;</span> <span class="n">not_smaller_than_edge</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="c1"># Flattened histogram matrix (1D)</span>
    <span class="c1"># Reshape is used so that overlarge arrays</span>
    <span class="c1"># will raise an error.</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">nbin</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Compute the sample indices in the flattened histogram matrix.</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">nbin</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">D</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">xy</span> <span class="o">+=</span> <span class="n">Ncount</span><span class="p">[</span><span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">nbin</span><span class="p">[</span><span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]]</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
    <span class="n">xy</span> <span class="o">+=</span> <span class="n">Ncount</span><span class="p">[</span><span class="n">ni</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1"># Compute the number of repetitions in xy and assign it to the</span>
    <span class="c1"># flattened histmat.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">zeros</span><span class="p">(</span><span class="n">nbin</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="n">edges</span>

    <span class="n">flatcount</span> <span class="o">=</span> <span class="n">bincount</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flatcount</span><span class="p">))</span>
    <span class="n">hist</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">flatcount</span>

    <span class="c1"># Shape into a proper matrix</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sort</span><span class="p">(</span><span class="n">nbin</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">nbin</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">hist</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ni</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ni</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Remove outliers (indices 0 and -1 for each dimension).</span>
    <span class="n">core</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">hist</span><span class="p">[</span><span class="n">core</span><span class="p">]</span>

    <span class="c1"># Normalize if normed is True</span>
    <span class="k">if</span> <span class="n">normed</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="n">hist</span> <span class="o">=</span> <span class="n">hist</span> <span class="o">/</span> <span class="n">dedges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">hist</span> <span class="o">/=</span> <span class="n">s</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">nbin</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Internal Shape Error&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hist</span><span class="p">,</span> <span class="n">edges</span>


<span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the weighted average along the specified axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Array containing data to be averaged. If `a` is not an array, a</span>
<span class="sd">        conversion is attempted.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        Axis along which to average `a`. If `None`, averaging is done over</span>
<span class="sd">        the flattened array.</span>
<span class="sd">    weights : array_like, optional</span>
<span class="sd">        An array of weights associated with the values in `a`. Each value in</span>
<span class="sd">        `a` contributes to the average according to its associated weight.</span>
<span class="sd">        The weights array can either be 1-D (in which case its length must be</span>
<span class="sd">        the size of `a` along the given axis) or of the same shape as `a`.</span>
<span class="sd">        If `weights=None`, then all data in `a` are assumed to have a</span>
<span class="sd">        weight equal to one.</span>
<span class="sd">    returned : bool, optional</span>
<span class="sd">        Default is `False`. If `True`, the tuple (`average`, `sum_of_weights`)</span>
<span class="sd">        is returned, otherwise only the average is returned.</span>
<span class="sd">        If `weights=None`, `sum_of_weights` is equivalent to the number of</span>
<span class="sd">        elements over which the average is taken.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    average, [sum_of_weights] : array_type or double</span>
<span class="sd">        Return the average along the specified axis. When returned is `True`,</span>
<span class="sd">        return a tuple with the average as the first element and the sum</span>
<span class="sd">        of the weights as the second element. The return type is `Float`</span>
<span class="sd">        if `a` is of integer type, otherwise it is of the same type as `a`.</span>
<span class="sd">        `sum_of_weights` is of the same type as `average`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ZeroDivisionError</span>
<span class="sd">        When all weights along axis are zero. See `numpy.ma.average` for a</span>
<span class="sd">        version robust to this type of error.</span>
<span class="sd">    TypeError</span>
<span class="sd">        When the length of 1D `weights` is not the same as the shape of `a`</span>
<span class="sd">        along axis.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    mean</span>

<span class="sd">    ma.average : average for masked arrays -- useful if your data contains</span>
<span class="sd">                 &quot;missing&quot; values</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = range(1,5)</span>
<span class="sd">    &gt;&gt;&gt; data</span>
<span class="sd">    [1, 2, 3, 4]</span>
<span class="sd">    &gt;&gt;&gt; np.average(data)</span>
<span class="sd">    2.5</span>
<span class="sd">    &gt;&gt;&gt; np.average(range(1,11), weights=range(10,0,-1))</span>
<span class="sd">    4.0</span>

<span class="sd">    &gt;&gt;&gt; data = np.arange(6).reshape((3,2))</span>
<span class="sd">    &gt;&gt;&gt; data</span>
<span class="sd">    array([[0, 1],</span>
<span class="sd">           [2, 3],</span>
<span class="sd">           [4, 5]])</span>
<span class="sd">    &gt;&gt;&gt; np.average(data, axis=1, weights=[1./4, 3./4])</span>
<span class="sd">    array([ 0.75,  2.75,  4.75])</span>
<span class="sd">    &gt;&gt;&gt; np.average(data, weights=[1./4, 3./4])</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: Axis must be specified when shapes of a and weights differ.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">avg</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">scl</span> <span class="o">=</span> <span class="n">avg</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="o">/</span><span class="n">avg</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">0.0</span>
        <span class="n">wgt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="c1"># Sanity checks</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">wgt</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;Axis must be specified when shapes of a and weights &quot;</span>
                    <span class="s2">&quot;differ.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">wgt</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;1D weights expected when shapes of a and weights differ.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">wgt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Length of weights not compatible with specified axis.&quot;</span><span class="p">)</span>

            <span class="c1"># setup wgt to broadcast along axis</span>
            <span class="n">wgt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wgt</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

        <span class="n">scl</span> <span class="o">=</span> <span class="n">wgt</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">wgt</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">scl</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span>
                <span class="s2">&quot;Weights sum to zero, can&#39;t be normalized&quot;</span><span class="p">)</span>

        <span class="n">avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">wgt</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span><span class="o">/</span><span class="n">scl</span>

    <span class="k">if</span> <span class="n">returned</span><span class="p">:</span>
        <span class="n">scl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">avg</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">scl</span>
        <span class="k">return</span> <span class="n">avg</span><span class="p">,</span> <span class="n">scl</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">avg</span>


<span class="k">def</span> <span class="nf">asarray_chkfinite</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert the input to an array, checking for NaNs or Infs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input data, in any form that can be converted to an array.  This</span>
<span class="sd">        includes lists, lists of tuples, tuples, tuples of tuples, tuples</span>
<span class="sd">        of lists and ndarrays.  Success requires no NaNs or Infs.</span>
<span class="sd">    dtype : data-type, optional</span>
<span class="sd">        By default, the data-type is inferred from the input data.</span>
<span class="sd">    order : {&#39;C&#39;, &#39;F&#39;}, optional</span>
<span class="sd">         Whether to use row-major (C-style) or</span>
<span class="sd">         column-major (Fortran-style) memory representation.</span>
<span class="sd">         Defaults to &#39;C&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        Array interpretation of `a`.  No copy is performed if the input</span>
<span class="sd">        is already an ndarray.  If `a` is a subclass of ndarray, a base</span>
<span class="sd">        class ndarray is returned.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises ValueError if `a` contains NaN (Not a Number) or Inf (Infinity).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    asarray : Create and array.</span>
<span class="sd">    asanyarray : Similar function which passes through subclasses.</span>
<span class="sd">    ascontiguousarray : Convert input to a contiguous array.</span>
<span class="sd">    asfarray : Convert input to a floating point ndarray.</span>
<span class="sd">    asfortranarray : Convert input to an ndarray with column-major</span>
<span class="sd">                     memory order.</span>
<span class="sd">    fromiter : Create an array from an iterator.</span>
<span class="sd">    fromfunction : Construct an array by executing a function on grid</span>
<span class="sd">                   positions.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Convert a list into an array.  If all elements are finite</span>
<span class="sd">    ``asarray_chkfinite`` is identical to ``asarray``.</span>

<span class="sd">    &gt;&gt;&gt; a = [1, 2]</span>
<span class="sd">    &gt;&gt;&gt; np.asarray_chkfinite(a, dtype=float)</span>
<span class="sd">    array([1., 2.])</span>

<span class="sd">    Raises ValueError if array_like contains Nans or Infs.</span>

<span class="sd">    &gt;&gt;&gt; a = [1, 2, np.inf]</span>
<span class="sd">    &gt;&gt;&gt; try:</span>
<span class="sd">    ...     np.asarray_chkfinite(a)</span>
<span class="sd">    ... except ValueError:</span>
<span class="sd">    ...     print &#39;ValueError&#39;</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="ow">in</span> <span class="n">typecodes</span><span class="p">[</span><span class="s1">&#39;AllFloat&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;array must not contain infs or NaNs&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>


<span class="k">def</span> <span class="nf">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">condlist</span><span class="p">,</span> <span class="n">funclist</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate a piecewise-defined function.</span>

<span class="sd">    Given a set of conditions and corresponding functions, evaluate each</span>
<span class="sd">    function on the input data wherever its condition is true.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        The input domain.</span>
<span class="sd">    condlist : list of bool arrays</span>
<span class="sd">        Each boolean array corresponds to a function in `funclist`.  Wherever</span>
<span class="sd">        `condlist[i]` is True, `funclist[i](x)` is used as the output value.</span>

<span class="sd">        Each boolean array in `condlist` selects a piece of `x`,</span>
<span class="sd">        and should therefore be of the same shape as `x`.</span>

<span class="sd">        The length of `condlist` must correspond to that of `funclist`.</span>
<span class="sd">        If one extra function is given, i.e. if</span>
<span class="sd">        ``len(funclist) - len(condlist) == 1``, then that extra function</span>
<span class="sd">        is the default value, used wherever all conditions are false.</span>
<span class="sd">    funclist : list of callables, f(x,*args,**kw), or scalars</span>
<span class="sd">        Each function is evaluated over `x` wherever its corresponding</span>
<span class="sd">        condition is True.  It should take an array as input and give an array</span>
<span class="sd">        or a scalar value as output.  If, instead of a callable,</span>
<span class="sd">        a scalar is provided then a constant function (``lambda x: scalar``) is</span>
<span class="sd">        assumed.</span>
<span class="sd">    args : tuple, optional</span>
<span class="sd">        Any further arguments given to `piecewise` are passed to the functions</span>
<span class="sd">        upon execution, i.e., if called ``piecewise(..., ..., 1, &#39;a&#39;)``, then</span>
<span class="sd">        each function is called as ``f(x, 1, &#39;a&#39;)``.</span>
<span class="sd">    kw : dict, optional</span>
<span class="sd">        Keyword arguments used in calling `piecewise` are passed to the</span>
<span class="sd">        functions upon execution, i.e., if called</span>
<span class="sd">        ``piecewise(..., ..., lambda=1)``, then each function is called as</span>
<span class="sd">        ``f(x, lambda=1)``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        The output is the same shape and type as x and is found by</span>
<span class="sd">        calling the functions in `funclist` on the appropriate portions of `x`,</span>
<span class="sd">        as defined by the boolean arrays in `condlist`.  Portions not covered</span>
<span class="sd">        by any condition have a default value of 0.</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    choose, select, where</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This is similar to choose or select, except that functions are</span>
<span class="sd">    evaluated on elements of `x` that satisfy the corresponding condition from</span>
<span class="sd">    `condlist`.</span>

<span class="sd">    The result is::</span>

<span class="sd">            |--</span>
<span class="sd">            |funclist[0](x[condlist[0]])</span>
<span class="sd">      out = |funclist[1](x[condlist[1]])</span>
<span class="sd">            |...</span>
<span class="sd">            |funclist[n2](x[condlist[n2]])</span>
<span class="sd">            |--</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Define the sigma function, which is -1 for ``x &lt; 0`` and +1 for ``x &gt;= 0``.</span>

<span class="sd">    &gt;&gt;&gt; x = np.linspace(-2.5, 2.5, 6)</span>
<span class="sd">    &gt;&gt;&gt; np.piecewise(x, [x &lt; 0, x &gt;= 0], [-1, 1])</span>
<span class="sd">    array([-1., -1., -1.,  1.,  1.,  1.])</span>

<span class="sd">    Define the absolute value, which is ``-x`` for ``x &lt;0`` and ``x`` for</span>
<span class="sd">    ``x &gt;= 0``.</span>

<span class="sd">    &gt;&gt;&gt; np.piecewise(x, [x &lt; 0, x &gt;= 0], [lambda x: -x, lambda x: x])</span>
<span class="sd">    array([ 2.5,  1.5,  0.5,  0.5,  1.5,  2.5])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">funclist</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">isscalar</span><span class="p">(</span><span class="n">condlist</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">condlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span>
                                   <span class="nb">isinstance</span><span class="p">(</span><span class="n">condlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ndarray</span><span class="p">))):</span>
        <span class="n">condlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">condlist</span><span class="p">]</span>
    <span class="n">condlist</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">condlist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">condlist</span><span class="p">)</span>
    <span class="c1"># This is a hack to work around problems with NumPy&#39;s</span>
    <span class="c1">#  handling of 0-d arrays and boolean indexing with</span>
    <span class="c1">#  numpy.bool_ scalars</span>
    <span class="n">zerod</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span>
        <span class="n">zerod</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">condlist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">condlist</span> <span class="o">=</span> <span class="n">condlist</span><span class="o">.</span><span class="n">T</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># compute the &quot;otherwise&quot; condition.</span>
        <span class="n">totlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">condlist</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">condlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">condlist</span><span class="p">,</span> <span class="o">~</span><span class="n">totlist</span><span class="p">])</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">!=</span> <span class="n">n2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;function list and condition list must be the same&quot;</span><span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">funclist</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">):</span>
            <span class="n">y</span><span class="p">[</span><span class="n">condlist</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">condlist</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">vals</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">y</span><span class="p">[</span><span class="n">condlist</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zerod</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="n">condlist</span><span class="p">,</span> <span class="n">choicelist</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return an array drawn from elements in choicelist, depending on conditions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    condlist : list of bool ndarrays</span>
<span class="sd">        The list of conditions which determine from which array in `choicelist`</span>
<span class="sd">        the output elements are taken. When multiple conditions are satisfied,</span>
<span class="sd">        the first one encountered in `condlist` is used.</span>
<span class="sd">    choicelist : list of ndarrays</span>
<span class="sd">        The list of arrays from which the output elements are taken. It has</span>
<span class="sd">        to be of the same length as `condlist`.</span>
<span class="sd">    default : scalar, optional</span>
<span class="sd">        The element inserted in `output` when all conditions evaluate to False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    output : ndarray</span>
<span class="sd">        The output at position m is the m-th element of the array in</span>
<span class="sd">        `choicelist` where the m-th element of the corresponding array in</span>
<span class="sd">        `condlist` is True.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    where : Return elements from one of two arrays depending on condition.</span>
<span class="sd">    take, choose, compress, diag, diagonal</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(10)</span>
<span class="sd">    &gt;&gt;&gt; condlist = [x&lt;3, x&gt;5]</span>
<span class="sd">    &gt;&gt;&gt; choicelist = [x, x**2]</span>
<span class="sd">    &gt;&gt;&gt; np.select(condlist, choicelist)</span>
<span class="sd">    array([ 0,  1,  2,  0,  0,  0, 36, 49, 64, 81])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check the size of condlist and choicelist are the same, or abort.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">condlist</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">choicelist</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;list of cases must be same length as list of conditions&#39;</span><span class="p">)</span>

    <span class="c1"># Now that the dtype is known, handle the deprecated select([], []) case</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">condlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># 2014-02-24, 1.9</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;select with an empty condition list is not possible&quot;</span>
                      <span class="s2">&quot;and will be deprecated&quot;</span><span class="p">,</span>
                      <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">default</span><span class="p">)[()]</span>

    <span class="n">choicelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span> <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choicelist</span><span class="p">]</span>
    <span class="n">choicelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">default</span><span class="p">))</span>

    <span class="c1"># need to get the result type before broadcasting for correct scalar</span>
    <span class="c1"># behaviour</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="o">*</span><span class="n">choicelist</span><span class="p">)</span>

    <span class="c1"># Convert conditions to arrays and broadcast conditions and choices</span>
    <span class="c1"># as the shape is needed for the result. Doing it seperatly optimizes</span>
    <span class="c1"># for example when all choices are scalars.</span>
    <span class="n">condlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="o">*</span><span class="n">condlist</span><span class="p">)</span>
    <span class="n">choicelist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="o">*</span><span class="n">choicelist</span><span class="p">)</span>

    <span class="c1"># If cond array is not an ndarray in boolean format or scalar bool, abort.</span>
    <span class="n">deprecated_ints</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">condlist</span><span class="p">)):</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">condlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
                <span class="c1"># A previous implementation accepted int ndarrays accidentally.</span>
                <span class="c1"># Supported here deliberately, but deprecated.</span>
                <span class="n">condlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">condlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
                <span class="n">deprecated_ints</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;invalid entry in choicelist: should be boolean ndarray&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">deprecated_ints</span><span class="p">:</span>
        <span class="c1"># 2014-02-24, 1.9</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;select condlists containing integer ndarrays is deprecated &quot;</span> \
            <span class="s2">&quot;and will be removed in the future. Use `.astype(bool)` to &quot;</span> \
            <span class="s2">&quot;convert to bools.&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">choicelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># This may be common, so avoid the call.</span>
        <span class="n">result_shape</span> <span class="o">=</span> <span class="n">condlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="n">condlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">choicelist</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">result_shape</span><span class="p">,</span> <span class="n">choicelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># Use np.copyto to burn each choicelist array onto result, using the</span>
    <span class="c1"># corresponding condlist as a boolean mask. This is done in reverse</span>
    <span class="c1"># order since the first choice should take precedence.</span>
    <span class="n">choicelist</span> <span class="o">=</span> <span class="n">choicelist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">condlist</span> <span class="o">=</span> <span class="n">condlist</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">choice</span><span class="p">,</span> <span class="n">cond</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">choicelist</span><span class="p">,</span> <span class="n">condlist</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">cond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return an array copy of the given object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input data.</span>
<span class="sd">    order : {&#39;C&#39;, &#39;F&#39;, &#39;A&#39;, &#39;K&#39;}, optional</span>
<span class="sd">        Controls the memory layout of the copy. &#39;C&#39; means C-order,</span>
<span class="sd">        &#39;F&#39; means F-order, &#39;A&#39; means &#39;F&#39; if `a` is Fortran contiguous,</span>
<span class="sd">        &#39;C&#39; otherwise. &#39;K&#39; means match the layout of `a` as closely</span>
<span class="sd">        as possible. (Note that this function and :meth:ndarray.copy are very</span>
<span class="sd">        similar, but have different default values for their order=</span>
<span class="sd">        arguments.)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    arr : ndarray</span>
<span class="sd">        Array interpretation of `a`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This is equivalent to</span>

<span class="sd">    &gt;&gt;&gt; np.array(a, copy=True)                              #doctest: +SKIP</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Create an array x, with a reference y and a copy z:</span>

<span class="sd">    &gt;&gt;&gt; x = np.array([1, 2, 3])</span>
<span class="sd">    &gt;&gt;&gt; y = x</span>
<span class="sd">    &gt;&gt;&gt; z = np.copy(x)</span>

<span class="sd">    Note that, when we modify x, y changes, but not z:</span>

<span class="sd">    &gt;&gt;&gt; x[0] = 10</span>
<span class="sd">    &gt;&gt;&gt; x[0] == y[0]</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; x[0] == z[0]</span>
<span class="sd">    False</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Basic operations</span>


<span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">varargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the gradient of an N-dimensional array.</span>

<span class="sd">    The gradient is computed using second order accurate central differences</span>
<span class="sd">    in the interior and either first differences or second order accurate</span>
<span class="sd">    one-sides (forward or backwards) differences at the boundaries. The</span>
<span class="sd">    returned gradient hence has the same shape as the input array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : array_like</span>
<span class="sd">        An N-dimensional array containing samples of a scalar function.</span>
<span class="sd">    varargs : list of scalar, optional</span>
<span class="sd">        N scalars specifying the sample distances for each dimension,</span>
<span class="sd">        i.e. `dx`, `dy`, `dz`, ... Default distance: 1.</span>
<span class="sd">    edge_order : {1, 2}, optional</span>
<span class="sd">        Gradient is calculated using N\ :sup:`th` order accurate differences</span>
<span class="sd">        at the boundaries. Default: 1.</span>

<span class="sd">        .. versionadded:: 1.9.1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gradient : list of ndarray</span>
<span class="sd">        Each element of `list` has the same shape as `f` giving the derivative </span>
<span class="sd">        of `f` with respect to each dimension.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.array([1, 2, 4, 7, 11, 16], dtype=np.float)</span>
<span class="sd">    &gt;&gt;&gt; np.gradient(x)</span>
<span class="sd">    array([ 1. ,  1.5,  2.5,  3.5,  4.5,  5. ])</span>
<span class="sd">    &gt;&gt;&gt; np.gradient(x, 2)</span>
<span class="sd">    array([ 0.5 ,  0.75,  1.25,  1.75,  2.25,  2.5 ])</span>

<span class="sd">    For two dimensional arrays, the return will be two arrays ordered by </span>
<span class="sd">    axis. In this example the first array stands for the gradient in </span>
<span class="sd">    rows and the second one in columns direction:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; np.gradient(np.array([[1, 2, 6], [3, 4, 5]], dtype=np.float))</span>
<span class="sd">    [array([[ 2.,  2., -1.],</span>
<span class="sd">            [ 2.,  2., -1.]]), array([[ 1. ,  2.5,  4. ],</span>
<span class="sd">            [ 1. ,  1. ,  1. ]])]</span>

<span class="sd">    &gt;&gt;&gt; x = np.array([0, 1, 2, 3, 4])</span>
<span class="sd">    &gt;&gt;&gt; dx = np.gradient(x)</span>
<span class="sd">    &gt;&gt;&gt; y = x**2</span>
<span class="sd">    &gt;&gt;&gt; np.gradient(y, dx, edge_order=2)</span>
<span class="sd">    array([-0.,  2.,  4.,  6.,  8.])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># number of dimensions</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">varargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="p">[</span><span class="n">varargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="n">N</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">varargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span>
            <span class="s2">&quot;invalid number of arguments&quot;</span><span class="p">)</span>

    <span class="n">edge_order</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;edge_order&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&quot;{}&quot; are not valid keyword arguments.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                                  <span class="s1">&#39;&quot;, &quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
    <span class="k">if</span> <span class="n">edge_order</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;edge_order&#39; greater than 2 not supported&quot;</span><span class="p">)</span>

    <span class="c1"># use central differences on interior and one-sided differences on the</span>
    <span class="c1"># endpoints. This preserves second order-accuracy over the full domain.</span>

    <span class="n">outvals</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># create slice objects --- initially all are [:, :, ..., :]</span>
    <span class="n">slice1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">N</span>
    <span class="n">slice2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">N</span>
    <span class="n">slice3</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">N</span>
    <span class="n">slice4</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">N</span>

    <span class="n">otype</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span>
    <span class="k">if</span> <span class="n">otype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">]:</span>
        <span class="n">otype</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>

    <span class="c1"># Difference of datetime64 elements results in timedelta64</span>
    <span class="k">if</span> <span class="n">otype</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
        <span class="c1"># Need to use the full dtype name because it contains unit information</span>
        <span class="n">otype</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;timedelta&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">otype</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="c1"># Needs to keep the specific units, can&#39;t be a general unit</span>
        <span class="n">otype</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">dtype</span>

    <span class="c1"># Convert datetime64 data into ints. Make dummy variable `y`</span>
    <span class="c1"># that is a view of ints if the data is datetime64, otherwise</span>
    <span class="c1"># just set y equal to the the array `f`.</span>
    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">]:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">f</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Shape of array too small to calculate a numerical gradient, &quot;</span>
                <span class="s2">&quot;at least two elements are required.&quot;</span><span class="p">)</span>

        <span class="c1"># Numerical differentiation: 1st order edges, 2nd order interior</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">edge_order</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Use first order differences for time data</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">otype</span><span class="p">)</span>

            <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">slice3</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1"># 1D equivalent -- out[1:-1] = (y[2:] - y[:-2])/2.0</span>
            <span class="n">out</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">slice3</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>

            <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">slice3</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># 1D equivalent -- out[0] = (y[1] - y[0])</span>
            <span class="n">out</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">slice3</span><span class="p">])</span>

            <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">slice3</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
            <span class="c1"># 1D equivalent -- out[-1] = (y[-1] - y[-2])</span>
            <span class="n">out</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">slice3</span><span class="p">])</span>

        <span class="c1"># Numerical differentiation: 2st order edges, 2nd order interior</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use second order differences where possible</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">otype</span><span class="p">)</span>

            <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">slice3</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1"># 1D equivalent -- out[1:-1] = (y[2:] - y[:-2])/2.0</span>
            <span class="n">out</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">slice3</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>

            <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">slice3</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">slice4</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="c1"># 1D equivalent -- out[0] = -(3*y[0] - 4*y[1] + y[2]) / 2.0</span>
            <span class="n">out</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">slice3</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">slice4</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>

            <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">slice3</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
            <span class="n">slice4</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
            <span class="c1"># 1D equivalent -- out[-1] = (3*y[-1] - 4*y[-2] + y[-3])</span>
            <span class="n">out</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">slice3</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">slice4</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>

        <span class="c1"># divide by step size</span>
        <span class="n">out</span> <span class="o">/=</span> <span class="n">dx</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="n">outvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="c1"># reset the slice object in this dimension to &quot;:&quot;</span>
        <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">slice3</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">slice4</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">outvals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">outvals</span>


<span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the n-th order discrete difference along given axis.</span>

<span class="sd">    The first order difference is given by ``out[n] = a[n+1] - a[n]`` along</span>
<span class="sd">    the given axis, higher order differences are calculated by using `diff`</span>
<span class="sd">    recursively.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array</span>
<span class="sd">    n : int, optional</span>
<span class="sd">        The number of times values are differenced.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        The axis along which the difference is taken, default is the last axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    diff : ndarray</span>
<span class="sd">        The `n` order differences. The shape of the output is the same as `a`</span>
<span class="sd">        except along `axis` where the dimension is smaller by `n`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    gradient, ediff1d, cumsum</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.array([1, 2, 4, 7, 0])</span>
<span class="sd">    &gt;&gt;&gt; np.diff(x)</span>
<span class="sd">    array([ 1,  2,  3, -7])</span>
<span class="sd">    &gt;&gt;&gt; np.diff(x, n=2)</span>
<span class="sd">    array([  1,   1, -10])</span>

<span class="sd">    &gt;&gt;&gt; x = np.array([[1, 3, 6, 10], [0, 5, 6, 8]])</span>
<span class="sd">    &gt;&gt;&gt; np.diff(x)</span>
<span class="sd">    array([[2, 3, 4],</span>
<span class="sd">           [5, 1, 2]])</span>
<span class="sd">    &gt;&gt;&gt; np.diff(x, axis=0)</span>
<span class="sd">    array([[-1,  2,  0, -2]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;order must be non-negative but got &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">slice1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">nd</span>
    <span class="n">slice2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">nd</span>
    <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">slice1</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">slice1</span><span class="p">)</span>
    <span class="n">slice2</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">slice2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">diff</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="n">slice2</span><span class="p">],</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="n">slice2</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    One-dimensional linear interpolation.</span>

<span class="sd">    Returns the one-dimensional piecewise linear interpolant to a function</span>
<span class="sd">    with given values at discrete data-points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        The x-coordinates of the interpolated values.</span>

<span class="sd">    xp : 1-D sequence of floats</span>
<span class="sd">        The x-coordinates of the data points, must be increasing if argument</span>
<span class="sd">        `period` is not specified. Otherwise, `xp` is internally sorted after</span>
<span class="sd">        normalizing the periodic boundaries with ``xp = xp % period``.</span>

<span class="sd">    fp : 1-D sequence of floats</span>
<span class="sd">        The y-coordinates of the data points, same length as `xp`.</span>

<span class="sd">    left : float, optional</span>
<span class="sd">        Value to return for `x &lt; xp[0]`, default is `fp[0]`.</span>

<span class="sd">    right : float, optional</span>
<span class="sd">        Value to return for `x &gt; xp[-1]`, default is `fp[-1]`.</span>

<span class="sd">    period : None or float, optional</span>
<span class="sd">        A period for the x-coordinates. This parameter allows the proper</span>
<span class="sd">        interpolation of angular x-coordinates. Parameters `left` and `right`</span>
<span class="sd">        are ignored if `period` is specified.</span>

<span class="sd">        .. versionadded:: 1.10.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y : float or ndarray</span>
<span class="sd">        The interpolated values, same shape as `x`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If `xp` and `fp` have different length</span>
<span class="sd">        If `xp` or `fp` are not 1-D sequences</span>
<span class="sd">        If `period == 0`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Does not check that the x-coordinate sequence `xp` is increasing.</span>
<span class="sd">    If `xp` is not increasing, the results are nonsense.</span>
<span class="sd">    A simple check for increasing is::</span>

<span class="sd">        np.all(np.diff(xp) &gt; 0)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; xp = [1, 2, 3]</span>
<span class="sd">    &gt;&gt;&gt; fp = [3, 2, 0]</span>
<span class="sd">    &gt;&gt;&gt; np.interp(2.5, xp, fp)</span>
<span class="sd">    1.0</span>
<span class="sd">    &gt;&gt;&gt; np.interp([0, 1, 1.5, 2.72, 3.14], xp, fp)</span>
<span class="sd">    array([ 3. ,  3. ,  2.5 ,  0.56,  0. ])</span>
<span class="sd">    &gt;&gt;&gt; UNDEF = -99.0</span>
<span class="sd">    &gt;&gt;&gt; np.interp(3.14, xp, fp, right=UNDEF)</span>
<span class="sd">    -99.0</span>

<span class="sd">    Plot an interpolant to the sine function:</span>

<span class="sd">    &gt;&gt;&gt; x = np.linspace(0, 2*np.pi, 10)</span>
<span class="sd">    &gt;&gt;&gt; y = np.sin(x)</span>
<span class="sd">    &gt;&gt;&gt; xvals = np.linspace(0, 2*np.pi, 50)</span>
<span class="sd">    &gt;&gt;&gt; yinterp = np.interp(xvals, x, y)</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(x, y, &#39;o&#39;)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(xvals, yinterp, &#39;-x&#39;)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    Interpolation with periodic x-coordinates:</span>

<span class="sd">    &gt;&gt;&gt; x = [-180, -170, -185, 185, -10, -5, 0, 365]</span>
<span class="sd">    &gt;&gt;&gt; xp = [190, -190, 350, -350]</span>
<span class="sd">    &gt;&gt;&gt; fp = [5, 10, 3, 4]</span>
<span class="sd">    &gt;&gt;&gt; np.interp(x, xp, fp, period=360)</span>
<span class="sd">    array([7.5, 5., 8.75, 6.25, 3., 3.25, 3.5, 3.75])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">period</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">number</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">compiled_interp</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">xp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">compiled_interp</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">xp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">compiled_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">period</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;period must be a non-zero value&quot;</span><span class="p">)</span>
        <span class="n">period</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">right</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">return_array</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">number</span><span class="p">)):</span>
            <span class="n">return_array</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xp</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">fp</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data points must be 1-D sequences&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fp and xp are not of the same length&quot;</span><span class="p">)</span>
        <span class="c1"># normalizing periodic boundaries</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">%</span> <span class="n">period</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">%</span> <span class="n">period</span>
        <span class="n">asort_xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span><span class="p">[</span><span class="n">asort_xp</span><span class="p">]</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">fp</span><span class="p">[</span><span class="n">asort_xp</span><span class="p">]</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">period</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">xp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">period</span><span class="p">))</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">fp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">return_array</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">compiled_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">compiled_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the angle of the complex argument.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z : array_like</span>
<span class="sd">        A complex number or sequence of complex numbers.</span>
<span class="sd">    deg : bool, optional</span>
<span class="sd">        Return angle in degrees if True, radians if False (default).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    angle : ndarray or scalar</span>
<span class="sd">        The counterclockwise angle from the positive real axis on</span>
<span class="sd">        the complex plane, with dtype as numpy.float64.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    arctan2</span>
<span class="sd">    absolute</span>



<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.angle([1.0, 1.0j, 1+1j])               # in radians</span>
<span class="sd">    array([ 0.        ,  1.57079633,  0.78539816])</span>
<span class="sd">    &gt;&gt;&gt; np.angle(1+1j, deg=True)                  # in degrees</span>
<span class="sd">    45.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">deg</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="mi">180</span><span class="o">/</span><span class="n">pi</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">_nx</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">)):</span>
        <span class="n">zimag</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span>
        <span class="n">zreal</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zimag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">zreal</span> <span class="o">=</span> <span class="n">z</span>
    <span class="k">return</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">zimag</span><span class="p">,</span> <span class="n">zreal</span><span class="p">)</span> <span class="o">*</span> <span class="n">fact</span>


<span class="k">def</span> <span class="nf">unwrap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">discont</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unwrap by changing deltas between values to 2*pi complement.</span>

<span class="sd">    Unwrap radian phase `p` by changing absolute jumps greater than</span>
<span class="sd">    `discont` to their 2*pi complement along the given axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    p : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    discont : float, optional</span>
<span class="sd">        Maximum discontinuity between values, default is ``pi``.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        Axis along which unwrap will operate, default is the last axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        Output array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    rad2deg, deg2rad</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If the discontinuity in `p` is smaller than ``pi``, but larger than</span>
<span class="sd">    `discont`, no unwrapping is done because taking the 2*pi complement</span>
<span class="sd">    would only make the discontinuity larger.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; phase = np.linspace(0, np.pi, num=5)</span>
<span class="sd">    &gt;&gt;&gt; phase[3:] += np.pi</span>
<span class="sd">    &gt;&gt;&gt; phase</span>
<span class="sd">    array([ 0.        ,  0.78539816,  1.57079633,  5.49778714,  6.28318531])</span>
<span class="sd">    &gt;&gt;&gt; np.unwrap(phase)</span>
<span class="sd">    array([ 0.        ,  0.78539816,  1.57079633, -0.78539816,  0.        ])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">dd</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">slice1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">nd</span>     <span class="c1"># full slices</span>
    <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">ddmod</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">dd</span> <span class="o">+</span> <span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">pi</span>
    <span class="n">_nx</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">ddmod</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">ddmod</span> <span class="o">==</span> <span class="o">-</span><span class="n">pi</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dd</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">ph_correct</span> <span class="o">=</span> <span class="n">ddmod</span> <span class="o">-</span> <span class="n">dd</span>
    <span class="n">_nx</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">ph_correct</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">discont</span><span class="p">)</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="n">up</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ph_correct</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">up</span>


<span class="k">def</span> <span class="nf">sort_complex</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sort a complex array using the real part first, then the imaginary part.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : complex ndarray</span>
<span class="sd">        Always returns a sorted complex array.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.sort_complex([5, 3, 6, 2, 1])</span>
<span class="sd">    array([ 1.+0.j,  2.+0.j,  3.+0.j,  5.+0.j,  6.+0.j])</span>

<span class="sd">    &gt;&gt;&gt; np.sort_complex([1 + 2j, 2 - 1j, 3 - 2j, 3 - 3j, 3 + 5j])</span>
<span class="sd">    array([ 1.+2.j,  2.-1.j,  3.-3.j,  3.-2.j,  3.+5.j])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">_nx</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="ow">in</span> <span class="s1">&#39;bhBH&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">b</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">b</span>


<span class="k">def</span> <span class="nf">trim_zeros</span><span class="p">(</span><span class="n">filt</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="s1">&#39;fb&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trim the leading and/or trailing zeros from a 1-D array or sequence.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filt : 1-D array or sequence</span>
<span class="sd">        Input array.</span>
<span class="sd">    trim : str, optional</span>
<span class="sd">        A string with &#39;f&#39; representing trim from front and &#39;b&#39; to trim from</span>
<span class="sd">        back. Default is &#39;fb&#39;, trim zeros from both front and back of the</span>
<span class="sd">        array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    trimmed : 1-D array or sequence</span>
<span class="sd">        The result of trimming the input. The input data type is preserved.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = np.array((0, 0, 0, 1, 2, 3, 0, 2, 1, 0))</span>
<span class="sd">    &gt;&gt;&gt; np.trim_zeros(a)</span>
<span class="sd">    array([1, 2, 3, 0, 2, 1])</span>

<span class="sd">    &gt;&gt;&gt; np.trim_zeros(a, &#39;b&#39;)</span>
<span class="sd">    array([0, 0, 0, 1, 2, 3, 0, 2, 1])</span>

<span class="sd">    The input data type is preserved, list/tuple in means list/tuple out.</span>

<span class="sd">    &gt;&gt;&gt; np.trim_zeros([0, 1, 2, 0])</span>
<span class="sd">    [1, 2]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">first</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">trim</span> <span class="o">=</span> <span class="n">trim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;F&#39;</span> <span class="ow">in</span> <span class="n">trim</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">filt</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">last</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">trim</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">filt</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">last</span> <span class="o">=</span> <span class="n">last</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">filt</span><span class="p">[</span><span class="n">first</span><span class="p">:</span><span class="n">last</span><span class="p">]</span>


<span class="nd">@deprecate</span>
<span class="k">def</span> <span class="nf">unique</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is deprecated.  Use numpy.lib.arraysetops.unique()</span>
<span class="sd">    instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tmp</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(([</span><span class="bp">True</span><span class="p">],</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">tmp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">tmp</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">asarray</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the elements of an array that satisfy some condition.</span>

<span class="sd">    This is equivalent to ``np.compress(ravel(condition), ravel(arr))``.  If</span>
<span class="sd">    `condition` is boolean ``np.extract`` is equivalent to ``arr[condition]``.</span>

<span class="sd">    Note that `place` does the exact opposite of `extract`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    condition : array_like</span>
<span class="sd">        An array whose nonzero or True entries indicate the elements of `arr`</span>
<span class="sd">        to extract.</span>
<span class="sd">    arr : array_like</span>
<span class="sd">        Input array of the same size as `condition`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    extract : ndarray</span>
<span class="sd">        Rank 1 array of values from `arr` where `condition` is True.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    take, put, copyto, compress, place</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; arr = np.arange(12).reshape((3, 4))</span>
<span class="sd">    &gt;&gt;&gt; arr</span>
<span class="sd">    array([[ 0,  1,  2,  3],</span>
<span class="sd">           [ 4,  5,  6,  7],</span>
<span class="sd">           [ 8,  9, 10, 11]])</span>
<span class="sd">    &gt;&gt;&gt; condition = np.mod(arr, 3)==0</span>
<span class="sd">    &gt;&gt;&gt; condition</span>
<span class="sd">    array([[ True, False, False,  True],</span>
<span class="sd">           [False, False,  True, False],</span>
<span class="sd">           [False,  True, False, False]], dtype=bool)</span>
<span class="sd">    &gt;&gt;&gt; np.extract(condition, arr)</span>
<span class="sd">    array([0, 3, 6, 9])</span>


<span class="sd">    If `condition` is boolean:</span>

<span class="sd">    &gt;&gt;&gt; arr[condition]</span>
<span class="sd">    array([0, 3, 6, 9])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_nx</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">ravel</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">nonzero</span><span class="p">(</span><span class="n">ravel</span><span class="p">(</span><span class="n">condition</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">place</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change elements of an array based on conditional and input values.</span>

<span class="sd">    Similar to ``np.copyto(arr, vals, where=mask)``, the difference is that</span>
<span class="sd">    `place` uses the first N elements of `vals`, where N is the number of</span>
<span class="sd">    True values in `mask`, while `copyto` uses the elements where `mask`</span>
<span class="sd">    is True.</span>

<span class="sd">    Note that `extract` does the exact opposite of `place`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr : array_like</span>
<span class="sd">        Array to put data into.</span>
<span class="sd">    mask : array_like</span>
<span class="sd">        Boolean mask array. Must have the same size as `a`.</span>
<span class="sd">    vals : 1-D sequence</span>
<span class="sd">        Values to put into `a`. Only the first N elements are used, where</span>
<span class="sd">        N is the number of True values in `mask`. If `vals` is smaller</span>
<span class="sd">        than N it will be repeated.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    copyto, put, take, extract</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; arr = np.arange(6).reshape(2, 3)</span>
<span class="sd">    &gt;&gt;&gt; np.place(arr, arr&gt;2, [44, 55])</span>
<span class="sd">    &gt;&gt;&gt; arr</span>
<span class="sd">    array([[ 0,  1,  2],</span>
<span class="sd">           [44, 55, 44]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_insert</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">disp</span><span class="p">(</span><span class="n">mesg</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">linefeed</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a message on a device.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mesg : str</span>
<span class="sd">        Message to display.</span>
<span class="sd">    device : object</span>
<span class="sd">        Device to write message. If None, defaults to ``sys.stdout`` which is</span>
<span class="sd">        very similar to ``print``. `device` needs to have ``write()`` and</span>
<span class="sd">        ``flush()`` methods.</span>
<span class="sd">    linefeed : bool, optional</span>
<span class="sd">        Option whether to print a line feed or not. Defaults to True.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AttributeError</span>
<span class="sd">        If `device` does not have a ``write()`` or ``flush()`` method.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Besides ``sys.stdout``, a file-like object can also be used as it has</span>
<span class="sd">    both required methods:</span>

<span class="sd">    &gt;&gt;&gt; from StringIO import StringIO</span>
<span class="sd">    &gt;&gt;&gt; buf = StringIO()</span>
<span class="sd">    &gt;&gt;&gt; np.disp(&#39;&quot;Display&quot; in a file&#39;, device=buf)</span>
<span class="sd">    &gt;&gt;&gt; buf.getvalue()</span>
<span class="sd">    &#39;&quot;Display&quot; in a file\\n&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
    <span class="k">if</span> <span class="n">linefeed</span><span class="p">:</span>
        <span class="n">device</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mesg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">device</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mesg</span><span class="p">)</span>
    <span class="n">device</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">return</span>


<span class="k">class</span> <span class="nc">vectorize</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    vectorize(pyfunc, otypes=&#39;&#39;, doc=None, excluded=None, cache=False)</span>

<span class="sd">    Generalized function class.</span>

<span class="sd">    Define a vectorized function which takes a nested sequence</span>
<span class="sd">    of objects or numpy arrays as inputs and returns a</span>
<span class="sd">    numpy array as output. The vectorized function evaluates `pyfunc` over</span>
<span class="sd">    successive tuples of the input arrays like the python map function,</span>
<span class="sd">    except it uses the broadcasting rules of numpy.</span>

<span class="sd">    The data type of the output of `vectorized` is determined by calling</span>
<span class="sd">    the function with the first element of the input.  This can be avoided</span>
<span class="sd">    by specifying the `otypes` argument.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pyfunc : callable</span>
<span class="sd">        A python function or method.</span>
<span class="sd">    otypes : str or list of dtypes, optional</span>
<span class="sd">        The output data type. It must be specified as either a string of</span>
<span class="sd">        typecode characters or a list of data type specifiers. There should</span>
<span class="sd">        be one data type specifier for each output.</span>
<span class="sd">    doc : str, optional</span>
<span class="sd">        The docstring for the function. If `None`, the docstring will be the</span>
<span class="sd">        ``pyfunc.__doc__``.</span>
<span class="sd">    excluded : set, optional</span>
<span class="sd">        Set of strings or integers representing the positional or keyword</span>
<span class="sd">        arguments for which the function will not be vectorized.  These will be</span>
<span class="sd">        passed directly to `pyfunc` unmodified.</span>

<span class="sd">        .. versionadded:: 1.7.0</span>

<span class="sd">    cache : bool, optional</span>
<span class="sd">       If `True`, then cache the first function call that determines the number</span>
<span class="sd">       of outputs if `otypes` is not provided.</span>

<span class="sd">        .. versionadded:: 1.7.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vectorized : callable</span>
<span class="sd">        Vectorized function.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; def myfunc(a, b):</span>
<span class="sd">    ...     &quot;Return a-b if a&gt;b, otherwise return a+b&quot;</span>
<span class="sd">    ...     if a &gt; b:</span>
<span class="sd">    ...         return a - b</span>
<span class="sd">    ...     else:</span>
<span class="sd">    ...         return a + b</span>

<span class="sd">    &gt;&gt;&gt; vfunc = np.vectorize(myfunc)</span>
<span class="sd">    &gt;&gt;&gt; vfunc([1, 2, 3, 4], 2)</span>
<span class="sd">    array([3, 4, 1, 2])</span>

<span class="sd">    The docstring is taken from the input function to `vectorize` unless it</span>
<span class="sd">    is specified</span>

<span class="sd">    &gt;&gt;&gt; vfunc.__doc__</span>
<span class="sd">    &#39;Return a-b if a&gt;b, otherwise return a+b&#39;</span>
<span class="sd">    &gt;&gt;&gt; vfunc = np.vectorize(myfunc, doc=&#39;Vectorized `myfunc`&#39;)</span>
<span class="sd">    &gt;&gt;&gt; vfunc.__doc__</span>
<span class="sd">    &#39;Vectorized `myfunc`&#39;</span>

<span class="sd">    The output type is determined by evaluating the first element of the input,</span>
<span class="sd">    unless it is specified</span>

<span class="sd">    &gt;&gt;&gt; out = vfunc([1, 2, 3, 4], 2)</span>
<span class="sd">    &gt;&gt;&gt; type(out[0])</span>
<span class="sd">    &lt;type &#39;numpy.int32&#39;&gt;</span>
<span class="sd">    &gt;&gt;&gt; vfunc = np.vectorize(myfunc, otypes=[np.float])</span>
<span class="sd">    &gt;&gt;&gt; out = vfunc([1, 2, 3, 4], 2)</span>
<span class="sd">    &gt;&gt;&gt; type(out[0])</span>
<span class="sd">    &lt;type &#39;numpy.float64&#39;&gt;</span>

<span class="sd">    The `excluded` argument can be used to prevent vectorizing over certain</span>
<span class="sd">    arguments.  This can be useful for array-like arguments of a fixed length</span>
<span class="sd">    such as the coefficients for a polynomial as in `polyval`:</span>

<span class="sd">    &gt;&gt;&gt; def mypolyval(p, x):</span>
<span class="sd">    ...     _p = list(p)</span>
<span class="sd">    ...     res = _p.pop(0)</span>
<span class="sd">    ...     while _p:</span>
<span class="sd">    ...         res = res*x + _p.pop(0)</span>
<span class="sd">    ...     return res</span>
<span class="sd">    &gt;&gt;&gt; vpolyval = np.vectorize(mypolyval, excluded=[&#39;p&#39;])</span>
<span class="sd">    &gt;&gt;&gt; vpolyval(p=[1, 2, 3], x=[0, 1])</span>
<span class="sd">    array([3, 6])</span>

<span class="sd">    Positional arguments may also be excluded by specifying their position:</span>

<span class="sd">    &gt;&gt;&gt; vpolyval.excluded.add(0)</span>
<span class="sd">    &gt;&gt;&gt; vpolyval([1, 2, 3], x=[0, 1])</span>
<span class="sd">    array([3, 6])</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `vectorize` function is provided primarily for convenience, not for</span>
<span class="sd">    performance. The implementation is essentially a for loop.</span>

<span class="sd">    If `otypes` is not specified, then a call to the function with the</span>
<span class="sd">    first argument will be used to determine the number of outputs.  The</span>
<span class="sd">    results of this call will be cached if `cache` is `True` to prevent</span>
<span class="sd">    calling the function twice.  However, to implement the cache, the</span>
<span class="sd">    original function must be wrapped which will slow down subsequent</span>
<span class="sd">    calls, so only do this if your function is expensive.</span>

<span class="sd">    The new keyword argument interface and `excluded` argument support</span>
<span class="sd">    further degrades performance.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pyfunc</span><span class="p">,</span> <span class="n">otypes</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excluded</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">cache</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyfunc</span> <span class="o">=</span> <span class="n">pyfunc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ufunc</span> <span class="o">=</span> <span class="bp">None</span>    <span class="c1"># Caching to improve default performance</span>

        <span class="k">if</span> <span class="n">doc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">pyfunc</span><span class="o">.</span><span class="n">__doc__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">doc</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">otypes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otypes</span> <span class="o">=</span> <span class="n">otypes</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">otypes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">typecodes</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Invalid otype specified: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">char</span><span class="p">,))</span>
        <span class="k">elif</span> <span class="n">iterable</span><span class="p">(</span><span class="n">otypes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otypes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_nx</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">char</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">otypes</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid otype specification&quot;</span><span class="p">)</span>

        <span class="c1"># Excluded variable support</span>
        <span class="k">if</span> <span class="n">excluded</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return arrays with the results of `pyfunc` broadcast (vectorized) over</span>
<span class="sd">        `args` and `kwargs` not in `excluded`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">excluded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">excluded</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pyfunc</span>
            <span class="n">vargs</span> <span class="o">=</span> <span class="n">args</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The wrapper accepts only positional arguments: we use `names` and</span>
            <span class="c1"># `inds` to mutate `the_args` and `kwargs` to pass to the original</span>
            <span class="c1"># function.</span>
            <span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">_n</span> <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">if</span> <span class="n">_n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded</span><span class="p">]</span>
            <span class="n">inds</span> <span class="o">=</span> <span class="p">[</span><span class="n">_i</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">_i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded</span><span class="p">]</span>
            <span class="n">the_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">vargs</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">_n</span><span class="p">,</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inds</span><span class="p">):</span>
                    <span class="n">the_args</span><span class="p">[</span><span class="n">_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vargs</span><span class="p">[</span><span class="n">_n</span><span class="p">]</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">vargs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">inds</span><span class="p">):]))</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pyfunc</span><span class="p">(</span><span class="o">*</span><span class="n">the_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="n">vargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="n">_i</span><span class="p">]</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">]</span>
            <span class="n">vargs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">kwargs</span><span class="p">[</span><span class="n">_n</span><span class="p">]</span> <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="n">names</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vectorize_call</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">vargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_ufunc_and_otypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return (ufunc, otypes).&quot;&quot;&quot;</span>
        <span class="c1"># frompyfunc will fail if args is empty</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;args can not be empty&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">otypes</span><span class="p">:</span>
            <span class="n">otypes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">otypes</span>
            <span class="n">nout</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otypes</span><span class="p">)</span>

            <span class="c1"># Note logic here: We only *use* self._ufunc if func is self.pyfunc</span>
            <span class="c1"># even though we set self._ufunc regardless.</span>
            <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">pyfunc</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ufunc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ufunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ufunc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ufunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ufunc</span> <span class="o">=</span> <span class="n">frompyfunc</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">nout</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get number of outputs and output types by calling the function on</span>
            <span class="c1"># the first entries of args.  We also cache the result to prevent</span>
            <span class="c1"># the subsequent call when the ufunc is evaluated.</span>
            <span class="c1"># Assumes that ufunc first evaluates the 0th elements in the input</span>
            <span class="c1"># arrays (the input values are not checked to ensure this)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">asarray</span><span class="p">(</span><span class="n">_a</span><span class="p">)</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span>

            <span class="c1"># Performance note: profiling indicates that -- for simple</span>
            <span class="c1"># functions at least -- this wrapping can almost double the</span>
            <span class="c1"># execution time.</span>
            <span class="c1"># Hence we make it optional.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
                <span class="n">_cache</span> <span class="o">=</span> <span class="p">[</span><span class="n">outputs</span><span class="p">]</span>

                <span class="k">def</span> <span class="nf">_func</span><span class="p">(</span><span class="o">*</span><span class="n">vargs</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">_cache</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">_cache</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">vargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_func</span> <span class="o">=</span> <span class="n">func</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">nout</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nout</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">outputs</span><span class="p">,)</span>

            <span class="n">otypes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">asarray</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="n">_k</span><span class="p">])</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span>
                              <span class="k">for</span> <span class="n">_k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nout</span><span class="p">)])</span>

            <span class="c1"># Performance note: profiling indicates that creating the ufunc is</span>
            <span class="c1"># not a significant cost compared with wrapping so it seems not</span>
            <span class="c1"># worth trying to cache this.</span>
            <span class="n">ufunc</span> <span class="o">=</span> <span class="n">frompyfunc</span><span class="p">(</span><span class="n">_func</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">nout</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">otypes</span>

    <span class="k">def</span> <span class="nf">_vectorize_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vectorized call to `func` over positional `args`.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">_res</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ufunc</span><span class="p">,</span> <span class="n">otypes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ufunc_and_otypes</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

            <span class="c1"># Convert args to object arrays first</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">array</span><span class="p">(</span><span class="n">_a</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">_a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>

            <span class="n">outputs</span> <span class="o">=</span> <span class="n">ufunc</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ufunc</span><span class="o">.</span><span class="n">nout</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">_res</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span>
                             <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">otypes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_res</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">array</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">_t</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">_x</span><span class="p">,</span> <span class="n">_t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">otypes</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">_res</span>


<span class="k">def</span> <span class="nf">cov</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fweights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">aweights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate a covariance matrix, given data and weights.</span>

<span class="sd">    Covariance indicates the level to which two variables vary together.</span>
<span class="sd">    If we examine N-dimensional samples, :math:`X = [x_1, x_2, ... x_N]^T`,</span>
<span class="sd">    then the covariance matrix element :math:`C_{ij}` is the covariance of</span>
<span class="sd">    :math:`x_i` and :math:`x_j`. The element :math:`C_{ii}` is the variance</span>
<span class="sd">    of :math:`x_i`.</span>

<span class="sd">    See the notes for an outline of the algorithm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : array_like</span>
<span class="sd">        A 1-D or 2-D array containing multiple variables and observations.</span>
<span class="sd">        Each row of `m` represents a variable, and each column a single</span>
<span class="sd">        observation of all those variables. Also see `rowvar` below.</span>
<span class="sd">    y : array_like, optional</span>
<span class="sd">        An additional set of variables and observations. `y` has the same form</span>
<span class="sd">        as that of `m`.</span>
<span class="sd">    rowvar : int, optional</span>
<span class="sd">        If `rowvar` is non-zero (default), then each row represents a</span>
<span class="sd">        variable, with observations in the columns. Otherwise, the relationship</span>
<span class="sd">        is transposed: each column represents a variable, while the rows</span>
<span class="sd">        contain observations.</span>
<span class="sd">    bias : int, optional</span>
<span class="sd">        Default normalization is by ``(N - 1)``, where ``N`` corresponds to the</span>
<span class="sd">        number of observations given (unbiased estimate). If `bias` is 1, then</span>
<span class="sd">        normalization is by ``N``. These values can be overridden by using the</span>
<span class="sd">        keyword ``ddof`` in numpy versions &gt;= 1.5.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        If not ``None`` the default value implied by `bias` is overridden.</span>
<span class="sd">        Note that ``ddof=1`` will return the unbiased estimate, even if both</span>
<span class="sd">        `fweights` and `aweights` are specified, and ``ddof=0`` will return</span>
<span class="sd">        the simple average. See the notes for the details. The default value</span>
<span class="sd">        is ``None``.</span>

<span class="sd">        .. versionadded:: 1.5</span>
<span class="sd">    fweights : array_like, int, optional</span>
<span class="sd">        1-D array of integer freguency weights; the number of times each</span>
<span class="sd">        observation vector should be repeated.</span>

<span class="sd">        .. versionadded:: 1.10</span>
<span class="sd">    aweights : array_like, optional</span>
<span class="sd">        1-D array of observation vector weights. These relative weights are</span>
<span class="sd">        typically large for observations considered &quot;important&quot; and smaller for</span>
<span class="sd">        observations considered less &quot;important&quot;. If ``ddof=0`` the array of</span>
<span class="sd">        weights can be used to assign probabilities to observation vectors.</span>

<span class="sd">        .. versionadded:: 1.10</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        The covariance matrix of the variables.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    corrcoef : Normalized covariance matrix</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assume that the observations are in the columns of the observation</span>
<span class="sd">    array `m` and let ``f = fweights`` and ``a = aweights`` for brevity. The</span>
<span class="sd">    steps to compute the weighted covariance are as follows::</span>

<span class="sd">        &gt;&gt;&gt; w = f * a</span>
<span class="sd">        &gt;&gt;&gt; v1 = np.sum(w)</span>
<span class="sd">        &gt;&gt;&gt; v2 = np.sum(w * a)</span>
<span class="sd">        &gt;&gt;&gt; m -= np.sum(m * w, axis=1, keepdims=True) / v1</span>
<span class="sd">        &gt;&gt;&gt; cov = np.dot(m * w, m.T) * v1 / (v1**2 - ddof * v2)</span>

<span class="sd">    Note that when ``a == 1``, the normalization factor</span>
<span class="sd">    ``v1 / (v1**2 - ddof * v2)`` goes over to ``1 / (np.sum(f) - ddof)``</span>
<span class="sd">    as it should.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Consider two variables, :math:`x_0` and :math:`x_1`, which</span>
<span class="sd">    correlate perfectly, but in opposite directions:</span>

<span class="sd">    &gt;&gt;&gt; x = np.array([[0, 2], [1, 1], [2, 0]]).T</span>
<span class="sd">    &gt;&gt;&gt; x</span>
<span class="sd">    array([[0, 1, 2],</span>
<span class="sd">           [2, 1, 0]])</span>

<span class="sd">    Note how :math:`x_0` increases while :math:`x_1` decreases. The covariance</span>
<span class="sd">    matrix shows this clearly:</span>

<span class="sd">    &gt;&gt;&gt; np.cov(x)</span>
<span class="sd">    array([[ 1., -1.],</span>
<span class="sd">           [-1.,  1.]])</span>

<span class="sd">    Note that element :math:`C_{0,1}`, which shows the correlation between</span>
<span class="sd">    :math:`x_0` and :math:`x_1`, is negative.</span>

<span class="sd">    Further, note how `x` and `y` are combined:</span>

<span class="sd">    &gt;&gt;&gt; x = [-2.1, -1,  4.3]</span>
<span class="sd">    &gt;&gt;&gt; y = [3,  1.1,  0.12]</span>
<span class="sd">    &gt;&gt;&gt; X = np.vstack((x,y))</span>
<span class="sd">    &gt;&gt;&gt; print np.cov(X)</span>
<span class="sd">    [[ 11.71        -4.286     ]</span>
<span class="sd">     [ -4.286        2.14413333]]</span>
<span class="sd">    &gt;&gt;&gt; print np.cov(x, y)</span>
<span class="sd">    [[ 11.71        -4.286     ]</span>
<span class="sd">     [ -4.286        2.14413333]]</span>
<span class="sd">    &gt;&gt;&gt; print np.cov(x)</span>
<span class="sd">    11.71</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check inputs</span>
    <span class="k">if</span> <span class="n">ddof</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">ddof</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ddof</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;ddof must be integer&quot;</span><span class="p">)</span>

    <span class="c1"># Handles complex arrays too</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rowvar</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rowvar</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">T</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">ddof</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bias</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ddof</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ddof</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Get the product of frequencies and weights</span>
    <span class="n">w</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">fweights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fweights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fweights</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fweights</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">fweights</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;fweights must be integer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fweights</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;cannot handle multidimensional fweights&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fweights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;incompatible numbers of samples and fweights&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">fweights</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;fweights cannot be negative&quot;</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">fweights</span>
    <span class="k">if</span> <span class="n">aweights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">aweights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">aweights</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">aweights</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;cannot handle multidimensional aweights&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">aweights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;incompatible numbers of samples and aweights&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">aweights</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;aweights cannot be negative&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">aweights</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">*=</span> <span class="n">aweights</span>

    <span class="n">avg</span><span class="p">,</span> <span class="n">w_sum</span> <span class="o">=</span> <span class="n">average</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">w_sum</span> <span class="o">=</span> <span class="n">w_sum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Determine the normalization</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ddof</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ddof</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="n">w_sum</span>
    <span class="k">elif</span> <span class="n">aweights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="n">w_sum</span> <span class="o">-</span> <span class="n">ddof</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="n">w_sum</span> <span class="o">-</span> <span class="n">ddof</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">aweights</span><span class="p">)</span><span class="o">/</span><span class="n">w_sum</span>

    <span class="k">if</span> <span class="n">fact</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Degrees of freedom &lt;= 0 for slice&quot;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">X</span> <span class="o">-=</span> <span class="n">avg</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">X_T</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_T</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X_T</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span><span class="o">/</span><span class="n">fact</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">_NoValue</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">_NoValue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return Pearson product-moment correlation coefficients.</span>

<span class="sd">    Please refer to the documentation for `cov` for more detail.  The</span>
<span class="sd">    relationship between the correlation coefficient matrix, `R`, and the</span>
<span class="sd">    covariance matrix, `C`, is</span>

<span class="sd">    .. math:: R_{ij} = \\frac{ C_{ij} } { \\sqrt{ C_{ii} * C_{jj} } }</span>

<span class="sd">    The values of `R` are between -1 and 1, inclusive.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        A 1-D or 2-D array containing multiple variables and observations.</span>
<span class="sd">        Each row of `x` represents a variable, and each column a single</span>
<span class="sd">        observation of all those variables. Also see `rowvar` below.</span>
<span class="sd">    y : array_like, optional</span>
<span class="sd">        An additional set of variables and observations. `y` has the same</span>
<span class="sd">        shape as `x`.</span>
<span class="sd">    rowvar : int, optional</span>
<span class="sd">        If `rowvar` is non-zero (default), then each row represents a</span>
<span class="sd">        variable, with observations in the columns. Otherwise, the relationship</span>
<span class="sd">        is transposed: each column represents a variable, while the rows</span>
<span class="sd">        contain observations.</span>
<span class="sd">    bias : _NoValue, optional</span>
<span class="sd">        Has no affect, do not use.</span>

<span class="sd">        .. deprecated:: 1.10.0</span>
<span class="sd">    ddof : _NoValue, optional</span>
<span class="sd">        Has no affect, do not use.</span>

<span class="sd">        .. deprecated:: 1.10.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    R : ndarray</span>
<span class="sd">        The correlation coefficient matrix of the variables.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    cov : Covariance matrix</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function accepts but discards arguments `bias` and `ddof`.  This is</span>
<span class="sd">    for backwards compatibility with previous versions of this function.  These</span>
<span class="sd">    arguments had no effect on the return values of the function and can be</span>
<span class="sd">    safely ignored in this and previous versions of numpy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">_NoValue</span> <span class="ow">or</span> <span class="n">ddof</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">_NoValue</span><span class="p">:</span>
        <span class="c1"># 2015-03-15, 1.10</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;bias and ddof have no affect and are deprecated&#39;</span><span class="p">,</span>
                      <span class="ne">DeprecationWarning</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rowvar</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">diag</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># scalar covariance</span>
        <span class="c1"># nan if incorrect value (nan, inf, 0), 1 otherwise</span>
        <span class="k">return</span> <span class="n">c</span> <span class="o">/</span> <span class="n">c</span>
    <span class="k">return</span> <span class="n">c</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">multiply</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">blackman</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the Blackman window.</span>

<span class="sd">    The Blackman window is a taper formed by using the first three</span>
<span class="sd">    terms of a summation of cosines. It was designed to have close to the</span>
<span class="sd">    minimal leakage possible.  It is close to optimal, only slightly worse</span>
<span class="sd">    than a Kaiser window.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : int</span>
<span class="sd">        Number of points in the output window. If zero or less, an empty</span>
<span class="sd">        array is returned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        The window, with the maximum value normalized to one (the value one</span>
<span class="sd">        appears only if the number of samples is odd).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    bartlett, hamming, hanning, kaiser</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Blackman window is defined as</span>

<span class="sd">    .. math::  w(n) = 0.42 - 0.5 \\cos(2\\pi n/M) + 0.08 \\cos(4\\pi n/M)</span>

<span class="sd">    Most references to the Blackman window come from the signal processing</span>
<span class="sd">    literature, where it is used as one of many windowing functions for</span>
<span class="sd">    smoothing values.  It is also known as an apodization (which means</span>
<span class="sd">    &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span>
<span class="sd">    and end of the sampled signal) or tapering function. It is known as a</span>
<span class="sd">    &quot;near optimal&quot; tapering function, almost as good (by some measures)</span>
<span class="sd">    as the kaiser window.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Blackman, R.B. and Tukey, J.W., (1958) The measurement of power spectra,</span>
<span class="sd">    Dover Publications, New York.</span>

<span class="sd">    Oppenheim, A.V., and R.W. Schafer. Discrete-Time Signal Processing.</span>
<span class="sd">    Upper Saddle River, NJ: Prentice-Hall, 1999, pp. 468-471.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.blackman(12)</span>
<span class="sd">    array([ -1.38777878e-17,   3.26064346e-02,   1.59903635e-01,</span>
<span class="sd">             4.14397981e-01,   7.36045180e-01,   9.67046769e-01,</span>
<span class="sd">             9.67046769e-01,   7.36045180e-01,   4.14397981e-01,</span>
<span class="sd">             1.59903635e-01,   3.26064346e-02,  -1.38777878e-17])</span>


<span class="sd">    Plot the window and the frequency response:</span>

<span class="sd">    &gt;&gt;&gt; from numpy.fft import fft, fftshift</span>
<span class="sd">    &gt;&gt;&gt; window = np.blackman(51)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(window)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Blackman window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &gt;&gt;&gt; plt.figure()</span>
<span class="sd">    &lt;matplotlib.figure.Figure object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span>
<span class="sd">    &gt;&gt;&gt; mag = np.abs(fftshift(A))</span>
<span class="sd">    &gt;&gt;&gt; freq = np.linspace(-0.5, 0.5, len(A))</span>
<span class="sd">    &gt;&gt;&gt; response = 20 * np.log10(mag)</span>
<span class="sd">    &gt;&gt;&gt; response = np.clip(response, -100, 100)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(freq, response)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Frequency response of Blackman window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.axis(&#39;tight&#39;)</span>
<span class="sd">    (-0.5, 0.5, -100.0, ...)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.42</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">bartlett</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the Bartlett window.</span>

<span class="sd">    The Bartlett window is very similar to a triangular window, except</span>
<span class="sd">    that the end points are at zero.  It is often used in signal</span>
<span class="sd">    processing for tapering a signal, without generating too much</span>
<span class="sd">    ripple in the frequency domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : int</span>
<span class="sd">        Number of points in the output window. If zero or less, an</span>
<span class="sd">        empty array is returned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : array</span>
<span class="sd">        The triangular window, with the maximum value normalized to one</span>
<span class="sd">        (the value one appears only if the number of samples is odd), with</span>
<span class="sd">        the first and last samples equal to zero.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    blackman, hamming, hanning, kaiser</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Bartlett window is defined as</span>

<span class="sd">    .. math:: w(n) = \\frac{2}{M-1} \\left(</span>
<span class="sd">              \\frac{M-1}{2} - \\left|n - \\frac{M-1}{2}\\right|</span>
<span class="sd">              \\right)</span>

<span class="sd">    Most references to the Bartlett window come from the signal</span>
<span class="sd">    processing literature, where it is used as one of many windowing</span>
<span class="sd">    functions for smoothing values.  Note that convolution with this</span>
<span class="sd">    window produces linear interpolation.  It is also known as an</span>
<span class="sd">    apodization (which means&quot;removing the foot&quot;, i.e. smoothing</span>
<span class="sd">    discontinuities at the beginning and end of the sampled signal) or</span>
<span class="sd">    tapering function. The fourier transform of the Bartlett is the product</span>
<span class="sd">    of two sinc functions.</span>
<span class="sd">    Note the excellent discussion in Kanasewich.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] M.S. Bartlett, &quot;Periodogram Analysis and Continuous Spectra&quot;,</span>
<span class="sd">           Biometrika 37, 1-16, 1950.</span>
<span class="sd">    .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;,</span>
<span class="sd">           The University of Alberta Press, 1975, pp. 109-110.</span>
<span class="sd">    .. [3] A.V. Oppenheim and R.W. Schafer, &quot;Discrete-Time Signal</span>
<span class="sd">           Processing&quot;, Prentice-Hall, 1999, pp. 468-471.</span>
<span class="sd">    .. [4] Wikipedia, &quot;Window function&quot;,</span>
<span class="sd">           http://en.wikipedia.org/wiki/Window_function</span>
<span class="sd">    .. [5] W.H. Press,  B.P. Flannery, S.A. Teukolsky, and W.T. Vetterling,</span>
<span class="sd">           &quot;Numerical Recipes&quot;, Cambridge University Press, 1986, page 429.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.bartlett(12)</span>
<span class="sd">    array([ 0.        ,  0.18181818,  0.36363636,  0.54545455,  0.72727273,</span>
<span class="sd">            0.90909091,  0.90909091,  0.72727273,  0.54545455,  0.36363636,</span>
<span class="sd">            0.18181818,  0.        ])</span>

<span class="sd">    Plot the window and its frequency response (requires SciPy and matplotlib):</span>

<span class="sd">    &gt;&gt;&gt; from numpy.fft import fft, fftshift</span>
<span class="sd">    &gt;&gt;&gt; window = np.bartlett(51)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(window)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Bartlett window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &gt;&gt;&gt; plt.figure()</span>
<span class="sd">    &lt;matplotlib.figure.Figure object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span>
<span class="sd">    &gt;&gt;&gt; mag = np.abs(fftshift(A))</span>
<span class="sd">    &gt;&gt;&gt; freq = np.linspace(-0.5, 0.5, len(A))</span>
<span class="sd">    &gt;&gt;&gt; response = 20 * np.log10(mag)</span>
<span class="sd">    &gt;&gt;&gt; response = np.clip(response, -100, 100)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(freq, response)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Frequency response of Bartlett window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.axis(&#39;tight&#39;)</span>
<span class="sd">    (-0.5, 0.5, -100.0, ...)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">less_equal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">),</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">hanning</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the Hanning window.</span>

<span class="sd">    The Hanning window is a taper formed by using a weighted cosine.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : int</span>
<span class="sd">        Number of points in the output window. If zero or less, an</span>
<span class="sd">        empty array is returned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray, shape(M,)</span>
<span class="sd">        The window, with the maximum value normalized to one (the value</span>
<span class="sd">        one appears only if `M` is odd).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    bartlett, blackman, hamming, kaiser</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Hanning window is defined as</span>

<span class="sd">    .. math::  w(n) = 0.5 - 0.5cos\\left(\\frac{2\\pi{n}}{M-1}\\right)</span>
<span class="sd">               \\qquad 0 \\leq n \\leq M-1</span>

<span class="sd">    The Hanning was named for Julius von Hann, an Austrian meteorologist.</span>
<span class="sd">    It is also known as the Cosine Bell. Some authors prefer that it be</span>
<span class="sd">    called a Hann window, to help avoid confusion with the very similar</span>
<span class="sd">    Hamming window.</span>

<span class="sd">    Most references to the Hanning window come from the signal processing</span>
<span class="sd">    literature, where it is used as one of many windowing functions for</span>
<span class="sd">    smoothing values.  It is also known as an apodization (which means</span>
<span class="sd">    &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span>
<span class="sd">    and end of the sampled signal) or tapering function.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Blackman, R.B. and Tukey, J.W., (1958) The measurement of power</span>
<span class="sd">           spectra, Dover Publications, New York.</span>
<span class="sd">    .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;,</span>
<span class="sd">           The University of Alberta Press, 1975, pp. 106-108.</span>
<span class="sd">    .. [3] Wikipedia, &quot;Window function&quot;,</span>
<span class="sd">           http://en.wikipedia.org/wiki/Window_function</span>
<span class="sd">    .. [4] W.H. Press,  B.P. Flannery, S.A. Teukolsky, and W.T. Vetterling,</span>
<span class="sd">           &quot;Numerical Recipes&quot;, Cambridge University Press, 1986, page 425.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.hanning(12)</span>
<span class="sd">    array([ 0.        ,  0.07937323,  0.29229249,  0.57115742,  0.82743037,</span>
<span class="sd">            0.97974649,  0.97974649,  0.82743037,  0.57115742,  0.29229249,</span>
<span class="sd">            0.07937323,  0.        ])</span>

<span class="sd">    Plot the window and its frequency response:</span>

<span class="sd">    &gt;&gt;&gt; from numpy.fft import fft, fftshift</span>
<span class="sd">    &gt;&gt;&gt; window = np.hanning(51)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(window)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Hann window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &gt;&gt;&gt; plt.figure()</span>
<span class="sd">    &lt;matplotlib.figure.Figure object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span>
<span class="sd">    &gt;&gt;&gt; mag = np.abs(fftshift(A))</span>
<span class="sd">    &gt;&gt;&gt; freq = np.linspace(-0.5, 0.5, len(A))</span>
<span class="sd">    &gt;&gt;&gt; response = 20 * np.log10(mag)</span>
<span class="sd">    &gt;&gt;&gt; response = np.clip(response, -100, 100)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(freq, response)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Frequency response of the Hann window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.axis(&#39;tight&#39;)</span>
<span class="sd">    (-0.5, 0.5, -100.0, ...)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">hamming</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the Hamming window.</span>

<span class="sd">    The Hamming window is a taper formed by using a weighted cosine.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : int</span>
<span class="sd">        Number of points in the output window. If zero or less, an</span>
<span class="sd">        empty array is returned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        The window, with the maximum value normalized to one (the value</span>
<span class="sd">        one appears only if the number of samples is odd).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    bartlett, blackman, hanning, kaiser</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Hamming window is defined as</span>

<span class="sd">    .. math::  w(n) = 0.54 - 0.46cos\\left(\\frac{2\\pi{n}}{M-1}\\right)</span>
<span class="sd">               \\qquad 0 \\leq n \\leq M-1</span>

<span class="sd">    The Hamming was named for R. W. Hamming, an associate of J. W. Tukey</span>
<span class="sd">    and is described in Blackman and Tukey. It was recommended for</span>
<span class="sd">    smoothing the truncated autocovariance function in the time domain.</span>
<span class="sd">    Most references to the Hamming window come from the signal processing</span>
<span class="sd">    literature, where it is used as one of many windowing functions for</span>
<span class="sd">    smoothing values.  It is also known as an apodization (which means</span>
<span class="sd">    &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span>
<span class="sd">    and end of the sampled signal) or tapering function.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Blackman, R.B. and Tukey, J.W., (1958) The measurement of power</span>
<span class="sd">           spectra, Dover Publications, New York.</span>
<span class="sd">    .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;, The</span>
<span class="sd">           University of Alberta Press, 1975, pp. 109-110.</span>
<span class="sd">    .. [3] Wikipedia, &quot;Window function&quot;,</span>
<span class="sd">           http://en.wikipedia.org/wiki/Window_function</span>
<span class="sd">    .. [4] W.H. Press,  B.P. Flannery, S.A. Teukolsky, and W.T. Vetterling,</span>
<span class="sd">           &quot;Numerical Recipes&quot;, Cambridge University Press, 1986, page 425.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.hamming(12)</span>
<span class="sd">    array([ 0.08      ,  0.15302337,  0.34890909,  0.60546483,  0.84123594,</span>
<span class="sd">            0.98136677,  0.98136677,  0.84123594,  0.60546483,  0.34890909,</span>
<span class="sd">            0.15302337,  0.08      ])</span>

<span class="sd">    Plot the window and the frequency response:</span>

<span class="sd">    &gt;&gt;&gt; from numpy.fft import fft, fftshift</span>
<span class="sd">    &gt;&gt;&gt; window = np.hamming(51)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(window)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Hamming window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &gt;&gt;&gt; plt.figure()</span>
<span class="sd">    &lt;matplotlib.figure.Figure object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span>
<span class="sd">    &gt;&gt;&gt; mag = np.abs(fftshift(A))</span>
<span class="sd">    &gt;&gt;&gt; freq = np.linspace(-0.5, 0.5, len(A))</span>
<span class="sd">    &gt;&gt;&gt; response = 20 * np.log10(mag)</span>
<span class="sd">    &gt;&gt;&gt; response = np.clip(response, -100, 100)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(freq, response)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Frequency response of Hamming window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.axis(&#39;tight&#39;)</span>
<span class="sd">    (-0.5, 0.5, -100.0, ...)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.54</span> <span class="o">-</span> <span class="mf">0.46</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1">## Code from cephes for i0</span>

<span class="n">_i0A</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">-</span><span class="mf">4.41534164647933937950E-18</span><span class="p">,</span>
    <span class="mf">3.33079451882223809783E-17</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">2.43127984654795469359E-16</span><span class="p">,</span>
    <span class="mf">1.71539128555513303061E-15</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.16853328779934516808E-14</span><span class="p">,</span>
    <span class="mf">7.67618549860493561688E-14</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">4.85644678311192946090E-13</span><span class="p">,</span>
    <span class="mf">2.95505266312963983461E-12</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.72682629144155570723E-11</span><span class="p">,</span>
    <span class="mf">9.67580903537323691224E-11</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">5.18979560163526290666E-10</span><span class="p">,</span>
    <span class="mf">2.65982372468238665035E-9</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.30002500998624804212E-8</span><span class="p">,</span>
    <span class="mf">6.04699502254191894932E-8</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">2.67079385394061173391E-7</span><span class="p">,</span>
    <span class="mf">1.11738753912010371815E-6</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">4.41673835845875056359E-6</span><span class="p">,</span>
    <span class="mf">1.64484480707288970893E-5</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">5.75419501008210370398E-5</span><span class="p">,</span>
    <span class="mf">1.88502885095841655729E-4</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">5.76375574538582365885E-4</span><span class="p">,</span>
    <span class="mf">1.63947561694133579842E-3</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">4.32430999505057594430E-3</span><span class="p">,</span>
    <span class="mf">1.05464603945949983183E-2</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">2.37374148058994688156E-2</span><span class="p">,</span>
    <span class="mf">4.93052842396707084878E-2</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">9.49010970480476444210E-2</span><span class="p">,</span>
    <span class="mf">1.71620901522208775349E-1</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">3.04682672343198398683E-1</span><span class="p">,</span>
    <span class="mf">6.76795274409476084995E-1</span>
    <span class="p">]</span>

<span class="n">_i0B</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">-</span><span class="mf">7.23318048787475395456E-18</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">4.83050448594418207126E-18</span><span class="p">,</span>
    <span class="mf">4.46562142029675999901E-17</span><span class="p">,</span>
    <span class="mf">3.46122286769746109310E-17</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">2.82762398051658348494E-16</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">3.42548561967721913462E-16</span><span class="p">,</span>
    <span class="mf">1.77256013305652638360E-15</span><span class="p">,</span>
    <span class="mf">3.81168066935262242075E-15</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">9.55484669882830764870E-15</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">4.15056934728722208663E-14</span><span class="p">,</span>
    <span class="mf">1.54008621752140982691E-14</span><span class="p">,</span>
    <span class="mf">3.85277838274214270114E-13</span><span class="p">,</span>
    <span class="mf">7.18012445138366623367E-13</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.79417853150680611778E-12</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.32158118404477131188E-11</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">3.14991652796324136454E-11</span><span class="p">,</span>
    <span class="mf">1.18891471078464383424E-11</span><span class="p">,</span>
    <span class="mf">4.94060238822496958910E-10</span><span class="p">,</span>
    <span class="mf">3.39623202570838634515E-9</span><span class="p">,</span>
    <span class="mf">2.26666899049817806459E-8</span><span class="p">,</span>
    <span class="mf">2.04891858946906374183E-7</span><span class="p">,</span>
    <span class="mf">2.89137052083475648297E-6</span><span class="p">,</span>
    <span class="mf">6.88975834691682398426E-5</span><span class="p">,</span>
    <span class="mf">3.36911647825569408990E-3</span><span class="p">,</span>
    <span class="mf">8.04490411014108831608E-1</span>
    <span class="p">]</span>


<span class="k">def</span> <span class="nf">_chbevl</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
    <span class="n">b0</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">b1</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">b0</span>
        <span class="n">b0</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">b1</span> <span class="o">-</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">b0</span> <span class="o">-</span> <span class="n">b2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_i0_1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">_chbevl</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">2.0</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">_i0A</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_i0_2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">_chbevl</span><span class="p">(</span><span class="mf">32.0</span><span class="o">/</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">_i0B</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">i0</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modified Bessel function of the first kind, order 0.</span>

<span class="sd">    Usually denoted :math:`I_0`.  This function does broadcast, but will *not*</span>
<span class="sd">    &quot;up-cast&quot; int dtype arguments unless accompanied by at least one float or</span>
<span class="sd">    complex dtype argument (see Raises below).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like, dtype float or complex</span>
<span class="sd">        Argument of the Bessel function.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray, shape = x.shape, dtype = x.dtype</span>
<span class="sd">        The modified Bessel function evaluated at each of the elements of `x`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    TypeError: array cannot be safely cast to required type</span>
<span class="sd">        If argument consists exclusively of int dtypes.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.special.iv, scipy.special.ive</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    We use the algorithm published by Clenshaw [1]_ and referenced by</span>
<span class="sd">    Abramowitz and Stegun [2]_, for which the function domain is</span>
<span class="sd">    partitioned into the two intervals [0,8] and (8,inf), and Chebyshev</span>
<span class="sd">    polynomial expansions are employed in each interval. Relative error on</span>
<span class="sd">    the domain [0,30] using IEEE arithmetic is documented [3]_ as having a</span>
<span class="sd">    peak of 5.8e-16 with an rms of 1.4e-16 (n = 30000).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] C. W. Clenshaw, &quot;Chebyshev series for mathematical functions&quot;, in</span>
<span class="sd">           *National Physical Laboratory Mathematical Tables*, vol. 5, London:</span>
<span class="sd">           Her Majesty&#39;s Stationery Office, 1962.</span>
<span class="sd">    .. [2] M. Abramowitz and I. A. Stegun, *Handbook of Mathematical</span>
<span class="sd">           Functions*, 10th printing, New York: Dover, 1964, pp. 379.</span>
<span class="sd">           http://www.math.sfu.ca/~cbm/aands/page_379.htm</span>
<span class="sd">    .. [3] http://kobesearch.cpan.org/htdocs/Math-Cephes/Math/Cephes.html</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.i0([0.])</span>
<span class="sd">    array(1.0)</span>
<span class="sd">    &gt;&gt;&gt; np.i0([0., 1. + 2j])</span>
<span class="sd">    array([ 1.00000000+0.j        ,  0.18785373+0.64616944j])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">empty_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mf">8.0</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">_i0_1</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="n">ind2</span> <span class="o">=</span> <span class="o">~</span><span class="n">ind</span>
    <span class="n">y</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span> <span class="o">=</span> <span class="n">_i0_2</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ind2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="c1">## End of cephes code for i0</span>


<span class="k">def</span> <span class="nf">kaiser</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the Kaiser window.</span>

<span class="sd">    The Kaiser window is a taper formed by using a Bessel function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : int</span>
<span class="sd">        Number of points in the output window. If zero or less, an</span>
<span class="sd">        empty array is returned.</span>
<span class="sd">    beta : float</span>
<span class="sd">        Shape parameter for window.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : array</span>
<span class="sd">        The window, with the maximum value normalized to one (the value</span>
<span class="sd">        one appears only if the number of samples is odd).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    bartlett, blackman, hamming, hanning</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Kaiser window is defined as</span>

<span class="sd">    .. math::  w(n) = I_0\\left( \\beta \\sqrt{1-\\frac{4n^2}{(M-1)^2}}</span>
<span class="sd">               \\right)/I_0(\\beta)</span>

<span class="sd">    with</span>

<span class="sd">    .. math:: \\quad -\\frac{M-1}{2} \\leq n \\leq \\frac{M-1}{2},</span>

<span class="sd">    where :math:`I_0` is the modified zeroth-order Bessel function.</span>

<span class="sd">    The Kaiser was named for Jim Kaiser, who discovered a simple</span>
<span class="sd">    approximation to the DPSS window based on Bessel functions.  The Kaiser</span>
<span class="sd">    window is a very good approximation to the Digital Prolate Spheroidal</span>
<span class="sd">    Sequence, or Slepian window, which is the transform which maximizes the</span>
<span class="sd">    energy in the main lobe of the window relative to total energy.</span>

<span class="sd">    The Kaiser can approximate many other windows by varying the beta</span>
<span class="sd">    parameter.</span>

<span class="sd">    ====  =======================</span>
<span class="sd">    beta  Window shape</span>
<span class="sd">    ====  =======================</span>
<span class="sd">    0     Rectangular</span>
<span class="sd">    5     Similar to a Hamming</span>
<span class="sd">    6     Similar to a Hanning</span>
<span class="sd">    8.6   Similar to a Blackman</span>
<span class="sd">    ====  =======================</span>

<span class="sd">    A beta value of 14 is probably a good starting point. Note that as beta</span>
<span class="sd">    gets large, the window narrows, and so the number of samples needs to be</span>
<span class="sd">    large enough to sample the increasingly narrow spike, otherwise NaNs will</span>
<span class="sd">    get returned.</span>

<span class="sd">    Most references to the Kaiser window come from the signal processing</span>
<span class="sd">    literature, where it is used as one of many windowing functions for</span>
<span class="sd">    smoothing values.  It is also known as an apodization (which means</span>
<span class="sd">    &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span>
<span class="sd">    and end of the sampled signal) or tapering function.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] J. F. Kaiser, &quot;Digital Filters&quot; - Ch 7 in &quot;Systems analysis by</span>
<span class="sd">           digital computer&quot;, Editors: F.F. Kuo and J.F. Kaiser, p 218-285.</span>
<span class="sd">           John Wiley and Sons, New York, (1966).</span>
<span class="sd">    .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;, The</span>
<span class="sd">           University of Alberta Press, 1975, pp. 177-178.</span>
<span class="sd">    .. [3] Wikipedia, &quot;Window function&quot;,</span>
<span class="sd">           http://en.wikipedia.org/wiki/Window_function</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.kaiser(12, 14)</span>
<span class="sd">    array([  7.72686684e-06,   3.46009194e-03,   4.65200189e-02,</span>
<span class="sd">             2.29737120e-01,   5.99885316e-01,   9.45674898e-01,</span>
<span class="sd">             9.45674898e-01,   5.99885316e-01,   2.29737120e-01,</span>
<span class="sd">             4.65200189e-02,   3.46009194e-03,   7.72686684e-06])</span>


<span class="sd">    Plot the window and the frequency response:</span>

<span class="sd">    &gt;&gt;&gt; from numpy.fft import fft, fftshift</span>
<span class="sd">    &gt;&gt;&gt; window = np.kaiser(51, 14)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(window)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Kaiser window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &gt;&gt;&gt; plt.figure()</span>
<span class="sd">    &lt;matplotlib.figure.Figure object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span>
<span class="sd">    &gt;&gt;&gt; mag = np.abs(fftshift(A))</span>
<span class="sd">    &gt;&gt;&gt; freq = np.linspace(-0.5, 0.5, len(A))</span>
<span class="sd">    &gt;&gt;&gt; response = 20 * np.log10(mag)</span>
<span class="sd">    &gt;&gt;&gt; response = np.clip(response, -100, 100)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(freq, response)</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Frequency response of Kaiser window&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.axis(&#39;tight&#39;)</span>
<span class="sd">    (-0.5, 0.5, -100.0, ...)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">numpy.dual</span> <span class="kn">import</span> <span class="n">i0</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">])</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">return</span> <span class="n">i0</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span><span class="o">/</span><span class="n">i0</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>


<div class="viewcode-block" id="sinc"><a class="viewcode-back" href="../../../generated/scipy.special.sinc.html#scipy.integrate.sinc">[docs]</a><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the sinc function.</span>

<span class="sd">    The sinc function is :math:`\\sin(\\pi x)/(\\pi x)`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        Array (possibly multi-dimensional) of values for which to to</span>
<span class="sd">        calculate ``sinc(x)``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        ``sinc(x)``, which has the same shape as the input.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    ``sinc(0)`` is the limit value 1.</span>

<span class="sd">    The name sinc is short for &quot;sine cardinal&quot; or &quot;sinus cardinalis&quot;.</span>

<span class="sd">    The sinc function is used in various signal processing applications,</span>
<span class="sd">    including in anti-aliasing, in the construction of a Lanczos resampling</span>
<span class="sd">    filter, and in interpolation.</span>

<span class="sd">    For bandlimited interpolation of discrete-time signals, the ideal</span>
<span class="sd">    interpolation kernel is proportional to the sinc function.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Weisstein, Eric W. &quot;Sinc Function.&quot; From MathWorld--A Wolfram Web</span>
<span class="sd">           Resource. http://mathworld.wolfram.com/SincFunction.html</span>
<span class="sd">    .. [2] Wikipedia, &quot;Sinc function&quot;,</span>
<span class="sd">           http://en.wikipedia.org/wiki/Sinc_function</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.linspace(-4, 4, 41)</span>
<span class="sd">    &gt;&gt;&gt; np.sinc(x)</span>
<span class="sd">    array([ -3.89804309e-17,  -4.92362781e-02,  -8.40918587e-02,</span>
<span class="sd">            -8.90384387e-02,  -5.84680802e-02,   3.89804309e-17,</span>
<span class="sd">             6.68206631e-02,   1.16434881e-01,   1.26137788e-01,</span>
<span class="sd">             8.50444803e-02,  -3.89804309e-17,  -1.03943254e-01,</span>
<span class="sd">            -1.89206682e-01,  -2.16236208e-01,  -1.55914881e-01,</span>
<span class="sd">             3.89804309e-17,   2.33872321e-01,   5.04551152e-01,</span>
<span class="sd">             7.56826729e-01,   9.35489284e-01,   1.00000000e+00,</span>
<span class="sd">             9.35489284e-01,   7.56826729e-01,   5.04551152e-01,</span>
<span class="sd">             2.33872321e-01,   3.89804309e-17,  -1.55914881e-01,</span>
<span class="sd">            -2.16236208e-01,  -1.89206682e-01,  -1.03943254e-01,</span>
<span class="sd">            -3.89804309e-17,   8.50444803e-02,   1.26137788e-01,</span>
<span class="sd">             1.16434881e-01,   6.68206631e-02,   3.89804309e-17,</span>
<span class="sd">            -5.84680802e-02,  -8.90384387e-02,  -8.40918587e-02,</span>
<span class="sd">            -4.92362781e-02,  -3.89804309e-17])</span>

<span class="sd">    &gt;&gt;&gt; plt.plot(x, np.sinc(x))</span>
<span class="sd">    [&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<span class="sd">    &gt;&gt;&gt; plt.title(&quot;Sinc Function&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.xlabel(&quot;X&quot;)</span>
<span class="sd">    &lt;matplotlib.text.Text object at 0x...&gt;</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    It works in 2-D as well:</span>

<span class="sd">    &gt;&gt;&gt; x = np.linspace(-4, 4, 401)</span>
<span class="sd">    &gt;&gt;&gt; xx = np.outer(x, x)</span>
<span class="sd">    &gt;&gt;&gt; plt.imshow(np.sinc(xx))</span>
<span class="sd">    &lt;matplotlib.image.AxesImage object at 0x...&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0e-20</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">y</span></div>


<span class="k">def</span> <span class="nf">msort</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a copy of an array sorted along the first axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Array to be sorted.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sorted_array : ndarray</span>
<span class="sd">        Array of the same type and shape as `a`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    sort</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    ``np.msort(a)`` is equivalent to  ``np.sort(a, axis=0)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span>


<span class="k">def</span> <span class="nf">_ureduce</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internal Function.</span>
<span class="sd">    Call `func` with `a` as first argument swapping the axes to use extended</span>
<span class="sd">    axis on functions that don&#39;t support it natively.</span>

<span class="sd">    Returns result and a.shape with axis dims set to 1.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array or object that can be converted to an array.</span>
<span class="sd">    func : callable</span>
<span class="sd">        Reduction function Kapable of receiving an axis argument.</span>
<span class="sd">        It is is called with `a` as first argument followed by `kwargs`.</span>
<span class="sd">     kwargs : keyword arguments</span>
<span class="sd">        additional keyword arguments to pass to `func`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result : tuple</span>
<span class="sd">        Result of func(a, **kwargs) and a.shape with axis dims set to 1</span>
<span class="sd">        which can be used to reshape the result to the same shape a ufunc with</span>
<span class="sd">        keepdims=True would produce.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">axis</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">keepdim</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">&gt;=</span> <span class="n">nd</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">nd</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;axis </span><span class="si">%d</span><span class="s2"> out of bounds (</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
            <span class="n">keepdim</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">sax</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">nd</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">nd</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;axis </span><span class="si">%d</span><span class="s2"> out of bounds (</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nd</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sax</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;duplicate value in axis&quot;</span><span class="p">)</span>
                <span class="n">sax</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span>
                <span class="n">keepdim</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nd</span><span class="p">)))</span>
            <span class="n">nkeep</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keep</span><span class="p">)</span>
            <span class="c1"># swap axis that should not be reduced to front</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">keep</span><span class="p">)):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="c1"># merge reduced axis</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="n">nkeep</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,))</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">keepdim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">keepdim</span>


<span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">overwrite_input</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the median along the specified axis.</span>

<span class="sd">    Returns the median of the array elements.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array or object that can be converted to an array.</span>
<span class="sd">    axis : int or sequence of int, optional</span>
<span class="sd">        Axis along which the medians are computed. The default (axis=None)</span>
<span class="sd">        is to compute the median along a flattened version of the array.</span>
<span class="sd">        A sequence of axes is supported since version 1.9.0.</span>
<span class="sd">    out : ndarray, optional</span>
<span class="sd">        Alternative output array in which to place the result. It must have</span>
<span class="sd">        the same shape and buffer length as the expected output, but the</span>
<span class="sd">        type (of the output) will be cast if necessary.</span>
<span class="sd">    overwrite_input : bool, optional</span>
<span class="sd">       If True, then allow use of memory of input array (a) for</span>
<span class="sd">       calculations. The input array will be modified by the call to</span>
<span class="sd">       median. This will save memory when you do not need to preserve the</span>
<span class="sd">       contents of the input array. Treat the input as undefined, but it</span>
<span class="sd">       will probably be fully or partially sorted. Default is False. Note</span>
<span class="sd">       that, if `overwrite_input` is True and the input is not already an</span>
<span class="sd">       ndarray, an error will be raised.</span>
<span class="sd">    keepdims : bool, optional</span>
<span class="sd">        If this is set to True, the axes which are reduced are left</span>
<span class="sd">        in the result as dimensions with size one. With this option,</span>
<span class="sd">        the result will broadcast correctly against the original `arr`.</span>

<span class="sd">        .. versionadded:: 1.9.0</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    median : ndarray</span>
<span class="sd">        A new array holding the result (unless `out` is specified, in which</span>
<span class="sd">        case that array is returned instead).  If the input contains</span>
<span class="sd">        integers, or floats of smaller precision than 64, then the output</span>
<span class="sd">        data-type is float64.  Otherwise, the output data-type is the same</span>
<span class="sd">        as that of the input.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    mean, percentile</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Given a vector V of length N, the median of V is the middle value of</span>
<span class="sd">    a sorted copy of V, ``V_sorted`` - i.e., ``V_sorted[(N-1)/2]``, when N is</span>
<span class="sd">    odd.  When N is even, it is the average of the two middle values of</span>
<span class="sd">    ``V_sorted``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([[10, 7, 4], [3, 2, 1]])</span>
<span class="sd">    &gt;&gt;&gt; a</span>
<span class="sd">    array([[10,  7,  4],</span>
<span class="sd">           [ 3,  2,  1]])</span>
<span class="sd">    &gt;&gt;&gt; np.median(a)</span>
<span class="sd">    3.5</span>
<span class="sd">    &gt;&gt;&gt; np.median(a, axis=0)</span>
<span class="sd">    array([ 6.5,  4.5,  2.5])</span>
<span class="sd">    &gt;&gt;&gt; np.median(a, axis=1)</span>
<span class="sd">    array([ 7.,  2.])</span>
<span class="sd">    &gt;&gt;&gt; m = np.median(a, axis=0)</span>
<span class="sd">    &gt;&gt;&gt; out = np.zeros_like(m)</span>
<span class="sd">    &gt;&gt;&gt; np.median(a, axis=0, out=m)</span>
<span class="sd">    array([ 6.5,  4.5,  2.5])</span>
<span class="sd">    &gt;&gt;&gt; m</span>
<span class="sd">    array([ 6.5,  4.5,  2.5])</span>
<span class="sd">    &gt;&gt;&gt; b = a.copy()</span>
<span class="sd">    &gt;&gt;&gt; np.median(b, axis=1, overwrite_input=True)</span>
<span class="sd">    array([ 7.,  2.])</span>
<span class="sd">    &gt;&gt;&gt; assert not np.all(a==b)</span>
<span class="sd">    &gt;&gt;&gt; b = a.copy()</span>
<span class="sd">    &gt;&gt;&gt; np.median(b, axis=None, overwrite_input=True)</span>
<span class="sd">    3.5</span>
<span class="sd">    &gt;&gt;&gt; assert not np.all(a==b)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">_ureduce</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">_median</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
                    <span class="n">overwrite_input</span><span class="o">=</span><span class="n">overwrite_input</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keepdims</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span>

<span class="k">def</span> <span class="nf">_median</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">overwrite_input</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="c1"># can&#39;t be reasonably be implemented in terms of percentile as we have to</span>
    <span class="c1"># call mean to not break astropy</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c1"># Set the partition indexes</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sz</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">szh</span> <span class="o">=</span> <span class="n">sz</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">kth</span> <span class="o">=</span> <span class="p">[</span><span class="n">szh</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">szh</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kth</span> <span class="o">=</span> <span class="p">[(</span><span class="n">sz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
    <span class="c1"># Check if the array contains any nan&#39;s</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>
        <span class="n">kth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">overwrite_input</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">part</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">part</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">kth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">kth</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">part</span> <span class="o">=</span> <span class="n">a</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">part</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">kth</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
        <span class="c1"># make 0-D arrays work</span>
        <span class="k">return</span> <span class="n">part</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">part</span><span class="o">.</span><span class="n">ndim</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># index with slice to allow mean (below) to work</span>
        <span class="n">indexer</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indexer</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Check if the array contains any nan&#39;s</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># warn and return nans like mean would</span>
        <span class="n">rout</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="n">indexer</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>
        <span class="n">part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">rout</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Invalid value encountered in median&quot;</span><span class="p">,</span>
                              <span class="ne">RuntimeWarning</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">out</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                    <span class="n">rout</span> <span class="o">=</span> <span class="n">out</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rout</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Invalid value encountered in median for&quot;</span> <span class="o">+</span>
                          <span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> results&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span>
                          <span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="n">rout</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">rout</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if there are no nans</span>
        <span class="c1"># Use mean in odd and even case to coerce data type</span>
        <span class="c1"># and check, use out array.</span>
        <span class="k">return</span> <span class="n">mean</span><span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="n">indexer</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">percentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">overwrite_input</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the qth percentile of the data along the specified axis.</span>

<span class="sd">    Returns the qth percentile of the array elements.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array or object that can be converted to an array.</span>
<span class="sd">    q : float in range of [0,100] (or sequence of floats)</span>
<span class="sd">        Percentile to compute which must be between 0 and 100 inclusive.</span>
<span class="sd">    axis : int or sequence of int, optional</span>
<span class="sd">        Axis along which the percentiles are computed. The default (None)</span>
<span class="sd">        is to compute the percentiles along a flattened version of the array.</span>
<span class="sd">        A sequence of axes is supported since version 1.9.0.</span>
<span class="sd">    out : ndarray, optional</span>
<span class="sd">        Alternative output array in which to place the result. It must</span>
<span class="sd">        have the same shape and buffer length as the expected output,</span>
<span class="sd">        but the type (of the output) will be cast if necessary.</span>
<span class="sd">    overwrite_input : bool, optional</span>
<span class="sd">        If True, then allow use of memory of input array `a` for</span>
<span class="sd">        calculations. The input array will be modified by the call to</span>
<span class="sd">        percentile. This will save memory when you do not need to preserve</span>
<span class="sd">        the contents of the input array. In this case you should not make</span>
<span class="sd">        any assumptions about the content of the passed in array `a` after</span>
<span class="sd">        this function completes -- treat it as undefined. Default is False.</span>
<span class="sd">        Note that, if the `a` input is not already an array this parameter</span>
<span class="sd">        will have no effect, `a` will be converted to an array internally</span>
<span class="sd">        regardless of the value of this parameter.</span>
<span class="sd">    interpolation : {&#39;linear&#39;, &#39;lower&#39;, &#39;higher&#39;, &#39;midpoint&#39;, &#39;nearest&#39;}</span>
<span class="sd">        This optional parameter specifies the interpolation method to use,</span>
<span class="sd">        when the desired quantile lies between two data points `i` and `j`:</span>
<span class="sd">            * linear: `i + (j - i) * fraction`, where `fraction` is the</span>
<span class="sd">              fractional part of the index surrounded by `i` and `j`.</span>
<span class="sd">            * lower: `i`.</span>
<span class="sd">            * higher: `j`.</span>
<span class="sd">            * nearest: `i` or `j` whichever is nearest.</span>
<span class="sd">            * midpoint: (`i` + `j`) / 2.</span>

<span class="sd">        .. versionadded:: 1.9.0</span>
<span class="sd">    keepdims : bool, optional</span>
<span class="sd">        If this is set to True, the axes which are reduced are left</span>
<span class="sd">        in the result as dimensions with size one. With this option,</span>
<span class="sd">        the result will broadcast correctly against the original array `a`.</span>

<span class="sd">        .. versionadded:: 1.9.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    percentile : scalar or ndarray</span>
<span class="sd">        If a single percentile `q` is given and axis=None a scalar is</span>
<span class="sd">        returned.  If multiple percentiles `q` are given an array holding</span>
<span class="sd">        the result is returned. The results are listed in the first axis.</span>
<span class="sd">        (If `out` is specified, in which case that array is returned</span>
<span class="sd">        instead).  If the input contains integers, or floats of smaller</span>
<span class="sd">        precision than 64, then the output data-type is float64. Otherwise,</span>
<span class="sd">        the output data-type is the same as that of the input.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    mean, median</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Given a vector V of length N, the q-th percentile of V is the q-th ranked</span>
<span class="sd">    value in a sorted copy of V.  The values and distances of the two</span>
<span class="sd">    nearest neighbors as well as the `interpolation` parameter will</span>
<span class="sd">    determine the percentile if the normalized ranking does not match q</span>
<span class="sd">    exactly. This function is the same as the median if ``q=50``, the same</span>
<span class="sd">    as the minimum if ``q=0`` and the same as the maximum if ``q=100``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([[10, 7, 4], [3, 2, 1]])</span>
<span class="sd">    &gt;&gt;&gt; a</span>
<span class="sd">    array([[10,  7,  4],</span>
<span class="sd">           [ 3,  2,  1]])</span>
<span class="sd">    &gt;&gt;&gt; np.percentile(a, 50)</span>
<span class="sd">    array([ 3.5])</span>
<span class="sd">    &gt;&gt;&gt; np.percentile(a, 50, axis=0)</span>
<span class="sd">    array([[ 6.5,  4.5,  2.5]])</span>
<span class="sd">    &gt;&gt;&gt; np.percentile(a, 50, axis=1)</span>
<span class="sd">    array([[ 7.],</span>
<span class="sd">           [ 2.]])</span>

<span class="sd">    &gt;&gt;&gt; m = np.percentile(a, 50, axis=0)</span>
<span class="sd">    &gt;&gt;&gt; out = np.zeros_like(m)</span>
<span class="sd">    &gt;&gt;&gt; np.percentile(a, 50, axis=0, out=m)</span>
<span class="sd">    array([[ 6.5,  4.5,  2.5]])</span>
<span class="sd">    &gt;&gt;&gt; m</span>
<span class="sd">    array([[ 6.5,  4.5,  2.5]])</span>

<span class="sd">    &gt;&gt;&gt; b = a.copy()</span>
<span class="sd">    &gt;&gt;&gt; np.percentile(b, 50, axis=1, overwrite_input=True)</span>
<span class="sd">    array([[ 7.],</span>
<span class="sd">           [ 2.]])</span>
<span class="sd">    &gt;&gt;&gt; assert not np.all(a==b)</span>
<span class="sd">    &gt;&gt;&gt; b = a.copy()</span>
<span class="sd">    &gt;&gt;&gt; np.percentile(b, 50, axis=None, overwrite_input=True)</span>
<span class="sd">    array([ 3.5])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">_ureduce</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">_percentile</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
                    <span class="n">overwrite_input</span><span class="o">=</span><span class="n">overwrite_input</span><span class="p">,</span>
                    <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keepdims</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span>


<span class="k">def</span> <span class="nf">_percentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">overwrite_input</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Do not allow 0-d arrays because following code fails for scalar</span>
        <span class="n">zerod</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zerod</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1"># avoid expensive reductions, relevant for arrays with &lt; O(1000) elements</span>
    <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">or</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">100.</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Percentiles must be in the range [0,100]&quot;</span><span class="p">)</span>
            <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">100.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># faster than any()</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mf">100.</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Percentiles must be in the range [0,100]&quot;</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">/=</span> <span class="mf">100.</span>

    <span class="c1"># prepare a for partioning</span>
    <span class="k">if</span> <span class="n">overwrite_input</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ap</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ap</span> <span class="o">=</span> <span class="n">a</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ap</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ap</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">Nx</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">q</span> <span class="o">*</span> <span class="p">(</span><span class="n">Nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># round fractional indices according to interpolation method</span>
    <span class="k">if</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;lower&#39;</span><span class="p">:</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;higher&#39;</span><span class="p">:</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;midpoint&#39;</span><span class="p">:</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span>
    <span class="k">elif</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;nearest&#39;</span><span class="p">:</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">around</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># keep index as fraction and interpolate</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;interpolation can only be &#39;linear&#39;, &#39;lower&#39; &#39;higher&#39;, &quot;</span>
            <span class="s2">&quot;&#39;midpoint&#39;, or &#39;nearest&#39;&quot;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span> <span class="c1"># check for nan&#39;s flag</span>
    <span class="k">if</span> <span class="n">indices</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">intp</span><span class="p">:</span>  <span class="c1"># take the points along axis</span>
        <span class="c1"># Check if the array contains any nan&#39;s</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">((</span><span class="n">indices</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">ap</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="c1"># ensure axis with qth is first</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Check if the array contains any nan&#39;s</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="o">...</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">zerod</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">take</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>


    <span class="k">else</span><span class="p">:</span>  <span class="c1"># weight the points above and below the indices</span>
        <span class="n">indices_below</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
        <span class="n">indices_above</span> <span class="o">=</span> <span class="n">indices_below</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">indices_above</span><span class="p">[</span><span class="n">indices_above</span> <span class="o">&gt;</span> <span class="n">Nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nx</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># Check if the array contains any nan&#39;s</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>
            <span class="n">indices_above</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">((</span><span class="n">indices_above</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">weights_above</span> <span class="o">=</span> <span class="n">indices</span> <span class="o">-</span> <span class="n">indices_below</span>
        <span class="n">weights_below</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weights_above</span>

        <span class="n">weights_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">]</span> <span class="o">*</span> <span class="n">ap</span><span class="o">.</span><span class="n">ndim</span>
        <span class="n">weights_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">weights_below</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">weights_shape</span>
        <span class="n">weights_above</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">weights_shape</span>

        <span class="n">ap</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">concatenate</span><span class="p">((</span><span class="n">indices_below</span><span class="p">,</span> <span class="n">indices_above</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

        <span class="c1"># ensure axis with qth is first</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">weights_below</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">weights_below</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">weights_above</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">weights_above</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Check if the array contains any nan&#39;s</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>
            <span class="n">indices_above</span> <span class="o">=</span> <span class="n">indices_above</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="o">...</span><span class="p">])</span>

        <span class="n">x1</span> <span class="o">=</span> <span class="n">take</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">indices_below</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span> <span class="o">*</span> <span class="n">weights_below</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">take</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">indices_above</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span> <span class="o">*</span> <span class="n">weights_above</span>

        <span class="c1"># ensure axis with qth is first</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">zerod</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Invalid value encountered in median&quot;</span><span class="p">,</span>
                              <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zerod</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ap</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">out</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">out</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">r</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span>


<div class="viewcode-block" id="trapz"><a class="viewcode-back" href="../../../generated/scipy.integrate.trapz.html#scipy.integrate.trapz">[docs]</a><span class="k">def</span> <span class="nf">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrate along the given axis using the composite trapezoidal rule.</span>

<span class="sd">    Integrate `y` (`x`) along given axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : array_like</span>
<span class="sd">        Input array to integrate.</span>
<span class="sd">    x : array_like, optional</span>
<span class="sd">        If `x` is None, then spacing between all `y` elements is `dx`.</span>
<span class="sd">    dx : scalar, optional</span>
<span class="sd">        If `x` is None, spacing given by `dx` is assumed. Default is 1.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        Specify the axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    trapz : float</span>
<span class="sd">        Definite integral as approximated by trapezoidal rule.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    sum, cumsum</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Image [2]_ illustrates trapezoidal rule -- y-axis locations of points</span>
<span class="sd">    will be taken from `y` array, by default x-axis distances between</span>
<span class="sd">    points will be 1.0, alternatively they can be provided with `x` array</span>
<span class="sd">    or with `dx` scalar.  Return value will be equal to combined area under</span>
<span class="sd">    the red lines.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Wikipedia page: http://en.wikipedia.org/wiki/Trapezoidal_rule</span>

<span class="sd">    .. [2] Illustration image:</span>
<span class="sd">           http://en.wikipedia.org/wiki/File:Composite_trapezoidal_rule_illustration.png</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.trapz([1,2,3])</span>
<span class="sd">    4.0</span>
<span class="sd">    &gt;&gt;&gt; np.trapz([1,2,3], x=[4,6,8])</span>
<span class="sd">    8.0</span>
<span class="sd">    &gt;&gt;&gt; np.trapz([1,2,3], dx=2)</span>
<span class="sd">    8.0</span>
<span class="sd">    &gt;&gt;&gt; a = np.arange(6).reshape(2, 3)</span>
<span class="sd">    &gt;&gt;&gt; a</span>
<span class="sd">    array([[0, 1, 2],</span>
<span class="sd">           [3, 4, 5]])</span>
<span class="sd">    &gt;&gt;&gt; np.trapz(a, axis=0)</span>
<span class="sd">    array([ 1.5,  2.5,  3.5])</span>
<span class="sd">    &gt;&gt;&gt; np.trapz(a, axis=1)</span>
<span class="sd">    array([ 2.,  8.])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">asanyarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">dx</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="c1"># reshape to correct shape</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">ndim</span>
            <span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">slice1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">nd</span>
    <span class="n">slice2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">nd</span>
    <span class="n">slice1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">slice2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="c1"># Operations didn&#39;t work, cast to ndarray</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">slice1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="n">slice2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span></div>


<span class="c1">#always succeed</span>
<span class="k">def</span> <span class="nf">add_newdoc</span><span class="p">(</span><span class="n">place</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds documentation to obj which is in module place.</span>

<span class="sd">    If doc is a string add it to obj as a docstring</span>

<span class="sd">    If doc is a tuple, then the first element is interpreted as</span>
<span class="sd">       an attribute of obj and the second as the docstring</span>
<span class="sd">          (method, docstring)</span>

<span class="sd">    If doc is a list, then each element of the list should be a</span>
<span class="sd">       sequence of length two --&gt; [(method1, docstring1),</span>
<span class="sd">       (method2, docstring2), ...]</span>

<span class="sd">    This routine never raises an error.</span>

<span class="sd">    This routine cannot modify read-only docstrings, as appear</span>
<span class="sd">    in new-style classes or built-in functions. Because this</span>
<span class="sd">    routine never raises an error the caller must check manually</span>
<span class="sd">    that the docstrings were changed.</span>
<span class="sd">       &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="n">place</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">obj</span><span class="p">]),</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">add_docstring</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">add_docstring</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">doc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
                <span class="n">add_docstring</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>


<span class="c1"># Based on scitools meshgrid</span>
<span class="k">def</span> <span class="nf">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">xi</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return coordinate matrices from coordinate vectors.</span>

<span class="sd">    Make N-D coordinate arrays for vectorized evaluations of</span>
<span class="sd">    N-D scalar/vector fields over N-D grids, given</span>
<span class="sd">    one-dimensional coordinate arrays x1, x2,..., xn.</span>

<span class="sd">    .. versionchanged:: 1.9</span>
<span class="sd">       1-D and 0-D cases are allowed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x1, x2,..., xn : array_like</span>
<span class="sd">        1-D arrays representing the coordinates of a grid.</span>
<span class="sd">    indexing : {&#39;xy&#39;, &#39;ij&#39;}, optional</span>
<span class="sd">        Cartesian (&#39;xy&#39;, default) or matrix (&#39;ij&#39;) indexing of output.</span>
<span class="sd">        See Notes for more details.</span>

<span class="sd">        .. versionadded:: 1.7.0</span>
<span class="sd">    sparse : bool, optional</span>
<span class="sd">        If True a sparse grid is returned in order to conserve memory.</span>
<span class="sd">        Default is False.</span>

<span class="sd">        .. versionadded:: 1.7.0</span>
<span class="sd">    copy : bool, optional</span>
<span class="sd">        If False, a view into the original arrays are returned in order to</span>
<span class="sd">        conserve memory.  Default is True.  Please note that</span>
<span class="sd">        ``sparse=False, copy=False`` will likely return non-contiguous</span>
<span class="sd">        arrays.  Furthermore, more than one element of a broadcast array</span>
<span class="sd">        may refer to a single memory location.  If you need to write to the</span>
<span class="sd">        arrays, make copies first.</span>

<span class="sd">        .. versionadded:: 1.7.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X1, X2,..., XN : ndarray</span>
<span class="sd">        For vectors `x1`, `x2`,..., &#39;xn&#39; with lengths ``Ni=len(xi)`` ,</span>
<span class="sd">        return ``(N1, N2, N3,...Nn)`` shaped arrays if indexing=&#39;ij&#39;</span>
<span class="sd">        or ``(N2, N1, N3,...Nn)`` shaped arrays if indexing=&#39;xy&#39;</span>
<span class="sd">        with the elements of `xi` repeated to fill the matrix along</span>
<span class="sd">        the first dimension for `x1`, the second for `x2` and so on.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function supports both indexing conventions through the indexing</span>
<span class="sd">    keyword argument.  Giving the string &#39;ij&#39; returns a meshgrid with</span>
<span class="sd">    matrix indexing, while &#39;xy&#39; returns a meshgrid with Cartesian indexing.</span>
<span class="sd">    In the 2-D case with inputs of length M and N, the outputs are of shape</span>
<span class="sd">    (N, M) for &#39;xy&#39; indexing and (M, N) for &#39;ij&#39; indexing.  In the 3-D case</span>
<span class="sd">    with inputs of length M, N and P, outputs are of shape (N, M, P) for</span>
<span class="sd">    &#39;xy&#39; indexing and (M, N, P) for &#39;ij&#39; indexing.  The difference is</span>
<span class="sd">    illustrated by the following code snippet::</span>

<span class="sd">        xv, yv = meshgrid(x, y, sparse=False, indexing=&#39;ij&#39;)</span>
<span class="sd">        for i in range(nx):</span>
<span class="sd">            for j in range(ny):</span>
<span class="sd">                # treat xv[i,j], yv[i,j]</span>

<span class="sd">        xv, yv = meshgrid(x, y, sparse=False, indexing=&#39;xy&#39;)</span>
<span class="sd">        for i in range(nx):</span>
<span class="sd">            for j in range(ny):</span>
<span class="sd">                # treat xv[j,i], yv[j,i]</span>

<span class="sd">    In the 1-D and 0-D case, the indexing and sparse keywords have no effect.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    index_tricks.mgrid : Construct a multi-dimensional &quot;meshgrid&quot;</span>
<span class="sd">                     using indexing notation.</span>
<span class="sd">    index_tricks.ogrid : Construct an open multi-dimensional &quot;meshgrid&quot;</span>
<span class="sd">                     using indexing notation.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; nx, ny = (3, 2)</span>
<span class="sd">    &gt;&gt;&gt; x = np.linspace(0, 1, nx)</span>
<span class="sd">    &gt;&gt;&gt; y = np.linspace(0, 1, ny)</span>
<span class="sd">    &gt;&gt;&gt; xv, yv = meshgrid(x, y)</span>
<span class="sd">    &gt;&gt;&gt; xv</span>
<span class="sd">    array([[ 0. ,  0.5,  1. ],</span>
<span class="sd">           [ 0. ,  0.5,  1. ]])</span>
<span class="sd">    &gt;&gt;&gt; yv</span>
<span class="sd">    array([[ 0.,  0.,  0.],</span>
<span class="sd">           [ 1.,  1.,  1.]])</span>
<span class="sd">    &gt;&gt;&gt; xv, yv = meshgrid(x, y, sparse=True)  # make sparse output arrays</span>
<span class="sd">    &gt;&gt;&gt; xv</span>
<span class="sd">    array([[ 0. ,  0.5,  1. ]])</span>
<span class="sd">    &gt;&gt;&gt; yv</span>
<span class="sd">    array([[ 0.],</span>
<span class="sd">           [ 1.]])</span>

<span class="sd">    `meshgrid` is very useful to evaluate functions on a grid.</span>

<span class="sd">    &gt;&gt;&gt; x = np.arange(-5, 5, 0.1)</span>
<span class="sd">    &gt;&gt;&gt; y = np.arange(-5, 5, 0.1)</span>
<span class="sd">    &gt;&gt;&gt; xx, yy = meshgrid(x, y, sparse=True)</span>
<span class="sd">    &gt;&gt;&gt; z = np.sin(xx**2 + yy**2) / (xx**2 + yy**2)</span>
<span class="sd">    &gt;&gt;&gt; h = plt.contourf(x,y,z)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>

    <span class="n">copy_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;copy&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">sparse</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;sparse&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">indexing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;indexing&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;meshgrid() got an unexpected keyword argument &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">],))</span>

    <span class="k">if</span> <span class="n">indexing</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;ij&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Valid values for `indexing` are &#39;xy&#39; and &#39;ij&#39;.&quot;</span><span class="p">)</span>

    <span class="n">s0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">*</span> <span class="n">ndim</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">s0</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">s0</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">::])</span>
              <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xi</span><span class="p">)]</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">indexing</span> <span class="o">==</span> <span class="s1">&#39;xy&#39;</span> <span class="ow">and</span> <span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># switch first and second axis</span>
        <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="p">(</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="p">(</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sparse</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">copy_</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">output</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Return the full N-D matrix (not only the 1-D vector)</span>
        <span class="k">if</span> <span class="n">copy_</span><span class="p">:</span>
            <span class="n">mult_fact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">mult_fact</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="o">*</span><span class="n">output</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new array with sub-arrays along an axis deleted. For a one</span>
<span class="sd">    dimensional array, this returns those entries not returned by</span>
<span class="sd">    `arr[obj]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr : array_like</span>
<span class="sd">      Input array.</span>
<span class="sd">    obj : slice, int or array of ints</span>
<span class="sd">      Indicate which sub-arrays to remove.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">      The axis along which to delete the subarray defined by `obj`.</span>
<span class="sd">      If `axis` is None, `obj` is applied to the flattened array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        A copy of `arr` with the elements specified by `obj` removed. Note</span>
<span class="sd">        that `delete` does not occur in-place. If `axis` is None, `out` is</span>
<span class="sd">        a flattened array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    insert : Insert elements into an array.</span>
<span class="sd">    append : Append elements at the end of an array.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Often it is preferable to use a boolean mask. For example:</span>

<span class="sd">    &gt;&gt;&gt; mask = np.ones(len(arr), dtype=bool)</span>
<span class="sd">    &gt;&gt;&gt; mask[[0,2,4]] = False</span>
<span class="sd">    &gt;&gt;&gt; result = arr[mask,...]</span>

<span class="sd">    Is equivalent to `np.delete(arr, [0,2,4], axis=0)`, but allows further</span>
<span class="sd">    use of `mask`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; arr = np.array([[1,2,3,4], [5,6,7,8], [9,10,11,12]])</span>
<span class="sd">    &gt;&gt;&gt; arr</span>
<span class="sd">    array([[ 1,  2,  3,  4],</span>
<span class="sd">           [ 5,  6,  7,  8],</span>
<span class="sd">           [ 9, 10, 11, 12]])</span>
<span class="sd">    &gt;&gt;&gt; np.delete(arr, 1, 0)</span>
<span class="sd">    array([[ 1,  2,  3,  4],</span>
<span class="sd">           [ 9, 10, 11, 12]])</span>

<span class="sd">    &gt;&gt;&gt; np.delete(arr, np.s_[::2], 1)</span>
<span class="sd">    array([[ 2,  4],</span>
<span class="sd">           [ 6,  8],</span>
<span class="sd">           [10, 12]])</span>
<span class="sd">    &gt;&gt;&gt; np.delete(arr, [1,3,5], None)</span>
<span class="sd">    array([ 1,  3,  5,  7,  8,  9, 10, 11, 12])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ndarray</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">wrap</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">__array_wrap__</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># 2013-09-24, 1.9</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;in the future the special handling of scalars will be removed &quot;</span>
            <span class="s2">&quot;from delete and raise an error&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">slobj</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">ndim</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">newshape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">numtodel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">numtodel</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Invert if step is negative:</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="o">-</span><span class="n">step</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">xr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">xr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">newshape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numtodel</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">newshape</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">fnc</span><span class="p">)</span>
        <span class="c1"># copy initial chunk</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
            <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span>
        <span class="c1"># copy end chunck</span>
        <span class="k">if</span> <span class="n">stop</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">stop</span><span class="o">-</span><span class="n">numtodel</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">slobj2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">ndim</span>
            <span class="n">slobj2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj2</span><span class="p">]</span>
        <span class="c1"># copy middle pieces</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># use array indexing.</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">stop</span><span class="o">-</span><span class="n">start</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="n">keep</span><span class="p">[:</span><span class="n">stop</span><span class="o">-</span><span class="n">start</span><span class="p">:</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">-</span><span class="n">numtodel</span><span class="p">)</span>
            <span class="n">slobj2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">ndim</span>
            <span class="n">slobj2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj2</span><span class="p">]</span>
            <span class="n">slobj2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">keep</span>
            <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new</span>

    <span class="n">_obj</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="c1"># After removing the special handling of booleans and out of</span>
    <span class="c1"># bounds values, the conversion to the array can be removed.</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;in the future insert will treat boolean arrays and array-likes &quot;</span>
            <span class="s2">&quot;as boolean index instead of casting it to integer&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">long</span><span class="p">,</span> <span class="n">integer</span><span class="p">)):</span>
        <span class="c1"># optimization for a single value</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">N</span> <span class="ow">or</span> <span class="n">obj</span> <span class="o">&gt;=</span> <span class="n">N</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="s2">&quot;index </span><span class="si">%i</span><span class="s2"> is out of bounds for axis </span><span class="si">%i</span><span class="s2"> with &quot;</span>
                <span class="s2">&quot;size </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">+=</span> <span class="n">N</span>
        <span class="n">newshape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">newshape</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">fnc</span><span class="p">)</span>
        <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span>
        <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">slobj2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">ndim</span>
        <span class="n">slobj2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">obj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_obj</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">can_cast</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">intp</span><span class="p">,</span> <span class="s1">&#39;same_kind&#39;</span><span class="p">):</span>
            <span class="c1"># obj.size = 1 special case always failed and would just</span>
            <span class="c1"># give superfluous warnings.</span>
            <span class="c1"># 2013-09-24, 1.9</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;using a non-integer array as obj in delete will result in an &quot;</span>
                <span class="s2">&quot;error in the future&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
        <span class="n">keep</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

        <span class="c1"># Test if there are out of bound indices, this is deprecated</span>
        <span class="n">inside_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">obj</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">N</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inside_bounds</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="c1"># 2013-09-24, 1.9</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;in the future out of bounds indices will raise an error &quot;</span>
                <span class="s2">&quot;instead of being ignored by `numpy.delete`.&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">inside_bounds</span><span class="p">]</span>
        <span class="n">positive_indices</span> <span class="o">=</span> <span class="n">obj</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">positive_indices</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;in the future negative indices will not be ignored by &quot;</span>
                <span class="s2">&quot;`numpy.delete`.&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">positive_indices</span><span class="p">]</span>

        <span class="n">keep</span><span class="p">[</span><span class="n">obj</span><span class="p">,</span> <span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">keep</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">new</span>


<span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Insert values along the given axis before the given indices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    obj : int, slice or sequence of ints</span>
<span class="sd">        Object that defines the index or indices before which `values` is</span>
<span class="sd">        inserted.</span>

<span class="sd">        .. versionadded:: 1.8.0</span>

<span class="sd">        Support for multiple insertions when `obj` is a single scalar or a</span>
<span class="sd">        sequence with one element (similar to calling insert multiple</span>
<span class="sd">        times).</span>
<span class="sd">    values : array_like</span>
<span class="sd">        Values to insert into `arr`. If the type of `values` is different</span>
<span class="sd">        from that of `arr`, `values` is converted to the type of `arr`.</span>
<span class="sd">        `values` should be shaped so that ``arr[...,obj,...] = values``</span>
<span class="sd">        is legal.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        Axis along which to insert `values`.  If `axis` is None then `arr`</span>
<span class="sd">        is flattened first.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        A copy of `arr` with `values` inserted.  Note that `insert`</span>
<span class="sd">        does not occur in-place: a new array is returned. If</span>
<span class="sd">        `axis` is None, `out` is a flattened array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    append : Append elements at the end of an array.</span>
<span class="sd">    concatenate : Join a sequence of arrays along an existing axis.</span>
<span class="sd">    delete : Delete elements from an array.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that for higher dimensional inserts `obj=0` behaves very different</span>
<span class="sd">    from `obj=[0]` just like `arr[:,0,:] = values` is different from</span>
<span class="sd">    `arr[:,[0],:] = values`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([[1, 1], [2, 2], [3, 3]])</span>
<span class="sd">    &gt;&gt;&gt; a</span>
<span class="sd">    array([[1, 1],</span>
<span class="sd">           [2, 2],</span>
<span class="sd">           [3, 3]])</span>
<span class="sd">    &gt;&gt;&gt; np.insert(a, 1, 5)</span>
<span class="sd">    array([1, 5, 1, 2, 2, 3, 3])</span>
<span class="sd">    &gt;&gt;&gt; np.insert(a, 1, 5, axis=1)</span>
<span class="sd">    array([[1, 5, 1],</span>
<span class="sd">           [2, 5, 2],</span>
<span class="sd">           [3, 5, 3]])</span>

<span class="sd">    Difference between sequence and scalars:</span>

<span class="sd">    &gt;&gt;&gt; np.insert(a, [1], [[1],[2],[3]], axis=1)</span>
<span class="sd">    array([[1, 1, 1],</span>
<span class="sd">           [2, 2, 2],</span>
<span class="sd">           [3, 3, 3]])</span>
<span class="sd">    &gt;&gt;&gt; np.array_equal(np.insert(a, 1, [1, 2, 3], axis=1),</span>
<span class="sd">    ...                np.insert(a, [1], [[1],[2],[3]], axis=1))</span>
<span class="sd">    True</span>

<span class="sd">    &gt;&gt;&gt; b = a.flatten()</span>
<span class="sd">    &gt;&gt;&gt; b</span>
<span class="sd">    array([1, 1, 2, 2, 3, 3])</span>
<span class="sd">    &gt;&gt;&gt; np.insert(b, [2, 2], [5, 6])</span>
<span class="sd">    array([1, 1, 5, 6, 2, 2, 3, 3])</span>

<span class="sd">    &gt;&gt;&gt; np.insert(b, slice(2, 4), [5, 6])</span>
<span class="sd">    array([1, 1, 5, 2, 6, 2, 3, 3])</span>

<span class="sd">    &gt;&gt;&gt; np.insert(b, [2, 2], [7.13, False]) # type casting</span>
<span class="sd">    array([1, 1, 7, 0, 2, 2, 3, 3])</span>

<span class="sd">    &gt;&gt;&gt; x = np.arange(8).reshape(2, 4)</span>
<span class="sd">    &gt;&gt;&gt; idx = (1, 3)</span>
<span class="sd">    &gt;&gt;&gt; np.insert(x, idx, 999, axis=1)</span>
<span class="sd">    array([[  0, 999,   1,   2, 999,   3],</span>
<span class="sd">           [  4, 999,   5,   6, 999,   7]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ndarray</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">wrap</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">__array_wrap__</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">axis</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ndim</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">&gt;=</span> <span class="n">ndim</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="s2">&quot;axis </span><span class="si">%i</span><span class="s2"> is out of bounds for an array of &quot;</span>
                <span class="s2">&quot;dimension </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">ndim</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">axis</span> <span class="o">+=</span> <span class="n">ndim</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># 2013-09-24, 1.9</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;in the future the special handling of scalars will be removed &quot;</span>
            <span class="s2">&quot;from insert and raise an error&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">arr</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arr</span>
    <span class="n">slobj</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">ndim</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">newshape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
        <span class="c1"># turn it into a range object</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="n">intp</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># need to copy obj, because indices will be changed in-place</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">indices</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="c1"># See also delete</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;in the future insert will treat boolean arrays and &quot;</span>
                <span class="s2">&quot;array-likes as a boolean index instead of casting it to &quot;</span>
                <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>
            <span class="c1"># Code after warning period:</span>
            <span class="c1">#if obj.ndim != 1:</span>
            <span class="c1">#    raise ValueError(&#39;boolean array argument obj to insert &#39;</span>
            <span class="c1">#                     &#39;must be one dimensional&#39;)</span>
            <span class="c1">#indices = np.flatnonzero(obj)</span>
        <span class="k">elif</span> <span class="n">indices</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;index array argument obj to insert must be one dimensional &quot;</span>
                <span class="s2">&quot;or scalar&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">indices</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">N</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="s2">&quot;index </span><span class="si">%i</span><span class="s2"> is out of bounds for axis </span><span class="si">%i</span><span class="s2"> with &quot;</span>
                <span class="s2">&quot;size </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="n">N</span>

        <span class="c1"># There are some object array corner cases here, but we cannot avoid</span>
        <span class="c1"># that:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">indices</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># broadcasting is very different here, since a[:,0,:] = ... behaves</span>
            <span class="c1"># very different from a[:,[0],:] = ...! This changes values so that</span>
            <span class="c1"># it works likes the second case. (here a[:,0:1,:])</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">axis</span> <span class="o">%</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">numnew</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="n">newshape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">+=</span> <span class="n">numnew</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">newshape</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">fnc</span><span class="p">)</span>
        <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span>
        <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="n">numnew</span><span class="p">)</span>
        <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="n">numnew</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">slobj2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">ndim</span>
        <span class="n">slobj2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slobj2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span>
    <span class="k">elif</span> <span class="n">indices</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="c1"># Can safely cast the empty list to intp</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">can_cast</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">intp</span><span class="p">,</span> <span class="s1">&#39;same_kind&#39;</span><span class="p">):</span>
        <span class="c1"># 2013-09-24, 1.9</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;using a non-integer array as obj in insert will result in an &quot;</span>
            <span class="s2">&quot;error in the future&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">intp</span><span class="p">)</span>

    <span class="n">indices</span><span class="p">[</span><span class="n">indices</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N</span>

    <span class="n">numnew</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span>   <span class="c1"># stable sort</span>
    <span class="n">indices</span><span class="p">[</span><span class="n">order</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">numnew</span><span class="p">)</span>

    <span class="n">newshape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">+=</span> <span class="n">numnew</span>
    <span class="n">old_mask</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">newshape</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">old_mask</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">new</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">newshape</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">fnc</span><span class="p">)</span>
    <span class="n">slobj2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span><span class="o">*</span><span class="n">ndim</span>
    <span class="n">slobj</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">indices</span>
    <span class="n">slobj2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_mask</span>
    <span class="n">new</span><span class="p">[</span><span class="n">slobj</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
    <span class="n">new</span><span class="p">[</span><span class="n">slobj2</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>

    <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new</span>


<span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Append values to the end of an array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr : array_like</span>
<span class="sd">        Values are appended to a copy of this array.</span>
<span class="sd">    values : array_like</span>
<span class="sd">        These values are appended to a copy of `arr`.  It must be of the</span>
<span class="sd">        correct shape (the same shape as `arr`, excluding `axis`).  If</span>
<span class="sd">        `axis` is not specified, `values` can be any shape and will be</span>
<span class="sd">        flattened before use.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        The axis along which `values` are appended.  If `axis` is not</span>
<span class="sd">        given, both `arr` and `values` are flattened before use.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    append : ndarray</span>
<span class="sd">        A copy of `arr` with `values` appended to `axis`.  Note that</span>
<span class="sd">        `append` does not occur in-place: a new array is allocated and</span>
<span class="sd">        filled.  If `axis` is None, `out` is a flattened array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    insert : Insert elements into an array.</span>
<span class="sd">    delete : Delete elements from an array.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; np.append([1, 2, 3], [[4, 5, 6], [7, 8, 9]])</span>
<span class="sd">    array([1, 2, 3, 4, 5, 6, 7, 8, 9])</span>

<span class="sd">    When `axis` is specified, `values` must have the correct shape.</span>

<span class="sd">    &gt;&gt;&gt; np.append([[1, 2, 3], [4, 5, 6]], [[7, 8, 9]], axis=0)</span>
<span class="sd">    array([[1, 2, 3],</span>
<span class="sd">           [4, 5, 6],</span>
<span class="sd">           [7, 8, 9]])</span>
<span class="sd">    &gt;&gt;&gt; np.append([[1, 2, 3], [4, 5, 6]], [7, 8, 9], axis=0)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: arrays must have same number of dimensions</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">asanyarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">ravel</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">concatenate</span><span class="p">((</span><span class="n">arr</span><span class="p">,</span> <span class="n">values</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>