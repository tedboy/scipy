

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>scipy.cluster.hierarchy</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Scipy API
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">1. SciPy Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/general.html">1.1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/general.html#scipy-organization">1.1.1. SciPy Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/general.html#finding-documentation">1.1.2. Finding Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/basic.html">1.2. Basic functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/basic.html#interaction-with-numpy">1.2.1. Interaction with Numpy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#index-tricks">1.2.1.1. Index Tricks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#shape-manipulation">1.2.1.2. Shape manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#polynomials">1.2.1.3. Polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#vectorizing-functions-vectorize">1.2.1.4. Vectorizing functions (vectorize)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#type-handling">1.2.1.5. Type handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#other-useful-functions">1.2.1.6. Other useful functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/special.html">1.3. Special functions (<code class="docutils literal"><span class="pre">scipy.special</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/special.html#bessel-functions-of-real-order-jn-jn-zeros">1.3.1. Bessel functions of real order(<code class="docutils literal"><span class="pre">jn()</span></code>, <code class="docutils literal"><span class="pre">jn_zeros()</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/integrate.html">1.4. Integration (<code class="docutils literal"><span class="pre">scipy.integrate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#general-integration-quad">1.4.1. General integration (<code class="docutils literal"><span class="pre">quad()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#general-multiple-integration-dblquad-tplquad-nquad">1.4.2. General multiple integration (<code class="docutils literal"><span class="pre">dblquad()</span></code>, <code class="docutils literal"><span class="pre">tplquad()</span></code>, <code class="docutils literal"><span class="pre">nquad()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#gaussian-quadrature">1.4.3. Gaussian quadrature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#romberg-integration">1.4.4. Romberg Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#integrating-using-samples">1.4.5. Integrating using Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#faster-integration-using-ctypes">1.4.6. Faster integration using Ctypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#ordinary-differential-equations-odeint">1.4.7. Ordinary differential equations (<code class="docutils literal"><span class="pre">odeint()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/integrate.html#references">1.4.7.1. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/optimize.html">1.5. Optimization (<code class="docutils literal"><span class="pre">scipy.optimize</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#unconstrained-minimization-of-multivariate-scalar-functions-minimize">1.5.1. Unconstrained minimization of multivariate scalar functions (<code class="docutils literal"><span class="pre">minimize()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#nelder-mead-simplex-algorithm-method-nelder-mead">1.5.1.1. Nelder-Mead Simplex algorithm (<code class="docutils literal"><span class="pre">method='Nelder-Mead'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#broyden-fletcher-goldfarb-shanno-algorithm-method-bfgs">1.5.1.2. Broyden-Fletcher-Goldfarb-Shanno algorithm (<code class="docutils literal"><span class="pre">method='BFGS'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#newton-conjugate-gradient-algorithm-method-newton-cg">1.5.1.3. Newton-Conjugate-Gradient algorithm (<code class="docutils literal"><span class="pre">method='Newton-CG'</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#constrained-minimization-of-multivariate-scalar-functions-minimize">1.5.2. Constrained minimization of multivariate scalar functions (<code class="docutils literal"><span class="pre">minimize()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#least-squares-minimization-least-squares">1.5.3. Least-squares minimization (<code class="docutils literal"><span class="pre">least_squares()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#example-of-solving-a-fitting-problem">1.5.3.1. Example of solving a fitting problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#further-examples">1.5.3.2. Further examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#univariate-function-minimizers-minimize-scalar">1.5.4. Univariate function minimizers (<code class="docutils literal"><span class="pre">minimize_scalar()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#unconstrained-minimization-method-brent">1.5.4.1. Unconstrained minimization (<code class="docutils literal"><span class="pre">method='brent'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#bounded-minimization-method-bounded">1.5.4.2. Bounded minimization (<code class="docutils literal"><span class="pre">method='bounded'</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#custom-minimizers">1.5.5. Custom minimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#root-finding">1.5.6. Root finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#scalar-functions">1.5.6.1. Scalar functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#fixed-point-solving">1.5.6.2. Fixed-point solving</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#sets-of-equations">1.5.6.3. Sets of equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#root-finding-for-large-problems">1.5.6.4. Root finding for large problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#still-too-slow-preconditioning">1.5.6.5. Still too slow? Preconditioning.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/interpolate.html">1.6. Interpolation (<code class="docutils literal"><span class="pre">scipy.interpolate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#d-interpolation-interp1d">1.6.1. 1-D interpolation (<code class="docutils literal"><span class="pre">interp1d</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#multivariate-data-interpolation-griddata">1.6.2. Multivariate data interpolation (<code class="docutils literal"><span class="pre">griddata()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation">1.6.3. Spline interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation-in-1-d-procedural-interpolate-splxxx">1.6.3.1. Spline interpolation in 1-d: Procedural (interpolate.splXXX)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation-in-1-d-object-oriented-univariatespline">1.6.3.2. Spline interpolation in 1-d: Object-oriented (<code class="docutils literal"><span class="pre">UnivariateSpline</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#two-dimensional-spline-representation-procedural-bisplrep">1.6.3.3. Two-dimensional spline representation: Procedural (<code class="docutils literal"><span class="pre">bisplrep()</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#two-dimensional-spline-representation-object-oriented-bivariatespline">1.6.3.4. Two-dimensional spline representation: Object-oriented (<code class="docutils literal"><span class="pre">BivariateSpline</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#using-radial-basis-functions-for-smoothing-interpolation">1.6.4. Using radial basis functions for smoothing/interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#d-example">1.6.4.1. 1-d Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#id1">1.6.4.2. 2-d Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/fftpack.html">1.7. Fourier Transforms (<code class="docutils literal"><span class="pre">scipy.fftpack</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#fast-fourier-transforms">1.7.1. Fast Fourier transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#one-dimensional-discrete-fourier-transforms">1.7.1.1. One dimensional discrete Fourier transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#two-and-n-dimensional-discrete-fourier-transforms">1.7.1.2. Two and n-dimensional discrete Fourier transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#fft-convolution">1.7.1.3. FFT convolution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#discrete-cosine-transforms">1.7.2. Discrete Cosine Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-i-dct">1.7.2.1. Type I DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-ii-dct">1.7.2.2. Type II DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-iii-dct">1.7.2.3. Type III DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#dct-and-idct">1.7.2.4. DCT and IDCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#example">1.7.2.5. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#discrete-sine-transforms">1.7.3. Discrete Sine Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-i-dst">1.7.3.1. Type I DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-ii-dst">1.7.3.2. Type II DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-iii-dst">1.7.3.3. Type III DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#dst-and-idst">1.7.3.4. DST and IDST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#cache-destruction">1.7.4. Cache Destruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#references">1.7.5. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/signal.html">1.8. Signal Processing (<cite>scipy.signal</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#b-splines">1.8.1. B-splines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#filtering">1.8.2. Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#convolution-correlation">1.8.2.1. Convolution/Correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#difference-equation-filtering">1.8.2.2. Difference-equation filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#filter-design">1.8.2.3. Filter Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#other-filters">1.8.2.4. Other filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#analog-filter-design">1.8.2.5. Analog Filter Design</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#spectral-analysis">1.8.3. Spectral Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#periodogram-measurements">1.8.3.1. Periodogram Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#spectral-analysis-using-welch-s-method">1.8.3.2. Spectral Analysis using Welch&#8217;s Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#lomb-scargle-periodograms-lombscargle">1.8.3.3. Lomb-Scargle Periodograms (<code class="docutils literal"><span class="pre">lombscargle()</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#detrend">1.8.4. Detrend</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/linalg.html">1.9. Linear Algebra (<cite>scipy.linalg</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#scipy-linalg-vs-numpy-linalg">1.9.1. scipy.linalg vs numpy.linalg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#numpy-matrix-vs-2d-numpy-ndarray">1.9.2. numpy.matrix vs 2D numpy.ndarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#basic-routines">1.9.3. Basic routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#finding-inverse">1.9.3.1. Finding Inverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#solving-linear-system">1.9.3.2. Solving linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#finding-determinant">1.9.3.3. Finding Determinant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#computing-norms">1.9.3.4. Computing norms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#solving-linear-least-squares-problems-and-pseudo-inverses">1.9.3.5. Solving linear least-squares problems and pseudo-inverses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#generalized-inverse">1.9.3.6. Generalized inverse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#decompositions">1.9.4. Decompositions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#eigenvalues-and-eigenvectors">1.9.4.1. Eigenvalues and eigenvectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#singular-value-decomposition">1.9.4.2. Singular value decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#lu-decomposition">1.9.4.3. LU decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#cholesky-decomposition">1.9.4.4. Cholesky decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#qr-decomposition">1.9.4.5. QR decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#schur-decomposition">1.9.4.6. Schur decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#interpolative-decomposition">1.9.4.7. Interpolative Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#matrix-functions">1.9.5. Matrix Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#exponential-and-logarithm-functions">1.9.5.1. Exponential and logarithm functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#trigonometric-functions">1.9.5.2. Trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#hyperbolic-trigonometric-functions">1.9.5.3. Hyperbolic trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#arbitrary-function">1.9.5.4. Arbitrary function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#special-matrices">1.9.6. Special matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/arpack.html">1.10. Sparse Eigenvalue Problems with ARPACK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#introduction">1.10.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#basic-functionality">1.10.2. Basic Functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#shift-invert-mode">1.10.3. Shift-Invert Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#examples">1.10.4. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#references">1.10.5. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/csgraph.html">1.11. Compressed Sparse Graph Routines (<cite>scipy.sparse.csgraph</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/csgraph.html#example-word-ladders">1.11.1. Example: Word Ladders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/spatial.html">1.12. Spatial data structures and algorithms (<cite>scipy.spatial</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#delaunay-triangulations">1.12.1. Delaunay triangulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/spatial.html#coplanar-points">1.12.1.1. Coplanar points</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#convex-hulls">1.12.2. Convex hulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#voronoi-diagrams">1.12.3. Voronoi diagrams</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/stats.html">1.13. Statistics (<cite>scipy.stats</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#introduction">1.13.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#random-variables">1.13.2. Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#getting-help">1.13.2.1. Getting Help</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#common-methods">1.13.2.2. Common Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#shifting-and-scaling">1.13.2.3. Shifting and Scaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#shape-parameters">1.13.2.4. Shape Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#freezing-a-distribution">1.13.2.5. Freezing a Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#broadcasting">1.13.2.6. Broadcasting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#specific-points-for-discrete-distributions">1.13.2.7. Specific Points for Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#fitting-distributions">1.13.2.8. Fitting Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#performance-issues-and-cautionary-remarks">1.13.2.9. Performance Issues and Cautionary Remarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#remaining-issues">1.13.2.10. Remaining Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#building-specific-distributions">1.13.3. Building Specific Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#making-a-continuous-distribution-i-e-subclassing-rv-continuous">1.13.3.1. Making a Continuous Distribution, i.e., Subclassing <code class="docutils literal"><span class="pre">rv_continuous</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#subclassing-rv-discrete">1.13.3.2. Subclassing <code class="docutils literal"><span class="pre">rv_discrete</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#analysing-one-sample">1.13.4. Analysing One Sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#descriptive-statistics">1.13.4.1. Descriptive Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#t-test-and-ks-test">1.13.4.2. T-test and KS-test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#tails-of-the-distribution">1.13.4.3. Tails of the distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#special-tests-for-normal-distributions">1.13.4.4. Special tests for normal distributions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#comparing-two-samples">1.13.5. Comparing two samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#comparing-means">1.13.5.1. Comparing means</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#kolmogorov-smirnov-test-for-two-samples-ks-2samp">1.13.5.2. Kolmogorov-Smirnov test for two samples ks_2samp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#kernel-density-estimation">1.13.6. Kernel Density Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#univariate-estimation">1.13.6.1. Univariate estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#multivariate-estimation">1.13.6.2. Multivariate estimation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/ndimage.html">1.14. Multidimensional image processing (<cite>scipy.ndimage</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#introduction">1.14.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#properties-shared-by-all-functions">1.14.2. Properties shared by all functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#filter-functions">1.14.3. Filter functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#correlation-and-convolution">1.14.3.1. Correlation and convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#smoothing-filters">1.14.3.2. Smoothing filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#filters-based-on-order-statistics">1.14.3.3. Filters based on order statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#derivatives">1.14.3.4. Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#generic-filter-functions">1.14.3.5. Generic filter functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#fourier-domain-filters">1.14.3.6. Fourier domain filters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#interpolation-functions">1.14.4. Interpolation functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#spline-pre-filters">1.14.4.1. Spline pre-filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#id8">1.14.4.2. Interpolation functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#morphology">1.14.5. Morphology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#binary-morphology">1.14.5.1. Binary morphology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#grey-scale-morphology">1.14.5.2. Grey-scale morphology</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#distance-transforms">1.14.6. Distance transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#segmentation-and-labeling">1.14.7. Segmentation and labeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#object-measurements">1.14.8. Object measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#extending-scipy-ndimage-in-c">1.14.9. Extending <code class="docutils literal"><span class="pre">scipy.ndimage</span></code> in C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#functions-that-support-c-callback-functions">1.14.10. Functions that support C callback functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/io.html">1.15. File IO (<code class="docutils literal"><span class="pre">scipy.io</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#matlab-files">1.15.1. MATLAB files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#the-basic-functions">1.15.1.1. The basic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#how-do-i-start">1.15.1.2. How do I start?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#matlab-structs">1.15.1.3. MATLAB structs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#matlab-cell-arrays">1.15.1.4. MATLAB cell arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#idl-files">1.15.2. IDL files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#matrix-market-files">1.15.3. Matrix Market files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.wavfile">1.15.4. Wav sound files (<code class="docutils literal"><span class="pre">scipy.io.wavfile</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.arff">1.15.5. Arff files (<code class="docutils literal"><span class="pre">scipy.io.arff</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.netcdf">1.15.6. Netcdf (<code class="docutils literal"><span class="pre">scipy.io.netcdf</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/weave.html">1.16. Weave (<cite>scipy.weave</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#outline">1.16.1. Outline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#introduction">1.16.2. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#requirements">1.16.3. Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#installation">1.16.4. Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#testing">1.16.5. Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#testing-notes">1.16.5.1. Testing Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#benchmarks">1.16.6. Benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#inline">1.16.7. Inline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#more-with-printf">1.16.7.1. More with printf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#more-examples">1.16.7.2. More examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#keyword-option">1.16.7.3. Keyword Option</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#inline-arguments">1.16.7.4. Inline Arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#distutils-keywords">1.16.7.5. Distutils keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#technical-details">1.16.7.6. Technical Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#passing-variables-in-out-of-the-c-c-code">1.16.7.7. Passing Variables in/out of the C/C++ code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#type-conversions">1.16.7.8. Type Conversions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#the-catalog">1.16.7.9. The Catalog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#blitz">1.16.8. Blitz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#id1">1.16.8.1. Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#limitations">1.16.8.2. Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#numpy-efficiency-issues-what-compilation-buys-you">1.16.8.3. NumPy efficiency issues: What compilation buys you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#the-tools">1.16.8.4. The Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#type-definitions-and-coercion">1.16.8.5. Type definitions and coercion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#cataloging-compiled-functions">1.16.8.6. Cataloging Compiled Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#checking-array-sizes">1.16.8.7. Checking Array Sizes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#creating-the-extension-module">1.16.8.8. Creating the Extension Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#extension-modules">1.16.9. Extension Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#a-simple-example">1.16.9.1. A Simple Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#fibonacci-example">1.16.9.2. Fibonacci Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#customizing-type-conversions-type-factories">1.16.10. Customizing Type Conversions &#8211; Type Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#things-i-wish-weave-did">1.16.11. Things I wish <code class="docutils literal"><span class="pre">weave</span></code> did</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../API.html">2. API - importing from Scipy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../API.html#guidelines-for-importing-functions-from-scipy">2.1. Guidelines for importing functions from Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../API.html#api-definition">2.2. API definition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_c_to_i.html">3. API (<code class="docutils literal"><span class="pre">c-i</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cluster.html">3.1. <code class="docutils literal"><span class="pre">scipy.cluster</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.html#clustering-package-scipy-cluster">3.1.1. Clustering package (<code class="docutils literal"><span class="pre">scipy.cluster</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.vq.html">3.1.2. K-means clustering and vector quantization (<code class="docutils literal"><span class="pre">scipy.cluster.vq</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.whiten.html">3.1.2.1. scipy.cluster.vq.whiten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.vq.html">3.1.2.2. scipy.cluster.vq.vq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.kmeans.html">3.1.2.3. scipy.cluster.vq.kmeans</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.kmeans2.html">3.1.2.4. scipy.cluster.vq.kmeans2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cluster.vq.html#background-information">3.1.2.5. Background information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.hierarchy.html">3.1.3. Hierarchical clustering (<code class="docutils literal"><span class="pre">scipy.cluster.hierarchy</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.fcluster.html">3.1.3.1. scipy.cluster.hierarchy.fcluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.fclusterdata.html">3.1.3.2. scipy.cluster.hierarchy.fclusterdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.leaders.html">3.1.3.3. scipy.cluster.hierarchy.leaders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.linkage.html">3.1.3.4. scipy.cluster.hierarchy.linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.single.html">3.1.3.5. scipy.cluster.hierarchy.single</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.complete.html">3.1.3.6. scipy.cluster.hierarchy.complete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.average.html">3.1.3.7. scipy.cluster.hierarchy.average</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.weighted.html">3.1.3.8. scipy.cluster.hierarchy.weighted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.centroid.html">3.1.3.9. scipy.cluster.hierarchy.centroid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.median.html">3.1.3.10. scipy.cluster.hierarchy.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.ward.html">3.1.3.11. scipy.cluster.hierarchy.ward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.cophenet.html">3.1.3.12. scipy.cluster.hierarchy.cophenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.from_mlab_linkage.html">3.1.3.13. scipy.cluster.hierarchy.from_mlab_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.inconsistent.html">3.1.3.14. scipy.cluster.hierarchy.inconsistent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxinconsts.html">3.1.3.15. scipy.cluster.hierarchy.maxinconsts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxdists.html">3.1.3.16. scipy.cluster.hierarchy.maxdists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxRstat.html">3.1.3.17. scipy.cluster.hierarchy.maxRstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.to_mlab_linkage.html">3.1.3.18. scipy.cluster.hierarchy.to_mlab_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.dendrogram.html">3.1.3.19. scipy.cluster.hierarchy.dendrogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.ClusterNode.html">3.1.3.20. scipy.cluster.hierarchy.ClusterNode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.leaves_list.html">3.1.3.21. scipy.cluster.hierarchy.leaves_list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.to_tree.html">3.1.3.22. scipy.cluster.hierarchy.to_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.cut_tree.html">3.1.3.23. scipy.cluster.hierarchy.cut_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_valid_im.html">3.1.3.24. scipy.cluster.hierarchy.is_valid_im</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_valid_linkage.html">3.1.3.25. scipy.cluster.hierarchy.is_valid_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_isomorphic.html">3.1.3.26. scipy.cluster.hierarchy.is_isomorphic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_monotonic.html">3.1.3.27. scipy.cluster.hierarchy.is_monotonic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.correspond.html">3.1.3.28. scipy.cluster.hierarchy.correspond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.num_obs_linkage.html">3.1.3.29. scipy.cluster.hierarchy.num_obs_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.set_link_color_palette.html">3.1.3.30. scipy.cluster.hierarchy.set_link_color_palette</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cluster.hierarchy.html#references">3.1.3.31. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../constants.html">3.2. Constants (<code class="docutils literal"><span class="pre">scipy.constants</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#mathematical-constants">3.2.1. Mathematical constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#physical-constants">3.2.2. Physical constants</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#constants-database">3.2.2.1. Constants database</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#units">3.2.3. Units</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#si-prefixes">3.2.3.1. SI prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#binary-prefixes">3.2.3.2. Binary prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#weight">3.2.3.3. Weight</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#angle">3.2.3.4. Angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#time">3.2.3.5. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#length">3.2.3.6. Length</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#pressure">3.2.3.7. Pressure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#area">3.2.3.8. Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#volume">3.2.3.9. Volume</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#speed">3.2.3.10. Speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#temperature">3.2.3.11. Temperature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#energy">3.2.3.12. Energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#power">3.2.3.13. Power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#force">3.2.3.14. Force</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#optics">3.2.3.15. Optics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#references">3.2.4. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../fftpack.html">3.3. Discrete Fourier transforms (<code class="docutils literal"><span class="pre">scipy.fftpack</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#fast-fourier-transforms-ffts">3.3.1. Fast Fourier Transforms (FFTs)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fft.html">3.3.1.1. scipy.fftpack.fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifft.html">3.3.1.2. scipy.fftpack.ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fft2.html">3.3.1.3. scipy.fftpack.fft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifft2.html">3.3.1.4. scipy.fftpack.ifft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftn.html">3.3.1.5. scipy.fftpack.fftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifftn.html">3.3.1.6. scipy.fftpack.ifftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.rfft.html">3.3.1.7. scipy.fftpack.rfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.irfft.html">3.3.1.8. scipy.fftpack.irfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.dct.html">3.3.1.9. scipy.fftpack.dct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.idct.html">3.3.1.10. scipy.fftpack.idct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.dst.html">3.3.1.11. scipy.fftpack.dst</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.idst.html">3.3.1.12. scipy.fftpack.idst</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#differential-and-pseudo-differential-operators">3.3.2. Differential and pseudo-differential operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.diff.html">3.3.2.1. scipy.fftpack.diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.tilbert.html">3.3.2.2. scipy.fftpack.tilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.itilbert.html">3.3.2.3. scipy.fftpack.itilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.hilbert.html">3.3.2.4. scipy.fftpack.hilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ihilbert.html">3.3.2.5. scipy.fftpack.ihilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.cs_diff.html">3.3.2.6. scipy.fftpack.cs_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.sc_diff.html">3.3.2.7. scipy.fftpack.sc_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ss_diff.html">3.3.2.8. scipy.fftpack.ss_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.cc_diff.html">3.3.2.9. scipy.fftpack.cc_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.shift.html">3.3.2.10. scipy.fftpack.shift</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#helper-functions">3.3.3. Helper functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftshift.html">3.3.3.1. scipy.fftpack.fftshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifftshift.html">3.3.3.2. scipy.fftpack.ifftshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftfreq.html">3.3.3.3. scipy.fftpack.fftfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.rfftfreq.html">3.3.3.4. scipy.fftpack.rfftfreq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#module-scipy.fftpack.convolve">3.3.4. Convolutions (<code class="docutils literal"><span class="pre">scipy.fftpack.convolve</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.convolve.html">3.3.4.1. scipy.fftpack.convolve.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.convolve_z.html">3.3.4.2. scipy.fftpack.convolve.convolve_z</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.init_convolution_kernel.html">3.3.4.3. scipy.fftpack.convolve.init_convolution_kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.destroy_convolve_cache.html">3.3.4.4. scipy.fftpack.convolve.destroy_convolve_cache</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../integrate.html">3.4. Integration and ODEs (<code class="docutils literal"><span class="pre">scipy.integrate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrating-functions-given-function-object">3.4.1. Integrating functions, given function object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quad.html">3.4.1.1. scipy.integrate.quad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.dblquad.html">3.4.1.2. scipy.integrate.dblquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.tplquad.html">3.4.1.3. scipy.integrate.tplquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.nquad.html">3.4.1.4. scipy.integrate.nquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.fixed_quad.html">3.4.1.5. scipy.integrate.fixed_quad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quadrature.html">3.4.1.6. scipy.integrate.quadrature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.romberg.html">3.4.1.7. scipy.integrate.romberg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quad_explain.html">3.4.1.8. scipy.integrate.quad_explain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.newton_cotes.html">3.4.1.9. scipy.integrate.newton_cotes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.IntegrationWarning.html">3.4.1.10. scipy.integrate.IntegrationWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrating-functions-given-fixed-samples">3.4.2. Integrating functions, given fixed samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.trapz.html">3.4.2.1. scipy.integrate.trapz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.cumtrapz.html">3.4.2.2. scipy.integrate.cumtrapz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.simps.html">3.4.2.3. scipy.integrate.simps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.romb.html">3.4.2.4. scipy.integrate.romb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrators-of-ode-systems">3.4.3. Integrators of ODE systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.odeint.html">3.4.3.1. scipy.integrate.odeint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.ode.html">3.4.3.2. scipy.integrate.ode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.complex_ode.html">3.4.3.3. scipy.integrate.complex_ode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../interpolate.html">3.5. Interpolation (<code class="docutils literal"><span class="pre">scipy.interpolate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#univariate-interpolation">3.5.1. Univariate interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interp1d.html">3.5.1.1. scipy.interpolate.interp1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BarycentricInterpolator.html">3.5.1.2. scipy.interpolate.BarycentricInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.KroghInterpolator.html">3.5.1.3. scipy.interpolate.KroghInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PiecewisePolynomial.html">3.5.1.4. scipy.interpolate.PiecewisePolynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PchipInterpolator.html">3.5.1.5. scipy.interpolate.PchipInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.barycentric_interpolate.html">3.5.1.6. scipy.interpolate.barycentric_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.krogh_interpolate.html">3.5.1.7. scipy.interpolate.krogh_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.piecewise_polynomial_interpolate.html">3.5.1.8. scipy.interpolate.piecewise_polynomial_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.pchip_interpolate.html">3.5.1.9. scipy.interpolate.pchip_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.Akima1DInterpolator.html">3.5.1.10. scipy.interpolate.Akima1DInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PPoly.html">3.5.1.11. scipy.interpolate.PPoly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BPoly.html">3.5.1.12. scipy.interpolate.BPoly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#multivariate-interpolation">3.5.2. Multivariate interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.griddata.html">3.5.2.1. scipy.interpolate.griddata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LinearNDInterpolator.html">3.5.2.2. scipy.interpolate.LinearNDInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.NearestNDInterpolator.html">3.5.2.3. scipy.interpolate.NearestNDInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.CloughTocher2DInterpolator.html">3.5.2.4. scipy.interpolate.CloughTocher2DInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.Rbf.html">3.5.2.5. scipy.interpolate.Rbf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interp2d.html">3.5.2.6. scipy.interpolate.interp2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interpn.html">3.5.2.7. scipy.interpolate.interpn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RegularGridInterpolator.html">3.5.2.8. scipy.interpolate.RegularGridInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectBivariateSpline.html">3.5.2.9. scipy.interpolate.RectBivariateSpline</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#d-splines">3.5.3. 1-D Splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.UnivariateSpline.html">3.5.3.1. scipy.interpolate.UnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.InterpolatedUnivariateSpline.html">3.5.3.2. scipy.interpolate.InterpolatedUnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQUnivariateSpline.html">3.5.3.3. scipy.interpolate.LSQUnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splrep.html">3.5.3.4. scipy.interpolate.splrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splprep.html">3.5.3.5. scipy.interpolate.splprep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splev.html">3.5.3.6. scipy.interpolate.splev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splint.html">3.5.3.7. scipy.interpolate.splint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.sproot.html">3.5.3.8. scipy.interpolate.sproot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spalde.html">3.5.3.9. scipy.interpolate.spalde</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splder.html">3.5.3.10. scipy.interpolate.splder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splantider.html">3.5.3.11. scipy.interpolate.splantider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.insert.html">3.5.3.12. scipy.interpolate.insert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#id1">3.5.4. 2-D Splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectBivariateSpline.html">3.5.2.9. scipy.interpolate.RectBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectSphereBivariateSpline.html">3.5.4.1. scipy.interpolate.RectSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BivariateSpline.html">3.5.4.2. scipy.interpolate.BivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.SmoothBivariateSpline.html">3.5.4.3. scipy.interpolate.SmoothBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.SmoothSphereBivariateSpline.html">3.5.4.4. scipy.interpolate.SmoothSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQBivariateSpline.html">3.5.4.5. scipy.interpolate.LSQBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQSphereBivariateSpline.html">3.5.4.6. scipy.interpolate.LSQSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.bisplrep.html">3.5.4.7. scipy.interpolate.bisplrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.bisplev.html">3.5.4.8. scipy.interpolate.bisplev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#additional-tools">3.5.5. Additional tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.lagrange.html">3.5.5.1. scipy.interpolate.lagrange</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.approximate_taylor_polynomial.html">3.5.5.2. scipy.interpolate.approximate_taylor_polynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.ppform.html">3.5.5.3. scipy.interpolate.ppform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spleval.html">3.5.5.4. scipy.interpolate.spleval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spline.html">3.5.5.5. scipy.interpolate.spline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splmake.html">3.5.5.6. scipy.interpolate.splmake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spltopp.html">3.5.5.7. scipy.interpolate.spltopp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.pchip.html">3.5.5.8. scipy.interpolate.pchip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../io.html">3.6. Input and output (<code class="docutils literal"><span class="pre">scipy.io</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#matlab-files">3.6.1. MATLAB® files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.loadmat.html">3.6.1.1. scipy.io.loadmat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.savemat.html">3.6.1.2. scipy.io.savemat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.whosmat.html">3.6.1.3. scipy.io.whosmat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#idl-files">3.6.2. IDL® files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.readsav.html">3.6.2.1. scipy.io.readsav</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#matrix-market-files">3.6.3. Matrix Market files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mminfo.html">3.6.3.1. scipy.io.mminfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mmread.html">3.6.3.2. scipy.io.mmread</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mmwrite.html">3.6.3.3. scipy.io.mmwrite</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#unformatted-fortran-files">3.6.4. Unformatted Fortran files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.FortranFile.html">3.6.4.1. scipy.io.FortranFile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#netcdf">3.6.5. Netcdf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.netcdf_file.html">3.6.5.1. scipy.io.netcdf_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.netcdf_variable.html">3.6.5.2. scipy.io.netcdf_variable</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#harwell-boeing-files">3.6.6. Harwell-Boeing files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.hb_read.html">3.6.6.1. scipy.io.hb_read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.hb_write.html">3.6.6.2. scipy.io.hb_write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#module-scipy.io.wavfile">3.6.7. Wav sound files (<code class="docutils literal"><span class="pre">scipy.io.wavfile</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.read.html">3.6.7.1. scipy.io.wavfile.read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.write.html">3.6.7.2. scipy.io.wavfile.write</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.WavFileWarning.html">3.6.7.3. scipy.io.wavfile.WavFileWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#module-scipy.io.arff">3.6.8. Arff files (<code class="docutils literal"><span class="pre">scipy.io.arff</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.loadarff.html">3.6.8.1. scipy.io.arff.loadarff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.MetaData.html">3.6.8.2. scipy.io.arff.MetaData</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.ArffError.html">3.6.8.3. scipy.io.arff.ArffError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.ParseArffError.html">3.6.8.4. scipy.io.arff.ParseArffError</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_l_to_o.html">4. API (<code class="docutils literal"><span class="pre">l-o</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg.html">4.1. Linear Algebra scipy.linalg</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.html#id1">4.1.1. Linear algebra (<code class="docutils literal"><span class="pre">scipy.linalg</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#basics">4.1.1.1. Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#eigenvalue-problems">4.1.1.2. Eigenvalue Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#decompositions">4.1.1.3. Decompositions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#matrix-functions">4.1.1.4. Matrix Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#matrix-equation-solvers">4.1.1.5. Matrix Equation Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#special-matrices">4.1.1.6. Special Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#low-level-routines">4.1.1.7. Low-level routines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.blas.html">4.1.2. Low-level BLAS functions (<code class="docutils literal"><span class="pre">scipy.linalg.blas</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#finding-functions">4.1.2.1. Finding functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-1-functions">4.1.2.2. BLAS Level 1 functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-2-functions">4.1.2.3. BLAS Level 2 functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-3-functions">4.1.2.4. BLAS Level 3 functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.lapack.html">4.1.3. Low-level LAPACK functions (<code class="docutils literal"><span class="pre">scipy.linalg.lapack</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.lapack.html#finding-functions">4.1.3.1. Finding functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.lapack.html#all-functions">4.1.3.2. All functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.cython_blas.html">4.1.4. BLAS Functions for Cython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.cython_lapack.html">4.1.5. LAPACK functions for Cython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.interpolative.html">4.1.6. Interpolative matrix decomposition (<code class="docutils literal"><span class="pre">scipy.linalg.interpolative</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#routines">4.1.6.1. Routines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#references">4.1.6.2. References</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#tutorial">4.1.6.3. Tutorial</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc.html">4.2. Miscellaneous routines (<code class="docutils literal"><span class="pre">scipy.misc</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.ascent.html">4.2.1. scipy.misc.ascent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.bytescale.html">4.2.2. scipy.misc.bytescale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.central_diff_weights.html">4.2.3. scipy.misc.central_diff_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.comb.html">4.2.4. scipy.misc.comb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.derivative.html">4.2.5. scipy.misc.derivative</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.face.html">4.2.6. scipy.misc.face</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorial.html">4.2.7. scipy.misc.factorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorial2.html">4.2.8. scipy.misc.factorial2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorialk.html">4.2.9. scipy.misc.factorialk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.fromimage.html">4.2.10. scipy.misc.fromimage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imfilter.html">4.2.11. scipy.misc.imfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imread.html">4.2.12. scipy.misc.imread</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imresize.html">4.2.13. scipy.misc.imresize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imrotate.html">4.2.14. scipy.misc.imrotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imsave.html">4.2.15. scipy.misc.imsave</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imshow.html">4.2.16. scipy.misc.imshow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.info.html">4.2.17. scipy.misc.info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.lena.html">4.2.18. scipy.misc.lena</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.logsumexp.html">4.2.19. scipy.misc.logsumexp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.pade.html">4.2.20. scipy.misc.pade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.toimage.html">4.2.21. scipy.misc.toimage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.source.html">4.2.22. scipy.misc.source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.who.html">4.2.23. scipy.misc.who</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../ndimage.html">4.3. Multi-dimensional image processing (<code class="docutils literal"><span class="pre">scipy.ndimage</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#filters">4.3.1. Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.convolve.html">4.3.1.1. scipy.ndimage.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.convolve1d.html">4.3.1.2. scipy.ndimage.convolve1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.correlate.html">4.3.1.3. scipy.ndimage.correlate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.correlate1d.html">4.3.1.4. scipy.ndimage.correlate1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_filter.html">4.3.1.5. scipy.ndimage.gaussian_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_filter1d.html">4.3.1.6. scipy.ndimage.gaussian_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_gradient_magnitude.html">4.3.1.7. scipy.ndimage.gaussian_gradient_magnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_laplace.html">4.3.1.8. scipy.ndimage.gaussian_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_filter.html">4.3.1.9. scipy.ndimage.generic_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_filter1d.html">4.3.1.10. scipy.ndimage.generic_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_gradient_magnitude.html">4.3.1.11. scipy.ndimage.generic_gradient_magnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_laplace.html">4.3.1.12. scipy.ndimage.generic_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.laplace.html">4.3.1.13. scipy.ndimage.laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_filter.html">4.3.1.14. scipy.ndimage.maximum_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_filter1d.html">4.3.1.15. scipy.ndimage.maximum_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.median_filter.html">4.3.1.16. scipy.ndimage.median_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_filter.html">4.3.1.17. scipy.ndimage.minimum_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_filter1d.html">4.3.1.18. scipy.ndimage.minimum_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.percentile_filter.html">4.3.1.19. scipy.ndimage.percentile_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.prewitt.html">4.3.1.20. scipy.ndimage.prewitt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.rank_filter.html">4.3.1.21. scipy.ndimage.rank_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.sobel.html">4.3.1.22. scipy.ndimage.sobel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.uniform_filter.html">4.3.1.23. scipy.ndimage.uniform_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.uniform_filter1d.html">4.3.1.24. scipy.ndimage.uniform_filter1d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#fourier-filters">4.3.2. Fourier filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_ellipsoid.html">4.3.2.1. scipy.ndimage.fourier_ellipsoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_gaussian.html">4.3.2.2. scipy.ndimage.fourier_gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_shift.html">4.3.2.3. scipy.ndimage.fourier_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_uniform.html">4.3.2.4. scipy.ndimage.fourier_uniform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#interpolation">4.3.3. Interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.affine_transform.html">4.3.3.1. scipy.ndimage.affine_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.geometric_transform.html">4.3.3.2. scipy.ndimage.geometric_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.map_coordinates.html">4.3.3.3. scipy.ndimage.map_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.rotate.html">4.3.3.4. scipy.ndimage.rotate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.shift.html">4.3.3.5. scipy.ndimage.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.spline_filter.html">4.3.3.6. scipy.ndimage.spline_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.spline_filter1d.html">4.3.3.7. scipy.ndimage.spline_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.zoom.html">4.3.3.8. scipy.ndimage.zoom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#measurements">4.3.4. Measurements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.center_of_mass.html">4.3.4.1. scipy.ndimage.center_of_mass</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.extrema.html">4.3.4.2. scipy.ndimage.extrema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.find_objects.html">4.3.4.3. scipy.ndimage.find_objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.histogram.html">4.3.4.4. scipy.ndimage.histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.label.html">4.3.4.5. scipy.ndimage.label</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.labeled_comprehension.html">4.3.4.6. scipy.ndimage.labeled_comprehension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum.html">4.3.4.7. scipy.ndimage.maximum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_position.html">4.3.4.8. scipy.ndimage.maximum_position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.mean.html">4.3.4.9. scipy.ndimage.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.median.html">4.3.4.10. scipy.ndimage.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum.html">4.3.4.11. scipy.ndimage.minimum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_position.html">4.3.4.12. scipy.ndimage.minimum_position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.standard_deviation.html">4.3.4.13. scipy.ndimage.standard_deviation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.sum.html">4.3.4.14. scipy.ndimage.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.variance.html">4.3.4.15. scipy.ndimage.variance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.watershed_ift.html">4.3.4.16. scipy.ndimage.watershed_ift</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#morphology">4.3.5. Morphology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_closing.html">4.3.5.1. scipy.ndimage.binary_closing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_dilation.html">4.3.5.2. scipy.ndimage.binary_dilation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_erosion.html">4.3.5.3. scipy.ndimage.binary_erosion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_fill_holes.html">4.3.5.4. scipy.ndimage.binary_fill_holes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_hit_or_miss.html">4.3.5.5. scipy.ndimage.binary_hit_or_miss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_opening.html">4.3.5.6. scipy.ndimage.binary_opening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_propagation.html">4.3.5.7. scipy.ndimage.binary_propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.black_tophat.html">4.3.5.8. scipy.ndimage.black_tophat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_bf.html">4.3.5.9. scipy.ndimage.distance_transform_bf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_cdt.html">4.3.5.10. scipy.ndimage.distance_transform_cdt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_edt.html">4.3.5.11. scipy.ndimage.distance_transform_edt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generate_binary_structure.html">4.3.5.12. scipy.ndimage.generate_binary_structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_closing.html">4.3.5.13. scipy.ndimage.grey_closing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_dilation.html">4.3.5.14. scipy.ndimage.grey_dilation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_erosion.html">4.3.5.15. scipy.ndimage.grey_erosion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_opening.html">4.3.5.16. scipy.ndimage.grey_opening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.iterate_structure.html">4.3.5.17. scipy.ndimage.iterate_structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.morphological_gradient.html">4.3.5.18. scipy.ndimage.morphological_gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.morphological_laplace.html">4.3.5.19. scipy.ndimage.morphological_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.white_tophat.html">4.3.5.20. scipy.ndimage.white_tophat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#utility">4.3.6. Utility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.imread.html">4.3.6.1. scipy.ndimage.imread</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../odr.html">4.4. Orthogonal distance regression (<code class="docutils literal"><span class="pre">scipy.odr</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../odr.html#package-content">4.4.1. Package Content</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Data.html">4.4.1.1. scipy.odr.Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.RealData.html">4.4.1.2. scipy.odr.RealData</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Model.html">4.4.1.3. scipy.odr.Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.ODR.html">4.4.1.4. scipy.odr.ODR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Output.html">4.4.1.5. scipy.odr.Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr.html">4.4.1.6. scipy.odr.odr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr_error.html">4.4.1.7. scipy.odr.odr_error</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr_stop.html">4.4.1.8. scipy.odr.odr_stop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.polynomial.html">4.4.1.9. scipy.odr.polynomial</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../odr.html#usage-information">4.4.2. Usage information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#introduction">4.4.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#basic-usage">4.4.2.2. Basic usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#references">4.4.2.3. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimize.html">4.5. Optimization and root finding (<code class="docutils literal"><span class="pre">scipy.optimize</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#optimization">4.5.1. Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#local-optimization">4.5.1.1. Local Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#equation-local-minimizers">4.5.1.2. Equation (Local) Minimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#global-optimization">4.5.1.3. Global Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#rosenbrock-function">4.5.1.4. Rosenbrock function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#fitting">4.5.2. Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.curve_fit.html">4.5.2.1. scipy.optimize.curve_fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#root-finding">4.5.3. Root finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#scalar-functions">4.5.3.1. Scalar functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#multidimensional">4.5.3.2. Multidimensional</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#linear-programming">4.5.4. Linear Programming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linprog.html">4.5.4.1. scipy.optimize.linprog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linprog_verbose_callback.html">4.5.4.2. scipy.optimize.linprog_verbose_callback</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.linprog-simplex.html">4.5.4.3. linprog(method=&#8217;Simplex&#8217;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linear_sum_assignment.html">4.5.4.4. scipy.optimize.linear_sum_assignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#utilities">4.5.5. Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.approx_fprime.html">4.5.5.1. scipy.optimize.approx_fprime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.bracket.html">4.5.5.2. scipy.optimize.bracket</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.check_grad.html">4.5.5.3. scipy.optimize.check_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.line_search.html">4.5.5.4. scipy.optimize.line_search</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.show_options.html">4.5.5.5. scipy.optimize.show_options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.LbfgsInvHessProduct.html">4.5.5.6. scipy.optimize.LbfgsInvHessProduct</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimize.nonlin.html">4.6. Nonlinear solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.nonlin.html#routines">4.6.1. Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.nonlin.html#examples">4.6.2. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_s_to_w.html">5. API (<code class="docutils literal"><span class="pre">s-w</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../signal.html">5.1. Signal processing (<code class="docutils literal"><span class="pre">scipy.signal</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#convolution">5.1.1. Convolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.convolve.html">5.1.1.1. scipy.signal.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.correlate.html">5.1.1.2. scipy.signal.correlate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.fftconvolve.html">5.1.1.3. scipy.signal.fftconvolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.convolve2d.html">5.1.1.4. scipy.signal.convolve2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.correlate2d.html">5.1.1.5. scipy.signal.correlate2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sepfir2d.html">5.1.1.6. scipy.signal.sepfir2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#b-splines">5.1.2. B-splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bspline.html">5.1.2.1. scipy.signal.bspline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cubic.html">5.1.2.2. scipy.signal.cubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.quadratic.html">5.1.2.3. scipy.signal.quadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gauss_spline.html">5.1.2.4. scipy.signal.gauss_spline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline1d.html">5.1.2.5. scipy.signal.cspline1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline1d.html">5.1.2.6. scipy.signal.qspline1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline2d.html">5.1.2.7. scipy.signal.cspline2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline2d.html">5.1.2.8. scipy.signal.qspline2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline1d_eval.html">5.1.2.9. scipy.signal.cspline1d_eval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline1d_eval.html">5.1.2.10. scipy.signal.qspline1d_eval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.spline_filter.html">5.1.2.11. scipy.signal.spline_filter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#filtering">5.1.3. Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.order_filter.html">5.1.3.1. scipy.signal.order_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.medfilt.html">5.1.3.2. scipy.signal.medfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.medfilt2d.html">5.1.3.3. scipy.signal.medfilt2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.wiener.html">5.1.3.4. scipy.signal.wiener</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.symiirorder1.html">5.1.3.5. scipy.signal.symiirorder1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.symiirorder2.html">5.1.3.6. scipy.signal.symiirorder2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfilter.html">5.1.3.7. scipy.signal.lfilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfiltic.html">5.1.3.8. scipy.signal.lfiltic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfilter_zi.html">5.1.3.9. scipy.signal.lfilter_zi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.filtfilt.html">5.1.3.10. scipy.signal.filtfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.savgol_filter.html">5.1.3.11. scipy.signal.savgol_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.deconvolve.html">5.1.3.12. scipy.signal.deconvolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sosfilt.html">5.1.3.13. scipy.signal.sosfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sosfilt_zi.html">5.1.3.14. scipy.signal.sosfilt_zi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hilbert.html">5.1.3.15. scipy.signal.hilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hilbert2.html">5.1.3.16. scipy.signal.hilbert2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.decimate.html">5.1.3.17. scipy.signal.decimate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.detrend.html">5.1.3.18. scipy.signal.detrend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.resample.html">5.1.3.19. scipy.signal.resample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#filter-design">5.1.4. Filter design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bilinear.html">5.1.4.1. scipy.signal.bilinear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.findfreqs.html">5.1.4.2. scipy.signal.findfreqs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.firwin.html">5.1.4.3. scipy.signal.firwin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.firwin2.html">5.1.4.4. scipy.signal.firwin2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqs.html">5.1.4.5. scipy.signal.freqs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqz.html">5.1.4.6. scipy.signal.freqz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.group_delay.html">5.1.4.7. scipy.signal.group_delay</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.iirdesign.html">5.1.4.8. scipy.signal.iirdesign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.iirfilter.html">5.1.4.9. scipy.signal.iirfilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser_atten.html">5.1.4.10. scipy.signal.kaiser_atten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser_beta.html">5.1.4.11. scipy.signal.kaiser_beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiserord.html">5.1.4.12. scipy.signal.kaiserord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.savgol_coeffs.html">5.1.4.13. scipy.signal.savgol_coeffs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.remez.html">5.1.4.14. scipy.signal.remez</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.unique_roots.html">5.1.4.15. scipy.signal.unique_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.residue.html">5.1.4.16. scipy.signal.residue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.residuez.html">5.1.4.17. scipy.signal.residuez</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.invres.html">5.1.4.18. scipy.signal.invres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.invresz.html">5.1.4.19. scipy.signal.invresz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.BadCoefficients.html">5.1.4.20. scipy.signal.BadCoefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.abcd_normalize.html">5.1.4.21. scipy.signal.abcd_normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.band_stop_obj.html">5.1.4.22. scipy.signal.band_stop_obj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.besselap.html">5.1.4.23. scipy.signal.besselap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.buttap.html">5.1.4.24. scipy.signal.buttap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb1ap.html">5.1.4.25. scipy.signal.cheb1ap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb2ap.html">5.1.4.26. scipy.signal.cheb2ap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cmplx_sort.html">5.1.4.27. scipy.signal.cmplx_sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellipap.html">5.1.4.28. scipy.signal.ellipap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2bp.html">5.1.4.29. scipy.signal.lp2bp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2bs.html">5.1.4.30. scipy.signal.lp2bs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2hp.html">5.1.4.31. scipy.signal.lp2hp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2lp.html">5.1.4.32. scipy.signal.lp2lp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.normalize.html">5.1.4.33. scipy.signal.normalize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#matlab-style-iir-filter-design">5.1.5. Matlab-style IIR filter design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.butter.html">5.1.5.1. scipy.signal.butter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.buttord.html">5.1.5.2. scipy.signal.buttord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheby1.html">5.1.5.3. scipy.signal.cheby1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb1ord.html">5.1.5.4. scipy.signal.cheb1ord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheby2.html">5.1.5.5. scipy.signal.cheby2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb2ord.html">5.1.5.6. scipy.signal.cheb2ord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellip.html">5.1.5.7. scipy.signal.ellip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellipord.html">5.1.5.8. scipy.signal.ellipord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bessel.html">5.1.5.9. scipy.signal.bessel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#continuous-time-linear-systems">5.1.6. Continuous-Time Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqresp.html">5.1.6.1. scipy.signal.freqresp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lti.html">5.1.6.2. scipy.signal.lti</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.StateSpace.html">5.1.6.3. scipy.signal.StateSpace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.TransferFunction.html">5.1.6.4. scipy.signal.TransferFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ZerosPolesGain.html">5.1.6.5. scipy.signal.ZerosPolesGain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lsim.html">5.1.6.6. scipy.signal.lsim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lsim2.html">5.1.6.7. scipy.signal.lsim2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.impulse.html">5.1.6.8. scipy.signal.impulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.impulse2.html">5.1.6.9. scipy.signal.impulse2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.step.html">5.1.6.10. scipy.signal.step</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.step2.html">5.1.6.11. scipy.signal.step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bode.html">5.1.6.12. scipy.signal.bode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#discrete-time-linear-systems">5.1.7. Discrete-Time Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dlsim.html">5.1.7.1. scipy.signal.dlsim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dimpulse.html">5.1.7.2. scipy.signal.dimpulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dstep.html">5.1.7.3. scipy.signal.dstep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#lti-representations">5.1.8. LTI Representations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2zpk.html">5.1.8.1. scipy.signal.tf2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2sos.html">5.1.8.2. scipy.signal.tf2sos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2ss.html">5.1.8.3. scipy.signal.tf2ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2tf.html">5.1.8.4. scipy.signal.zpk2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2sos.html">5.1.8.5. scipy.signal.zpk2sos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2ss.html">5.1.8.6. scipy.signal.zpk2ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ss2tf.html">5.1.8.7. scipy.signal.ss2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ss2zpk.html">5.1.8.8. scipy.signal.ss2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sos2zpk.html">5.1.8.9. scipy.signal.sos2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sos2tf.html">5.1.8.10. scipy.signal.sos2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cont2discrete.html">5.1.8.11. scipy.signal.cont2discrete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.place_poles.html">5.1.8.12. scipy.signal.place_poles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#waveforms">5.1.9. Waveforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.chirp.html">5.1.9.1. scipy.signal.chirp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gausspulse.html">5.1.9.2. scipy.signal.gausspulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.max_len_seq.html">5.1.9.3. scipy.signal.max_len_seq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sawtooth.html">5.1.9.4. scipy.signal.sawtooth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.square.html">5.1.9.5. scipy.signal.square</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sweep_poly.html">5.1.9.6. scipy.signal.sweep_poly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#window-functions">5.1.10. Window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.get_window.html">5.1.10.1. scipy.signal.get_window</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.barthann.html">5.1.10.2. scipy.signal.barthann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bartlett.html">5.1.10.3. scipy.signal.bartlett</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.blackman.html">5.1.10.4. scipy.signal.blackman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.blackmanharris.html">5.1.10.5. scipy.signal.blackmanharris</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bohman.html">5.1.10.6. scipy.signal.bohman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.boxcar.html">5.1.10.7. scipy.signal.boxcar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.chebwin.html">5.1.10.8. scipy.signal.chebwin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cosine.html">5.1.10.9. scipy.signal.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.exponential.html">5.1.10.10. scipy.signal.exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.flattop.html">5.1.10.11. scipy.signal.flattop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gaussian.html">5.1.10.12. scipy.signal.gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.general_gaussian.html">5.1.10.13. scipy.signal.general_gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hamming.html">5.1.10.14. scipy.signal.hamming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hann.html">5.1.10.15. scipy.signal.hann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hanning.html">5.1.10.16. scipy.signal.hanning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser.html">5.1.10.17. scipy.signal.kaiser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.nuttall.html">5.1.10.18. scipy.signal.nuttall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.parzen.html">5.1.10.19. scipy.signal.parzen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.slepian.html">5.1.10.20. scipy.signal.slepian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.triang.html">5.1.10.21. scipy.signal.triang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tukey.html">5.1.10.22. scipy.signal.tukey</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#wavelets">5.1.11. Wavelets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cascade.html">5.1.11.1. scipy.signal.cascade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.daub.html">5.1.11.2. scipy.signal.daub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.morlet.html">5.1.11.3. scipy.signal.morlet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qmf.html">5.1.11.4. scipy.signal.qmf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ricker.html">5.1.11.5. scipy.signal.ricker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cwt.html">5.1.11.6. scipy.signal.cwt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#peak-finding">5.1.12. Peak finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.find_peaks_cwt.html">5.1.12.1. scipy.signal.find_peaks_cwt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelmin.html">5.1.12.2. scipy.signal.argrelmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelmax.html">5.1.12.3. scipy.signal.argrelmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelextrema.html">5.1.12.4. scipy.signal.argrelextrema</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#spectral-analysis">5.1.13. Spectral Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.periodogram.html">5.1.13.1. scipy.signal.periodogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.welch.html">5.1.13.2. scipy.signal.welch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.csd.html">5.1.13.3. scipy.signal.csd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.coherence.html">5.1.13.4. scipy.signal.coherence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.spectrogram.html">5.1.13.5. scipy.signal.spectrogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lombscargle.html">5.1.13.6. scipy.signal.lombscargle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.vectorstrength.html">5.1.13.7. scipy.signal.vectorstrength</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.html">5.2. Sparse matrices (<code class="docutils literal"><span class="pre">scipy.sparse</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.html#contents">5.2.1. Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#sparse-matrix-classes">5.2.1.1. Sparse matrix classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#functions">5.2.1.2. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#submodules">5.2.1.3. Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#exceptions">5.2.1.4. Exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.html#usage-information">5.2.2. Usage information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#matrix-vector-product">5.2.2.1. Matrix vector product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#example-1">5.2.2.2. Example 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#example-2">5.2.2.3. Example 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#further-details">5.2.2.4. Further Details</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.linalg.html">5.3. Sparse linear algebra (<code class="docutils literal"><span class="pre">scipy.sparse.linalg</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#abstract-linear-operators">5.3.1. Abstract linear operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.LinearOperator.html">5.3.1.1. scipy.sparse.linalg.LinearOperator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.aslinearoperator.html">5.3.1.2. scipy.sparse.linalg.aslinearoperator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-operations">5.3.2. Matrix Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.inv.html">5.3.2.1. scipy.sparse.linalg.inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.expm.html">5.3.2.2. scipy.sparse.linalg.expm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.expm_multiply.html">5.3.2.3. scipy.sparse.linalg.expm_multiply</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-norms">5.3.3. Matrix norms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.norm.html">5.3.3.1. scipy.sparse.linalg.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.onenormest.html">5.3.3.2. scipy.sparse.linalg.onenormest</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#solving-linear-problems">5.3.4. Solving linear problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.spsolve.html">5.3.4.1. scipy.sparse.linalg.spsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.factorized.html">5.3.4.2. scipy.sparse.linalg.factorized</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.MatrixRankWarning.html">5.3.4.3. scipy.sparse.linalg.MatrixRankWarning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.use_solver.html">5.3.4.4. scipy.sparse.linalg.use_solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.bicg.html">5.3.4.5. scipy.sparse.linalg.bicg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.bicgstab.html">5.3.4.6. scipy.sparse.linalg.bicgstab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.cg.html">5.3.4.7. scipy.sparse.linalg.cg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.cgs.html">5.3.4.8. scipy.sparse.linalg.cgs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.gmres.html">5.3.4.9. scipy.sparse.linalg.gmres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lgmres.html">5.3.4.10. scipy.sparse.linalg.lgmres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.minres.html">5.3.4.11. scipy.sparse.linalg.minres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.qmr.html">5.3.4.12. scipy.sparse.linalg.qmr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lsqr.html">5.3.4.13. scipy.sparse.linalg.lsqr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lsmr.html">5.3.4.14. scipy.sparse.linalg.lsmr</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-factorizations">5.3.5. Matrix factorizations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.eigs.html">5.3.5.1. scipy.sparse.linalg.eigs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.eigsh.html">5.3.5.2. scipy.sparse.linalg.eigsh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lobpcg.html">5.3.5.3. scipy.sparse.linalg.lobpcg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.svds.html">5.3.5.4. scipy.sparse.linalg.svds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.splu.html">5.3.5.5. scipy.sparse.linalg.splu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.spilu.html">5.3.5.6. scipy.sparse.linalg.spilu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.SuperLU.html">5.3.5.7. scipy.sparse.linalg.SuperLU</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#exceptions">5.3.6. Exceptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.ArpackNoConvergence.html">5.3.6.1. scipy.sparse.linalg.ArpackNoConvergence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.ArpackError.html">5.3.6.2. scipy.sparse.linalg.ArpackError</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.csgraph.html">5.4. Compressed Sparse Graph Routines (<code class="docutils literal"><span class="pre">scipy.sparse.csgraph</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.csgraph.html#contents">5.4.1. Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.connected_components.html">5.4.1.1. scipy.sparse.csgraph.connected_components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.laplacian.html">5.4.1.2. scipy.sparse.csgraph.laplacian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.shortest_path.html">5.4.1.3. scipy.sparse.csgraph.shortest_path</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.dijkstra.html">5.4.1.4. scipy.sparse.csgraph.dijkstra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.floyd_warshall.html">5.4.1.5. scipy.sparse.csgraph.floyd_warshall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.bellman_ford.html">5.4.1.6. scipy.sparse.csgraph.bellman_ford</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.johnson.html">5.4.1.7. scipy.sparse.csgraph.johnson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.breadth_first_order.html">5.4.1.8. scipy.sparse.csgraph.breadth_first_order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.depth_first_order.html">5.4.1.9. scipy.sparse.csgraph.depth_first_order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.breadth_first_tree.html">5.4.1.10. scipy.sparse.csgraph.breadth_first_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.depth_first_tree.html">5.4.1.11. scipy.sparse.csgraph.depth_first_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.minimum_spanning_tree.html">5.4.1.12. scipy.sparse.csgraph.minimum_spanning_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.reverse_cuthill_mckee.html">5.4.1.13. scipy.sparse.csgraph.reverse_cuthill_mckee</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.maximum_bipartite_matching.html">5.4.1.14. scipy.sparse.csgraph.maximum_bipartite_matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.NegativeCycleError.html">5.4.1.15. scipy.sparse.csgraph.NegativeCycleError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.construct_dist_matrix.html">5.4.1.16. scipy.sparse.csgraph.construct_dist_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_from_dense.html">5.4.1.17. scipy.sparse.csgraph.csgraph_from_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_from_masked.html">5.4.1.18. scipy.sparse.csgraph.csgraph_from_masked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_masked_from_dense.html">5.4.1.19. scipy.sparse.csgraph.csgraph_masked_from_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_to_dense.html">5.4.1.20. scipy.sparse.csgraph.csgraph_to_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_to_masked.html">5.4.1.21. scipy.sparse.csgraph.csgraph_to_masked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.reconstruct_path.html">5.4.1.22. scipy.sparse.csgraph.reconstruct_path</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.csgraph.html#graph-representations">5.4.2. Graph Representations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.csgraph.html#directed-vs-undirected">5.4.2.1. Directed vs. Undirected</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../spatial.html">5.5. Spatial algorithms and data structures (<code class="docutils literal"><span class="pre">scipy.spatial</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#nearest-neighbor-queries">5.5.1. Nearest-neighbor Queries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.KDTree.html">5.5.1.1. scipy.spatial.KDTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.cKDTree.html">5.5.1.2. scipy.spatial.cKDTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.html">5.5.1.3. scipy.spatial.distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Rectangle.html">5.5.1.4. scipy.spatial.Rectangle</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#delaunay-triangulation-convex-hulls-and-voronoi-diagrams">5.5.2. Delaunay Triangulation, Convex Hulls and Voronoi Diagrams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Delaunay.html">5.5.2.1. scipy.spatial.Delaunay</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.ConvexHull.html">5.5.2.2. scipy.spatial.ConvexHull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Voronoi.html">5.5.2.3. scipy.spatial.Voronoi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#plotting-helpers">5.5.3. Plotting Helpers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.delaunay_plot_2d.html">5.5.3.1. scipy.spatial.delaunay_plot_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.convex_hull_plot_2d.html">5.5.3.2. scipy.spatial.convex_hull_plot_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.voronoi_plot_2d.html">5.5.3.3. scipy.spatial.voronoi_plot_2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#simplex-representation">5.5.4. Simplex representation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../spatial.html#functions">5.5.4.1. Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../spatial.distance.html">5.6. Distance computations (<code class="docutils literal"><span class="pre">scipy.spatial.distance</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.distance.html#function-reference">5.6.1. Function Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.pdist.html">5.6.1.1. scipy.spatial.distance.pdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cdist.html">5.6.1.2. scipy.spatial.distance.cdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.squareform.html">5.6.1.3. scipy.spatial.distance.squareform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.is_valid_dm.html">5.6.1.4. scipy.spatial.distance.is_valid_dm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.is_valid_y.html">5.6.1.5. scipy.spatial.distance.is_valid_y</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.num_obs_dm.html">5.6.1.6. scipy.spatial.distance.num_obs_dm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.num_obs_y.html">5.6.1.7. scipy.spatial.distance.num_obs_y</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.braycurtis.html">5.6.1.8. scipy.spatial.distance.braycurtis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.canberra.html">5.6.1.9. scipy.spatial.distance.canberra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.chebyshev.html">5.6.1.10. scipy.spatial.distance.chebyshev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cityblock.html">5.6.1.11. scipy.spatial.distance.cityblock</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.correlation.html">5.6.1.12. scipy.spatial.distance.correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cosine.html">5.6.1.13. scipy.spatial.distance.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.dice.html">5.6.1.14. scipy.spatial.distance.dice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.euclidean.html">5.6.1.15. scipy.spatial.distance.euclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.hamming.html">5.6.1.16. scipy.spatial.distance.hamming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.jaccard.html">5.6.1.17. scipy.spatial.distance.jaccard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.kulsinski.html">5.6.1.18. scipy.spatial.distance.kulsinski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.mahalanobis.html">5.6.1.19. scipy.spatial.distance.mahalanobis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.matching.html">5.6.1.20. scipy.spatial.distance.matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.minkowski.html">5.6.1.21. scipy.spatial.distance.minkowski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.rogerstanimoto.html">5.6.1.22. scipy.spatial.distance.rogerstanimoto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.russellrao.html">5.6.1.23. scipy.spatial.distance.russellrao</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.seuclidean.html">5.6.1.24. scipy.spatial.distance.seuclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sokalmichener.html">5.6.1.25. scipy.spatial.distance.sokalmichener</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sokalsneath.html">5.6.1.26. scipy.spatial.distance.sokalsneath</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sqeuclidean.html">5.6.1.27. scipy.spatial.distance.sqeuclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.wminkowski.html">5.6.1.28. scipy.spatial.distance.wminkowski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.yule.html">5.6.1.29. scipy.spatial.distance.yule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../special.html">5.7. Special functions (<code class="docutils literal"><span class="pre">scipy.special</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../special.html#error-handling">5.7.1. Error handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.special.errprint.html">5.7.1.1. scipy.special.errprint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.special.SpecialFunctionWarning.html">5.7.1.2. scipy.special.SpecialFunctionWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../special.html#available-functions">5.7.2. Available functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#airy-functions">5.7.2.1. Airy functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#elliptic-functions-and-integrals">5.7.2.2. Elliptic Functions and Integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#bessel-functions">5.7.2.3. Bessel Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#struve-functions">5.7.2.4. Struve Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#raw-statistical-functions">5.7.2.5. Raw Statistical Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#information-theory-functions">5.7.2.6. Information Theory Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#gamma-and-related-functions">5.7.2.7. Gamma and Related Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#error-function-and-fresnel-integrals">5.7.2.8. Error Function and Fresnel Integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#legendre-functions">5.7.2.9. Legendre Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#ellipsoidal-harmonics">5.7.2.10. Ellipsoidal Harmonics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#orthogonal-polynomials">5.7.2.11. Orthogonal polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#hypergeometric-functions">5.7.2.12. Hypergeometric Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#parabolic-cylinder-functions">5.7.2.13. Parabolic Cylinder Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#mathieu-and-related-functions">5.7.2.14. Mathieu and Related Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#spheroidal-wave-functions">5.7.2.15. Spheroidal Wave Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#kelvin-functions">5.7.2.16. Kelvin Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#combinatorics">5.7.2.17. Combinatorics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#other-special-functions">5.7.2.18. Other Special Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#convenience-functions">5.7.2.19. Convenience Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../stats.html">5.8. Statistical functions (<code class="docutils literal"><span class="pre">scipy.stats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.rv_continuous.html">5.8.1. scipy.stats.rv_continuous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.rv_discrete.html">5.8.2. scipy.stats.rv_discrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#continuous-distributions">5.8.3. Continuous distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.alpha.html">5.8.3.1. scipy.stats.alpha</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anglit.html">5.8.3.2. scipy.stats.anglit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.arcsine.html">5.8.3.3. scipy.stats.arcsine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.beta.html">5.8.3.4. scipy.stats.beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.betaprime.html">5.8.3.5. scipy.stats.betaprime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bradford.html">5.8.3.6. scipy.stats.bradford</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.burr.html">5.8.3.7. scipy.stats.burr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cauchy.html">5.8.3.8. scipy.stats.cauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi.html">5.8.3.9. scipy.stats.chi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi2.html">5.8.3.10. scipy.stats.chi2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cosine.html">5.8.3.11. scipy.stats.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dgamma.html">5.8.3.12. scipy.stats.dgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dweibull.html">5.8.3.13. scipy.stats.dweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.erlang.html">5.8.3.14. scipy.stats.erlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.expon.html">5.8.3.15. scipy.stats.expon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponnorm.html">5.8.3.16. scipy.stats.exponnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponweib.html">5.8.3.17. scipy.stats.exponweib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponpow.html">5.8.3.18. scipy.stats.exponpow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f.html">5.8.3.19. scipy.stats.f</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fatiguelife.html">5.8.3.20. scipy.stats.fatiguelife</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fisk.html">5.8.3.21. scipy.stats.fisk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.foldcauchy.html">5.8.3.22. scipy.stats.foldcauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.foldnorm.html">5.8.3.23. scipy.stats.foldnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.frechet_r.html">5.8.3.24. scipy.stats.frechet_r</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.frechet_l.html">5.8.3.25. scipy.stats.frechet_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genlogistic.html">5.8.3.26. scipy.stats.genlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gennorm.html">5.8.3.27. scipy.stats.gennorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genpareto.html">5.8.3.28. scipy.stats.genpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genexpon.html">5.8.3.29. scipy.stats.genexpon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genextreme.html">5.8.3.30. scipy.stats.genextreme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gausshyper.html">5.8.3.31. scipy.stats.gausshyper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gamma.html">5.8.3.32. scipy.stats.gamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gengamma.html">5.8.3.33. scipy.stats.gengamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genhalflogistic.html">5.8.3.34. scipy.stats.genhalflogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gilbrat.html">5.8.3.35. scipy.stats.gilbrat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gompertz.html">5.8.3.36. scipy.stats.gompertz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gumbel_r.html">5.8.3.37. scipy.stats.gumbel_r</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gumbel_l.html">5.8.3.38. scipy.stats.gumbel_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfcauchy.html">5.8.3.39. scipy.stats.halfcauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halflogistic.html">5.8.3.40. scipy.stats.halflogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfnorm.html">5.8.3.41. scipy.stats.halfnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfgennorm.html">5.8.3.42. scipy.stats.halfgennorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hypsecant.html">5.8.3.43. scipy.stats.hypsecant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invgamma.html">5.8.3.44. scipy.stats.invgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invgauss.html">5.8.3.45. scipy.stats.invgauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invweibull.html">5.8.3.46. scipy.stats.invweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.johnsonsb.html">5.8.3.47. scipy.stats.johnsonsb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.johnsonsu.html">5.8.3.48. scipy.stats.johnsonsu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ksone.html">5.8.3.49. scipy.stats.ksone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstwobign.html">5.8.3.50. scipy.stats.kstwobign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.laplace.html">5.8.3.51. scipy.stats.laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy.html">5.8.3.52. scipy.stats.levy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy_l.html">5.8.3.53. scipy.stats.levy_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy_stable.html">5.8.3.54. scipy.stats.levy_stable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.logistic.html">5.8.3.55. scipy.stats.logistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.loggamma.html">5.8.3.56. scipy.stats.loggamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.loglaplace.html">5.8.3.57. scipy.stats.loglaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.lognorm.html">5.8.3.58. scipy.stats.lognorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.lomax.html">5.8.3.59. scipy.stats.lomax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.maxwell.html">5.8.3.60. scipy.stats.maxwell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mielke.html">5.8.3.61. scipy.stats.mielke</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nakagami.html">5.8.3.62. scipy.stats.nakagami</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ncx2.html">5.8.3.63. scipy.stats.ncx2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ncf.html">5.8.3.64. scipy.stats.ncf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nct.html">5.8.3.65. scipy.stats.nct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.norm.html">5.8.3.66. scipy.stats.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pareto.html">5.8.3.67. scipy.stats.pareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pearson3.html">5.8.3.68. scipy.stats.pearson3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powerlaw.html">5.8.3.69. scipy.stats.powerlaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powerlognorm.html">5.8.3.70. scipy.stats.powerlognorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powernorm.html">5.8.3.71. scipy.stats.powernorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rdist.html">5.8.3.72. scipy.stats.rdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.reciprocal.html">5.8.3.73. scipy.stats.reciprocal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rayleigh.html">5.8.3.74. scipy.stats.rayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rice.html">5.8.3.75. scipy.stats.rice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.recipinvgauss.html">5.8.3.76. scipy.stats.recipinvgauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.semicircular.html">5.8.3.77. scipy.stats.semicircular</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.t.html">5.8.3.78. scipy.stats.t</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.triang.html">5.8.3.79. scipy.stats.triang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.truncexpon.html">5.8.3.80. scipy.stats.truncexpon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.truncnorm.html">5.8.3.81. scipy.stats.truncnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tukeylambda.html">5.8.3.82. scipy.stats.tukeylambda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.uniform.html">5.8.3.83. scipy.stats.uniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.vonmises.html">5.8.3.84. scipy.stats.vonmises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.vonmises_line.html">5.8.3.85. scipy.stats.vonmises_line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wald.html">5.8.3.86. scipy.stats.wald</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.weibull_min.html">5.8.3.87. scipy.stats.weibull_min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.weibull_max.html">5.8.3.88. scipy.stats.weibull_max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wrapcauchy.html">5.8.3.89. scipy.stats.wrapcauchy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#multivariate-distributions">5.8.4. Multivariate distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.multivariate_normal.html">5.8.4.1. scipy.stats.multivariate_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.matrix_normal.html">5.8.4.2. scipy.stats.matrix_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dirichlet.html">5.8.4.3. scipy.stats.dirichlet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wishart.html">5.8.4.4. scipy.stats.wishart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invwishart.html">5.8.4.5. scipy.stats.invwishart</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#discrete-distributions">5.8.5. Discrete distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bernoulli.html">5.8.5.1. scipy.stats.bernoulli</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binom.html">5.8.5.2. scipy.stats.binom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boltzmann.html">5.8.5.3. scipy.stats.boltzmann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dlaplace.html">5.8.5.4. scipy.stats.dlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.geom.html">5.8.5.5. scipy.stats.geom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hypergeom.html">5.8.5.6. scipy.stats.hypergeom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.logser.html">5.8.5.7. scipy.stats.logser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nbinom.html">5.8.5.8. scipy.stats.nbinom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.planck.html">5.8.5.9. scipy.stats.planck</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.poisson.html">5.8.5.10. scipy.stats.poisson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.randint.html">5.8.5.11. scipy.stats.randint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skellam.html">5.8.5.12. scipy.stats.skellam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zipf.html">5.8.5.13. scipy.stats.zipf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#statistical-functions">5.8.6. Statistical functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.describe.html">5.8.6.1. scipy.stats.describe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gmean.html">5.8.6.2. scipy.stats.gmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hmean.html">5.8.6.3. scipy.stats.hmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kurtosis.html">5.8.6.4. scipy.stats.kurtosis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kurtosistest.html">5.8.6.5. scipy.stats.kurtosistest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mode.html">5.8.6.6. scipy.stats.mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.moment.html">5.8.6.7. scipy.stats.moment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.normaltest.html">5.8.6.8. scipy.stats.normaltest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skew.html">5.8.6.9. scipy.stats.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skewtest.html">5.8.6.10. scipy.stats.skewtest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstat.html">5.8.6.11. scipy.stats.kstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstatvar.html">5.8.6.12. scipy.stats.kstatvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmean.html">5.8.6.13. scipy.stats.tmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tvar.html">5.8.6.14. scipy.stats.tvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmin.html">5.8.6.15. scipy.stats.tmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmax.html">5.8.6.16. scipy.stats.tmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tstd.html">5.8.6.17. scipy.stats.tstd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tsem.html">5.8.6.18. scipy.stats.tsem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanmean.html">5.8.6.19. scipy.stats.nanmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanstd.html">5.8.6.20. scipy.stats.nanstd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanmedian.html">5.8.6.21. scipy.stats.nanmedian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.variation.html">5.8.6.22. scipy.stats.variation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.find_repeats.html">5.8.6.23. scipy.stats.find_repeats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trim_mean.html">5.8.6.24. scipy.stats.trim_mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cumfreq.html">5.8.6.25. scipy.stats.cumfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.histogram2.html">5.8.6.26. scipy.stats.histogram2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.histogram.html">5.8.6.27. scipy.stats.histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.itemfreq.html">5.8.6.28. scipy.stats.itemfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.percentileofscore.html">5.8.6.29. scipy.stats.percentileofscore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.scoreatpercentile.html">5.8.6.30. scipy.stats.scoreatpercentile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.relfreq.html">5.8.6.31. scipy.stats.relfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic.html">5.8.6.32. scipy.stats.binned_statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic_2d.html">5.8.6.33. scipy.stats.binned_statistic_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic_dd.html">5.8.6.34. scipy.stats.binned_statistic_dd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.obrientransform.html">5.8.6.35. scipy.stats.obrientransform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.signaltonoise.html">5.8.6.36. scipy.stats.signaltonoise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bayes_mvs.html">5.8.6.37. scipy.stats.bayes_mvs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mvsdist.html">5.8.6.38. scipy.stats.mvsdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.sem.html">5.8.6.39. scipy.stats.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zmap.html">5.8.6.40. scipy.stats.zmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zscore.html">5.8.6.41. scipy.stats.zscore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.sigmaclip.html">5.8.6.42. scipy.stats.sigmaclip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.threshold.html">5.8.6.43. scipy.stats.threshold</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trimboth.html">5.8.6.44. scipy.stats.trimboth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trim1.html">5.8.6.45. scipy.stats.trim1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f_oneway.html">5.8.6.46. scipy.stats.f_oneway</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pearsonr.html">5.8.6.47. scipy.stats.pearsonr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.spearmanr.html">5.8.6.48. scipy.stats.spearmanr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pointbiserialr.html">5.8.6.49. scipy.stats.pointbiserialr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kendalltau.html">5.8.6.50. scipy.stats.kendalltau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.linregress.html">5.8.6.51. scipy.stats.linregress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.theilslopes.html">5.8.6.52. scipy.stats.theilslopes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f_value.html">5.8.6.53. scipy.stats.f_value</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_1samp.html">5.8.6.54. scipy.stats.ttest_1samp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_ind.html">5.8.6.55. scipy.stats.ttest_ind</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_ind_from_stats.html">5.8.6.56. scipy.stats.ttest_ind_from_stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_rel.html">5.8.6.57. scipy.stats.ttest_rel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstest.html">5.8.6.58. scipy.stats.kstest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chisquare.html">5.8.6.59. scipy.stats.chisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.power_divergence.html">5.8.6.60. scipy.stats.power_divergence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ks_2samp.html">5.8.6.61. scipy.stats.ks_2samp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mannwhitneyu.html">5.8.6.62. scipy.stats.mannwhitneyu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tiecorrect.html">5.8.6.63. scipy.stats.tiecorrect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rankdata.html">5.8.6.64. scipy.stats.rankdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ranksums.html">5.8.6.65. scipy.stats.ranksums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wilcoxon.html">5.8.6.66. scipy.stats.wilcoxon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kruskal.html">5.8.6.67. scipy.stats.kruskal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.friedmanchisquare.html">5.8.6.68. scipy.stats.friedmanchisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.combine_pvalues.html">5.8.6.69. scipy.stats.combine_pvalues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ss.html">5.8.6.70. scipy.stats.ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.square_of_sums.html">5.8.6.71. scipy.stats.square_of_sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.jarque_bera.html">5.8.6.72. scipy.stats.jarque_bera</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ansari.html">5.8.6.73. scipy.stats.ansari</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bartlett.html">5.8.6.74. scipy.stats.bartlett</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levene.html">5.8.6.75. scipy.stats.levene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.shapiro.html">5.8.6.76. scipy.stats.shapiro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anderson.html">5.8.6.77. scipy.stats.anderson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anderson_ksamp.html">5.8.6.78. scipy.stats.anderson_ksamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binom_test.html">5.8.6.79. scipy.stats.binom_test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fligner.html">5.8.6.80. scipy.stats.fligner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.median_test.html">5.8.6.81. scipy.stats.median_test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mood.html">5.8.6.82. scipy.stats.mood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox.html">5.8.6.83. scipy.stats.boxcox</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_normmax.html">5.8.6.84. scipy.stats.boxcox_normmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_llf.html">5.8.6.85. scipy.stats.boxcox_llf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.entropy.html">5.8.6.86. scipy.stats.entropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chisqprob.html">5.8.6.87. scipy.stats.chisqprob</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.betai.html">5.8.6.88. scipy.stats.betai</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#circular-statistical-functions">5.8.7. Circular statistical functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circmean.html">5.8.7.1. scipy.stats.circmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circvar.html">5.8.7.2. scipy.stats.circvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circstd.html">5.8.7.3. scipy.stats.circstd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#contingency-table-functions">5.8.8. Contingency table functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi2_contingency.html">5.8.8.1. scipy.stats.chi2_contingency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.contingency.expected_freq.html">5.8.8.2. scipy.stats.contingency.expected_freq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.contingency.margins.html">5.8.8.3. scipy.stats.contingency.margins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fisher_exact.html">5.8.8.4. scipy.stats.fisher_exact</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#plot-tests">5.8.9. Plot-tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ppcc_max.html">5.8.9.1. scipy.stats.ppcc_max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ppcc_plot.html">5.8.9.2. scipy.stats.ppcc_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.probplot.html">5.8.9.3. scipy.stats.probplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_normplot.html">5.8.9.4. scipy.stats.boxcox_normplot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#masked-statistics-functions">5.8.10. Masked statistics functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../stats.mstats.html">5.8.10.1. Statistical functions for masked arrays (<code class="docutils literal"><span class="pre">scipy.stats.mstats</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#univariate-and-multivariate-kernel-density-estimation-scipy-stats-kde">5.8.11. Univariate and multivariate kernel density estimation (<code class="docutils literal"><span class="pre">scipy.stats.kde</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gaussian_kde.html">5.8.11.1. scipy.stats.gaussian_kde</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../stats.mstats.html">5.8.10.1. Statistical functions for masked arrays (<code class="docutils literal"><span class="pre">scipy.stats.mstats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.argstoarray.html">5.8.10.1.1. scipy.stats.mstats.argstoarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.betai.html">5.8.10.1.2. scipy.stats.mstats.betai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.chisquare.html">5.8.10.1.3. scipy.stats.mstats.chisquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.count_tied_groups.html">5.8.10.1.4. scipy.stats.mstats.count_tied_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.describe.html">5.8.10.1.5. scipy.stats.mstats.describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.f_oneway.html">5.8.10.1.6. scipy.stats.mstats.f_oneway</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.f_value_wilks_lambda.html">5.8.10.1.7. scipy.stats.mstats.f_value_wilks_lambda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.find_repeats.html">5.8.10.1.8. scipy.stats.mstats.find_repeats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.friedmanchisquare.html">5.8.10.1.9. scipy.stats.mstats.friedmanchisquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kendalltau.html">5.8.10.1.10. scipy.stats.mstats.kendalltau</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kendalltau_seasonal.html">5.8.10.1.11. scipy.stats.mstats.kendalltau_seasonal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kruskalwallis.html">5.8.10.1.12. scipy.stats.mstats.kruskalwallis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ks_twosamp.html">5.8.10.1.13. scipy.stats.mstats.ks_twosamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kurtosis.html">5.8.10.1.14. scipy.stats.mstats.kurtosis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kurtosistest.html">5.8.10.1.15. scipy.stats.mstats.kurtosistest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.linregress.html">5.8.10.1.16. scipy.stats.mstats.linregress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mannwhitneyu.html">5.8.10.1.17. scipy.stats.mstats.mannwhitneyu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.plotting_positions.html">5.8.10.1.18. scipy.stats.mstats.plotting_positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mode.html">5.8.10.1.19. scipy.stats.mstats.mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.moment.html">5.8.10.1.20. scipy.stats.mstats.moment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mquantiles.html">5.8.10.1.21. scipy.stats.mstats.mquantiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.msign.html">5.8.10.1.22. scipy.stats.mstats.msign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.normaltest.html">5.8.10.1.23. scipy.stats.mstats.normaltest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.obrientransform.html">5.8.10.1.24. scipy.stats.mstats.obrientransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.pearsonr.html">5.8.10.1.25. scipy.stats.mstats.pearsonr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.plotting_positions.html">5.8.10.1.18. scipy.stats.mstats.plotting_positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.pointbiserialr.html">5.8.10.1.26. scipy.stats.mstats.pointbiserialr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.rankdata.html">5.8.10.1.27. scipy.stats.mstats.rankdata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.scoreatpercentile.html">5.8.10.1.28. scipy.stats.mstats.scoreatpercentile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.sem.html">5.8.10.1.29. scipy.stats.mstats.sem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.signaltonoise.html">5.8.10.1.30. scipy.stats.mstats.signaltonoise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.skew.html">5.8.10.1.31. scipy.stats.mstats.skew</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.skewtest.html">5.8.10.1.32. scipy.stats.mstats.skewtest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.spearmanr.html">5.8.10.1.33. scipy.stats.mstats.spearmanr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.theilslopes.html">5.8.10.1.34. scipy.stats.mstats.theilslopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.threshold.html">5.8.10.1.35. scipy.stats.mstats.threshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmax.html">5.8.10.1.36. scipy.stats.mstats.tmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmean.html">5.8.10.1.37. scipy.stats.mstats.tmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmin.html">5.8.10.1.38. scipy.stats.mstats.tmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trim.html">5.8.10.1.39. scipy.stats.mstats.trim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trima.html">5.8.10.1.40. scipy.stats.mstats.trima</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimboth.html">5.8.10.1.41. scipy.stats.mstats.trimboth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_stde.html">5.8.10.1.42. scipy.stats.mstats.trimmed_stde</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimr.html">5.8.10.1.43. scipy.stats.mstats.trimr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimtail.html">5.8.10.1.44. scipy.stats.mstats.trimtail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tsem.html">5.8.10.1.45. scipy.stats.mstats.tsem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_onesamp.html">5.8.10.1.46. scipy.stats.mstats.ttest_onesamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_ind.html">5.8.10.1.47. scipy.stats.mstats.ttest_ind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_onesamp.html">5.8.10.1.46. scipy.stats.mstats.ttest_onesamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_rel.html">5.8.10.1.48. scipy.stats.mstats.ttest_rel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tvar.html">5.8.10.1.49. scipy.stats.mstats.tvar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.variation.html">5.8.10.1.50. scipy.stats.mstats.variation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.winsorize.html">5.8.10.1.51. scipy.stats.mstats.winsorize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.zmap.html">5.8.10.1.52. scipy.stats.mstats.zmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.zscore.html">5.8.10.1.53. scipy.stats.mstats.zscore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.compare_medians_ms.html">5.8.10.1.54. scipy.stats.mstats.compare_medians_ms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.gmean.html">5.8.10.1.55. scipy.stats.mstats.gmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdmedian.html">5.8.10.1.56. scipy.stats.mstats.hdmedian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdquantiles.html">5.8.10.1.57. scipy.stats.mstats.hdquantiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdquantiles_sd.html">5.8.10.1.58. scipy.stats.mstats.hdquantiles_sd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hmean.html">5.8.10.1.59. scipy.stats.mstats.hmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.idealfourths.html">5.8.10.1.60. scipy.stats.mstats.idealfourths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kruskal.html">5.8.10.1.61. scipy.stats.mstats.kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ks_2samp.html">5.8.10.1.62. scipy.stats.mstats.ks_2samp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.median_cihs.html">5.8.10.1.63. scipy.stats.mstats.median_cihs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.meppf.html">5.8.10.1.64. scipy.stats.mstats.meppf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mjci.html">5.8.10.1.65. scipy.stats.mstats.mjci</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mquantiles_cimj.html">5.8.10.1.66. scipy.stats.mstats.mquantiles_cimj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.rsh.html">5.8.10.1.67. scipy.stats.mstats.rsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.sen_seasonal_slopes.html">5.8.10.1.68. scipy.stats.mstats.sen_seasonal_slopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_mean.html">5.8.10.1.69. scipy.stats.mstats.trimmed_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_mean_ci.html">5.8.10.1.70. scipy.stats.mstats.trimmed_mean_ci</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_std.html">5.8.10.1.71. scipy.stats.mstats.trimmed_std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_var.html">5.8.10.1.72. scipy.stats.mstats.trimmed_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_1samp.html">5.8.10.1.73. scipy.stats.mstats.ttest_1samp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../weave.html">5.9. C/C++ integration (<code class="docutils literal"><span class="pre">scipy.weave</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../weave.html#c-c-integration">5.9.1. C/C++ integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.inline.html">5.9.2. scipy.weave.inline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.blitz.html">5.9.3. scipy.weave.blitz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.ext_tools.html">5.9.4. scipy.weave.ext_tools</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Scipy API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>scipy.cluster.hierarchy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for scipy.cluster.hierarchy</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">========================================================</span>
<span class="sd">Hierarchical clustering (:mod:`scipy.cluster.hierarchy`)</span>
<span class="sd">========================================================</span>

<span class="sd">.. currentmodule:: scipy.cluster.hierarchy</span>

<span class="sd">These functions cut hierarchical clusterings into flat clusterings</span>
<span class="sd">or find the roots of the forest formed by a cut by providing the flat</span>
<span class="sd">cluster ids of each observation.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   fcluster</span>
<span class="sd">   fclusterdata</span>
<span class="sd">   leaders</span>

<span class="sd">These are routines for agglomerative clustering.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   linkage</span>
<span class="sd">   single</span>
<span class="sd">   complete</span>
<span class="sd">   average</span>
<span class="sd">   weighted</span>
<span class="sd">   centroid</span>
<span class="sd">   median</span>
<span class="sd">   ward</span>

<span class="sd">These routines compute statistics on hierarchies.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   cophenet</span>
<span class="sd">   from_mlab_linkage</span>
<span class="sd">   inconsistent</span>
<span class="sd">   maxinconsts</span>
<span class="sd">   maxdists</span>
<span class="sd">   maxRstat</span>
<span class="sd">   to_mlab_linkage</span>

<span class="sd">Routines for visualizing flat clusters.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   dendrogram</span>

<span class="sd">These are data structures and routines for representing hierarchies as</span>
<span class="sd">tree objects.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   ClusterNode</span>
<span class="sd">   leaves_list</span>
<span class="sd">   to_tree</span>
<span class="sd">   cut_tree</span>

<span class="sd">These are predicates for checking the validity of linkage and</span>
<span class="sd">inconsistency matrices as well as for checking isomorphism of two</span>
<span class="sd">flat cluster assignments.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   is_valid_im</span>
<span class="sd">   is_valid_linkage</span>
<span class="sd">   is_isomorphic</span>
<span class="sd">   is_monotonic</span>
<span class="sd">   correspond</span>
<span class="sd">   num_obs_linkage</span>

<span class="sd">Utility routines for plotting:</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   set_link_color_palette</span>

<span class="sd">References</span>
<span class="sd">----------</span>

<span class="sd">.. [1] &quot;Statistics toolbox.&quot; API Reference Documentation. The MathWorks.</span>
<span class="sd">   http://www.mathworks.com/access/helpdesk/help/toolbox/stats/.</span>
<span class="sd">   Accessed October 1, 2007.</span>

<span class="sd">.. [2] &quot;Hierarchical clustering.&quot; API Reference Documentation.</span>
<span class="sd">   The Wolfram Research, Inc.</span>
<span class="sd">   http://reference.wolfram.com/mathematica/HierarchicalClustering/tutorial/</span>
<span class="sd">   HierarchicalClustering.html.</span>
<span class="sd">   Accessed October 1, 2007.</span>

<span class="sd">.. [3] Gower, JC and Ross, GJS. &quot;Minimum Spanning Trees and Single Linkage</span>
<span class="sd">   Cluster Analysis.&quot; Applied Statistics. 18(1): pp. 54--64. 1969.</span>

<span class="sd">.. [4] Ward Jr, JH. &quot;Hierarchical grouping to optimize an objective</span>
<span class="sd">   function.&quot; Journal of the American Statistical Association. 58(301):</span>
<span class="sd">   pp. 236--44. 1963.</span>

<span class="sd">.. [5] Johnson, SC. &quot;Hierarchical clustering schemes.&quot; Psychometrika.</span>
<span class="sd">   32(2): pp. 241--54. 1966.</span>

<span class="sd">.. [6] Sneath, PH and Sokal, RR. &quot;Numerical taxonomy.&quot; Nature. 193: pp.</span>
<span class="sd">   855--60. 1962.</span>

<span class="sd">.. [7] Batagelj, V. &quot;Comparing resemblance measures.&quot; Journal of</span>
<span class="sd">   Classification. 12: pp. 73--90. 1995.</span>

<span class="sd">.. [8] Sokal, RR and Michener, CD. &quot;A statistical method for evaluating</span>
<span class="sd">   systematic relationships.&quot; Scientific Bulletins. 38(22):</span>
<span class="sd">   pp. 1409--38. 1958.</span>

<span class="sd">.. [9] Edelbrock, C. &quot;Mixture model tests of hierarchical clustering</span>
<span class="sd">   algorithms: the problem of classifying everybody.&quot; Multivariate</span>
<span class="sd">   Behavioral Research. 14: pp. 367--84. 1979.</span>

<span class="sd">.. [10] Jain, A., and Dubes, R., &quot;Algorithms for Clustering Data.&quot;</span>
<span class="sd">   Prentice-Hall. Englewood Cliffs, NJ. 1988.</span>

<span class="sd">.. [11] Fisher, RA &quot;The use of multiple measurements in taxonomic</span>
<span class="sd">   problems.&quot; Annals of Eugenics, 7(2): 179-188. 1936</span>


<span class="sd">* MATLAB and MathWorks are registered trademarks of The MathWorks, Inc.</span>

<span class="sd">* Mathematica is a registered trademark of The Wolfram Research, Inc.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span>

<span class="c1"># Copyright (C) Damian Eads, 2007-2008. New BSD License.</span>

<span class="c1"># hierarchy.py (derived from cluster.py, http://scipy-cluster.googlecode.com)</span>
<span class="c1">#</span>
<span class="c1"># Author: Damian Eads</span>
<span class="c1"># Date:   September 22, 2007</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2007, 2008, Damian Eads</span>
<span class="c1">#</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions</span>
<span class="c1"># are met:</span>
<span class="c1">#   - Redistributions of source code must retain the above</span>
<span class="c1">#     copyright notice, this list of conditions and the</span>
<span class="c1">#     following disclaimer.</span>
<span class="c1">#   - Redistributions in binary form must reproduce the above copyright</span>
<span class="c1">#     notice, this list of conditions and the following disclaimer</span>
<span class="c1">#     in the documentation and/or other materials provided with the</span>
<span class="c1">#     distribution.</span>
<span class="c1">#   - Neither the name of the author nor the names of its</span>
<span class="c1">#     contributors may be used to endorse or promote products derived</span>
<span class="c1">#     from this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="c1"># &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="c1"># LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="c1"># A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="c1"># OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c1"># SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="c1"># LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="c1"># DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="c1"># THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="c1"># (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">bisect</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_hierarchy</span>
<span class="kn">import</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">as</span> <span class="nn">distance</span>

<span class="kn">from</span> <span class="nn">scipy._lib.six</span> <span class="kn">import</span> <span class="n">string_types</span>
<span class="kn">from</span> <span class="nn">scipy._lib.six</span> <span class="kn">import</span> <span class="nb">xrange</span>

<span class="n">_cpy_non_euclid_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;single&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;complete&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                           <span class="s1">&#39;weighted&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
<span class="n">_cpy_euclid_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ward&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="n">_cpy_linkage_methods</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">_cpy_non_euclid_methods</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
    <span class="nb">set</span><span class="p">(</span><span class="n">_cpy_euclid_methods</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ClusterNode&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;centroid&#39;</span><span class="p">,</span> <span class="s1">&#39;complete&#39;</span><span class="p">,</span> <span class="s1">&#39;cophenet&#39;</span><span class="p">,</span>
           <span class="s1">&#39;correspond&#39;</span><span class="p">,</span> <span class="s1">&#39;cut_tree&#39;</span><span class="p">,</span> <span class="s1">&#39;dendrogram&#39;</span><span class="p">,</span> <span class="s1">&#39;fcluster&#39;</span><span class="p">,</span> <span class="s1">&#39;fclusterdata&#39;</span><span class="p">,</span>
           <span class="s1">&#39;from_mlab_linkage&#39;</span><span class="p">,</span> <span class="s1">&#39;inconsistent&#39;</span><span class="p">,</span> <span class="s1">&#39;is_isomorphic&#39;</span><span class="p">,</span>
           <span class="s1">&#39;is_monotonic&#39;</span><span class="p">,</span> <span class="s1">&#39;is_valid_im&#39;</span><span class="p">,</span> <span class="s1">&#39;is_valid_linkage&#39;</span><span class="p">,</span> <span class="s1">&#39;leaders&#39;</span><span class="p">,</span>
           <span class="s1">&#39;leaves_list&#39;</span><span class="p">,</span> <span class="s1">&#39;linkage&#39;</span><span class="p">,</span> <span class="s1">&#39;maxRstat&#39;</span><span class="p">,</span> <span class="s1">&#39;maxdists&#39;</span><span class="p">,</span> <span class="s1">&#39;maxinconsts&#39;</span><span class="p">,</span>
           <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;num_obs_linkage&#39;</span><span class="p">,</span> <span class="s1">&#39;set_link_color_palette&#39;</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span>
           <span class="s1">&#39;to_mlab_linkage&#39;</span><span class="p">,</span> <span class="s1">&#39;to_tree&#39;</span><span class="p">,</span> <span class="s1">&#39;ward&#39;</span><span class="p">,</span> <span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_warning</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;scipy.cluster: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">s</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_copy_array_if_base_present</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copies the array if its base points to a parent array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubsctype</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span>


<span class="k">def</span> <span class="nf">_copy_arrays_if_base_present</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Accepts a tuple of arrays T. Copies the array T[i] if its base array</span>
<span class="sd">    points to an actual array. Otherwise, the reference is just copied.</span>
<span class="sd">    This is useful if the arrays are being passed to a C function that</span>
<span class="sd">    does not do proper striding.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">_copy_array_if_base_present</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">l</span>


<span class="k">def</span> <span class="nf">_randdm</span><span class="p">(</span><span class="n">pnts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Generates a random distance matrix stored in condensed form. A</span>
<span class="sd">        pnts * (pnts - 1) / 2 sized vector is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pnts</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">pnts</span> <span class="o">*</span> <span class="p">(</span><span class="n">pnts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of points in the distance matrix &quot;</span>
                         <span class="s2">&quot;must be at least 2.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span>


<div class="viewcode-block" id="single"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.single.html#scipy.cluster.hierarchy.single">[docs]</a><span class="k">def</span> <span class="nf">single</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs single/min/nearest linkage on the condensed distance matrix ``y``</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        The upper triangular of the distance matrix. The result of</span>
<span class="sd">        ``pdist`` is returned in this form.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The linkage matrix.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage: for advanced creation of hierarchical clusterings.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="complete"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.complete.html#scipy.cluster.hierarchy.complete">[docs]</a><span class="k">def</span> <span class="nf">complete</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs complete/max/farthest point linkage on a condensed distance matrix</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        The upper triangular of the distance matrix. The result of</span>
<span class="sd">        ``pdist`` is returned in this form.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        A linkage matrix containing the hierarchical clustering. See</span>
<span class="sd">        the ``linkage`` function documentation for more information</span>
<span class="sd">        on its structure.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;complete&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="average"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.average.html#scipy.cluster.hierarchy.average">[docs]</a><span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs average/UPGMA linkage on a condensed distance matrix</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        The upper triangular of the distance matrix. The result of</span>
<span class="sd">        ``pdist`` is returned in this form.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        A linkage matrix containing the hierarchical clustering. See</span>
<span class="sd">        the ``linkage`` function documentation for more information</span>
<span class="sd">        on its structure.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage: for advanced creation of hierarchical clusterings.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="weighted"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.weighted.html#scipy.cluster.hierarchy.weighted">[docs]</a><span class="k">def</span> <span class="nf">weighted</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs weighted/WPGMA linkage on the condensed distance matrix.</span>

<span class="sd">    See ``linkage`` for more information on the return</span>
<span class="sd">    structure and algorithm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        The upper triangular of the distance matrix. The result of</span>
<span class="sd">        ``pdist`` is returned in this form.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        A linkage matrix containing the hierarchical clustering. See</span>
<span class="sd">        the ``linkage`` function documentation for more information</span>
<span class="sd">        on its structure.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage : for advanced creation of hierarchical clusterings.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="centroid"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.centroid.html#scipy.cluster.hierarchy.centroid">[docs]</a><span class="k">def</span> <span class="nf">centroid</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs centroid/UPGMC linkage.</span>

<span class="sd">    See ``linkage`` for more information on the return structure</span>
<span class="sd">    and algorithm.</span>

<span class="sd">    The following are common calling conventions:</span>

<span class="sd">    1. ``Z = centroid(y)``</span>

<span class="sd">       Performs centroid/UPGMC linkage on the condensed distance</span>
<span class="sd">       matrix ``y``.  See ``linkage`` for more information on the return</span>
<span class="sd">       structure and algorithm.</span>

<span class="sd">    2. ``Z = centroid(X)``</span>

<span class="sd">       Performs centroid/UPGMC linkage on the observation matrix ``X``</span>
<span class="sd">       using Euclidean distance as the distance metric. See ``linkage``</span>
<span class="sd">       for more information on the return structure and algorithm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        A condensed or redundant distance matrix. A condensed</span>
<span class="sd">        distance matrix is a flat array containing the upper</span>
<span class="sd">        triangular of the distance matrix. This is the form that</span>
<span class="sd">        ``pdist`` returns. Alternatively, a collection of</span>
<span class="sd">        m observation vectors in n dimensions may be passed as</span>
<span class="sd">        a m by n array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        A linkage matrix containing the hierarchical clustering. See</span>
<span class="sd">        the ``linkage`` function documentation for more information</span>
<span class="sd">        on its structure.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage: for advanced creation of hierarchical clusterings.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;centroid&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="median"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.median.html#scipy.cluster.hierarchy.median">[docs]</a><span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs median/WPGMC linkage.</span>

<span class="sd">    See ``linkage`` for more information on the return structure</span>
<span class="sd">    and algorithm.</span>

<span class="sd">     The following are common calling conventions:</span>

<span class="sd">     1. ``Z = median(y)``</span>

<span class="sd">        Performs median/WPGMC linkage on the condensed distance matrix</span>
<span class="sd">        ``y``.  See ``linkage`` for more information on the return</span>
<span class="sd">        structure and algorithm.</span>

<span class="sd">     2. ``Z = median(X)``</span>

<span class="sd">        Performs median/WPGMC linkage on the observation matrix ``X``</span>
<span class="sd">        using Euclidean distance as the distance metric. See linkage</span>
<span class="sd">        for more information on the return structure and algorithm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        A condensed or redundant distance matrix. A condensed</span>
<span class="sd">        distance matrix is a flat array containing the upper</span>
<span class="sd">        triangular of the distance matrix. This is the form that</span>
<span class="sd">        ``pdist`` returns. Alternatively, a collection of</span>
<span class="sd">        m observation vectors in n dimensions may be passed as</span>
<span class="sd">        a m by n array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as a linkage matrix.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage: for advanced creation of hierarchical clusterings.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ward"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.ward.html#scipy.cluster.hierarchy.ward">[docs]</a><span class="k">def</span> <span class="nf">ward</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs Ward&#39;s linkage on a condensed or redundant distance matrix.</span>

<span class="sd">    See linkage for more information on the return structure</span>
<span class="sd">    and algorithm.</span>

<span class="sd">    The following are common calling conventions:</span>

<span class="sd">    1. ``Z = ward(y)``</span>
<span class="sd">       Performs Ward&#39;s linkage on the condensed distance matrix ``Z``. See</span>
<span class="sd">       linkage for more information on the return structure and</span>
<span class="sd">       algorithm.</span>

<span class="sd">    2. ``Z = ward(X)``</span>
<span class="sd">       Performs Ward&#39;s linkage on the observation matrix ``X`` using</span>
<span class="sd">       Euclidean distance as the distance metric. See linkage for more</span>
<span class="sd">       information on the return structure and algorithm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        A condensed or redundant distance matrix. A condensed</span>
<span class="sd">        distance matrix is a flat array containing the upper</span>
<span class="sd">        triangular of the distance matrix. This is the form that</span>
<span class="sd">        ``pdist`` returns. Alternatively, a collection of</span>
<span class="sd">        m observation vectors in n dimensions may be passed as</span>
<span class="sd">        a m by n array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as a linkage matrix.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage: for advanced creation of hierarchical clusterings.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="linkage"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.linkage.html#scipy.cluster.hierarchy.linkage">[docs]</a><span class="k">def</span> <span class="nf">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs hierarchical/agglomerative clustering on the condensed</span>
<span class="sd">    distance matrix y.</span>

<span class="sd">    y must be a :math:`{n \\choose 2}` sized</span>
<span class="sd">    vector where n is the number of original observations paired</span>
<span class="sd">    in the distance matrix. The behavior of this function is very</span>
<span class="sd">    similar to the MATLAB linkage function.</span>

<span class="sd">    An :math:`(n-1)` by 4  matrix ``Z`` is returned. At the</span>
<span class="sd">    :math:`i`-th iteration, clusters with indices ``Z[i, 0]`` and</span>
<span class="sd">    ``Z[i, 1]`` are combined to form cluster :math:`n + i`. A</span>
<span class="sd">    cluster with an index less than :math:`n` corresponds to one of</span>
<span class="sd">    the :math:`n` original observations. The distance between</span>
<span class="sd">    clusters ``Z[i, 0]`` and ``Z[i, 1]`` is given by ``Z[i, 2]``. The</span>
<span class="sd">    fourth value ``Z[i, 3]`` represents the number of original</span>
<span class="sd">    observations in the newly formed cluster.</span>

<span class="sd">    The following linkage methods are used to compute the distance</span>
<span class="sd">    :math:`d(s, t)` between two clusters :math:`s` and</span>
<span class="sd">    :math:`t`. The algorithm begins with a forest of clusters that</span>
<span class="sd">    have yet to be used in the hierarchy being formed. When two</span>
<span class="sd">    clusters :math:`s` and :math:`t` from this forest are combined</span>
<span class="sd">    into a single cluster :math:`u`, :math:`s` and :math:`t` are</span>
<span class="sd">    removed from the forest, and :math:`u` is added to the</span>
<span class="sd">    forest. When only one cluster remains in the forest, the algorithm</span>
<span class="sd">    stops, and this cluster becomes the root.</span>

<span class="sd">    A distance matrix is maintained at each iteration. The ``d[i,j]``</span>
<span class="sd">    entry corresponds to the distance between cluster :math:`i` and</span>
<span class="sd">    :math:`j` in the original forest.</span>

<span class="sd">    At each iteration, the algorithm must update the distance matrix</span>
<span class="sd">    to reflect the distance of the newly formed cluster u with the</span>
<span class="sd">    remaining clusters in the forest.</span>

<span class="sd">    Suppose there are :math:`|u|` original observations</span>
<span class="sd">    :math:`u[0], \\ldots, u[|u|-1]` in cluster :math:`u` and</span>
<span class="sd">    :math:`|v|` original objects :math:`v[0], \\ldots, v[|v|-1]` in</span>
<span class="sd">    cluster :math:`v`. Recall :math:`s` and :math:`t` are</span>
<span class="sd">    combined to form cluster :math:`u`. Let :math:`v` be any</span>
<span class="sd">    remaining cluster in the forest that is not :math:`u`.</span>

<span class="sd">    The following are methods for calculating the distance between the</span>
<span class="sd">    newly formed cluster :math:`u` and each :math:`v`.</span>

<span class="sd">      * method=&#39;single&#39; assigns</span>

<span class="sd">        .. math::</span>
<span class="sd">           d(u,v) = \\min(dist(u[i],v[j]))</span>

<span class="sd">        for all points :math:`i` in cluster :math:`u` and</span>
<span class="sd">        :math:`j` in cluster :math:`v`. This is also known as the</span>
<span class="sd">        Nearest Point Algorithm.</span>

<span class="sd">      * method=&#39;complete&#39; assigns</span>

<span class="sd">        .. math::</span>
<span class="sd">           d(u, v) = \\max(dist(u[i],v[j]))</span>

<span class="sd">        for all points :math:`i` in cluster u and :math:`j` in</span>
<span class="sd">        cluster :math:`v`. This is also known by the Farthest Point</span>
<span class="sd">        Algorithm or Voor Hees Algorithm.</span>

<span class="sd">      * method=&#39;average&#39; assigns</span>

<span class="sd">        .. math::</span>
<span class="sd">           d(u,v) = \\sum_{ij} \\frac{d(u[i], v[j])}</span>
<span class="sd">                                   {(|u|*|v|)}</span>

<span class="sd">        for all points :math:`i` and :math:`j` where :math:`|u|`</span>
<span class="sd">        and :math:`|v|` are the cardinalities of clusters :math:`u`</span>
<span class="sd">        and :math:`v`, respectively. This is also called the UPGMA</span>
<span class="sd">        algorithm.</span>

<span class="sd">      * method=&#39;weighted&#39; assigns</span>

<span class="sd">        .. math::</span>
<span class="sd">           d(u,v) = (dist(s,v) + dist(t,v))/2</span>

<span class="sd">        where cluster u was formed with cluster s and t and v</span>
<span class="sd">        is a remaining cluster in the forest. (also called WPGMA)</span>

<span class="sd">      * method=&#39;centroid&#39; assigns</span>

<span class="sd">        .. math::</span>
<span class="sd">           dist(s,t) = ||c_s-c_t||_2</span>

<span class="sd">        where :math:`c_s` and :math:`c_t` are the centroids of</span>
<span class="sd">        clusters :math:`s` and :math:`t`, respectively. When two</span>
<span class="sd">        clusters :math:`s` and :math:`t` are combined into a new</span>
<span class="sd">        cluster :math:`u`, the new centroid is computed over all the</span>
<span class="sd">        original objects in clusters :math:`s` and :math:`t`. The</span>
<span class="sd">        distance then becomes the Euclidean distance between the</span>
<span class="sd">        centroid of :math:`u` and the centroid of a remaining cluster</span>
<span class="sd">        :math:`v` in the forest. This is also known as the UPGMC</span>
<span class="sd">        algorithm.</span>

<span class="sd">      * method=&#39;median&#39; assigns :math:`d(s,t)` like the ``centroid``</span>
<span class="sd">        method. When two clusters :math:`s` and :math:`t` are combined</span>
<span class="sd">        into a new cluster :math:`u`, the average of centroids s and t</span>
<span class="sd">        give the new centroid :math:`u`. This is also known as the</span>
<span class="sd">        WPGMC algorithm.</span>

<span class="sd">      * method=&#39;ward&#39; uses the Ward variance minimization algorithm.</span>
<span class="sd">        The new entry :math:`d(u,v)` is computed as follows,</span>

<span class="sd">        .. math::</span>

<span class="sd">           d(u,v) = \\sqrt{\\frac{|v|+|s|}</span>
<span class="sd">                               {T}d(v,s)^2</span>
<span class="sd">                        + \\frac{|v|+|t|}</span>
<span class="sd">                               {T}d(v,t)^2</span>
<span class="sd">                        - \\frac{|v|}</span>
<span class="sd">                               {T}d(s,t)^2}</span>

<span class="sd">        where :math:`u` is the newly joined cluster consisting of</span>
<span class="sd">        clusters :math:`s` and :math:`t`, :math:`v` is an unused</span>
<span class="sd">        cluster in the forest, :math:`T=|v|+|s|+|t|`, and</span>
<span class="sd">        :math:`|*|` is the cardinality of its argument. This is also</span>
<span class="sd">        known as the incremental algorithm.</span>

<span class="sd">    Warning: When the minimum distance pair in the forest is chosen, there</span>
<span class="sd">    may be two or more pairs with the same minimum distance. This</span>
<span class="sd">    implementation may chose a different minimum than the MATLAB</span>
<span class="sd">    version.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        A condensed or redundant distance matrix. A condensed distance matrix</span>
<span class="sd">        is a flat array containing the upper triangular of the distance matrix.</span>
<span class="sd">        This is the form that ``pdist`` returns. Alternatively, a collection of</span>
<span class="sd">        :math:`m` observation vectors in n dimensions may be passed as an</span>
<span class="sd">        :math:`m` by :math:`n` array.</span>
<span class="sd">    method : str, optional</span>
<span class="sd">        The linkage algorithm to use. See the ``Linkage Methods`` section below</span>
<span class="sd">        for full descriptions.</span>
<span class="sd">    metric : str or function, optional</span>
<span class="sd">        The distance metric to use in the case that y is a collection of</span>
<span class="sd">        observation vectors; ignored otherwise. See the ``distance.pdist``</span>
<span class="sd">        function for a list of valid distance metrics. A custom distance</span>
<span class="sd">        function can also be used. See the ``distance.pdist`` function for</span>
<span class="sd">        details.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as a linkage matrix.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument &#39;method&#39; must be a string.&quot;</span><span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">_convert_to_double</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">))</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">distance</span><span class="o">.</span><span class="n">is_valid_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">num_obs_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_cpy_non_euclid_methods</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Valid methods when the raw observations are &quot;</span>
                             <span class="s2">&quot;omitted are &#39;single&#39;, &#39;complete&#39;, &#39;weighted&#39;, &quot;</span>
                             <span class="s2">&quot;and &#39;average&#39;.&quot;</span><span class="p">)</span>
        <span class="c1"># Since the C code does not support striding using strides.</span>
        <span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">y</span><span class="p">])</span>

        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
            <span class="n">_hierarchy</span><span class="o">.</span><span class="n">slink</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_hierarchy</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">),</span>
                               <span class="nb">int</span><span class="p">(</span><span class="n">_cpy_non_euclid_methods</span><span class="p">[</span><span class="n">method</span><span class="p">]))</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">y</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_cpy_linkage_methods</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid method: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">method</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">_cpy_non_euclid_methods</span><span class="p">:</span>
            <span class="n">dm</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
                <span class="n">_hierarchy</span><span class="o">.</span><span class="n">slink</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_hierarchy</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span>
                                   <span class="nb">int</span><span class="p">(</span><span class="n">_cpy_non_euclid_methods</span><span class="p">[</span><span class="n">method</span><span class="p">]))</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">_cpy_euclid_methods</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">metric</span> <span class="o">!=</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">((</span><span class="s2">&quot;Method &#39;</span><span class="si">%s</span><span class="s2">&#39; requires the distance metric &quot;</span>
                                 <span class="s2">&quot;to be euclidean&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">method</span><span class="p">)</span>
            <span class="n">dm</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
            <span class="n">_hierarchy</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span>
                               <span class="nb">int</span><span class="p">(</span><span class="n">_cpy_euclid_methods</span><span class="p">[</span><span class="n">method</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">Z</span></div>


<div class="viewcode-block" id="ClusterNode"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.ClusterNode.html#scipy.cluster.hierarchy.ClusterNode">[docs]</a><span class="k">class</span> <span class="nc">ClusterNode</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A tree node class for representing a cluster.</span>

<span class="sd">    Leaf nodes correspond to original observations, while non-leaf nodes</span>
<span class="sd">    correspond to non-singleton clusters.</span>

<span class="sd">    The to_tree function converts a matrix returned by the linkage</span>
<span class="sd">    function into an easy-to-use tree representation.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    to_tree : for converting a linkage matrix ``Z`` into a tree object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ClusterNode.__init__"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.ClusterNode.html#scipy.cluster.hierarchy.ClusterNode.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The id must be non-negative.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The distance must be non-negative.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">left</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">right</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only full or proper binary trees are permitted.&#39;</span>
                             <span class="s1">&#39;  This node has one child.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;A cluster must contain at least one original &#39;</span>
                             <span class="s1">&#39;observation.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">count</span></div>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">ClusterNode</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t compare ClusterNode &quot;</span>
                             <span class="s2">&quot;to type {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">&lt;</span> <span class="n">node</span><span class="o">.</span><span class="n">dist</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">ClusterNode</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t compare ClusterNode &quot;</span>
                             <span class="s2">&quot;to type {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">dist</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">ClusterNode</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t compare ClusterNode &quot;</span>
                             <span class="s2">&quot;to type {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">==</span> <span class="n">node</span><span class="o">.</span><span class="n">dist</span>

    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The identifier of the target node.</span>

<span class="sd">        For ``0 &lt;= i &lt; n``, `i` corresponds to original observation i.</span>
<span class="sd">        For ``n &lt;= i &lt; 2n-1``, `i` corresponds to non-singleton cluster formed</span>
<span class="sd">        at iteration ``i-n``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        id : int</span>
<span class="sd">            The identifier of the target node.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">get_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The number of leaf nodes (original observations) belonging to</span>
<span class="sd">        the cluster node nd. If the target node is a leaf, 1 is</span>
<span class="sd">        returned.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        get_count : int</span>
<span class="sd">            The number of leaf nodes below the target node.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>

    <span class="k">def</span> <span class="nf">get_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a reference to the left child tree object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        left : ClusterNode</span>
<span class="sd">            The left child of the target node.  If the node is a leaf,</span>
<span class="sd">            None is returned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span>

    <span class="k">def</span> <span class="nf">get_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a reference to the right child tree object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        right : ClusterNode</span>
<span class="sd">            The left child of the target node.  If the node is a leaf,</span>
<span class="sd">            None is returned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span>

    <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the target node is a leaf.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        leafness : bool</span>
<span class="sd">            True if the target node is a leaf node.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">pre_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs pre-order traversal without recursive function calls.</span>

<span class="sd">        When a leaf node is first encountered, ``func`` is called with</span>
<span class="sd">        the leaf node as its argument, and its result is appended to</span>
<span class="sd">        the list.</span>

<span class="sd">        For example, the statement::</span>

<span class="sd">           ids = root.pre_order(lambda x: x.id)</span>

<span class="sd">        returns a list of the node ids corresponding to the leaf nodes</span>
<span class="sd">        of the tree as they appear from left to right.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : function</span>
<span class="sd">            Applied to each leaf ClusterNode object in the pre-order traversal.</span>
<span class="sd">            Given the i&#39;th leaf node in the pre-ordeR traversal ``n[i]``, the</span>
<span class="sd">            result of func(n[i]) is stored in L[i]. If not provided, the index</span>
<span class="sd">            of the original observation to which the node corresponds is used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        L : list</span>
<span class="sd">            The pre-order traversal.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Do a preorder traversal, caching the result. To avoid having to do</span>
        <span class="c1"># recursion, we&#39;ll store the previous index we&#39;ve visited in a vector.</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>

        <span class="n">curNode</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">lvisited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">rvisited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">curNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">preorder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nd</span> <span class="o">=</span> <span class="n">curNode</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">ndid</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">id</span>
            <span class="k">if</span> <span class="n">nd</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
                <span class="n">preorder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ndid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lvisited</span><span class="p">:</span>
                    <span class="n">curNode</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">left</span>
                    <span class="n">lvisited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ndid</span><span class="p">)</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">ndid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rvisited</span><span class="p">:</span>
                    <span class="n">curNode</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">right</span>
                    <span class="n">rvisited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ndid</span><span class="p">)</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="c1"># If we&#39;ve visited the left and right of this non-leaf</span>
                <span class="c1"># node already, go up in the tree.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">preorder</span></div>


<span class="n">_cnode_bare</span> <span class="o">=</span> <span class="n">ClusterNode</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">_cnode_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">ClusterNode</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_order_cluster_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns clustering nodes in bottom-up order by distance.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : scipy.cluster.linkage array</span>
<span class="sd">        The linkage matrix.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nodes : list</span>
<span class="sd">        A list of ClusterNode objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">to_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
            <span class="n">bisect</span><span class="o">.</span><span class="n">insort_left</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
            <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get_right</span><span class="p">())</span>
            <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get_left</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">nodes</span>


<div class="viewcode-block" id="cut_tree"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.cut_tree.html#scipy.cluster.hierarchy.cut_tree">[docs]</a><span class="k">def</span> <span class="nf">cut_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a linkage matrix Z, return the cut tree.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : scipy.cluster.linkage array</span>
<span class="sd">        The linkage matrix.</span>
<span class="sd">    n_clusters : array_like, optional</span>
<span class="sd">        Number of clusters in the tree at the cut point.</span>
<span class="sd">    height : array_like, optional</span>
<span class="sd">        The height at which to cut the tree.  Only possible for ultrametric</span>
<span class="sd">        trees.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cutree : array</span>
<span class="sd">        An array indicating group membership at each agglomeration step.  I.e.,</span>
<span class="sd">        for a full cut tree, in the first column each data point is in its own</span>
<span class="sd">        cluster.  At the next step, two nodes are merged.  Finally all singleton</span>
<span class="sd">        and non-singleton clusters are in one group.  If `n_clusters` or</span>
<span class="sd">        `height` is given, the columns correspond to the columns of `n_clusters` or</span>
<span class="sd">        `height`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import cluster</span>
<span class="sd">    &gt;&gt;&gt; np.random.seed(23)</span>
<span class="sd">    &gt;&gt;&gt; X = np.random.randn(50, 4)</span>
<span class="sd">    &gt;&gt;&gt; Z = cluster.hierarchy.ward(X)</span>
<span class="sd">    &gt;&gt;&gt; cutree = cluster.hierarchy.cut_tree(Z, n_clusters=[5, 10])</span>
<span class="sd">    &gt;&gt;&gt; cutree[:10]</span>
<span class="sd">    array([[0, 0],</span>
<span class="sd">           [1, 1],</span>
<span class="sd">           [2, 2],</span>
<span class="sd">           [3, 3],</span>
<span class="sd">           [3, 4],</span>
<span class="sd">           [2, 2],</span>
<span class="sd">           [0, 0],</span>
<span class="sd">           [1, 5],</span>
<span class="sd">           [3, 6],</span>
<span class="sd">           [4, 7]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="n">num_obs_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">_order_cluster_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">n_clusters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one of either height or n_clusters &quot;</span>
                         <span class="s2">&quot;must be None&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">height</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">n_clusters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># return the full cut tree</span>
        <span class="n">cols_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nobs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">dist</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">])</span>
        <span class="n">cols_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cols_idx</span> <span class="o">=</span> <span class="n">nobs</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nobs</span><span class="p">),</span> <span class="n">n_clusters</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">n_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols_idx</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># scalar</span>
        <span class="n">n_cols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">cols_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cols_idx</span><span class="p">])</span>

    <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">nobs</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">last_group</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nobs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">cols_idx</span><span class="p">:</span>
        <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_group</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">pre_order</span><span class="p">()</span>
        <span class="n">this_group</span> <span class="o">=</span> <span class="n">last_group</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">this_group</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_group</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">this_group</span><span class="p">[</span><span class="n">this_group</span> <span class="o">&gt;</span> <span class="n">last_group</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">cols_idx</span><span class="p">:</span>
            <span class="n">groups</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">cols_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">this_group</span>
        <span class="n">last_group</span> <span class="o">=</span> <span class="n">this_group</span>

    <span class="k">return</span> <span class="n">groups</span><span class="o">.</span><span class="n">T</span></div>


<div class="viewcode-block" id="to_tree"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.to_tree.html#scipy.cluster.hierarchy.to_tree">[docs]</a><span class="k">def</span> <span class="nf">to_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a hierarchical clustering encoded in the matrix ``Z`` (by</span>
<span class="sd">    linkage) into an easy-to-use tree object.</span>

<span class="sd">    The reference r to the root ClusterNode object is returned.</span>

<span class="sd">    Each ClusterNode object has a left, right, dist, id, and count</span>
<span class="sd">    attribute. The left and right attributes point to ClusterNode objects</span>
<span class="sd">    that were combined to generate the cluster. If both are None then</span>
<span class="sd">    the ClusterNode object is a leaf node, its count must be 1, and its</span>
<span class="sd">    distance is meaningless but set to 0.</span>

<span class="sd">    Note: This function is provided for the convenience of the library</span>
<span class="sd">    user. ClusterNodes are not used as input to any of the functions in this</span>
<span class="sd">    library.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The linkage matrix in proper form (see the ``linkage``</span>
<span class="sd">        function documentation).</span>
<span class="sd">    rd : bool, optional</span>
<span class="sd">        When False, a reference to the root ClusterNode object is</span>
<span class="sd">        returned.  Otherwise, a tuple (r,d) is returned. ``r`` is a</span>
<span class="sd">        reference to the root node while ``d`` is a dictionary</span>
<span class="sd">        mapping cluster ids to ClusterNode references. If a cluster id is</span>
<span class="sd">        less than n, then it corresponds to a singleton cluster</span>
<span class="sd">        (leaf node). See ``linkage`` for more information on the</span>
<span class="sd">        assignment of cluster ids to clusters.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    L : list</span>
<span class="sd">        The pre-order traversal.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>

    <span class="c1"># Number of original objects is equal to the number of rows minus 1.</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># Create a list full of None&#39;s to store the node objects</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Create the nodes corresponding to the n original objects.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ClusterNode</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">nd</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">fj</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">fi</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">((</span><span class="s1">&#39;Corrupt matrix Z. Index to derivative cluster &#39;</span>
                              <span class="s1">&#39;is used before it is formed. See row </span><span class="si">%d</span><span class="s1">, &#39;</span>
                              <span class="s1">&#39;column 0&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">fi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fj</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">((</span><span class="s1">&#39;Corrupt matrix Z. Index to derivative cluster &#39;</span>
                              <span class="s1">&#39;is used before it is formed. See row </span><span class="si">%d</span><span class="s1">, &#39;</span>
                              <span class="s1">&#39;column 1&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">fj</span><span class="p">)</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="n">ClusterNode</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">fi</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">fj</span><span class="p">],</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="c1">#          ^ id   ^ left ^ right ^ dist</span>
        <span class="k">if</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nd</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">((</span><span class="s1">&#39;Corrupt matrix Z. The count Z[</span><span class="si">%d</span><span class="s1">,3] is &#39;</span>
                              <span class="s1">&#39;incorrect.&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nd</span>

    <span class="k">if</span> <span class="n">rd</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nd</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nd</span></div>


<span class="k">def</span> <span class="nf">_convert_to_bool</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">X</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">contiguous</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">X</span>


<span class="k">def</span> <span class="nf">_convert_to_double</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">X</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">contiguous</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">X</span>


<div class="viewcode-block" id="cophenet"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.cophenet.html#scipy.cluster.hierarchy.cophenet">[docs]</a><span class="k">def</span> <span class="nf">cophenet</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the cophenetic distances between each observation in</span>
<span class="sd">    the hierarchical clustering defined by the linkage ``Z``.</span>

<span class="sd">    Suppose ``p`` and ``q`` are original observations in</span>
<span class="sd">    disjoint clusters ``s`` and ``t``, respectively and</span>
<span class="sd">    ``s`` and ``t`` are joined by a direct parent cluster</span>
<span class="sd">    ``u``. The cophenetic distance between observations</span>
<span class="sd">    ``i`` and ``j`` is simply the distance between</span>
<span class="sd">    clusters ``s`` and ``t``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as an array</span>
<span class="sd">        (see `linkage` function).</span>
<span class="sd">    Y : ndarray (optional)</span>
<span class="sd">        Calculates the cophenetic correlation coefficient ``c`` of a</span>
<span class="sd">        hierarchical clustering defined by the linkage matrix `Z`</span>
<span class="sd">        of a set of :math:`n` observations in :math:`m`</span>
<span class="sd">        dimensions. `Y` is the condensed distance matrix from which</span>
<span class="sd">        `Z` was generated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    c : ndarray</span>
<span class="sd">        The cophentic correlation distance (if ``y`` is passed).</span>
<span class="sd">    d : ndarray</span>
<span class="sd">        The cophenetic distance matrix in condensed form. The</span>
<span class="sd">        :math:`ij` th entry is the cophenetic distance between</span>
<span class="sd">        original observations :math:`i` and :math:`j`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="n">Zs</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
    <span class="c1"># Since the C code does not support striding using strides.</span>
    <span class="c1"># The dimensions are used instead.</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">_convert_to_double</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

    <span class="n">_hierarchy</span><span class="o">.</span><span class="n">cophenetic_distances</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">zz</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">distance</span><span class="o">.</span><span class="n">is_valid_y</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">zz</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">Yy</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">-</span> <span class="n">y</span>
    <span class="n">Zz</span> <span class="o">=</span> <span class="n">zz</span> <span class="o">-</span> <span class="n">z</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="p">(</span><span class="n">Yy</span> <span class="o">*</span> <span class="n">Zz</span><span class="p">)</span>
    <span class="n">denomA</span> <span class="o">=</span> <span class="n">Yy</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">denomB</span> <span class="o">=</span> <span class="n">Zz</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">denomA</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="n">denomB</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span></div>


<div class="viewcode-block" id="inconsistent"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.inconsistent.html#scipy.cluster.hierarchy.inconsistent">[docs]</a><span class="k">def</span> <span class="nf">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Calculates inconsistency statistics on a linkage.</span>

<span class="sd">    Note: This function behaves similarly to the MATLAB(TM)</span>
<span class="sd">    inconsistent function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The :math:`(n-1)` by 4 matrix encoding the linkage (hierarchical</span>
<span class="sd">        clustering).  See `linkage` documentation for more information on its</span>
<span class="sd">        form.</span>
<span class="sd">    d : int, optional</span>
<span class="sd">        The number of links up to `d` levels below each non-singleton cluster.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    R : ndarray</span>
<span class="sd">        A :math:`(n-1)` by 5 matrix where the ``i``&#39;th row contains the link</span>
<span class="sd">        statistics for the non-singleton cluster ``i``. The link statistics are</span>
<span class="sd">        computed over the link heights for links :math:`d` levels below the</span>
<span class="sd">        cluster ``i``. ``R[i,0]`` and ``R[i,1]`` are the mean and standard</span>
<span class="sd">        deviation of the link heights, respectively; ``R[i,2]`` is the number</span>
<span class="sd">        of links included in the calculation; and ``R[i,3]`` is the</span>
<span class="sd">        inconsistency coefficient,</span>

<span class="sd">        .. math:: \frac{\mathtt{Z[i,2]} - \mathtt{R[i,0]}} {R[i,1]}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

    <span class="n">Zs</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">d</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="ow">or</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The second argument d must be a nonnegative &#39;</span>
                         <span class="s1">&#39;integer value.&#39;</span><span class="p">)</span>

    <span class="c1"># Since the C code does not support striding using strides.</span>
    <span class="c1"># The dimensions are used instead.</span>
    <span class="p">[</span><span class="n">Z</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">Z</span><span class="p">])</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>

    <span class="n">_hierarchy</span><span class="o">.</span><span class="n">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">R</span></div>


<div class="viewcode-block" id="from_mlab_linkage"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.from_mlab_linkage.html#scipy.cluster.hierarchy.from_mlab_linkage">[docs]</a><span class="k">def</span> <span class="nf">from_mlab_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a linkage matrix generated by MATLAB(TM) to a new</span>
<span class="sd">    linkage matrix compatible with this module.</span>

<span class="sd">    The conversion does two things:</span>

<span class="sd">     * the indices are converted from ``1..N`` to ``0..(N-1)`` form,</span>
<span class="sd">       and</span>

<span class="sd">     * a fourth column Z[:,3] is added where Z[i,3] is represents the</span>
<span class="sd">       number of original observations (leaves) in the non-singleton</span>
<span class="sd">       cluster i.</span>

<span class="sd">    This function is useful when loading in linkages from legacy data</span>
<span class="sd">    files generated by MATLAB.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        A linkage matrix generated by MATLAB(TM).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ZS : ndarray</span>
<span class="sd">        A linkage matrix compatible with this library.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">Zs</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># If it&#39;s empty, return it.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Zs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Zs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Z</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Zs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The linkage array must be rectangular.&quot;</span><span class="p">)</span>

    <span class="c1"># If it contains no rows, return it.</span>
    <span class="k">if</span> <span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Z</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">Zpart</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">Zpart</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">!=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">Zpart</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The format of the indices is not 1..N&#39;</span><span class="p">)</span>

    <span class="n">Zpart</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">1.0</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
    <span class="n">_hierarchy</span><span class="o">.</span><span class="n">calculate_cluster_sizes</span><span class="p">(</span><span class="n">Zpart</span><span class="p">,</span> <span class="n">CS</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">Zpart</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)])</span></div>


<div class="viewcode-block" id="to_mlab_linkage"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.to_mlab_linkage.html#scipy.cluster.hierarchy.to_mlab_linkage">[docs]</a><span class="k">def</span> <span class="nf">to_mlab_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a linkage matrix to a MATLAB(TM) compatible one.</span>

<span class="sd">    Converts a linkage matrix ``Z`` generated by the linkage function</span>
<span class="sd">    of this module to a MATLAB(TM) compatible one. The return linkage</span>
<span class="sd">    matrix has the last column removed and the cluster indices are</span>
<span class="sd">    converted to ``1..N`` indexing.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        A linkage matrix generated by this library.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    to_mlab_linkage : ndarray</span>
<span class="sd">        A linkage matrix compatible with MATLAB(TM)&#39;s hierarchical</span>
<span class="sd">        clustering functions.</span>

<span class="sd">        The return linkage matrix has the last column removed</span>
<span class="sd">        and the cluster indices are converted to ``1..N`` indexing.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
    <span class="n">Zs</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Zs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Zs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Z</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>

    <span class="n">ZP</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ZP</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">ZP</span></div>


<div class="viewcode-block" id="is_monotonic"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.is_monotonic.html#scipy.cluster.hierarchy.is_monotonic">[docs]</a><span class="k">def</span> <span class="nf">is_monotonic</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns True if the linkage passed is monotonic.</span>

<span class="sd">    The linkage is monotonic if for every cluster :math:`s` and :math:`t`</span>
<span class="sd">    joined, the distance between them is no less than the distance</span>
<span class="sd">    between any previously joined clusters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The linkage matrix to check for monotonicity.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    b : bool</span>
<span class="sd">        A boolean indicating whether the linkage is monotonic.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>

    <span class="c1"># We expect the i&#39;th value to be greater than its successor.</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Z</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></div>


<div class="viewcode-block" id="is_valid_im"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.is_valid_im.html#scipy.cluster.hierarchy.is_valid_im">[docs]</a><span class="k">def</span> <span class="nf">is_valid_im</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">warning</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns True if the inconsistency matrix passed is valid.</span>

<span class="sd">    It must be a :math:`n` by 4 numpy array of doubles. The standard</span>
<span class="sd">    deviations ``R[:,1]`` must be nonnegative. The link counts</span>
<span class="sd">    ``R[:,2]`` must be positive and no greater than :math:`n-1`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    R : ndarray</span>
<span class="sd">        The inconsistency matrix to check for validity.</span>
<span class="sd">    warning : bool, optional</span>
<span class="sd">         When True, issues a Python warning if the linkage</span>
<span class="sd">         matrix passed is invalid.</span>
<span class="sd">    throw : bool, optional</span>
<span class="sd">         When True, throws a Python exception if the linkage</span>
<span class="sd">         matrix passed is invalid.</span>
<span class="sd">    name : str, optional</span>
<span class="sd">         This string refers to the variable name of the invalid</span>
<span class="sd">         linkage matrix.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    b : bool</span>
<span class="sd">        True if the inconsistency matrix is valid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">name_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Variable </span><span class="si">%s</span><span class="s1">passed as inconsistency matrix is not &#39;</span>
                            <span class="s1">&#39;a numpy array.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">R</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Inconsistency matrix </span><span class="si">%s</span><span class="s1">must contain doubles &#39;</span>
                            <span class="s1">&#39;(double).&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Inconsistency matrix </span><span class="si">%s</span><span class="s1">must have shape=2 (i.e. &#39;</span>
                             <span class="s1">&#39;be two-dimensional).&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Inconsistency matrix </span><span class="si">%s</span><span class="s1">must have 4 columns.&#39;</span> <span class="o">%</span>
                             <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Inconsistency matrix </span><span class="si">%s</span><span class="s1">must have at least one &#39;</span>
                             <span class="s1">&#39;row.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">R</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Inconsistency matrix </span><span class="si">%s</span><span class="s1">contains negative link &#39;</span>
                             <span class="s1">&#39;height means.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">R</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Inconsistency matrix </span><span class="si">%s</span><span class="s1">contains negative link &#39;</span>
                             <span class="s1">&#39;height standard deviations.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">R</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Inconsistency matrix </span><span class="si">%s</span><span class="s1">contains negative link &#39;</span>
                             <span class="s1">&#39;counts.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">throw</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">if</span> <span class="n">warning</span><span class="p">:</span>
            <span class="n">_warning</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">return</span> <span class="n">valid</span></div>


<div class="viewcode-block" id="is_valid_linkage"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.is_valid_linkage.html#scipy.cluster.hierarchy.is_valid_linkage">[docs]</a><span class="k">def</span> <span class="nf">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">warning</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the validity of a linkage matrix.</span>

<span class="sd">    A linkage matrix is valid if it is a two dimensional array (type double)</span>
<span class="sd">    with :math:`n` rows and 4 columns.  The first two columns must contain</span>
<span class="sd">    indices between 0 and :math:`2n-1`. For a given row ``i``, the following</span>
<span class="sd">    two expressions have to hold:</span>

<span class="sd">    .. math::</span>

<span class="sd">        0 \\leq \\mathtt{Z[i,0]} \\leq i+n-1</span>
<span class="sd">        0 \\leq Z[i,1] \\leq i+n-1</span>

<span class="sd">    I.e. a cluster cannot join another cluster unless the cluster being joined</span>
<span class="sd">    has been generated.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : array_like</span>
<span class="sd">        Linkage matrix.</span>
<span class="sd">    warning : bool, optional</span>
<span class="sd">        When True, issues a Python warning if the linkage</span>
<span class="sd">        matrix passed is invalid.</span>
<span class="sd">    throw : bool, optional</span>
<span class="sd">        When True, throws a Python exception if the linkage</span>
<span class="sd">        matrix passed is invalid.</span>
<span class="sd">    name : str, optional</span>
<span class="sd">           This string refers to the variable name of the invalid</span>
<span class="sd">           linkage matrix.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    b : bool</span>
<span class="sd">        True if the inconsistency matrix is valid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">name_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Passed linkage argument </span><span class="si">%s</span><span class="s1">is not a valid array.&#39;</span> <span class="o">%</span>
                            <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Z</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Linkage matrix </span><span class="si">%s</span><span class="s1">must contain doubles.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage matrix </span><span class="si">%s</span><span class="s1">must have shape=2 (i.e. be &#39;</span>
                             <span class="s1">&#39;two-dimensional).&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage matrix </span><span class="si">%s</span><span class="s1">must have 4 columns.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage must be computed on at least two &#39;</span>
                             <span class="s1">&#39;observations.&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Z</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage </span><span class="si">%s</span><span class="s1">contains negative indices.&#39;</span> <span class="o">%</span>
                                 <span class="n">name_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">Z</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage </span><span class="si">%s</span><span class="s1">contains negative distances.&#39;</span> <span class="o">%</span>
                                 <span class="n">name_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">Z</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage </span><span class="si">%s</span><span class="s1">contains negative counts.&#39;</span> <span class="o">%</span>
                                 <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_check_hierarchy_uses_cluster_before_formed</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage </span><span class="si">%s</span><span class="s1">uses non-singleton cluster before &#39;</span>
                             <span class="s1">&#39;it is formed.&#39;</span> <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_check_hierarchy_uses_cluster_more_than_once</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Linkage </span><span class="si">%s</span><span class="s1">uses the same cluster more than once.&#39;</span>
                             <span class="o">%</span> <span class="n">name_str</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">throw</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">if</span> <span class="n">warning</span><span class="p">:</span>
            <span class="n">_warning</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">return</span> <span class="n">valid</span></div>


<span class="k">def</span> <span class="nf">_check_hierarchy_uses_cluster_before_formed</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>


<span class="k">def</span> <span class="nf">_check_hierarchy_uses_cluster_more_than_once</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">chosen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">chosen</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">chosen</span><span class="p">)</span> <span class="ow">or</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="n">chosen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">chosen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">False</span>


<span class="k">def</span> <span class="nf">_check_hierarchy_not_all_clusters_used</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">chosen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">chosen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="n">chosen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">must_chosen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">must_chosen</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">chosen</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>


<div class="viewcode-block" id="num_obs_linkage"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.num_obs_linkage.html#scipy.cluster.hierarchy.num_obs_linkage">[docs]</a><span class="k">def</span> <span class="nf">num_obs_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of original observations of the linkage matrix</span>
<span class="sd">    passed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The linkage matrix on which to perform the operation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n : int</span>
<span class="sd">        The number of original observations in the linkage.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="correspond"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.correspond.html#scipy.cluster.hierarchy.correspond">[docs]</a><span class="k">def</span> <span class="nf">correspond</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks for correspondence between linkage and condensed distance matrices</span>

<span class="sd">    They must have the same number of original observations for</span>
<span class="sd">    the check to succeed.</span>

<span class="sd">    This function is useful as a sanity check in algorithms that make</span>
<span class="sd">    extensive use of linkage and distance matrices that must</span>
<span class="sd">    correspond to the same set of original observations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : array_like</span>
<span class="sd">        The linkage matrix to check for correspondence.</span>
<span class="sd">    Y : array_like</span>
<span class="sd">        The condensed distance matrix to check for correspondence.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    b : bool</span>
<span class="sd">        A boolean indicating whether the linkage matrix and distance</span>
<span class="sd">        matrix could possibly correspond to one another.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">distance</span><span class="o">.</span><span class="n">is_valid_y</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">distance</span><span class="o">.</span><span class="n">num_obs_y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">==</span> <span class="n">num_obs_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span></div>


<div class="viewcode-block" id="fcluster"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.fcluster.html#scipy.cluster.hierarchy.fcluster">[docs]</a><span class="k">def</span> <span class="nf">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;inconsistent&#39;</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">monocrit</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Forms flat clusters from the hierarchical clustering defined by</span>
<span class="sd">    the linkage matrix ``Z``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded with the matrix returned</span>
<span class="sd">        by the `linkage` function.</span>
<span class="sd">    t : float</span>
<span class="sd">        The threshold to apply when forming flat clusters.</span>
<span class="sd">    criterion : str, optional</span>
<span class="sd">        The criterion to use in forming flat clusters. This can</span>
<span class="sd">        be any of the following values:</span>

<span class="sd">          ``inconsistent`` : If a cluster node and all its</span>
<span class="sd">              descendants have an inconsistent value less than or equal</span>
<span class="sd">              to `t` then all its leaf descendants belong to the</span>
<span class="sd">              same flat cluster. When no non-singleton cluster meets</span>
<span class="sd">              this criterion, every node is assigned to its own</span>
<span class="sd">              cluster. (Default)</span>

<span class="sd">          ``distance`` : Forms flat clusters so that the original</span>
<span class="sd">              observations in each flat cluster have no greater a</span>
<span class="sd">              cophenetic distance than `t`.</span>

<span class="sd">          ``maxclust`` : Finds a minimum threshold ``r`` so that</span>
<span class="sd">              the cophenetic distance between any two original</span>
<span class="sd">              observations in the same flat cluster is no more than</span>
<span class="sd">              ``r`` and no more than `t` flat clusters are formed.</span>

<span class="sd">          ``monocrit`` : Forms a flat cluster from a cluster node c</span>
<span class="sd">              with index i when ``monocrit[j] &lt;= t``.</span>

<span class="sd">              For example, to threshold on the maximum mean distance</span>
<span class="sd">              as computed in the inconsistency matrix R with a</span>
<span class="sd">              threshold of 0.8 do::</span>

<span class="sd">                  MR = maxRstat(Z, R, 3)</span>
<span class="sd">                  cluster(Z, t=0.8, criterion=&#39;monocrit&#39;, monocrit=MR)</span>

<span class="sd">          ``maxclust_monocrit`` : Forms a flat cluster from a</span>
<span class="sd">              non-singleton cluster node ``c`` when ``monocrit[i] &lt;=</span>
<span class="sd">              r`` for all cluster indices ``i`` below and including</span>
<span class="sd">              ``c``. ``r`` is minimized such that no more than ``t``</span>
<span class="sd">              flat clusters are formed. monocrit must be</span>
<span class="sd">              monotonic. For example, to minimize the threshold t on</span>
<span class="sd">              maximum inconsistency values so that no more than 3 flat</span>
<span class="sd">              clusters are formed, do::</span>

<span class="sd">                  MI = maxinconsts(Z, R)</span>
<span class="sd">                  cluster(Z, t=3, criterion=&#39;maxclust_monocrit&#39;, monocrit=MI)</span>

<span class="sd">    depth : int, optional</span>
<span class="sd">        The maximum depth to perform the inconsistency calculation.</span>
<span class="sd">        It has no meaning for the other criteria. Default is 2.</span>
<span class="sd">    R : ndarray, optional</span>
<span class="sd">        The inconsistency matrix to use for the &#39;inconsistent&#39;</span>
<span class="sd">        criterion. This matrix is computed if not provided.</span>
<span class="sd">    monocrit : ndarray, optional</span>
<span class="sd">        An array of length n-1. `monocrit[i]` is the</span>
<span class="sd">        statistics upon which non-singleton i is thresholded. The</span>
<span class="sd">        monocrit vector must be monotonic, i.e. given a node c with</span>
<span class="sd">        index i, for all node indices j corresponding to nodes</span>
<span class="sd">        below c, ``monocrit[i] &gt;= monocrit[j]``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fcluster : ndarray</span>
<span class="sd">        An array of length n. T[i] is the flat cluster number to</span>
<span class="sd">        which original observation i belongs.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>

    <span class="c1"># Since the C code does not support striding using strides.</span>
    <span class="c1"># The dimensions are used instead.</span>
    <span class="p">[</span><span class="n">Z</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">Z</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;inconsistent&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
            <span class="n">is_valid_im</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
            <span class="c1"># Since the C code does not support striding using strides.</span>
            <span class="c1"># The dimensions are used instead.</span>
            <span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">R</span><span class="p">])</span>
        <span class="n">_hierarchy</span><span class="o">.</span><span class="n">cluster_in</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;distance&#39;</span><span class="p">:</span>
        <span class="n">_hierarchy</span><span class="o">.</span><span class="n">cluster_dist</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;maxclust&#39;</span><span class="p">:</span>
        <span class="n">_hierarchy</span><span class="o">.</span><span class="n">cluster_maxclust_dist</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;monocrit&#39;</span><span class="p">:</span>
        <span class="p">[</span><span class="n">monocrit</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">monocrit</span><span class="p">])</span>
        <span class="n">_hierarchy</span><span class="o">.</span><span class="n">cluster_monocrit</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">monocrit</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;maxclust_monocrit&#39;</span><span class="p">:</span>
        <span class="p">[</span><span class="n">monocrit</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">monocrit</span><span class="p">])</span>
        <span class="n">_hierarchy</span><span class="o">.</span><span class="n">cluster_maxclust_monocrit</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">monocrit</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid cluster formation criterion: </span><span class="si">%s</span><span class="s1">&#39;</span>
                         <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">criterion</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">T</span></div>


<div class="viewcode-block" id="fclusterdata"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.fclusterdata.html#scipy.cluster.hierarchy.fclusterdata">[docs]</a><span class="k">def</span> <span class="nf">fclusterdata</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;inconsistent&#39;</span><span class="p">,</span>
                 <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cluster observation data using a given metric.</span>

<span class="sd">    Clusters the original observations in the n-by-m data</span>
<span class="sd">    matrix X (n observations in m dimensions), using the euclidean</span>
<span class="sd">    distance metric to calculate distances between original observations,</span>
<span class="sd">    performs hierarchical clustering using the single linkage algorithm,</span>
<span class="sd">    and forms flat clusters using the inconsistency method with `t` as the</span>
<span class="sd">    cut-off threshold.</span>

<span class="sd">    A one-dimensional array T of length n is returned. T[i] is the index</span>
<span class="sd">    of the flat cluster to which the original observation i belongs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : (N, M) ndarray</span>
<span class="sd">        N by M data matrix with N observations in M dimensions.</span>
<span class="sd">    t : float</span>
<span class="sd">        The threshold to apply when forming flat clusters.</span>
<span class="sd">    criterion : str, optional</span>
<span class="sd">        Specifies the criterion for forming flat clusters.  Valid</span>
<span class="sd">        values are &#39;inconsistent&#39; (default), &#39;distance&#39;, or &#39;maxclust&#39;</span>
<span class="sd">        cluster formation algorithms. See `fcluster` for descriptions.</span>
<span class="sd">    metric : str, optional</span>
<span class="sd">        The distance metric for calculating pairwise distances. See</span>
<span class="sd">        `distance.pdist` for descriptions and linkage to verify</span>
<span class="sd">        compatibility with the linkage method.</span>
<span class="sd">    depth : int, optional</span>
<span class="sd">        The maximum depth for the inconsistency calculation. See</span>
<span class="sd">        `inconsistent` for more information.</span>
<span class="sd">    method : str, optional</span>
<span class="sd">        The linkage method to use (single, complete, average,</span>
<span class="sd">        weighted, median centroid, ward). See `linkage` for more</span>
<span class="sd">        information. Default is &quot;single&quot;.</span>
<span class="sd">    R : ndarray, optional</span>
<span class="sd">        The inconsistency matrix. It will be computed if necessary</span>
<span class="sd">        if it is not passed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fclusterdata : ndarray</span>
<span class="sd">        A vector of length n. T[i] is the flat cluster number to</span>
<span class="sd">        which original observation i belongs.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function is similar to the MATLAB function clusterdata.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The observation matrix X must be an n by m numpy &#39;</span>
                        <span class="s1">&#39;array.&#39;</span><span class="p">)</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">T</span></div>


<div class="viewcode-block" id="leaves_list"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.leaves_list.html#scipy.cluster.hierarchy.leaves_list">[docs]</a><span class="k">def</span> <span class="nf">leaves_list</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of leaf node ids</span>

<span class="sd">    The return corresponds to the observation vector index as it appears</span>
<span class="sd">    in the tree from left to right. Z is a linkage matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as a matrix.  `Z` is</span>
<span class="sd">        a linkage matrix.  See ``linkage`` for more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    leaves_list : ndarray</span>
<span class="sd">        The list of leaf node ids.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">ML</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="n">Z</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">Z</span><span class="p">])</span>
    <span class="n">_hierarchy</span><span class="o">.</span><span class="n">prelist</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">ML</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ML</span></div>


<span class="c1"># Maps number of leaves to text size.</span>
<span class="c1">#</span>
<span class="c1"># p &lt;= 20, size=&quot;12&quot;</span>
<span class="c1"># 20 &lt; p &lt;= 30, size=&quot;10&quot;</span>
<span class="c1"># 30 &lt; p &lt;= 50, size=&quot;8&quot;</span>
<span class="c1"># 50 &lt; p &lt;= np.inf, size=&quot;6&quot;</span>

<span class="n">_dtextsizes</span> <span class="o">=</span> <span class="p">{</span><span class="mi">20</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">85</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="n">_drotation</span> <span class="o">=</span> <span class="p">{</span><span class="mi">20</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span> <span class="mi">90</span><span class="p">}</span>
<span class="n">_dtextsortedkeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_dtextsizes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">_dtextsortedkeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">_drotationsortedkeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_drotation</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">_drotationsortedkeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_remove_dups</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes duplicates AND preserves the original order of the elements.</span>
<span class="sd">    The set class is not guaranteed to do this.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seen_before</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
    <span class="n">L2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_before</span><span class="p">:</span>
            <span class="n">seen_before</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">L2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">L2</span>


<span class="k">def</span> <span class="nf">_get_tick_text_size</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_dtextsortedkeys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_dtextsizes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_get_tick_rotation</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_drotationsortedkeys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_drotation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_plot_dendrogram</span><span class="p">(</span><span class="n">icoords</span><span class="p">,</span> <span class="n">dcoords</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mh</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span>
                     <span class="n">no_labels</span><span class="p">,</span> <span class="n">color_list</span><span class="p">,</span> <span class="n">leaf_font_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">leaf_rotation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">above_threshold_color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">):</span>
    <span class="c1"># Import matplotlib here so that it&#39;s not imported unless dendrograms</span>
    <span class="c1"># are plotted. Raise an informative error if importing fails.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># if an axis is provided, don&#39;t use pylab at all</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pylab</span>
        <span class="kn">import</span> <span class="nn">matplotlib.patches</span>
        <span class="kn">import</span> <span class="nn">matplotlib.collections</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;You must install the matplotlib library to plot &quot;</span>
                          <span class="s2">&quot;the dendrogram. Use no_plot=True to calculate the &quot;</span>
                          <span class="s2">&quot;dendrogram without plotting.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="c1"># if we&#39;re using pylab, we want to trigger a draw at the end</span>
        <span class="n">trigger_redraw</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">trigger_redraw</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1"># Independent variable plot width</span>
    <span class="n">ivw</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ivl</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="c1"># Dependent variable plot height</span>
    <span class="n">dvw</span> <span class="o">=</span> <span class="n">mh</span> <span class="o">+</span> <span class="n">mh</span> <span class="o">*</span> <span class="mf">0.05</span>

    <span class="n">iv_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ivl</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">dvw</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">ivw</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">dvw</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">ivw</span><span class="p">])</span>

        <span class="n">xlines</span> <span class="o">=</span> <span class="n">icoords</span>
        <span class="n">ylines</span> <span class="o">=</span> <span class="n">dcoords</span>
        <span class="k">if</span> <span class="n">no_labels</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">iv_ticks</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>

            <span class="c1"># Make the tick marks invisible because they cover up the links</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklines</span><span class="p">():</span>
                <span class="n">line</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

            <span class="n">leaf_rot</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">_get_tick_rotation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ivl</span><span class="p">)))</span> <span class="k">if</span> <span class="p">(</span>
                                    <span class="n">leaf_rotation</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">leaf_rotation</span>
            <span class="n">leaf_font</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">_get_tick_text_size</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ivl</span><span class="p">)))</span> <span class="k">if</span> <span class="p">(</span>
                                    <span class="n">leaf_font_size</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">leaf_font_size</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ivl</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">leaf_rot</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">leaf_font</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">dvw</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">ivw</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">dvw</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">ivw</span><span class="p">])</span>

        <span class="n">xlines</span> <span class="o">=</span> <span class="n">dcoords</span>
        <span class="n">ylines</span> <span class="o">=</span> <span class="n">icoords</span>
        <span class="k">if</span> <span class="n">no_labels</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">iv_ticks</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

            <span class="c1"># Make the tick marks invisible because they cover up the links</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklines</span><span class="p">():</span>
                <span class="n">line</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

            <span class="n">leaf_font</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">_get_tick_text_size</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ivl</span><span class="p">)))</span> <span class="k">if</span> <span class="p">(</span>
                                    <span class="n">leaf_font_size</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">leaf_font_size</span>

            <span class="k">if</span> <span class="n">leaf_rotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ivl</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">leaf_rotation</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">leaf_font</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ivl</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">leaf_font</span><span class="p">)</span>

    <span class="c1"># Let&#39;s use collections instead. This way there is a separate legend item</span>
    <span class="c1"># for each tree grouping, rather than stupidly one for each line segment.</span>
    <span class="n">colors_used</span> <span class="o">=</span> <span class="n">_remove_dups</span><span class="p">(</span><span class="n">color_list</span><span class="p">)</span>
    <span class="n">color_to_lines</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors_used</span><span class="p">:</span>
        <span class="n">color_to_lines</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xlines</span><span class="p">,</span> <span class="n">ylines</span><span class="p">,</span> <span class="n">color_list</span><span class="p">):</span>
        <span class="n">color_to_lines</span><span class="p">[</span><span class="n">color</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">)))</span>

    <span class="n">colors_to_collections</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Construct the collections.</span>
    <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors_used</span><span class="p">:</span>
        <span class="n">coll</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">LineCollection</span><span class="p">(</span><span class="n">color_to_lines</span><span class="p">[</span><span class="n">color</span><span class="p">],</span>
                                                     <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="n">color</span><span class="p">,))</span>
        <span class="n">colors_to_collections</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">=</span> <span class="n">coll</span>

    <span class="c1"># Add all the groupings below the color threshold.</span>
    <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors_used</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">color</span> <span class="o">!=</span> <span class="n">above_threshold_color</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">colors_to_collections</span><span class="p">[</span><span class="n">color</span><span class="p">])</span>
    <span class="c1"># If there&#39;s a grouping of links above the color threshold, it goes last.</span>
    <span class="k">if</span> <span class="n">above_threshold_color</span> <span class="ow">in</span> <span class="n">colors_to_collections</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">colors_to_collections</span><span class="p">[</span><span class="n">above_threshold_color</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">contraction_marks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">Ellipse</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">contraction_marks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">):</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">dvw</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">dvw</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">set_clip_box</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">trigger_redraw</span><span class="p">:</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pylab</span><span class="o">.</span><span class="n">draw_if_interactive</span><span class="p">()</span>


<span class="n">_link_line_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="set_link_color_palette"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.set_link_color_palette.html#scipy.cluster.hierarchy.set_link_color_palette">[docs]</a><span class="k">def</span> <span class="nf">set_link_color_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set list of matplotlib color codes for use by dendrogram.</span>

<span class="sd">    Note that this palette is global (i.e. setting it once changes the colors</span>
<span class="sd">    for all subsequent calls to `dendrogram`) and that it affects only the</span>
<span class="sd">    the colors below ``color_threshold``.</span>

<span class="sd">    Note that `dendrogram` also accepts a custom coloring function through its</span>
<span class="sd">    ``link_color_func`` keyword, which is more flexible and non-global.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    palette : list of str or None</span>
<span class="sd">        A list of matplotlib color codes.  The order of the color codes is the</span>
<span class="sd">        order in which the colors are cycled through when color thresholding in</span>
<span class="sd">        the dendrogram.</span>

<span class="sd">        If ``None``, resets the palette to its default (which is</span>
<span class="sd">        ``[&#39;g&#39;, &#39;r&#39;, &#39;c&#39;, &#39;m&#39;, &#39;y&#39;, &#39;k&#39;]``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    dendrogram</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Ability to reset the palette with ``None`` added in Scipy 0.17.0.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy.cluster import hierarchy</span>
<span class="sd">    &gt;&gt;&gt; ytdist = np.array([662., 877., 255., 412., 996., 295., 468., 268., 400.,</span>
<span class="sd">    ...                    754., 564., 138., 219., 869., 669.])</span>
<span class="sd">    &gt;&gt;&gt; Z = hierarchy.linkage(ytdist, &#39;single&#39;)</span>
<span class="sd">    &gt;&gt;&gt; dn = hierarchy.dendrogram(Z, no_plot=True)</span>
<span class="sd">    &gt;&gt;&gt; dn[&#39;color_list&#39;]</span>
<span class="sd">    [&#39;g&#39;, &#39;b&#39;, &#39;b&#39;, &#39;b&#39;, &#39;b&#39;]</span>
<span class="sd">    &gt;&gt;&gt; hierarchy.set_link_color_palette([&#39;c&#39;, &#39;m&#39;, &#39;y&#39;, &#39;k&#39;])</span>
<span class="sd">    &gt;&gt;&gt; dn = hierarchy.dendrogram(Z, no_plot=True)</span>
<span class="sd">    &gt;&gt;&gt; dn[&#39;color_list&#39;]</span>
<span class="sd">    [&#39;c&#39;, &#39;b&#39;, &#39;b&#39;, &#39;b&#39;, &#39;b&#39;]</span>
<span class="sd">    &gt;&gt;&gt; dn = hierarchy.dendrogram(Z, no_plot=True, color_threshold=267,</span>
<span class="sd">    ...                           above_threshold_color=&#39;k&#39;)</span>
<span class="sd">    &gt;&gt;&gt; dn[&#39;color_list&#39;]</span>
<span class="sd">    [&#39;c&#39;, &#39;m&#39;, &#39;m&#39;, &#39;k&#39;, &#39;k&#39;]</span>

<span class="sd">    Now reset the color palette to its default:</span>

<span class="sd">    &gt;&gt;&gt; hierarchy.set_link_color_palette(None)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">palette</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># reset to its default</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;palette must be a list or tuple&quot;</span><span class="p">)</span>
    <span class="n">_ptypes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">string_types</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palette</span><span class="p">]</span>

    <span class="k">if</span> <span class="bp">False</span> <span class="ow">in</span> <span class="n">_ptypes</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;all palette list elements must be color strings&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">_link_line_colors</span><span class="p">):</span>
        <span class="n">_link_line_colors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">_link_line_colors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">palette</span><span class="p">))</span></div>


<div class="viewcode-block" id="dendrogram"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.dendrogram.html#scipy.cluster.hierarchy.dendrogram">[docs]</a><span class="k">def</span> <span class="nf">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">color_threshold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">get_leaves</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">count_sort</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">distance_sort</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">show_leaf_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
               <span class="n">no_plot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">no_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">leaf_font_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">leaf_rotation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">leaf_label_func</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">show_contracted</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">link_color_func</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">above_threshold_color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the hierarchical clustering as a dendrogram.</span>

<span class="sd">    The dendrogram illustrates how each cluster is</span>
<span class="sd">    composed by drawing a U-shaped link between a non-singleton</span>
<span class="sd">    cluster and its children. The height of the top of the U-link is</span>
<span class="sd">    the distance between its children clusters. It is also the</span>
<span class="sd">    cophenetic distance between original observations in the two</span>
<span class="sd">    children clusters. It is expected that the distances in Z[:,2] be</span>
<span class="sd">    monotonic, otherwise crossings appear in the dendrogram.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The linkage matrix encoding the hierarchical clustering to</span>
<span class="sd">        render as a dendrogram. See the ``linkage`` function for more</span>
<span class="sd">        information on the format of ``Z``.</span>
<span class="sd">    p : int, optional</span>
<span class="sd">        The ``p`` parameter for ``truncate_mode``.</span>
<span class="sd">    truncate_mode : str, optional</span>
<span class="sd">        The dendrogram can be hard to read when the original</span>
<span class="sd">        observation matrix from which the linkage is derived is</span>
<span class="sd">        large. Truncation is used to condense the dendrogram. There</span>
<span class="sd">        are several modes:</span>

<span class="sd">        ``None/&#39;none&#39;``</span>
<span class="sd">          No truncation is performed (Default).</span>

<span class="sd">        ``&#39;lastp&#39;``</span>
<span class="sd">          The last ``p`` non-singleton formed in the linkage are the only</span>
<span class="sd">          non-leaf nodes in the linkage; they correspond to rows</span>
<span class="sd">          ``Z[n-p-2:end]`` in ``Z``. All other non-singleton clusters are</span>
<span class="sd">          contracted into leaf nodes.</span>

<span class="sd">        ``&#39;mlab&#39;``</span>
<span class="sd">          This corresponds to MATLAB(TM) behavior. (not implemented yet)</span>

<span class="sd">        ``&#39;level&#39;/&#39;mtica&#39;``</span>
<span class="sd">          No more than ``p`` levels of the dendrogram tree are displayed.</span>
<span class="sd">          This corresponds to Mathematica(TM) behavior.</span>

<span class="sd">    color_threshold : double, optional</span>
<span class="sd">        For brevity, let :math:`t` be the ``color_threshold``.</span>
<span class="sd">        Colors all the descendent links below a cluster node</span>
<span class="sd">        :math:`k` the same color if :math:`k` is the first node below</span>
<span class="sd">        the cut threshold :math:`t`. All links connecting nodes with</span>
<span class="sd">        distances greater than or equal to the threshold are colored</span>
<span class="sd">        blue. If :math:`t` is less than or equal to zero, all nodes</span>
<span class="sd">        are colored blue. If ``color_threshold`` is None or</span>
<span class="sd">        &#39;default&#39;, corresponding with MATLAB(TM) behavior, the</span>
<span class="sd">        threshold is set to ``0.7*max(Z[:,2])``.</span>
<span class="sd">    get_leaves : bool, optional</span>
<span class="sd">        Includes a list ``R[&#39;leaves&#39;]=H`` in the result</span>
<span class="sd">        dictionary. For each :math:`i`, ``H[i] == j``, cluster node</span>
<span class="sd">        ``j`` appears in position ``i`` in the left-to-right traversal</span>
<span class="sd">        of the leaves, where :math:`j &lt; 2n-1` and :math:`i &lt; n`.</span>
<span class="sd">    orientation : str, optional</span>
<span class="sd">        The direction to plot the dendrogram, which can be any</span>
<span class="sd">        of the following strings:</span>

<span class="sd">        ``&#39;top&#39;``</span>
<span class="sd">          Plots the root at the top, and plot descendent links going downwards.</span>
<span class="sd">          (default).</span>

<span class="sd">        ``&#39;bottom&#39;``</span>
<span class="sd">          Plots the root at the bottom, and plot descendent links going</span>
<span class="sd">          upwards.</span>

<span class="sd">        ``&#39;left&#39;``</span>
<span class="sd">          Plots the root at the left, and plot descendent links going right.</span>

<span class="sd">        ``&#39;right&#39;``</span>
<span class="sd">          Plots the root at the right, and plot descendent links going left.</span>

<span class="sd">    labels : ndarray, optional</span>
<span class="sd">        By default ``labels`` is None so the index of the original observation</span>
<span class="sd">        is used to label the leaf nodes.  Otherwise, this is an :math:`n`</span>
<span class="sd">        -sized list (or tuple). The ``labels[i]`` value is the text to put</span>
<span class="sd">        under the :math:`i` th leaf node only if it corresponds to an original</span>
<span class="sd">        observation and not a non-singleton cluster.</span>
<span class="sd">    count_sort : str or bool, optional</span>
<span class="sd">        For each node n, the order (visually, from left-to-right) n&#39;s</span>
<span class="sd">        two descendent links are plotted is determined by this</span>
<span class="sd">        parameter, which can be any of the following values:</span>

<span class="sd">        ``False``</span>
<span class="sd">          Nothing is done.</span>

<span class="sd">        ``&#39;ascending&#39;`` or ``True``</span>
<span class="sd">          The child with the minimum number of original objects in its cluster</span>
<span class="sd">          is plotted first.</span>

<span class="sd">        ``&#39;descendent&#39;``</span>
<span class="sd">          The child with the maximum number of original objects in its cluster</span>
<span class="sd">          is plotted first.</span>

<span class="sd">        Note ``distance_sort`` and ``count_sort`` cannot both be True.</span>
<span class="sd">    distance_sort : str or bool, optional</span>
<span class="sd">        For each node n, the order (visually, from left-to-right) n&#39;s</span>
<span class="sd">        two descendent links are plotted is determined by this</span>
<span class="sd">        parameter, which can be any of the following values:</span>

<span class="sd">        ``False``</span>
<span class="sd">          Nothing is done.</span>

<span class="sd">        ``&#39;ascending&#39;`` or ``True``</span>
<span class="sd">          The child with the minimum distance between its direct descendents is</span>
<span class="sd">          plotted first.</span>

<span class="sd">        ``&#39;descending&#39;``</span>
<span class="sd">          The child with the maximum distance between its direct descendents is</span>
<span class="sd">          plotted first.</span>

<span class="sd">        Note ``distance_sort`` and ``count_sort`` cannot both be True.</span>
<span class="sd">    show_leaf_counts : bool, optional</span>
<span class="sd">         When True, leaf nodes representing :math:`k&gt;1` original</span>
<span class="sd">         observation are labeled with the number of observations they</span>
<span class="sd">         contain in parentheses.</span>
<span class="sd">    no_plot : bool, optional</span>
<span class="sd">        When True, the final rendering is not performed. This is</span>
<span class="sd">        useful if only the data structures computed for the rendering</span>
<span class="sd">        are needed or if matplotlib is not available.</span>
<span class="sd">    no_labels : bool, optional</span>
<span class="sd">        When True, no labels appear next to the leaf nodes in the</span>
<span class="sd">        rendering of the dendrogram.</span>
<span class="sd">    leaf_rotation : double, optional</span>
<span class="sd">        Specifies the angle (in degrees) to rotate the leaf</span>
<span class="sd">        labels. When unspecified, the rotation is based on the number of</span>
<span class="sd">        nodes in the dendrogram (default is 0).</span>
<span class="sd">    leaf_font_size : int, optional</span>
<span class="sd">        Specifies the font size (in points) of the leaf labels. When</span>
<span class="sd">        unspecified, the size based on the number of nodes in the</span>
<span class="sd">        dendrogram.</span>
<span class="sd">    leaf_label_func : lambda or function, optional</span>
<span class="sd">        When leaf_label_func is a callable function, for each</span>
<span class="sd">        leaf with cluster index :math:`k &lt; 2n-1`. The function</span>
<span class="sd">        is expected to return a string with the label for the</span>
<span class="sd">        leaf.</span>

<span class="sd">        Indices :math:`k &lt; n` correspond to original observations</span>
<span class="sd">        while indices :math:`k \\geq n` correspond to non-singleton</span>
<span class="sd">        clusters.</span>

<span class="sd">        For example, to label singletons with their node id and</span>
<span class="sd">        non-singletons with their id, count, and inconsistency</span>
<span class="sd">        coefficient, simply do::</span>

<span class="sd">            # First define the leaf label function.</span>
<span class="sd">            def llf(id):</span>
<span class="sd">                if id &lt; n:</span>
<span class="sd">                    return str(id)</span>
<span class="sd">                else:</span>
<span class="sd">                    return &#39;[%d %d %1.2f]&#39; % (id, count, R[n-id,3])</span>
<span class="sd">            # The text for the leaf nodes is going to be big so force</span>
<span class="sd">            # a rotation of 90 degrees.</span>
<span class="sd">            dendrogram(Z, leaf_label_func=llf, leaf_rotation=90)</span>

<span class="sd">    show_contracted : bool, optional</span>
<span class="sd">        When True the heights of non-singleton nodes contracted</span>
<span class="sd">        into a leaf node are plotted as crosses along the link</span>
<span class="sd">        connecting that leaf node.  This really is only useful when</span>
<span class="sd">        truncation is used (see ``truncate_mode`` parameter).</span>
<span class="sd">    link_color_func : callable, optional</span>
<span class="sd">        If given, `link_color_function` is called with each non-singleton id</span>
<span class="sd">        corresponding to each U-shaped link it will paint. The function is</span>
<span class="sd">        expected to return the color to paint the link, encoded as a matplotlib</span>
<span class="sd">        color string code. For example::</span>

<span class="sd">            dendrogram(Z, link_color_func=lambda k: colors[k])</span>

<span class="sd">        colors the direct links below each untruncated non-singleton node</span>
<span class="sd">        ``k`` using ``colors[k]``.</span>
<span class="sd">    ax : matplotlib Axes instance, optional</span>
<span class="sd">        If None and `no_plot` is not True, the dendrogram will be plotted</span>
<span class="sd">        on the current axes.  Otherwise if `no_plot` is not True the</span>
<span class="sd">        dendrogram will be plotted on the given ``Axes`` instance. This can be</span>
<span class="sd">        useful if the dendrogram is part of a more complex figure.</span>
<span class="sd">    above_threshold_color : str, optional</span>
<span class="sd">        This matplotlib color string sets the color of the links above the</span>
<span class="sd">        color_threshold. The default is &#39;b&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    R : dict</span>
<span class="sd">        A dictionary of data structures computed to render the</span>
<span class="sd">        dendrogram. Its has the following keys:</span>

<span class="sd">        ``&#39;color_list&#39;``</span>
<span class="sd">          A list of color names. The k&#39;th element represents the color of the</span>
<span class="sd">          k&#39;th link.</span>

<span class="sd">        ``&#39;icoord&#39;`` and ``&#39;dcoord&#39;``</span>
<span class="sd">          Each of them is a list of lists. Let ``icoord = [I1, I2, ..., Ip]``</span>
<span class="sd">          where ``Ik = [xk1, xk2, xk3, xk4]`` and ``dcoord = [D1, D2, ..., Dp]``</span>
<span class="sd">          where ``Dk = [yk1, yk2, yk3, yk4]``, then the k&#39;th link painted is</span>
<span class="sd">          ``(xk1, yk1)`` - ``(xk2, yk2)`` - ``(xk3, yk3)`` - ``(xk4, yk4)``.</span>

<span class="sd">        ``&#39;ivl&#39;``</span>
<span class="sd">          A list of labels corresponding to the leaf nodes.</span>

<span class="sd">        ``&#39;leaves&#39;``</span>
<span class="sd">          For each i, ``H[i] == j``, cluster node ``j`` appears in position</span>
<span class="sd">          ``i`` in the left-to-right traversal of the leaves, where</span>
<span class="sd">          :math:`j &lt; 2n-1` and :math:`i &lt; n`. If ``j`` is less than ``n``, the</span>
<span class="sd">          ``i``-th leaf node corresponds to an original observation.</span>
<span class="sd">          Otherwise, it corresponds to a non-singleton cluster.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    linkage, set_link_color_palette</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy.cluster import hierarchy</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>

<span class="sd">    A very basic example:</span>

<span class="sd">    &gt;&gt;&gt; ytdist = np.array([662., 877., 255., 412., 996., 295., 468., 268.,</span>
<span class="sd">    ...                    400., 754., 564., 138., 219., 869., 669.])</span>
<span class="sd">    &gt;&gt;&gt; Z = hierarchy.linkage(ytdist, &#39;single&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.figure()</span>
<span class="sd">    &gt;&gt;&gt; dn = hierarchy.dendrogram(Z)</span>

<span class="sd">    Now plot in given axes, improve the color scheme and use both vertical and</span>
<span class="sd">    horizontal orientations:</span>

<span class="sd">    &gt;&gt;&gt; hierarchy.set_link_color_palette([&#39;m&#39;, &#39;c&#39;, &#39;y&#39;, &#39;k&#39;])</span>
<span class="sd">    &gt;&gt;&gt; fig, axes = plt.subplots(1, 2, figsize=(8, 3))</span>
<span class="sd">    &gt;&gt;&gt; dn1 = hierarchy.dendrogram(Z, ax=axes[0], above_threshold_color=&#39;y&#39;,</span>
<span class="sd">    ...                            orientation=&#39;top&#39;)</span>
<span class="sd">    &gt;&gt;&gt; dn2 = hierarchy.dendrogram(Z, ax=axes[1], above_threshold_color=&#39;#bcbddc&#39;,</span>
<span class="sd">    ...                            orientation=&#39;right&#39;)</span>
<span class="sd">    &gt;&gt;&gt; hierarchy.set_link_color_palette(None)  # reset to default after use</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This feature was thought about but never implemented (still useful?):</span>
    <span class="c1">#</span>
    <span class="c1">#         ... = dendrogram(..., leaves_order=None)</span>
    <span class="c1">#</span>
    <span class="c1">#         Plots the leaves in the order specified by a vector of</span>
    <span class="c1">#         original observation indices. If the vector contains duplicates</span>
    <span class="c1">#         or results in a crossing, an exception will be thrown. Passing</span>
    <span class="c1">#         None orders leaf nodes based on the order they appear in the</span>
    <span class="c1">#         pre-order traversal.</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">orientation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;orientation must be one of &#39;top&#39;, &#39;left&#39;, &quot;</span>
                         <span class="s2">&quot;&#39;bottom&#39;, or &#39;right&#39;&quot;</span><span class="p">)</span>

    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="n">Zs</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Zs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The second argument must be a number&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">truncate_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;lastp&#39;</span><span class="p">,</span> <span class="s1">&#39;mlab&#39;</span><span class="p">,</span> <span class="s1">&#39;mtica&#39;</span><span class="p">,</span> <span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid truncation mode.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">truncate_mode</span> <span class="o">==</span> <span class="s1">&#39;lastp&#39;</span> <span class="ow">or</span> <span class="n">truncate_mode</span> <span class="o">==</span> <span class="s1">&#39;mlab&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">if</span> <span class="n">truncate_mode</span> <span class="o">==</span> <span class="s1">&#39;mtica&#39;</span> <span class="ow">or</span> <span class="n">truncate_mode</span> <span class="o">==</span> <span class="s1">&#39;level&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="k">if</span> <span class="n">get_leaves</span><span class="p">:</span>
        <span class="n">lvs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lvs</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">icoord_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dcoord_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">color_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_color</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">currently_below_threshold</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span>
    <span class="n">ivl</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of leaves</span>

    <span class="k">if</span> <span class="n">color_threshold</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">color_threshold</span><span class="p">,</span> <span class="n">string_types</span><span class="p">)</span> <span class="ow">and</span>
                                   <span class="n">color_threshold</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="n">color_threshold</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.7</span>

    <span class="n">R</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;icoord&#39;</span><span class="p">:</span> <span class="n">icoord_list</span><span class="p">,</span> <span class="s1">&#39;dcoord&#39;</span><span class="p">:</span> <span class="n">dcoord_list</span><span class="p">,</span> <span class="s1">&#39;ivl&#39;</span><span class="p">:</span> <span class="n">ivl</span><span class="p">,</span>
         <span class="s1">&#39;leaves&#39;</span><span class="p">:</span> <span class="n">lvs</span><span class="p">,</span> <span class="s1">&#39;color_list&#39;</span><span class="p">:</span> <span class="n">color_list</span><span class="p">}</span>

    <span class="c1"># Empty list will be filled in _dendrogram_calculate_info</span>
    <span class="n">contraction_marks</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">show_contracted</span> <span class="k">else</span> <span class="bp">None</span>

    <span class="n">_dendrogram_calculate_info</span><span class="p">(</span>
        <span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
        <span class="n">truncate_mode</span><span class="o">=</span><span class="n">truncate_mode</span><span class="p">,</span>
        <span class="n">color_threshold</span><span class="o">=</span><span class="n">color_threshold</span><span class="p">,</span>
        <span class="n">get_leaves</span><span class="o">=</span><span class="n">get_leaves</span><span class="p">,</span>
        <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">count_sort</span><span class="o">=</span><span class="n">count_sort</span><span class="p">,</span>
        <span class="n">distance_sort</span><span class="o">=</span><span class="n">distance_sort</span><span class="p">,</span>
        <span class="n">show_leaf_counts</span><span class="o">=</span><span class="n">show_leaf_counts</span><span class="p">,</span>
        <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">iv</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">ivl</span><span class="o">=</span><span class="n">ivl</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">icoord_list</span><span class="o">=</span><span class="n">icoord_list</span><span class="p">,</span>
        <span class="n">dcoord_list</span><span class="o">=</span><span class="n">dcoord_list</span><span class="p">,</span>
        <span class="n">lvs</span><span class="o">=</span><span class="n">lvs</span><span class="p">,</span>
        <span class="n">current_color</span><span class="o">=</span><span class="n">current_color</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="n">color_list</span><span class="p">,</span>
        <span class="n">currently_below_threshold</span><span class="o">=</span><span class="n">currently_below_threshold</span><span class="p">,</span>
        <span class="n">leaf_label_func</span><span class="o">=</span><span class="n">leaf_label_func</span><span class="p">,</span>
        <span class="n">contraction_marks</span><span class="o">=</span><span class="n">contraction_marks</span><span class="p">,</span>
        <span class="n">link_color_func</span><span class="o">=</span><span class="n">link_color_func</span><span class="p">,</span>
        <span class="n">above_threshold_color</span><span class="o">=</span><span class="n">above_threshold_color</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">no_plot</span><span class="p">:</span>
        <span class="n">mh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="n">_plot_dendrogram</span><span class="p">(</span><span class="n">icoord_list</span><span class="p">,</span> <span class="n">dcoord_list</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mh</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span>
                         <span class="n">no_labels</span><span class="p">,</span> <span class="n">color_list</span><span class="p">,</span>
                         <span class="n">leaf_font_size</span><span class="o">=</span><span class="n">leaf_font_size</span><span class="p">,</span>
                         <span class="n">leaf_rotation</span><span class="o">=</span><span class="n">leaf_rotation</span><span class="p">,</span>
                         <span class="n">contraction_marks</span><span class="o">=</span><span class="n">contraction_marks</span><span class="p">,</span>
                         <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                         <span class="n">above_threshold_color</span><span class="o">=</span><span class="n">above_threshold_color</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">R</span></div>


<span class="k">def</span> <span class="nf">_append_singleton_leaf_node</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span> <span class="n">leaf_label_func</span><span class="p">,</span>
                                <span class="n">i</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="c1"># If the leaf id structure is not None and is a list then the caller</span>
    <span class="c1"># to dendrogram has indicated that cluster id&#39;s corresponding to the</span>
    <span class="c1"># leaf nodes should be recorded.</span>

    <span class="k">if</span> <span class="n">lvs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">lvs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="c1"># If leaf node labels are to be displayed...</span>
    <span class="k">if</span> <span class="n">ivl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># If a leaf_label_func has been provided, the label comes from the</span>
        <span class="c1"># string returned from the leaf_label_func, which is a function</span>
        <span class="c1"># passed to dendrogram.</span>
        <span class="k">if</span> <span class="n">leaf_label_func</span><span class="p">:</span>
            <span class="n">ivl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf_label_func</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise, if the dendrogram caller has passed a labels list</span>
            <span class="c1"># for the leaf nodes, use it.</span>
            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ivl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Otherwise, use the id as the label for the leaf.x</span>
                <span class="n">ivl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">_append_nonsingleton_leaf_node</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span> <span class="n">leaf_label_func</span><span class="p">,</span>
                                   <span class="n">i</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">show_leaf_counts</span><span class="p">):</span>
    <span class="c1"># If the leaf id structure is not None and is a list then the caller</span>
    <span class="c1"># to dendrogram has indicated that cluster id&#39;s corresponding to the</span>
    <span class="c1"># leaf nodes should be recorded.</span>

    <span class="k">if</span> <span class="n">lvs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">lvs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ivl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">leaf_label_func</span><span class="p">:</span>
            <span class="n">ivl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf_label_func</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_leaf_counts</span><span class="p">:</span>
                <span class="n">ivl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ivl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_append_contraction_marks</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">):</span>
    <span class="n">_append_contraction_marks_sub</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">)</span>
    <span class="n">_append_contraction_marks_sub</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_append_contraction_marks_sub</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">contraction_marks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iv</span><span class="p">,</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
        <span class="n">_append_contraction_marks_sub</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">)</span>
        <span class="n">_append_contraction_marks_sub</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_dendrogram_calculate_info</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="p">,</span>
                               <span class="n">color_threshold</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">get_leaves</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                               <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                               <span class="n">count_sort</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">distance_sort</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                               <span class="n">show_leaf_counts</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                               <span class="n">ivl</span><span class="o">=</span><span class="p">[],</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">icoord_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">dcoord_list</span><span class="o">=</span><span class="p">[],</span>
                               <span class="n">lvs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mhr</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                               <span class="n">current_color</span><span class="o">=</span><span class="p">[],</span> <span class="n">color_list</span><span class="o">=</span><span class="p">[],</span>
                               <span class="n">currently_below_threshold</span><span class="o">=</span><span class="p">[],</span>
                               <span class="n">leaf_label_func</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                               <span class="n">contraction_marks</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                               <span class="n">link_color_func</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                               <span class="n">above_threshold_color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the endpoints of the links as well as the labels for the</span>
<span class="sd">    the dendrogram rooted at the node with index i. iv is the independent</span>
<span class="sd">    variable value to plot the left-most leaf node below the root node i</span>
<span class="sd">    (if orientation=&#39;top&#39;, this would be the left-most x value where the</span>
<span class="sd">    plotting of this root node i and its descendents should begin).</span>

<span class="sd">    ivl is a list to store the labels of the leaf nodes. The leaf_label_func</span>
<span class="sd">    is called whenever ivl != None, labels == None, and</span>
<span class="sd">    leaf_label_func != None. When ivl != None and labels != None, the</span>
<span class="sd">    labels list is used only for labeling the leaf nodes. When</span>
<span class="sd">    ivl == None, no labels are generated for leaf nodes.</span>

<span class="sd">    When get_leaves==True, a list of leaves is built as they are visited</span>
<span class="sd">    in the dendrogram.</span>

<span class="sd">    Returns a tuple with l being the independent variable coordinate that</span>
<span class="sd">    corresponds to the midpoint of cluster to the left of cluster i if</span>
<span class="sd">    i is non-singleton, otherwise the independent coordinate of the leaf</span>
<span class="sd">    node if i is a leaf node.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A tuple (left, w, h, md), where:</span>

<span class="sd">      * left is the independent variable coordinate of the center of the</span>
<span class="sd">        the U of the subtree</span>

<span class="sd">      * w is the amount of space used for the subtree (in independent</span>
<span class="sd">        variable units)</span>

<span class="sd">      * h is the height of the subtree in dependent variable units</span>

<span class="sd">      * md is the ``max(Z[*,2]``) for all nodes ``*`` below and including</span>
<span class="sd">        the target node.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid singleton cluster count n.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid root cluster index i.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">truncate_mode</span> <span class="o">==</span> <span class="s1">&#39;lastp&#39;</span><span class="p">:</span>
        <span class="c1"># If the node is a leaf node but corresponds to a non-single cluster,</span>
        <span class="c1"># its label is either the empty string or the number of original</span>
        <span class="c1"># observations belonging to cluster i.</span>
        <span class="k">if</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">_append_nonsingleton_leaf_node</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span>
                                           <span class="n">leaf_label_func</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                                           <span class="n">show_leaf_counts</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">contraction_marks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">_append_contraction_marks</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">_append_singleton_leaf_node</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span>
                                        <span class="n">leaf_label_func</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">truncate_mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mtica&#39;</span><span class="p">,</span> <span class="s1">&#39;level&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">_append_nonsingleton_leaf_node</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span>
                                           <span class="n">leaf_label_func</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                                           <span class="n">show_leaf_counts</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">contraction_marks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">_append_contraction_marks</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">iv</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">_append_singleton_leaf_node</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span>
                                        <span class="n">leaf_label_func</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">truncate_mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mlab&#39;</span><span class="p">,):</span>
        <span class="k">pass</span>

    <span class="c1"># Otherwise, only truncate if we have a leaf node.</span>
    <span class="c1">#</span>
    <span class="c1"># If the truncate_mode is mlab, the linkage has been modified</span>
    <span class="c1"># with the truncated tree.</span>
    <span class="c1">#</span>
    <span class="c1"># Only place leaves if they correspond to original observations.</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">_append_singleton_leaf_node</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">ivl</span><span class="p">,</span>
                                    <span class="n">leaf_label_func</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

    <span class="c1"># !!! Otherwise, we don&#39;t have a leaf node, so work on plotting a</span>
    <span class="c1"># non-leaf node.</span>
    <span class="c1"># Actual indices of a and b</span>
    <span class="n">aa</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">aa</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="c1"># The number of singletons below cluster a</span>
        <span class="n">na</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">aa</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="c1"># The distance between a&#39;s two direct children.</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">aa</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">na</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">da</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">ab</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">ab</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">ab</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">db</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">if</span> <span class="n">count_sort</span> <span class="o">==</span> <span class="s1">&#39;ascending&#39;</span> <span class="ow">or</span> <span class="n">count_sort</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="c1"># If a has a count greater than b, it and its descendents should</span>
        <span class="c1"># be drawn to the right. Otherwise, to the left.</span>
        <span class="k">if</span> <span class="n">na</span> <span class="o">&gt;</span> <span class="n">nb</span><span class="p">:</span>
            <span class="c1"># The cluster index to draw to the left (ua) will be ab</span>
            <span class="c1"># and the one to draw to the right (ub) will be aa</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">ab</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">aa</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">aa</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">ab</span>
    <span class="k">elif</span> <span class="n">count_sort</span> <span class="o">==</span> <span class="s1">&#39;descending&#39;</span><span class="p">:</span>
        <span class="c1"># If a has a count less than or equal to b, it and its</span>
        <span class="c1"># descendents should be drawn to the left. Otherwise, to</span>
        <span class="c1"># the right.</span>
        <span class="k">if</span> <span class="n">na</span> <span class="o">&gt;</span> <span class="n">nb</span><span class="p">:</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">aa</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">ab</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">ab</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">aa</span>
    <span class="k">elif</span> <span class="n">distance_sort</span> <span class="o">==</span> <span class="s1">&#39;ascending&#39;</span> <span class="ow">or</span> <span class="n">distance_sort</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="c1"># If a has a distance greater than b, it and its descendents should</span>
        <span class="c1"># be drawn to the right. Otherwise, to the left.</span>
        <span class="k">if</span> <span class="n">da</span> <span class="o">&gt;</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">ab</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">aa</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">aa</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">ab</span>
    <span class="k">elif</span> <span class="n">distance_sort</span> <span class="o">==</span> <span class="s1">&#39;descending&#39;</span><span class="p">:</span>
        <span class="c1"># If a has a distance less than or equal to b, it and its</span>
        <span class="c1"># descendents should be drawn to the left. Otherwise, to</span>
        <span class="c1"># the right.</span>
        <span class="k">if</span> <span class="n">da</span> <span class="o">&gt;</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">aa</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">ab</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ua</span> <span class="o">=</span> <span class="n">ab</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">aa</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ua</span> <span class="o">=</span> <span class="n">aa</span>
        <span class="n">ub</span> <span class="o">=</span> <span class="n">ab</span>

    <span class="c1"># Updated iv variable and the amount of space used.</span>
    <span class="p">(</span><span class="n">uiva</span><span class="p">,</span> <span class="n">uwa</span><span class="p">,</span> <span class="n">uah</span><span class="p">,</span> <span class="n">uamd</span><span class="p">)</span> <span class="o">=</span> \
        <span class="n">_dendrogram_calculate_info</span><span class="p">(</span>
            <span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
            <span class="n">truncate_mode</span><span class="o">=</span><span class="n">truncate_mode</span><span class="p">,</span>
            <span class="n">color_threshold</span><span class="o">=</span><span class="n">color_threshold</span><span class="p">,</span>
            <span class="n">get_leaves</span><span class="o">=</span><span class="n">get_leaves</span><span class="p">,</span>
            <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
            <span class="n">count_sort</span><span class="o">=</span><span class="n">count_sort</span><span class="p">,</span>
            <span class="n">distance_sort</span><span class="o">=</span><span class="n">distance_sort</span><span class="p">,</span>
            <span class="n">show_leaf_counts</span><span class="o">=</span><span class="n">show_leaf_counts</span><span class="p">,</span>
            <span class="n">i</span><span class="o">=</span><span class="n">ua</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">iv</span><span class="p">,</span> <span class="n">ivl</span><span class="o">=</span><span class="n">ivl</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">icoord_list</span><span class="o">=</span><span class="n">icoord_list</span><span class="p">,</span>
            <span class="n">dcoord_list</span><span class="o">=</span><span class="n">dcoord_list</span><span class="p">,</span> <span class="n">lvs</span><span class="o">=</span><span class="n">lvs</span><span class="p">,</span>
            <span class="n">current_color</span><span class="o">=</span><span class="n">current_color</span><span class="p">,</span>
            <span class="n">color_list</span><span class="o">=</span><span class="n">color_list</span><span class="p">,</span>
            <span class="n">currently_below_threshold</span><span class="o">=</span><span class="n">currently_below_threshold</span><span class="p">,</span>
            <span class="n">leaf_label_func</span><span class="o">=</span><span class="n">leaf_label_func</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="o">=</span><span class="n">contraction_marks</span><span class="p">,</span>
            <span class="n">link_color_func</span><span class="o">=</span><span class="n">link_color_func</span><span class="p">,</span>
            <span class="n">above_threshold_color</span><span class="o">=</span><span class="n">above_threshold_color</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;=</span> <span class="n">color_threshold</span> <span class="ow">or</span> <span class="n">color_threshold</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">above_threshold_color</span>

        <span class="k">if</span> <span class="n">currently_below_threshold</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">current_color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">_link_line_colors</span><span class="p">)</span>
        <span class="n">currently_below_threshold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">currently_below_threshold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">_link_line_colors</span><span class="p">[</span><span class="n">current_color</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="p">(</span><span class="n">uivb</span><span class="p">,</span> <span class="n">uwb</span><span class="p">,</span> <span class="n">ubh</span><span class="p">,</span> <span class="n">ubmd</span><span class="p">)</span> <span class="o">=</span> \
        <span class="n">_dendrogram_calculate_info</span><span class="p">(</span>
            <span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
            <span class="n">truncate_mode</span><span class="o">=</span><span class="n">truncate_mode</span><span class="p">,</span>
            <span class="n">color_threshold</span><span class="o">=</span><span class="n">color_threshold</span><span class="p">,</span>
            <span class="n">get_leaves</span><span class="o">=</span><span class="n">get_leaves</span><span class="p">,</span>
            <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
            <span class="n">count_sort</span><span class="o">=</span><span class="n">count_sort</span><span class="p">,</span>
            <span class="n">distance_sort</span><span class="o">=</span><span class="n">distance_sort</span><span class="p">,</span>
            <span class="n">show_leaf_counts</span><span class="o">=</span><span class="n">show_leaf_counts</span><span class="p">,</span>
            <span class="n">i</span><span class="o">=</span><span class="n">ub</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">iv</span> <span class="o">+</span> <span class="n">uwa</span><span class="p">,</span> <span class="n">ivl</span><span class="o">=</span><span class="n">ivl</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">icoord_list</span><span class="o">=</span><span class="n">icoord_list</span><span class="p">,</span>
            <span class="n">dcoord_list</span><span class="o">=</span><span class="n">dcoord_list</span><span class="p">,</span> <span class="n">lvs</span><span class="o">=</span><span class="n">lvs</span><span class="p">,</span>
            <span class="n">current_color</span><span class="o">=</span><span class="n">current_color</span><span class="p">,</span>
            <span class="n">color_list</span><span class="o">=</span><span class="n">color_list</span><span class="p">,</span>
            <span class="n">currently_below_threshold</span><span class="o">=</span><span class="n">currently_below_threshold</span><span class="p">,</span>
            <span class="n">leaf_label_func</span><span class="o">=</span><span class="n">leaf_label_func</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">contraction_marks</span><span class="o">=</span><span class="n">contraction_marks</span><span class="p">,</span>
            <span class="n">link_color_func</span><span class="o">=</span><span class="n">link_color_func</span><span class="p">,</span>
            <span class="n">above_threshold_color</span><span class="o">=</span><span class="n">above_threshold_color</span><span class="p">)</span>

    <span class="n">max_dist</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">uamd</span><span class="p">,</span> <span class="n">ubmd</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

    <span class="n">icoord_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">uiva</span><span class="p">,</span> <span class="n">uiva</span><span class="p">,</span> <span class="n">uivb</span><span class="p">,</span> <span class="n">uivb</span><span class="p">])</span>
    <span class="n">dcoord_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">uah</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">ubh</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">link_color_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">link_color_func</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;link_color_func must return a matplotlib &quot;</span>
                            <span class="s2">&quot;color string!&quot;</span><span class="p">)</span>
        <span class="n">color_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">color_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(((</span><span class="n">uiva</span> <span class="o">+</span> <span class="n">uivb</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">uwa</span> <span class="o">+</span> <span class="n">uwb</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span>


<div class="viewcode-block" id="is_isomorphic"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.is_isomorphic.html#scipy.cluster.hierarchy.is_isomorphic">[docs]</a><span class="k">def</span> <span class="nf">is_isomorphic</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if two different cluster assignments are equivalent.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    T1 : array_like</span>
<span class="sd">        An assignment of singleton cluster ids to flat cluster ids.</span>
<span class="sd">    T2 : array_like</span>
<span class="sd">        An assignment of singleton cluster ids to flat cluster ids.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    b : bool</span>
<span class="sd">        Whether the flat cluster assignments `T1` and `T2` are</span>
<span class="sd">        equivalent.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">T2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;T1 must be a numpy array.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;T2 must be a numpy array.&#39;</span><span class="p">)</span>

    <span class="n">T1S</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">T2S</span> <span class="o">=</span> <span class="n">T2</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">T1S</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;T1 must be one-dimensional.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">T2S</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;T2 must be one-dimensional.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">T1S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">T2S</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;T1 and T2 must have the same number of elements.&#39;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">T1S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">T1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">T1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">T2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">T1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">T2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">True</span></div>


<div class="viewcode-block" id="maxdists"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.maxdists.html#scipy.cluster.hierarchy.maxdists">[docs]</a><span class="k">def</span> <span class="nf">maxdists</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the maximum distance between any non-singleton cluster.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as a matrix. See</span>
<span class="sd">        ``linkage`` for more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    maxdists : ndarray</span>
<span class="sd">        A ``(n-1)`` sized numpy array of doubles; ``MD[i]`` represents</span>
<span class="sd">        the maximum distance between any cluster (including</span>
<span class="sd">        singletons) below and including the node with index i. More</span>
<span class="sd">        specifically, ``MD[i] = Z[Q(i)-n, 2].max()`` where ``Q(i)`` is the</span>
<span class="sd">        set of all node indices below and including node i.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">MD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,))</span>
    <span class="p">[</span><span class="n">Z</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">Z</span><span class="p">])</span>
    <span class="n">_hierarchy</span><span class="o">.</span><span class="n">get_max_dist_for_each_cluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">MD</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">MD</span></div>


<div class="viewcode-block" id="maxinconsts"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.maxinconsts.html#scipy.cluster.hierarchy.maxinconsts">[docs]</a><span class="k">def</span> <span class="nf">maxinconsts</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the maximum inconsistency coefficient for each</span>
<span class="sd">    non-singleton cluster and its descendents.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as a matrix. See</span>
<span class="sd">        ``linkage`` for more information.</span>
<span class="sd">    R : ndarray</span>
<span class="sd">        The inconsistency matrix.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MI : ndarray</span>
<span class="sd">        A monotonic ``(n-1)``-sized numpy array of doubles.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="n">is_valid_im</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The inconsistency matrix and linkage matrix each &quot;</span>
                         <span class="s2">&quot;have a different number of rows.&quot;</span><span class="p">)</span>
    <span class="n">MI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,))</span>
    <span class="p">[</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">])</span>
    <span class="n">_hierarchy</span><span class="o">.</span><span class="n">get_max_Rfield_for_each_cluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">MI</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MI</span></div>


<div class="viewcode-block" id="maxRstat"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.maxRstat.html#scipy.cluster.hierarchy.maxRstat">[docs]</a><span class="k">def</span> <span class="nf">maxRstat</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the maximum statistic for each non-singleton cluster and</span>
<span class="sd">    its descendents.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : array_like</span>
<span class="sd">        The hierarchical clustering encoded as a matrix. See `linkage` for more</span>
<span class="sd">        information.</span>
<span class="sd">    R : array_like</span>
<span class="sd">        The inconsistency matrix.</span>
<span class="sd">    i : int</span>
<span class="sd">        The column of `R` to use as the statistic.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MR : ndarray</span>
<span class="sd">        Calculates the maximum statistic for the i&#39;th column of the</span>
<span class="sd">        inconsistency matrix `R` for each non-singleton cluster</span>
<span class="sd">        node. ``MR[j]`` is the maximum over ``R[Q(j)-n, i]`` where</span>
<span class="sd">        ``Q(j)`` the set of all node ids corresponding to nodes below</span>
<span class="sd">        and including ``j``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="n">is_valid_im</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The third argument must be an integer.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;i must be an integer between 0 and 3 inclusive.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The inconsistency matrix and linkage matrix each &quot;</span>
                         <span class="s2">&quot;have a different number of rows.&quot;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">MR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,))</span>
    <span class="p">[</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">])</span>
    <span class="n">_hierarchy</span><span class="o">.</span><span class="n">get_max_Rfield_for_each_cluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">MR</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MR</span></div>


<div class="viewcode-block" id="leaders"><a class="viewcode-back" href="../../../generated/scipy.cluster.hierarchy.leaders.html#scipy.cluster.hierarchy.leaders">[docs]</a><span class="k">def</span> <span class="nf">leaders</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the root nodes in a hierarchical clustering.</span>

<span class="sd">    Returns the root nodes in a hierarchical clustering corresponding</span>
<span class="sd">    to a cut defined by a flat cluster assignment vector ``T``. See</span>
<span class="sd">    the ``fcluster`` function for more information on the format of ``T``.</span>

<span class="sd">    For each flat cluster :math:`j` of the :math:`k` flat clusters</span>
<span class="sd">    represented in the n-sized flat cluster assignment vector ``T``,</span>
<span class="sd">    this function finds the lowest cluster node :math:`i` in the linkage</span>
<span class="sd">    tree Z such that:</span>

<span class="sd">      * leaf descendents belong only to flat cluster j</span>
<span class="sd">        (i.e. ``T[p]==j`` for all :math:`p` in :math:`S(i)` where</span>
<span class="sd">        :math:`S(i)` is the set of leaf ids of leaf nodes descendent</span>
<span class="sd">        with cluster node :math:`i`)</span>

<span class="sd">      * there does not exist a leaf that is not descendent with</span>
<span class="sd">        :math:`i` that also belongs to cluster :math:`j`</span>
<span class="sd">        (i.e. ``T[q]!=j`` for all :math:`q` not in :math:`S(i)`).  If</span>
<span class="sd">        this condition is violated, ``T`` is not a valid cluster</span>
<span class="sd">        assignment vector, and an exception will be thrown.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        The hierarchical clustering encoded as a matrix. See</span>
<span class="sd">        ``linkage`` for more information.</span>
<span class="sd">    T : ndarray</span>
<span class="sd">        The flat cluster assignment vector.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    L : ndarray</span>
<span class="sd">        The leader linkage node id&#39;s stored as a k-element 1-D array</span>
<span class="sd">        where ``k`` is the number of flat clusters found in ``T``.</span>

<span class="sd">        ``L[j]=i`` is the linkage cluster node id that is the</span>
<span class="sd">        leader of flat cluster with id M[j].  If ``i &lt; n``, ``i``</span>
<span class="sd">        corresponds to an original observation, otherwise it</span>
<span class="sd">        corresponds to a non-singleton cluster.</span>

<span class="sd">        For example: if ``L[3]=2`` and ``M[3]=8``, the flat cluster with</span>
<span class="sd">        id 8&#39;s leader is linkage node 2.</span>
<span class="sd">    M : ndarray</span>
<span class="sd">        The leader linkage node id&#39;s stored as a k-element 1-D array where</span>
<span class="sd">        ``k`` is the number of flat clusters found in ``T``. This allows the</span>
<span class="sd">        set of flat cluster ids to be any arbitrary set of ``k`` integers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">or</span> <span class="n">T</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;T must be a one-dimensional numpy array of integers.&#39;</span><span class="p">)</span>
    <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">throw</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Mismatch: len(T)!=Z.shape[0] + 1.&#39;</span><span class="p">)</span>

    <span class="n">Cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">kk</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">kk</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">kk</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">[</span><span class="n">Z</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">_copy_arrays_if_base_present</span><span class="p">([</span><span class="n">Z</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">_hierarchy</span><span class="o">.</span><span class="n">leaders</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">kk</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">((</span><span class="s1">&#39;T is not a valid assignment vector. Error found &#39;</span>
                          <span class="s1">&#39;when examining linkage node </span><span class="si">%d</span><span class="s1"> (&lt; 2n-1).&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>