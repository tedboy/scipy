

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>scipy.stats.stats</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Scipy API
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">1. SciPy Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/general.html">1.1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/general.html#scipy-organization">1.1.1. SciPy Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/general.html#finding-documentation">1.1.2. Finding Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/basic.html">1.2. Basic functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/basic.html#interaction-with-numpy">1.2.1. Interaction with Numpy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#index-tricks">1.2.1.1. Index Tricks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#shape-manipulation">1.2.1.2. Shape manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#polynomials">1.2.1.3. Polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#vectorizing-functions-vectorize">1.2.1.4. Vectorizing functions (vectorize)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#type-handling">1.2.1.5. Type handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/basic.html#other-useful-functions">1.2.1.6. Other useful functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/special.html">1.3. Special functions (<code class="docutils literal"><span class="pre">scipy.special</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/special.html#bessel-functions-of-real-order-jn-jn-zeros">1.3.1. Bessel functions of real order(<code class="docutils literal"><span class="pre">jn()</span></code>, <code class="docutils literal"><span class="pre">jn_zeros()</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/integrate.html">1.4. Integration (<code class="docutils literal"><span class="pre">scipy.integrate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#general-integration-quad">1.4.1. General integration (<code class="docutils literal"><span class="pre">quad()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#general-multiple-integration-dblquad-tplquad-nquad">1.4.2. General multiple integration (<code class="docutils literal"><span class="pre">dblquad()</span></code>, <code class="docutils literal"><span class="pre">tplquad()</span></code>, <code class="docutils literal"><span class="pre">nquad()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#gaussian-quadrature">1.4.3. Gaussian quadrature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#romberg-integration">1.4.4. Romberg Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#integrating-using-samples">1.4.5. Integrating using Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#faster-integration-using-ctypes">1.4.6. Faster integration using Ctypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/integrate.html#ordinary-differential-equations-odeint">1.4.7. Ordinary differential equations (<code class="docutils literal"><span class="pre">odeint()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/integrate.html#references">1.4.7.1. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/optimize.html">1.5. Optimization (<code class="docutils literal"><span class="pre">scipy.optimize</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#unconstrained-minimization-of-multivariate-scalar-functions-minimize">1.5.1. Unconstrained minimization of multivariate scalar functions (<code class="docutils literal"><span class="pre">minimize()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#nelder-mead-simplex-algorithm-method-nelder-mead">1.5.1.1. Nelder-Mead Simplex algorithm (<code class="docutils literal"><span class="pre">method='Nelder-Mead'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#broyden-fletcher-goldfarb-shanno-algorithm-method-bfgs">1.5.1.2. Broyden-Fletcher-Goldfarb-Shanno algorithm (<code class="docutils literal"><span class="pre">method='BFGS'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#newton-conjugate-gradient-algorithm-method-newton-cg">1.5.1.3. Newton-Conjugate-Gradient algorithm (<code class="docutils literal"><span class="pre">method='Newton-CG'</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#constrained-minimization-of-multivariate-scalar-functions-minimize">1.5.2. Constrained minimization of multivariate scalar functions (<code class="docutils literal"><span class="pre">minimize()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#least-squares-minimization-least-squares">1.5.3. Least-squares minimization (<code class="docutils literal"><span class="pre">least_squares()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#example-of-solving-a-fitting-problem">1.5.3.1. Example of solving a fitting problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#further-examples">1.5.3.2. Further examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#univariate-function-minimizers-minimize-scalar">1.5.4. Univariate function minimizers (<code class="docutils literal"><span class="pre">minimize_scalar()</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#unconstrained-minimization-method-brent">1.5.4.1. Unconstrained minimization (<code class="docutils literal"><span class="pre">method='brent'</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#bounded-minimization-method-bounded">1.5.4.2. Bounded minimization (<code class="docutils literal"><span class="pre">method='bounded'</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#custom-minimizers">1.5.5. Custom minimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/optimize.html#root-finding">1.5.6. Root finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#scalar-functions">1.5.6.1. Scalar functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#fixed-point-solving">1.5.6.2. Fixed-point solving</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#sets-of-equations">1.5.6.3. Sets of equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#root-finding-for-large-problems">1.5.6.4. Root finding for large problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/optimize.html#still-too-slow-preconditioning">1.5.6.5. Still too slow? Preconditioning.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/interpolate.html">1.6. Interpolation (<code class="docutils literal"><span class="pre">scipy.interpolate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#d-interpolation-interp1d">1.6.1. 1-D interpolation (<code class="docutils literal"><span class="pre">interp1d</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#multivariate-data-interpolation-griddata">1.6.2. Multivariate data interpolation (<code class="docutils literal"><span class="pre">griddata()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation">1.6.3. Spline interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation-in-1-d-procedural-interpolate-splxxx">1.6.3.1. Spline interpolation in 1-d: Procedural (interpolate.splXXX)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#spline-interpolation-in-1-d-object-oriented-univariatespline">1.6.3.2. Spline interpolation in 1-d: Object-oriented (<code class="docutils literal"><span class="pre">UnivariateSpline</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#two-dimensional-spline-representation-procedural-bisplrep">1.6.3.3. Two-dimensional spline representation: Procedural (<code class="docutils literal"><span class="pre">bisplrep()</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#two-dimensional-spline-representation-object-oriented-bivariatespline">1.6.3.4. Two-dimensional spline representation: Object-oriented (<code class="docutils literal"><span class="pre">BivariateSpline</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/interpolate.html#using-radial-basis-functions-for-smoothing-interpolation">1.6.4. Using radial basis functions for smoothing/interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#d-example">1.6.4.1. 1-d Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/interpolate.html#id1">1.6.4.2. 2-d Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/fftpack.html">1.7. Fourier Transforms (<code class="docutils literal"><span class="pre">scipy.fftpack</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#fast-fourier-transforms">1.7.1. Fast Fourier transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#one-dimensional-discrete-fourier-transforms">1.7.1.1. One dimensional discrete Fourier transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#two-and-n-dimensional-discrete-fourier-transforms">1.7.1.2. Two and n-dimensional discrete Fourier transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#fft-convolution">1.7.1.3. FFT convolution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#discrete-cosine-transforms">1.7.2. Discrete Cosine Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-i-dct">1.7.2.1. Type I DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-ii-dct">1.7.2.2. Type II DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-iii-dct">1.7.2.3. Type III DCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#dct-and-idct">1.7.2.4. DCT and IDCT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#example">1.7.2.5. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#discrete-sine-transforms">1.7.3. Discrete Sine Transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-i-dst">1.7.3.1. Type I DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-ii-dst">1.7.3.2. Type II DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#type-iii-dst">1.7.3.3. Type III DST</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/fftpack.html#dst-and-idst">1.7.3.4. DST and IDST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#cache-destruction">1.7.4. Cache Destruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/fftpack.html#references">1.7.5. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/signal.html">1.8. Signal Processing (<cite>scipy.signal</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#b-splines">1.8.1. B-splines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#filtering">1.8.2. Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#convolution-correlation">1.8.2.1. Convolution/Correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#difference-equation-filtering">1.8.2.2. Difference-equation filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#filter-design">1.8.2.3. Filter Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#other-filters">1.8.2.4. Other filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#analog-filter-design">1.8.2.5. Analog Filter Design</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#spectral-analysis">1.8.3. Spectral Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#periodogram-measurements">1.8.3.1. Periodogram Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#spectral-analysis-using-welch-s-method">1.8.3.2. Spectral Analysis using Welch&#8217;s Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/signal.html#lomb-scargle-periodograms-lombscargle">1.8.3.3. Lomb-Scargle Periodograms (<code class="docutils literal"><span class="pre">lombscargle()</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/signal.html#detrend">1.8.4. Detrend</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/linalg.html">1.9. Linear Algebra (<cite>scipy.linalg</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#scipy-linalg-vs-numpy-linalg">1.9.1. scipy.linalg vs numpy.linalg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#numpy-matrix-vs-2d-numpy-ndarray">1.9.2. numpy.matrix vs 2D numpy.ndarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#basic-routines">1.9.3. Basic routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#finding-inverse">1.9.3.1. Finding Inverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#solving-linear-system">1.9.3.2. Solving linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#finding-determinant">1.9.3.3. Finding Determinant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#computing-norms">1.9.3.4. Computing norms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#solving-linear-least-squares-problems-and-pseudo-inverses">1.9.3.5. Solving linear least-squares problems and pseudo-inverses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#generalized-inverse">1.9.3.6. Generalized inverse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#decompositions">1.9.4. Decompositions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#eigenvalues-and-eigenvectors">1.9.4.1. Eigenvalues and eigenvectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#singular-value-decomposition">1.9.4.2. Singular value decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#lu-decomposition">1.9.4.3. LU decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#cholesky-decomposition">1.9.4.4. Cholesky decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#qr-decomposition">1.9.4.5. QR decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#schur-decomposition">1.9.4.6. Schur decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#interpolative-decomposition">1.9.4.7. Interpolative Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#matrix-functions">1.9.5. Matrix Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#exponential-and-logarithm-functions">1.9.5.1. Exponential and logarithm functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#trigonometric-functions">1.9.5.2. Trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#hyperbolic-trigonometric-functions">1.9.5.3. Hyperbolic trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/linalg.html#arbitrary-function">1.9.5.4. Arbitrary function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/linalg.html#special-matrices">1.9.6. Special matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/arpack.html">1.10. Sparse Eigenvalue Problems with ARPACK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#introduction">1.10.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#basic-functionality">1.10.2. Basic Functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#shift-invert-mode">1.10.3. Shift-Invert Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#examples">1.10.4. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/arpack.html#references">1.10.5. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/csgraph.html">1.11. Compressed Sparse Graph Routines (<cite>scipy.sparse.csgraph</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/csgraph.html#example-word-ladders">1.11.1. Example: Word Ladders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/spatial.html">1.12. Spatial data structures and algorithms (<cite>scipy.spatial</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#delaunay-triangulations">1.12.1. Delaunay triangulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/spatial.html#coplanar-points">1.12.1.1. Coplanar points</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#convex-hulls">1.12.2. Convex hulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/spatial.html#voronoi-diagrams">1.12.3. Voronoi diagrams</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/stats.html">1.13. Statistics (<cite>scipy.stats</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#introduction">1.13.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#random-variables">1.13.2. Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#getting-help">1.13.2.1. Getting Help</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#common-methods">1.13.2.2. Common Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#shifting-and-scaling">1.13.2.3. Shifting and Scaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#shape-parameters">1.13.2.4. Shape Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#freezing-a-distribution">1.13.2.5. Freezing a Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#broadcasting">1.13.2.6. Broadcasting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#specific-points-for-discrete-distributions">1.13.2.7. Specific Points for Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#fitting-distributions">1.13.2.8. Fitting Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#performance-issues-and-cautionary-remarks">1.13.2.9. Performance Issues and Cautionary Remarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#remaining-issues">1.13.2.10. Remaining Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#building-specific-distributions">1.13.3. Building Specific Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#making-a-continuous-distribution-i-e-subclassing-rv-continuous">1.13.3.1. Making a Continuous Distribution, i.e., Subclassing <code class="docutils literal"><span class="pre">rv_continuous</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#subclassing-rv-discrete">1.13.3.2. Subclassing <code class="docutils literal"><span class="pre">rv_discrete</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#analysing-one-sample">1.13.4. Analysing One Sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#descriptive-statistics">1.13.4.1. Descriptive Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#t-test-and-ks-test">1.13.4.2. T-test and KS-test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#tails-of-the-distribution">1.13.4.3. Tails of the distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#special-tests-for-normal-distributions">1.13.4.4. Special tests for normal distributions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#comparing-two-samples">1.13.5. Comparing two samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#comparing-means">1.13.5.1. Comparing means</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#kolmogorov-smirnov-test-for-two-samples-ks-2samp">1.13.5.2. Kolmogorov-Smirnov test for two samples ks_2samp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/stats.html#kernel-density-estimation">1.13.6. Kernel Density Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#univariate-estimation">1.13.6.1. Univariate estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/stats.html#multivariate-estimation">1.13.6.2. Multivariate estimation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/ndimage.html">1.14. Multidimensional image processing (<cite>scipy.ndimage</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#introduction">1.14.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#properties-shared-by-all-functions">1.14.2. Properties shared by all functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#filter-functions">1.14.3. Filter functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#correlation-and-convolution">1.14.3.1. Correlation and convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#smoothing-filters">1.14.3.2. Smoothing filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#filters-based-on-order-statistics">1.14.3.3. Filters based on order statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#derivatives">1.14.3.4. Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#generic-filter-functions">1.14.3.5. Generic filter functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#fourier-domain-filters">1.14.3.6. Fourier domain filters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#interpolation-functions">1.14.4. Interpolation functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#spline-pre-filters">1.14.4.1. Spline pre-filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#id8">1.14.4.2. Interpolation functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#morphology">1.14.5. Morphology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#binary-morphology">1.14.5.1. Binary morphology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/ndimage.html#grey-scale-morphology">1.14.5.2. Grey-scale morphology</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#distance-transforms">1.14.6. Distance transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#segmentation-and-labeling">1.14.7. Segmentation and labeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#object-measurements">1.14.8. Object measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#extending-scipy-ndimage-in-c">1.14.9. Extending <code class="docutils literal"><span class="pre">scipy.ndimage</span></code> in C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/ndimage.html#functions-that-support-c-callback-functions">1.14.10. Functions that support C callback functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/io.html">1.15. File IO (<code class="docutils literal"><span class="pre">scipy.io</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#matlab-files">1.15.1. MATLAB files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#the-basic-functions">1.15.1.1. The basic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#how-do-i-start">1.15.1.2. How do I start?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#matlab-structs">1.15.1.3. MATLAB structs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/io.html#matlab-cell-arrays">1.15.1.4. MATLAB cell arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#idl-files">1.15.2. IDL files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#matrix-market-files">1.15.3. Matrix Market files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.wavfile">1.15.4. Wav sound files (<code class="docutils literal"><span class="pre">scipy.io.wavfile</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.arff">1.15.5. Arff files (<code class="docutils literal"><span class="pre">scipy.io.arff</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/io.html#module-scipy.io.netcdf">1.15.6. Netcdf (<code class="docutils literal"><span class="pre">scipy.io.netcdf</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial/weave.html">1.16. Weave (<cite>scipy.weave</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#outline">1.16.1. Outline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#introduction">1.16.2. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#requirements">1.16.3. Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#installation">1.16.4. Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#testing">1.16.5. Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#testing-notes">1.16.5.1. Testing Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#benchmarks">1.16.6. Benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#inline">1.16.7. Inline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#more-with-printf">1.16.7.1. More with printf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#more-examples">1.16.7.2. More examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#keyword-option">1.16.7.3. Keyword Option</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#inline-arguments">1.16.7.4. Inline Arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#distutils-keywords">1.16.7.5. Distutils keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#technical-details">1.16.7.6. Technical Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#passing-variables-in-out-of-the-c-c-code">1.16.7.7. Passing Variables in/out of the C/C++ code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#type-conversions">1.16.7.8. Type Conversions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#the-catalog">1.16.7.9. The Catalog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#blitz">1.16.8. Blitz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#id1">1.16.8.1. Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#limitations">1.16.8.2. Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#numpy-efficiency-issues-what-compilation-buys-you">1.16.8.3. NumPy efficiency issues: What compilation buys you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#the-tools">1.16.8.4. The Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#type-definitions-and-coercion">1.16.8.5. Type definitions and coercion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#cataloging-compiled-functions">1.16.8.6. Cataloging Compiled Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#checking-array-sizes">1.16.8.7. Checking Array Sizes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#creating-the-extension-module">1.16.8.8. Creating the Extension Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#extension-modules">1.16.9. Extension Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#a-simple-example">1.16.9.1. A Simple Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorial/weave.html#fibonacci-example">1.16.9.2. Fibonacci Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#customizing-type-conversions-type-factories">1.16.10. Customizing Type Conversions &#8211; Type Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorial/weave.html#things-i-wish-weave-did">1.16.11. Things I wish <code class="docutils literal"><span class="pre">weave</span></code> did</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../API.html">2. API - importing from Scipy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../API.html#guidelines-for-importing-functions-from-scipy">2.1. Guidelines for importing functions from Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../API.html#api-definition">2.2. API definition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_c_to_i.html">3. API (<code class="docutils literal"><span class="pre">c-i</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cluster.html">3.1. <code class="docutils literal"><span class="pre">scipy.cluster</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.html#clustering-package-scipy-cluster">3.1.1. Clustering package (<code class="docutils literal"><span class="pre">scipy.cluster</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.vq.html">3.1.2. K-means clustering and vector quantization (<code class="docutils literal"><span class="pre">scipy.cluster.vq</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.whiten.html">3.1.2.1. scipy.cluster.vq.whiten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.vq.html">3.1.2.2. scipy.cluster.vq.vq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.kmeans.html">3.1.2.3. scipy.cluster.vq.kmeans</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.vq.kmeans2.html">3.1.2.4. scipy.cluster.vq.kmeans2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cluster.vq.html#background-information">3.1.2.5. Background information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cluster.hierarchy.html">3.1.3. Hierarchical clustering (<code class="docutils literal"><span class="pre">scipy.cluster.hierarchy</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.fcluster.html">3.1.3.1. scipy.cluster.hierarchy.fcluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.fclusterdata.html">3.1.3.2. scipy.cluster.hierarchy.fclusterdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.leaders.html">3.1.3.3. scipy.cluster.hierarchy.leaders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.linkage.html">3.1.3.4. scipy.cluster.hierarchy.linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.single.html">3.1.3.5. scipy.cluster.hierarchy.single</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.complete.html">3.1.3.6. scipy.cluster.hierarchy.complete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.average.html">3.1.3.7. scipy.cluster.hierarchy.average</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.weighted.html">3.1.3.8. scipy.cluster.hierarchy.weighted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.centroid.html">3.1.3.9. scipy.cluster.hierarchy.centroid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.median.html">3.1.3.10. scipy.cluster.hierarchy.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.ward.html">3.1.3.11. scipy.cluster.hierarchy.ward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.cophenet.html">3.1.3.12. scipy.cluster.hierarchy.cophenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.from_mlab_linkage.html">3.1.3.13. scipy.cluster.hierarchy.from_mlab_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.inconsistent.html">3.1.3.14. scipy.cluster.hierarchy.inconsistent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxinconsts.html">3.1.3.15. scipy.cluster.hierarchy.maxinconsts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxdists.html">3.1.3.16. scipy.cluster.hierarchy.maxdists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.maxRstat.html">3.1.3.17. scipy.cluster.hierarchy.maxRstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.to_mlab_linkage.html">3.1.3.18. scipy.cluster.hierarchy.to_mlab_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.dendrogram.html">3.1.3.19. scipy.cluster.hierarchy.dendrogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.ClusterNode.html">3.1.3.20. scipy.cluster.hierarchy.ClusterNode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.leaves_list.html">3.1.3.21. scipy.cluster.hierarchy.leaves_list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.to_tree.html">3.1.3.22. scipy.cluster.hierarchy.to_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.cut_tree.html">3.1.3.23. scipy.cluster.hierarchy.cut_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_valid_im.html">3.1.3.24. scipy.cluster.hierarchy.is_valid_im</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_valid_linkage.html">3.1.3.25. scipy.cluster.hierarchy.is_valid_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_isomorphic.html">3.1.3.26. scipy.cluster.hierarchy.is_isomorphic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.is_monotonic.html">3.1.3.27. scipy.cluster.hierarchy.is_monotonic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.correspond.html">3.1.3.28. scipy.cluster.hierarchy.correspond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.num_obs_linkage.html">3.1.3.29. scipy.cluster.hierarchy.num_obs_linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.cluster.hierarchy.set_link_color_palette.html">3.1.3.30. scipy.cluster.hierarchy.set_link_color_palette</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cluster.hierarchy.html#references">3.1.3.31. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../constants.html">3.2. Constants (<code class="docutils literal"><span class="pre">scipy.constants</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#mathematical-constants">3.2.1. Mathematical constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#physical-constants">3.2.2. Physical constants</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#constants-database">3.2.2.1. Constants database</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#units">3.2.3. Units</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#si-prefixes">3.2.3.1. SI prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#binary-prefixes">3.2.3.2. Binary prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#weight">3.2.3.3. Weight</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#angle">3.2.3.4. Angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#time">3.2.3.5. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#length">3.2.3.6. Length</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#pressure">3.2.3.7. Pressure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#area">3.2.3.8. Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#volume">3.2.3.9. Volume</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#speed">3.2.3.10. Speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#temperature">3.2.3.11. Temperature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#energy">3.2.3.12. Energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#power">3.2.3.13. Power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#force">3.2.3.14. Force</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../constants.html#optics">3.2.3.15. Optics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../constants.html#references">3.2.4. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../fftpack.html">3.3. Discrete Fourier transforms (<code class="docutils literal"><span class="pre">scipy.fftpack</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#fast-fourier-transforms-ffts">3.3.1. Fast Fourier Transforms (FFTs)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fft.html">3.3.1.1. scipy.fftpack.fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifft.html">3.3.1.2. scipy.fftpack.ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fft2.html">3.3.1.3. scipy.fftpack.fft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifft2.html">3.3.1.4. scipy.fftpack.ifft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftn.html">3.3.1.5. scipy.fftpack.fftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifftn.html">3.3.1.6. scipy.fftpack.ifftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.rfft.html">3.3.1.7. scipy.fftpack.rfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.irfft.html">3.3.1.8. scipy.fftpack.irfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.dct.html">3.3.1.9. scipy.fftpack.dct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.idct.html">3.3.1.10. scipy.fftpack.idct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.dst.html">3.3.1.11. scipy.fftpack.dst</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.idst.html">3.3.1.12. scipy.fftpack.idst</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#differential-and-pseudo-differential-operators">3.3.2. Differential and pseudo-differential operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.diff.html">3.3.2.1. scipy.fftpack.diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.tilbert.html">3.3.2.2. scipy.fftpack.tilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.itilbert.html">3.3.2.3. scipy.fftpack.itilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.hilbert.html">3.3.2.4. scipy.fftpack.hilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ihilbert.html">3.3.2.5. scipy.fftpack.ihilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.cs_diff.html">3.3.2.6. scipy.fftpack.cs_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.sc_diff.html">3.3.2.7. scipy.fftpack.sc_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ss_diff.html">3.3.2.8. scipy.fftpack.ss_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.cc_diff.html">3.3.2.9. scipy.fftpack.cc_diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.shift.html">3.3.2.10. scipy.fftpack.shift</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#helper-functions">3.3.3. Helper functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftshift.html">3.3.3.1. scipy.fftpack.fftshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.ifftshift.html">3.3.3.2. scipy.fftpack.ifftshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.fftfreq.html">3.3.3.3. scipy.fftpack.fftfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.rfftfreq.html">3.3.3.4. scipy.fftpack.rfftfreq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fftpack.html#module-scipy.fftpack.convolve">3.3.4. Convolutions (<code class="docutils literal"><span class="pre">scipy.fftpack.convolve</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.convolve.html">3.3.4.1. scipy.fftpack.convolve.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.convolve_z.html">3.3.4.2. scipy.fftpack.convolve.convolve_z</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.init_convolution_kernel.html">3.3.4.3. scipy.fftpack.convolve.init_convolution_kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.fftpack.convolve.destroy_convolve_cache.html">3.3.4.4. scipy.fftpack.convolve.destroy_convolve_cache</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../integrate.html">3.4. Integration and ODEs (<code class="docutils literal"><span class="pre">scipy.integrate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrating-functions-given-function-object">3.4.1. Integrating functions, given function object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quad.html">3.4.1.1. scipy.integrate.quad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.dblquad.html">3.4.1.2. scipy.integrate.dblquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.tplquad.html">3.4.1.3. scipy.integrate.tplquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.nquad.html">3.4.1.4. scipy.integrate.nquad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.fixed_quad.html">3.4.1.5. scipy.integrate.fixed_quad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quadrature.html">3.4.1.6. scipy.integrate.quadrature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.romberg.html">3.4.1.7. scipy.integrate.romberg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.quad_explain.html">3.4.1.8. scipy.integrate.quad_explain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.newton_cotes.html">3.4.1.9. scipy.integrate.newton_cotes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.IntegrationWarning.html">3.4.1.10. scipy.integrate.IntegrationWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrating-functions-given-fixed-samples">3.4.2. Integrating functions, given fixed samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.trapz.html">3.4.2.1. scipy.integrate.trapz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.cumtrapz.html">3.4.2.2. scipy.integrate.cumtrapz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.simps.html">3.4.2.3. scipy.integrate.simps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.romb.html">3.4.2.4. scipy.integrate.romb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../integrate.html#integrators-of-ode-systems">3.4.3. Integrators of ODE systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.odeint.html">3.4.3.1. scipy.integrate.odeint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.ode.html">3.4.3.2. scipy.integrate.ode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.integrate.complex_ode.html">3.4.3.3. scipy.integrate.complex_ode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../interpolate.html">3.5. Interpolation (<code class="docutils literal"><span class="pre">scipy.interpolate</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#univariate-interpolation">3.5.1. Univariate interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interp1d.html">3.5.1.1. scipy.interpolate.interp1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BarycentricInterpolator.html">3.5.1.2. scipy.interpolate.BarycentricInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.KroghInterpolator.html">3.5.1.3. scipy.interpolate.KroghInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PiecewisePolynomial.html">3.5.1.4. scipy.interpolate.PiecewisePolynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PchipInterpolator.html">3.5.1.5. scipy.interpolate.PchipInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.barycentric_interpolate.html">3.5.1.6. scipy.interpolate.barycentric_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.krogh_interpolate.html">3.5.1.7. scipy.interpolate.krogh_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.piecewise_polynomial_interpolate.html">3.5.1.8. scipy.interpolate.piecewise_polynomial_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.pchip_interpolate.html">3.5.1.9. scipy.interpolate.pchip_interpolate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.Akima1DInterpolator.html">3.5.1.10. scipy.interpolate.Akima1DInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.PPoly.html">3.5.1.11. scipy.interpolate.PPoly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BPoly.html">3.5.1.12. scipy.interpolate.BPoly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#multivariate-interpolation">3.5.2. Multivariate interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.griddata.html">3.5.2.1. scipy.interpolate.griddata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LinearNDInterpolator.html">3.5.2.2. scipy.interpolate.LinearNDInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.NearestNDInterpolator.html">3.5.2.3. scipy.interpolate.NearestNDInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.CloughTocher2DInterpolator.html">3.5.2.4. scipy.interpolate.CloughTocher2DInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.Rbf.html">3.5.2.5. scipy.interpolate.Rbf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interp2d.html">3.5.2.6. scipy.interpolate.interp2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.interpn.html">3.5.2.7. scipy.interpolate.interpn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RegularGridInterpolator.html">3.5.2.8. scipy.interpolate.RegularGridInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectBivariateSpline.html">3.5.2.9. scipy.interpolate.RectBivariateSpline</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#d-splines">3.5.3. 1-D Splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.UnivariateSpline.html">3.5.3.1. scipy.interpolate.UnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.InterpolatedUnivariateSpline.html">3.5.3.2. scipy.interpolate.InterpolatedUnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQUnivariateSpline.html">3.5.3.3. scipy.interpolate.LSQUnivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splrep.html">3.5.3.4. scipy.interpolate.splrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splprep.html">3.5.3.5. scipy.interpolate.splprep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splev.html">3.5.3.6. scipy.interpolate.splev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splint.html">3.5.3.7. scipy.interpolate.splint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.sproot.html">3.5.3.8. scipy.interpolate.sproot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spalde.html">3.5.3.9. scipy.interpolate.spalde</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splder.html">3.5.3.10. scipy.interpolate.splder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splantider.html">3.5.3.11. scipy.interpolate.splantider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.insert.html">3.5.3.12. scipy.interpolate.insert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#id1">3.5.4. 2-D Splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectBivariateSpline.html">3.5.2.9. scipy.interpolate.RectBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.RectSphereBivariateSpline.html">3.5.4.1. scipy.interpolate.RectSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.BivariateSpline.html">3.5.4.2. scipy.interpolate.BivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.SmoothBivariateSpline.html">3.5.4.3. scipy.interpolate.SmoothBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.SmoothSphereBivariateSpline.html">3.5.4.4. scipy.interpolate.SmoothSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQBivariateSpline.html">3.5.4.5. scipy.interpolate.LSQBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.LSQSphereBivariateSpline.html">3.5.4.6. scipy.interpolate.LSQSphereBivariateSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.bisplrep.html">3.5.4.7. scipy.interpolate.bisplrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.bisplev.html">3.5.4.8. scipy.interpolate.bisplev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../interpolate.html#additional-tools">3.5.5. Additional tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.lagrange.html">3.5.5.1. scipy.interpolate.lagrange</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.approximate_taylor_polynomial.html">3.5.5.2. scipy.interpolate.approximate_taylor_polynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.ppform.html">3.5.5.3. scipy.interpolate.ppform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spleval.html">3.5.5.4. scipy.interpolate.spleval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spline.html">3.5.5.5. scipy.interpolate.spline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.splmake.html">3.5.5.6. scipy.interpolate.splmake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.spltopp.html">3.5.5.7. scipy.interpolate.spltopp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.interpolate.pchip.html">3.5.5.8. scipy.interpolate.pchip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../io.html">3.6. Input and output (<code class="docutils literal"><span class="pre">scipy.io</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#matlab-files">3.6.1. MATLAB files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.loadmat.html">3.6.1.1. scipy.io.loadmat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.savemat.html">3.6.1.2. scipy.io.savemat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.whosmat.html">3.6.1.3. scipy.io.whosmat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#idl-files">3.6.2. IDL files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.readsav.html">3.6.2.1. scipy.io.readsav</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#matrix-market-files">3.6.3. Matrix Market files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mminfo.html">3.6.3.1. scipy.io.mminfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mmread.html">3.6.3.2. scipy.io.mmread</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.mmwrite.html">3.6.3.3. scipy.io.mmwrite</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#unformatted-fortran-files">3.6.4. Unformatted Fortran files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.FortranFile.html">3.6.4.1. scipy.io.FortranFile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#netcdf">3.6.5. Netcdf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.netcdf_file.html">3.6.5.1. scipy.io.netcdf_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.netcdf_variable.html">3.6.5.2. scipy.io.netcdf_variable</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#harwell-boeing-files">3.6.6. Harwell-Boeing files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.hb_read.html">3.6.6.1. scipy.io.hb_read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.hb_write.html">3.6.6.2. scipy.io.hb_write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#module-scipy.io.wavfile">3.6.7. Wav sound files (<code class="docutils literal"><span class="pre">scipy.io.wavfile</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.read.html">3.6.7.1. scipy.io.wavfile.read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.write.html">3.6.7.2. scipy.io.wavfile.write</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.wavfile.WavFileWarning.html">3.6.7.3. scipy.io.wavfile.WavFileWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io.html#module-scipy.io.arff">3.6.8. Arff files (<code class="docutils literal"><span class="pre">scipy.io.arff</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.loadarff.html">3.6.8.1. scipy.io.arff.loadarff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.MetaData.html">3.6.8.2. scipy.io.arff.MetaData</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.ArffError.html">3.6.8.3. scipy.io.arff.ArffError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.io.arff.ParseArffError.html">3.6.8.4. scipy.io.arff.ParseArffError</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_l_to_o.html">4. API (<code class="docutils literal"><span class="pre">l-o</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg.html">4.1. Linear Algebra scipy.linalg</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.html#id1">4.1.1. Linear algebra (<code class="docutils literal"><span class="pre">scipy.linalg</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#basics">4.1.1.1. Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#eigenvalue-problems">4.1.1.2. Eigenvalue Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#decompositions">4.1.1.3. Decompositions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#matrix-functions">4.1.1.4. Matrix Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#matrix-equation-solvers">4.1.1.5. Matrix Equation Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#special-matrices">4.1.1.6. Special Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.html#low-level-routines">4.1.1.7. Low-level routines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.blas.html">4.1.2. Low-level BLAS functions (<code class="docutils literal"><span class="pre">scipy.linalg.blas</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#finding-functions">4.1.2.1. Finding functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-1-functions">4.1.2.2. BLAS Level 1 functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-2-functions">4.1.2.3. BLAS Level 2 functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.blas.html#blas-level-3-functions">4.1.2.4. BLAS Level 3 functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.lapack.html">4.1.3. Low-level LAPACK functions (<code class="docutils literal"><span class="pre">scipy.linalg.lapack</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.lapack.html#finding-functions">4.1.3.1. Finding functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.lapack.html#all-functions">4.1.3.2. All functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.cython_blas.html">4.1.4. BLAS Functions for Cython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.cython_lapack.html">4.1.5. LAPACK functions for Cython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../linalg.interpolative.html">4.1.6. Interpolative matrix decomposition (<code class="docutils literal"><span class="pre">scipy.linalg.interpolative</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#routines">4.1.6.1. Routines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#references">4.1.6.2. References</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../linalg.interpolative.html#tutorial">4.1.6.3. Tutorial</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc.html">4.2. Miscellaneous routines (<code class="docutils literal"><span class="pre">scipy.misc</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.ascent.html">4.2.1. scipy.misc.ascent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.bytescale.html">4.2.2. scipy.misc.bytescale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.central_diff_weights.html">4.2.3. scipy.misc.central_diff_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.comb.html">4.2.4. scipy.misc.comb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.derivative.html">4.2.5. scipy.misc.derivative</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.face.html">4.2.6. scipy.misc.face</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorial.html">4.2.7. scipy.misc.factorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorial2.html">4.2.8. scipy.misc.factorial2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.factorialk.html">4.2.9. scipy.misc.factorialk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.fromimage.html">4.2.10. scipy.misc.fromimage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imfilter.html">4.2.11. scipy.misc.imfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imread.html">4.2.12. scipy.misc.imread</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imresize.html">4.2.13. scipy.misc.imresize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imrotate.html">4.2.14. scipy.misc.imrotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imsave.html">4.2.15. scipy.misc.imsave</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.imshow.html">4.2.16. scipy.misc.imshow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.info.html">4.2.17. scipy.misc.info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.lena.html">4.2.18. scipy.misc.lena</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.logsumexp.html">4.2.19. scipy.misc.logsumexp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.pade.html">4.2.20. scipy.misc.pade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.toimage.html">4.2.21. scipy.misc.toimage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.source.html">4.2.22. scipy.misc.source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.misc.who.html">4.2.23. scipy.misc.who</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../ndimage.html">4.3. Multi-dimensional image processing (<code class="docutils literal"><span class="pre">scipy.ndimage</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#filters">4.3.1. Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.convolve.html">4.3.1.1. scipy.ndimage.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.convolve1d.html">4.3.1.2. scipy.ndimage.convolve1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.correlate.html">4.3.1.3. scipy.ndimage.correlate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.correlate1d.html">4.3.1.4. scipy.ndimage.correlate1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_filter.html">4.3.1.5. scipy.ndimage.gaussian_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_filter1d.html">4.3.1.6. scipy.ndimage.gaussian_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_gradient_magnitude.html">4.3.1.7. scipy.ndimage.gaussian_gradient_magnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.gaussian_laplace.html">4.3.1.8. scipy.ndimage.gaussian_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_filter.html">4.3.1.9. scipy.ndimage.generic_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_filter1d.html">4.3.1.10. scipy.ndimage.generic_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_gradient_magnitude.html">4.3.1.11. scipy.ndimage.generic_gradient_magnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generic_laplace.html">4.3.1.12. scipy.ndimage.generic_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.laplace.html">4.3.1.13. scipy.ndimage.laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_filter.html">4.3.1.14. scipy.ndimage.maximum_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_filter1d.html">4.3.1.15. scipy.ndimage.maximum_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.median_filter.html">4.3.1.16. scipy.ndimage.median_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_filter.html">4.3.1.17. scipy.ndimage.minimum_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_filter1d.html">4.3.1.18. scipy.ndimage.minimum_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.percentile_filter.html">4.3.1.19. scipy.ndimage.percentile_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.prewitt.html">4.3.1.20. scipy.ndimage.prewitt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.rank_filter.html">4.3.1.21. scipy.ndimage.rank_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.sobel.html">4.3.1.22. scipy.ndimage.sobel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.uniform_filter.html">4.3.1.23. scipy.ndimage.uniform_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.uniform_filter1d.html">4.3.1.24. scipy.ndimage.uniform_filter1d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#fourier-filters">4.3.2. Fourier filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_ellipsoid.html">4.3.2.1. scipy.ndimage.fourier_ellipsoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_gaussian.html">4.3.2.2. scipy.ndimage.fourier_gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_shift.html">4.3.2.3. scipy.ndimage.fourier_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.fourier_uniform.html">4.3.2.4. scipy.ndimage.fourier_uniform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#interpolation">4.3.3. Interpolation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.affine_transform.html">4.3.3.1. scipy.ndimage.affine_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.geometric_transform.html">4.3.3.2. scipy.ndimage.geometric_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.map_coordinates.html">4.3.3.3. scipy.ndimage.map_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.rotate.html">4.3.3.4. scipy.ndimage.rotate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.shift.html">4.3.3.5. scipy.ndimage.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.spline_filter.html">4.3.3.6. scipy.ndimage.spline_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.spline_filter1d.html">4.3.3.7. scipy.ndimage.spline_filter1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.zoom.html">4.3.3.8. scipy.ndimage.zoom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#measurements">4.3.4. Measurements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.center_of_mass.html">4.3.4.1. scipy.ndimage.center_of_mass</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.extrema.html">4.3.4.2. scipy.ndimage.extrema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.find_objects.html">4.3.4.3. scipy.ndimage.find_objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.histogram.html">4.3.4.4. scipy.ndimage.histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.label.html">4.3.4.5. scipy.ndimage.label</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.labeled_comprehension.html">4.3.4.6. scipy.ndimage.labeled_comprehension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum.html">4.3.4.7. scipy.ndimage.maximum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.maximum_position.html">4.3.4.8. scipy.ndimage.maximum_position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.mean.html">4.3.4.9. scipy.ndimage.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.median.html">4.3.4.10. scipy.ndimage.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum.html">4.3.4.11. scipy.ndimage.minimum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.minimum_position.html">4.3.4.12. scipy.ndimage.minimum_position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.standard_deviation.html">4.3.4.13. scipy.ndimage.standard_deviation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.sum.html">4.3.4.14. scipy.ndimage.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.variance.html">4.3.4.15. scipy.ndimage.variance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.watershed_ift.html">4.3.4.16. scipy.ndimage.watershed_ift</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#morphology">4.3.5. Morphology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_closing.html">4.3.5.1. scipy.ndimage.binary_closing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_dilation.html">4.3.5.2. scipy.ndimage.binary_dilation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_erosion.html">4.3.5.3. scipy.ndimage.binary_erosion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_fill_holes.html">4.3.5.4. scipy.ndimage.binary_fill_holes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_hit_or_miss.html">4.3.5.5. scipy.ndimage.binary_hit_or_miss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_opening.html">4.3.5.6. scipy.ndimage.binary_opening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.binary_propagation.html">4.3.5.7. scipy.ndimage.binary_propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.black_tophat.html">4.3.5.8. scipy.ndimage.black_tophat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_bf.html">4.3.5.9. scipy.ndimage.distance_transform_bf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_cdt.html">4.3.5.10. scipy.ndimage.distance_transform_cdt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.distance_transform_edt.html">4.3.5.11. scipy.ndimage.distance_transform_edt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.generate_binary_structure.html">4.3.5.12. scipy.ndimage.generate_binary_structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_closing.html">4.3.5.13. scipy.ndimage.grey_closing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_dilation.html">4.3.5.14. scipy.ndimage.grey_dilation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_erosion.html">4.3.5.15. scipy.ndimage.grey_erosion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.grey_opening.html">4.3.5.16. scipy.ndimage.grey_opening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.iterate_structure.html">4.3.5.17. scipy.ndimage.iterate_structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.morphological_gradient.html">4.3.5.18. scipy.ndimage.morphological_gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.morphological_laplace.html">4.3.5.19. scipy.ndimage.morphological_laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.white_tophat.html">4.3.5.20. scipy.ndimage.white_tophat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ndimage.html#utility">4.3.6. Utility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.ndimage.imread.html">4.3.6.1. scipy.ndimage.imread</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../odr.html">4.4. Orthogonal distance regression (<code class="docutils literal"><span class="pre">scipy.odr</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../odr.html#package-content">4.4.1. Package Content</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Data.html">4.4.1.1. scipy.odr.Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.RealData.html">4.4.1.2. scipy.odr.RealData</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Model.html">4.4.1.3. scipy.odr.Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.ODR.html">4.4.1.4. scipy.odr.ODR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.Output.html">4.4.1.5. scipy.odr.Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr.html">4.4.1.6. scipy.odr.odr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr_error.html">4.4.1.7. scipy.odr.odr_error</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.odr_stop.html">4.4.1.8. scipy.odr.odr_stop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.odr.polynomial.html">4.4.1.9. scipy.odr.polynomial</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../odr.html#usage-information">4.4.2. Usage information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#introduction">4.4.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#basic-usage">4.4.2.2. Basic usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../odr.html#references">4.4.2.3. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimize.html">4.5. Optimization and root finding (<code class="docutils literal"><span class="pre">scipy.optimize</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#optimization">4.5.1. Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#local-optimization">4.5.1.1. Local Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#equation-local-minimizers">4.5.1.2. Equation (Local) Minimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#global-optimization">4.5.1.3. Global Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#rosenbrock-function">4.5.1.4. Rosenbrock function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#fitting">4.5.2. Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.curve_fit.html">4.5.2.1. scipy.optimize.curve_fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#root-finding">4.5.3. Root finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#scalar-functions">4.5.3.1. Scalar functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.html#multidimensional">4.5.3.2. Multidimensional</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#linear-programming">4.5.4. Linear Programming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linprog.html">4.5.4.1. scipy.optimize.linprog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linprog_verbose_callback.html">4.5.4.2. scipy.optimize.linprog_verbose_callback</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimize.linprog-simplex.html">4.5.4.3. linprog(method=&#8217;Simplex&#8217;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.linear_sum_assignment.html">4.5.4.4. scipy.optimize.linear_sum_assignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.html#utilities">4.5.5. Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.approx_fprime.html">4.5.5.1. scipy.optimize.approx_fprime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.bracket.html">4.5.5.2. scipy.optimize.bracket</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.check_grad.html">4.5.5.3. scipy.optimize.check_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.line_search.html">4.5.5.4. scipy.optimize.line_search</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.show_options.html">4.5.5.5. scipy.optimize.show_options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.optimize.LbfgsInvHessProduct.html">4.5.5.6. scipy.optimize.LbfgsInvHessProduct</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimize.nonlin.html">4.6. Nonlinear solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.nonlin.html#routines">4.6.1. Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimize.nonlin.html#examples">4.6.2. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_s_to_w.html">5. API (<code class="docutils literal"><span class="pre">s-w</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../signal.html">5.1. Signal processing (<code class="docutils literal"><span class="pre">scipy.signal</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#convolution">5.1.1. Convolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.convolve.html">5.1.1.1. scipy.signal.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.correlate.html">5.1.1.2. scipy.signal.correlate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.fftconvolve.html">5.1.1.3. scipy.signal.fftconvolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.convolve2d.html">5.1.1.4. scipy.signal.convolve2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.correlate2d.html">5.1.1.5. scipy.signal.correlate2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sepfir2d.html">5.1.1.6. scipy.signal.sepfir2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#b-splines">5.1.2. B-splines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bspline.html">5.1.2.1. scipy.signal.bspline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cubic.html">5.1.2.2. scipy.signal.cubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.quadratic.html">5.1.2.3. scipy.signal.quadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gauss_spline.html">5.1.2.4. scipy.signal.gauss_spline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline1d.html">5.1.2.5. scipy.signal.cspline1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline1d.html">5.1.2.6. scipy.signal.qspline1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline2d.html">5.1.2.7. scipy.signal.cspline2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline2d.html">5.1.2.8. scipy.signal.qspline2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cspline1d_eval.html">5.1.2.9. scipy.signal.cspline1d_eval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qspline1d_eval.html">5.1.2.10. scipy.signal.qspline1d_eval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.spline_filter.html">5.1.2.11. scipy.signal.spline_filter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#filtering">5.1.3. Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.order_filter.html">5.1.3.1. scipy.signal.order_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.medfilt.html">5.1.3.2. scipy.signal.medfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.medfilt2d.html">5.1.3.3. scipy.signal.medfilt2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.wiener.html">5.1.3.4. scipy.signal.wiener</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.symiirorder1.html">5.1.3.5. scipy.signal.symiirorder1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.symiirorder2.html">5.1.3.6. scipy.signal.symiirorder2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfilter.html">5.1.3.7. scipy.signal.lfilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfiltic.html">5.1.3.8. scipy.signal.lfiltic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lfilter_zi.html">5.1.3.9. scipy.signal.lfilter_zi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.filtfilt.html">5.1.3.10. scipy.signal.filtfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.savgol_filter.html">5.1.3.11. scipy.signal.savgol_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.deconvolve.html">5.1.3.12. scipy.signal.deconvolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sosfilt.html">5.1.3.13. scipy.signal.sosfilt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sosfilt_zi.html">5.1.3.14. scipy.signal.sosfilt_zi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hilbert.html">5.1.3.15. scipy.signal.hilbert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hilbert2.html">5.1.3.16. scipy.signal.hilbert2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.decimate.html">5.1.3.17. scipy.signal.decimate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.detrend.html">5.1.3.18. scipy.signal.detrend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.resample.html">5.1.3.19. scipy.signal.resample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#filter-design">5.1.4. Filter design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bilinear.html">5.1.4.1. scipy.signal.bilinear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.findfreqs.html">5.1.4.2. scipy.signal.findfreqs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.firwin.html">5.1.4.3. scipy.signal.firwin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.firwin2.html">5.1.4.4. scipy.signal.firwin2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqs.html">5.1.4.5. scipy.signal.freqs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqz.html">5.1.4.6. scipy.signal.freqz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.group_delay.html">5.1.4.7. scipy.signal.group_delay</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.iirdesign.html">5.1.4.8. scipy.signal.iirdesign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.iirfilter.html">5.1.4.9. scipy.signal.iirfilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser_atten.html">5.1.4.10. scipy.signal.kaiser_atten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser_beta.html">5.1.4.11. scipy.signal.kaiser_beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiserord.html">5.1.4.12. scipy.signal.kaiserord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.savgol_coeffs.html">5.1.4.13. scipy.signal.savgol_coeffs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.remez.html">5.1.4.14. scipy.signal.remez</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.unique_roots.html">5.1.4.15. scipy.signal.unique_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.residue.html">5.1.4.16. scipy.signal.residue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.residuez.html">5.1.4.17. scipy.signal.residuez</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.invres.html">5.1.4.18. scipy.signal.invres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.invresz.html">5.1.4.19. scipy.signal.invresz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.BadCoefficients.html">5.1.4.20. scipy.signal.BadCoefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.abcd_normalize.html">5.1.4.21. scipy.signal.abcd_normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.band_stop_obj.html">5.1.4.22. scipy.signal.band_stop_obj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.besselap.html">5.1.4.23. scipy.signal.besselap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.buttap.html">5.1.4.24. scipy.signal.buttap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb1ap.html">5.1.4.25. scipy.signal.cheb1ap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb2ap.html">5.1.4.26. scipy.signal.cheb2ap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cmplx_sort.html">5.1.4.27. scipy.signal.cmplx_sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellipap.html">5.1.4.28. scipy.signal.ellipap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2bp.html">5.1.4.29. scipy.signal.lp2bp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2bs.html">5.1.4.30. scipy.signal.lp2bs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2hp.html">5.1.4.31. scipy.signal.lp2hp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lp2lp.html">5.1.4.32. scipy.signal.lp2lp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.normalize.html">5.1.4.33. scipy.signal.normalize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#matlab-style-iir-filter-design">5.1.5. Matlab-style IIR filter design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.butter.html">5.1.5.1. scipy.signal.butter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.buttord.html">5.1.5.2. scipy.signal.buttord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheby1.html">5.1.5.3. scipy.signal.cheby1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb1ord.html">5.1.5.4. scipy.signal.cheb1ord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheby2.html">5.1.5.5. scipy.signal.cheby2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cheb2ord.html">5.1.5.6. scipy.signal.cheb2ord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellip.html">5.1.5.7. scipy.signal.ellip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ellipord.html">5.1.5.8. scipy.signal.ellipord</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bessel.html">5.1.5.9. scipy.signal.bessel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#continuous-time-linear-systems">5.1.6. Continuous-Time Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.freqresp.html">5.1.6.1. scipy.signal.freqresp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lti.html">5.1.6.2. scipy.signal.lti</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.StateSpace.html">5.1.6.3. scipy.signal.StateSpace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.TransferFunction.html">5.1.6.4. scipy.signal.TransferFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ZerosPolesGain.html">5.1.6.5. scipy.signal.ZerosPolesGain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lsim.html">5.1.6.6. scipy.signal.lsim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lsim2.html">5.1.6.7. scipy.signal.lsim2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.impulse.html">5.1.6.8. scipy.signal.impulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.impulse2.html">5.1.6.9. scipy.signal.impulse2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.step.html">5.1.6.10. scipy.signal.step</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.step2.html">5.1.6.11. scipy.signal.step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bode.html">5.1.6.12. scipy.signal.bode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#discrete-time-linear-systems">5.1.7. Discrete-Time Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dlsim.html">5.1.7.1. scipy.signal.dlsim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dimpulse.html">5.1.7.2. scipy.signal.dimpulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.dstep.html">5.1.7.3. scipy.signal.dstep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#lti-representations">5.1.8. LTI Representations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2zpk.html">5.1.8.1. scipy.signal.tf2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2sos.html">5.1.8.2. scipy.signal.tf2sos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tf2ss.html">5.1.8.3. scipy.signal.tf2ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2tf.html">5.1.8.4. scipy.signal.zpk2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2sos.html">5.1.8.5. scipy.signal.zpk2sos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.zpk2ss.html">5.1.8.6. scipy.signal.zpk2ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ss2tf.html">5.1.8.7. scipy.signal.ss2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ss2zpk.html">5.1.8.8. scipy.signal.ss2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sos2zpk.html">5.1.8.9. scipy.signal.sos2zpk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sos2tf.html">5.1.8.10. scipy.signal.sos2tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cont2discrete.html">5.1.8.11. scipy.signal.cont2discrete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.place_poles.html">5.1.8.12. scipy.signal.place_poles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#waveforms">5.1.9. Waveforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.chirp.html">5.1.9.1. scipy.signal.chirp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gausspulse.html">5.1.9.2. scipy.signal.gausspulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.max_len_seq.html">5.1.9.3. scipy.signal.max_len_seq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sawtooth.html">5.1.9.4. scipy.signal.sawtooth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.square.html">5.1.9.5. scipy.signal.square</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.sweep_poly.html">5.1.9.6. scipy.signal.sweep_poly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#window-functions">5.1.10. Window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.get_window.html">5.1.10.1. scipy.signal.get_window</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.barthann.html">5.1.10.2. scipy.signal.barthann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bartlett.html">5.1.10.3. scipy.signal.bartlett</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.blackman.html">5.1.10.4. scipy.signal.blackman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.blackmanharris.html">5.1.10.5. scipy.signal.blackmanharris</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.bohman.html">5.1.10.6. scipy.signal.bohman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.boxcar.html">5.1.10.7. scipy.signal.boxcar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.chebwin.html">5.1.10.8. scipy.signal.chebwin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cosine.html">5.1.10.9. scipy.signal.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.exponential.html">5.1.10.10. scipy.signal.exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.flattop.html">5.1.10.11. scipy.signal.flattop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.gaussian.html">5.1.10.12. scipy.signal.gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.general_gaussian.html">5.1.10.13. scipy.signal.general_gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hamming.html">5.1.10.14. scipy.signal.hamming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hann.html">5.1.10.15. scipy.signal.hann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.hanning.html">5.1.10.16. scipy.signal.hanning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.kaiser.html">5.1.10.17. scipy.signal.kaiser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.nuttall.html">5.1.10.18. scipy.signal.nuttall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.parzen.html">5.1.10.19. scipy.signal.parzen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.slepian.html">5.1.10.20. scipy.signal.slepian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.triang.html">5.1.10.21. scipy.signal.triang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.tukey.html">5.1.10.22. scipy.signal.tukey</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#wavelets">5.1.11. Wavelets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cascade.html">5.1.11.1. scipy.signal.cascade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.daub.html">5.1.11.2. scipy.signal.daub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.morlet.html">5.1.11.3. scipy.signal.morlet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.qmf.html">5.1.11.4. scipy.signal.qmf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.ricker.html">5.1.11.5. scipy.signal.ricker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.cwt.html">5.1.11.6. scipy.signal.cwt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#peak-finding">5.1.12. Peak finding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.find_peaks_cwt.html">5.1.12.1. scipy.signal.find_peaks_cwt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelmin.html">5.1.12.2. scipy.signal.argrelmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelmax.html">5.1.12.3. scipy.signal.argrelmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.argrelextrema.html">5.1.12.4. scipy.signal.argrelextrema</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../signal.html#spectral-analysis">5.1.13. Spectral Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.periodogram.html">5.1.13.1. scipy.signal.periodogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.welch.html">5.1.13.2. scipy.signal.welch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.csd.html">5.1.13.3. scipy.signal.csd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.coherence.html">5.1.13.4. scipy.signal.coherence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.spectrogram.html">5.1.13.5. scipy.signal.spectrogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.lombscargle.html">5.1.13.6. scipy.signal.lombscargle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.signal.vectorstrength.html">5.1.13.7. scipy.signal.vectorstrength</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.html">5.2. Sparse matrices (<code class="docutils literal"><span class="pre">scipy.sparse</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.html#contents">5.2.1. Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#sparse-matrix-classes">5.2.1.1. Sparse matrix classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#functions">5.2.1.2. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#submodules">5.2.1.3. Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#exceptions">5.2.1.4. Exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.html#usage-information">5.2.2. Usage information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#matrix-vector-product">5.2.2.1. Matrix vector product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#example-1">5.2.2.2. Example 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#example-2">5.2.2.3. Example 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.html#further-details">5.2.2.4. Further Details</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.linalg.html">5.3. Sparse linear algebra (<code class="docutils literal"><span class="pre">scipy.sparse.linalg</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#abstract-linear-operators">5.3.1. Abstract linear operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.LinearOperator.html">5.3.1.1. scipy.sparse.linalg.LinearOperator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.aslinearoperator.html">5.3.1.2. scipy.sparse.linalg.aslinearoperator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-operations">5.3.2. Matrix Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.inv.html">5.3.2.1. scipy.sparse.linalg.inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.expm.html">5.3.2.2. scipy.sparse.linalg.expm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.expm_multiply.html">5.3.2.3. scipy.sparse.linalg.expm_multiply</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-norms">5.3.3. Matrix norms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.norm.html">5.3.3.1. scipy.sparse.linalg.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.onenormest.html">5.3.3.2. scipy.sparse.linalg.onenormest</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#solving-linear-problems">5.3.4. Solving linear problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.spsolve.html">5.3.4.1. scipy.sparse.linalg.spsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.factorized.html">5.3.4.2. scipy.sparse.linalg.factorized</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.MatrixRankWarning.html">5.3.4.3. scipy.sparse.linalg.MatrixRankWarning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.use_solver.html">5.3.4.4. scipy.sparse.linalg.use_solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.bicg.html">5.3.4.5. scipy.sparse.linalg.bicg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.bicgstab.html">5.3.4.6. scipy.sparse.linalg.bicgstab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.cg.html">5.3.4.7. scipy.sparse.linalg.cg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.cgs.html">5.3.4.8. scipy.sparse.linalg.cgs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.gmres.html">5.3.4.9. scipy.sparse.linalg.gmres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lgmres.html">5.3.4.10. scipy.sparse.linalg.lgmres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.minres.html">5.3.4.11. scipy.sparse.linalg.minres</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.qmr.html">5.3.4.12. scipy.sparse.linalg.qmr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lsqr.html">5.3.4.13. scipy.sparse.linalg.lsqr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lsmr.html">5.3.4.14. scipy.sparse.linalg.lsmr</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#matrix-factorizations">5.3.5. Matrix factorizations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.eigs.html">5.3.5.1. scipy.sparse.linalg.eigs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.eigsh.html">5.3.5.2. scipy.sparse.linalg.eigsh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.lobpcg.html">5.3.5.3. scipy.sparse.linalg.lobpcg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.svds.html">5.3.5.4. scipy.sparse.linalg.svds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.splu.html">5.3.5.5. scipy.sparse.linalg.splu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.spilu.html">5.3.5.6. scipy.sparse.linalg.spilu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.SuperLU.html">5.3.5.7. scipy.sparse.linalg.SuperLU</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.linalg.html#exceptions">5.3.6. Exceptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.ArpackNoConvergence.html">5.3.6.1. scipy.sparse.linalg.ArpackNoConvergence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.linalg.ArpackError.html">5.3.6.2. scipy.sparse.linalg.ArpackError</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse.csgraph.html">5.4. Compressed Sparse Graph Routines (<code class="docutils literal"><span class="pre">scipy.sparse.csgraph</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.csgraph.html#contents">5.4.1. Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.connected_components.html">5.4.1.1. scipy.sparse.csgraph.connected_components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.laplacian.html">5.4.1.2. scipy.sparse.csgraph.laplacian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.shortest_path.html">5.4.1.3. scipy.sparse.csgraph.shortest_path</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.dijkstra.html">5.4.1.4. scipy.sparse.csgraph.dijkstra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.floyd_warshall.html">5.4.1.5. scipy.sparse.csgraph.floyd_warshall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.bellman_ford.html">5.4.1.6. scipy.sparse.csgraph.bellman_ford</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.johnson.html">5.4.1.7. scipy.sparse.csgraph.johnson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.breadth_first_order.html">5.4.1.8. scipy.sparse.csgraph.breadth_first_order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.depth_first_order.html">5.4.1.9. scipy.sparse.csgraph.depth_first_order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.breadth_first_tree.html">5.4.1.10. scipy.sparse.csgraph.breadth_first_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.depth_first_tree.html">5.4.1.11. scipy.sparse.csgraph.depth_first_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.minimum_spanning_tree.html">5.4.1.12. scipy.sparse.csgraph.minimum_spanning_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.reverse_cuthill_mckee.html">5.4.1.13. scipy.sparse.csgraph.reverse_cuthill_mckee</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.maximum_bipartite_matching.html">5.4.1.14. scipy.sparse.csgraph.maximum_bipartite_matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.NegativeCycleError.html">5.4.1.15. scipy.sparse.csgraph.NegativeCycleError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.construct_dist_matrix.html">5.4.1.16. scipy.sparse.csgraph.construct_dist_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_from_dense.html">5.4.1.17. scipy.sparse.csgraph.csgraph_from_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_from_masked.html">5.4.1.18. scipy.sparse.csgraph.csgraph_from_masked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_masked_from_dense.html">5.4.1.19. scipy.sparse.csgraph.csgraph_masked_from_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_to_dense.html">5.4.1.20. scipy.sparse.csgraph.csgraph_to_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.csgraph_to_masked.html">5.4.1.21. scipy.sparse.csgraph.csgraph_to_masked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.sparse.csgraph.reconstruct_path.html">5.4.1.22. scipy.sparse.csgraph.reconstruct_path</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse.csgraph.html#graph-representations">5.4.2. Graph Representations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sparse.csgraph.html#directed-vs-undirected">5.4.2.1. Directed vs. Undirected</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../spatial.html">5.5. Spatial algorithms and data structures (<code class="docutils literal"><span class="pre">scipy.spatial</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#nearest-neighbor-queries">5.5.1. Nearest-neighbor Queries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.KDTree.html">5.5.1.1. scipy.spatial.KDTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.cKDTree.html">5.5.1.2. scipy.spatial.cKDTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.html">5.5.1.3. scipy.spatial.distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Rectangle.html">5.5.1.4. scipy.spatial.Rectangle</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#delaunay-triangulation-convex-hulls-and-voronoi-diagrams">5.5.2. Delaunay Triangulation, Convex Hulls and Voronoi Diagrams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Delaunay.html">5.5.2.1. scipy.spatial.Delaunay</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.ConvexHull.html">5.5.2.2. scipy.spatial.ConvexHull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.Voronoi.html">5.5.2.3. scipy.spatial.Voronoi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#plotting-helpers">5.5.3. Plotting Helpers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.delaunay_plot_2d.html">5.5.3.1. scipy.spatial.delaunay_plot_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.convex_hull_plot_2d.html">5.5.3.2. scipy.spatial.convex_hull_plot_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.voronoi_plot_2d.html">5.5.3.3. scipy.spatial.voronoi_plot_2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.html#simplex-representation">5.5.4. Simplex representation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../spatial.html#functions">5.5.4.1. Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../spatial.distance.html">5.6. Distance computations (<code class="docutils literal"><span class="pre">scipy.spatial.distance</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../spatial.distance.html#function-reference">5.6.1. Function Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.pdist.html">5.6.1.1. scipy.spatial.distance.pdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cdist.html">5.6.1.2. scipy.spatial.distance.cdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.squareform.html">5.6.1.3. scipy.spatial.distance.squareform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.is_valid_dm.html">5.6.1.4. scipy.spatial.distance.is_valid_dm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.is_valid_y.html">5.6.1.5. scipy.spatial.distance.is_valid_y</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.num_obs_dm.html">5.6.1.6. scipy.spatial.distance.num_obs_dm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.num_obs_y.html">5.6.1.7. scipy.spatial.distance.num_obs_y</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.braycurtis.html">5.6.1.8. scipy.spatial.distance.braycurtis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.canberra.html">5.6.1.9. scipy.spatial.distance.canberra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.chebyshev.html">5.6.1.10. scipy.spatial.distance.chebyshev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cityblock.html">5.6.1.11. scipy.spatial.distance.cityblock</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.correlation.html">5.6.1.12. scipy.spatial.distance.correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.cosine.html">5.6.1.13. scipy.spatial.distance.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.dice.html">5.6.1.14. scipy.spatial.distance.dice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.euclidean.html">5.6.1.15. scipy.spatial.distance.euclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.hamming.html">5.6.1.16. scipy.spatial.distance.hamming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.jaccard.html">5.6.1.17. scipy.spatial.distance.jaccard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.kulsinski.html">5.6.1.18. scipy.spatial.distance.kulsinski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.mahalanobis.html">5.6.1.19. scipy.spatial.distance.mahalanobis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.matching.html">5.6.1.20. scipy.spatial.distance.matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.minkowski.html">5.6.1.21. scipy.spatial.distance.minkowski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.rogerstanimoto.html">5.6.1.22. scipy.spatial.distance.rogerstanimoto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.russellrao.html">5.6.1.23. scipy.spatial.distance.russellrao</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.seuclidean.html">5.6.1.24. scipy.spatial.distance.seuclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sokalmichener.html">5.6.1.25. scipy.spatial.distance.sokalmichener</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sokalsneath.html">5.6.1.26. scipy.spatial.distance.sokalsneath</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.sqeuclidean.html">5.6.1.27. scipy.spatial.distance.sqeuclidean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.wminkowski.html">5.6.1.28. scipy.spatial.distance.wminkowski</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.spatial.distance.yule.html">5.6.1.29. scipy.spatial.distance.yule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../special.html">5.7. Special functions (<code class="docutils literal"><span class="pre">scipy.special</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../special.html#error-handling">5.7.1. Error handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.special.errprint.html">5.7.1.1. scipy.special.errprint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.special.SpecialFunctionWarning.html">5.7.1.2. scipy.special.SpecialFunctionWarning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../special.html#available-functions">5.7.2. Available functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#airy-functions">5.7.2.1. Airy functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#elliptic-functions-and-integrals">5.7.2.2. Elliptic Functions and Integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#bessel-functions">5.7.2.3. Bessel Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#struve-functions">5.7.2.4. Struve Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#raw-statistical-functions">5.7.2.5. Raw Statistical Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#information-theory-functions">5.7.2.6. Information Theory Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#gamma-and-related-functions">5.7.2.7. Gamma and Related Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#error-function-and-fresnel-integrals">5.7.2.8. Error Function and Fresnel Integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#legendre-functions">5.7.2.9. Legendre Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#ellipsoidal-harmonics">5.7.2.10. Ellipsoidal Harmonics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#orthogonal-polynomials">5.7.2.11. Orthogonal polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#hypergeometric-functions">5.7.2.12. Hypergeometric Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#parabolic-cylinder-functions">5.7.2.13. Parabolic Cylinder Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#mathieu-and-related-functions">5.7.2.14. Mathieu and Related Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#spheroidal-wave-functions">5.7.2.15. Spheroidal Wave Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#kelvin-functions">5.7.2.16. Kelvin Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#combinatorics">5.7.2.17. Combinatorics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#other-special-functions">5.7.2.18. Other Special Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../special.html#convenience-functions">5.7.2.19. Convenience Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../stats.html">5.8. Statistical functions (<code class="docutils literal"><span class="pre">scipy.stats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.rv_continuous.html">5.8.1. scipy.stats.rv_continuous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.rv_discrete.html">5.8.2. scipy.stats.rv_discrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#continuous-distributions">5.8.3. Continuous distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.alpha.html">5.8.3.1. scipy.stats.alpha</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anglit.html">5.8.3.2. scipy.stats.anglit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.arcsine.html">5.8.3.3. scipy.stats.arcsine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.beta.html">5.8.3.4. scipy.stats.beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.betaprime.html">5.8.3.5. scipy.stats.betaprime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bradford.html">5.8.3.6. scipy.stats.bradford</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.burr.html">5.8.3.7. scipy.stats.burr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cauchy.html">5.8.3.8. scipy.stats.cauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi.html">5.8.3.9. scipy.stats.chi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi2.html">5.8.3.10. scipy.stats.chi2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cosine.html">5.8.3.11. scipy.stats.cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dgamma.html">5.8.3.12. scipy.stats.dgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dweibull.html">5.8.3.13. scipy.stats.dweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.erlang.html">5.8.3.14. scipy.stats.erlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.expon.html">5.8.3.15. scipy.stats.expon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponnorm.html">5.8.3.16. scipy.stats.exponnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponweib.html">5.8.3.17. scipy.stats.exponweib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.exponpow.html">5.8.3.18. scipy.stats.exponpow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f.html">5.8.3.19. scipy.stats.f</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fatiguelife.html">5.8.3.20. scipy.stats.fatiguelife</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fisk.html">5.8.3.21. scipy.stats.fisk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.foldcauchy.html">5.8.3.22. scipy.stats.foldcauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.foldnorm.html">5.8.3.23. scipy.stats.foldnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.frechet_r.html">5.8.3.24. scipy.stats.frechet_r</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.frechet_l.html">5.8.3.25. scipy.stats.frechet_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genlogistic.html">5.8.3.26. scipy.stats.genlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gennorm.html">5.8.3.27. scipy.stats.gennorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genpareto.html">5.8.3.28. scipy.stats.genpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genexpon.html">5.8.3.29. scipy.stats.genexpon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genextreme.html">5.8.3.30. scipy.stats.genextreme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gausshyper.html">5.8.3.31. scipy.stats.gausshyper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gamma.html">5.8.3.32. scipy.stats.gamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gengamma.html">5.8.3.33. scipy.stats.gengamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.genhalflogistic.html">5.8.3.34. scipy.stats.genhalflogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gilbrat.html">5.8.3.35. scipy.stats.gilbrat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gompertz.html">5.8.3.36. scipy.stats.gompertz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gumbel_r.html">5.8.3.37. scipy.stats.gumbel_r</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gumbel_l.html">5.8.3.38. scipy.stats.gumbel_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfcauchy.html">5.8.3.39. scipy.stats.halfcauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halflogistic.html">5.8.3.40. scipy.stats.halflogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfnorm.html">5.8.3.41. scipy.stats.halfnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.halfgennorm.html">5.8.3.42. scipy.stats.halfgennorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hypsecant.html">5.8.3.43. scipy.stats.hypsecant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invgamma.html">5.8.3.44. scipy.stats.invgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invgauss.html">5.8.3.45. scipy.stats.invgauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invweibull.html">5.8.3.46. scipy.stats.invweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.johnsonsb.html">5.8.3.47. scipy.stats.johnsonsb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.johnsonsu.html">5.8.3.48. scipy.stats.johnsonsu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ksone.html">5.8.3.49. scipy.stats.ksone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstwobign.html">5.8.3.50. scipy.stats.kstwobign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.laplace.html">5.8.3.51. scipy.stats.laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy.html">5.8.3.52. scipy.stats.levy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy_l.html">5.8.3.53. scipy.stats.levy_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levy_stable.html">5.8.3.54. scipy.stats.levy_stable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.logistic.html">5.8.3.55. scipy.stats.logistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.loggamma.html">5.8.3.56. scipy.stats.loggamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.loglaplace.html">5.8.3.57. scipy.stats.loglaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.lognorm.html">5.8.3.58. scipy.stats.lognorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.lomax.html">5.8.3.59. scipy.stats.lomax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.maxwell.html">5.8.3.60. scipy.stats.maxwell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mielke.html">5.8.3.61. scipy.stats.mielke</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nakagami.html">5.8.3.62. scipy.stats.nakagami</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ncx2.html">5.8.3.63. scipy.stats.ncx2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ncf.html">5.8.3.64. scipy.stats.ncf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nct.html">5.8.3.65. scipy.stats.nct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.norm.html">5.8.3.66. scipy.stats.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pareto.html">5.8.3.67. scipy.stats.pareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pearson3.html">5.8.3.68. scipy.stats.pearson3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powerlaw.html">5.8.3.69. scipy.stats.powerlaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powerlognorm.html">5.8.3.70. scipy.stats.powerlognorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.powernorm.html">5.8.3.71. scipy.stats.powernorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rdist.html">5.8.3.72. scipy.stats.rdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.reciprocal.html">5.8.3.73. scipy.stats.reciprocal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rayleigh.html">5.8.3.74. scipy.stats.rayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rice.html">5.8.3.75. scipy.stats.rice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.recipinvgauss.html">5.8.3.76. scipy.stats.recipinvgauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.semicircular.html">5.8.3.77. scipy.stats.semicircular</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.t.html">5.8.3.78. scipy.stats.t</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.triang.html">5.8.3.79. scipy.stats.triang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.truncexpon.html">5.8.3.80. scipy.stats.truncexpon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.truncnorm.html">5.8.3.81. scipy.stats.truncnorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tukeylambda.html">5.8.3.82. scipy.stats.tukeylambda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.uniform.html">5.8.3.83. scipy.stats.uniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.vonmises.html">5.8.3.84. scipy.stats.vonmises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.vonmises_line.html">5.8.3.85. scipy.stats.vonmises_line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wald.html">5.8.3.86. scipy.stats.wald</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.weibull_min.html">5.8.3.87. scipy.stats.weibull_min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.weibull_max.html">5.8.3.88. scipy.stats.weibull_max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wrapcauchy.html">5.8.3.89. scipy.stats.wrapcauchy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#multivariate-distributions">5.8.4. Multivariate distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.multivariate_normal.html">5.8.4.1. scipy.stats.multivariate_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.matrix_normal.html">5.8.4.2. scipy.stats.matrix_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dirichlet.html">5.8.4.3. scipy.stats.dirichlet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wishart.html">5.8.4.4. scipy.stats.wishart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.invwishart.html">5.8.4.5. scipy.stats.invwishart</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#discrete-distributions">5.8.5. Discrete distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bernoulli.html">5.8.5.1. scipy.stats.bernoulli</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binom.html">5.8.5.2. scipy.stats.binom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boltzmann.html">5.8.5.3. scipy.stats.boltzmann</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.dlaplace.html">5.8.5.4. scipy.stats.dlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.geom.html">5.8.5.5. scipy.stats.geom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hypergeom.html">5.8.5.6. scipy.stats.hypergeom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.logser.html">5.8.5.7. scipy.stats.logser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nbinom.html">5.8.5.8. scipy.stats.nbinom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.planck.html">5.8.5.9. scipy.stats.planck</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.poisson.html">5.8.5.10. scipy.stats.poisson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.randint.html">5.8.5.11. scipy.stats.randint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skellam.html">5.8.5.12. scipy.stats.skellam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zipf.html">5.8.5.13. scipy.stats.zipf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#statistical-functions">5.8.6. Statistical functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.describe.html">5.8.6.1. scipy.stats.describe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gmean.html">5.8.6.2. scipy.stats.gmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.hmean.html">5.8.6.3. scipy.stats.hmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kurtosis.html">5.8.6.4. scipy.stats.kurtosis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kurtosistest.html">5.8.6.5. scipy.stats.kurtosistest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mode.html">5.8.6.6. scipy.stats.mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.moment.html">5.8.6.7. scipy.stats.moment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.normaltest.html">5.8.6.8. scipy.stats.normaltest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skew.html">5.8.6.9. scipy.stats.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.skewtest.html">5.8.6.10. scipy.stats.skewtest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstat.html">5.8.6.11. scipy.stats.kstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstatvar.html">5.8.6.12. scipy.stats.kstatvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmean.html">5.8.6.13. scipy.stats.tmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tvar.html">5.8.6.14. scipy.stats.tvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmin.html">5.8.6.15. scipy.stats.tmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tmax.html">5.8.6.16. scipy.stats.tmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tstd.html">5.8.6.17. scipy.stats.tstd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tsem.html">5.8.6.18. scipy.stats.tsem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanmean.html">5.8.6.19. scipy.stats.nanmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanstd.html">5.8.6.20. scipy.stats.nanstd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.nanmedian.html">5.8.6.21. scipy.stats.nanmedian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.variation.html">5.8.6.22. scipy.stats.variation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.find_repeats.html">5.8.6.23. scipy.stats.find_repeats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trim_mean.html">5.8.6.24. scipy.stats.trim_mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.cumfreq.html">5.8.6.25. scipy.stats.cumfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.histogram2.html">5.8.6.26. scipy.stats.histogram2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.histogram.html">5.8.6.27. scipy.stats.histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.itemfreq.html">5.8.6.28. scipy.stats.itemfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.percentileofscore.html">5.8.6.29. scipy.stats.percentileofscore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.scoreatpercentile.html">5.8.6.30. scipy.stats.scoreatpercentile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.relfreq.html">5.8.6.31. scipy.stats.relfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic.html">5.8.6.32. scipy.stats.binned_statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic_2d.html">5.8.6.33. scipy.stats.binned_statistic_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binned_statistic_dd.html">5.8.6.34. scipy.stats.binned_statistic_dd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.obrientransform.html">5.8.6.35. scipy.stats.obrientransform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.signaltonoise.html">5.8.6.36. scipy.stats.signaltonoise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bayes_mvs.html">5.8.6.37. scipy.stats.bayes_mvs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mvsdist.html">5.8.6.38. scipy.stats.mvsdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.sem.html">5.8.6.39. scipy.stats.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zmap.html">5.8.6.40. scipy.stats.zmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.zscore.html">5.8.6.41. scipy.stats.zscore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.sigmaclip.html">5.8.6.42. scipy.stats.sigmaclip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.threshold.html">5.8.6.43. scipy.stats.threshold</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trimboth.html">5.8.6.44. scipy.stats.trimboth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.trim1.html">5.8.6.45. scipy.stats.trim1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f_oneway.html">5.8.6.46. scipy.stats.f_oneway</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pearsonr.html">5.8.6.47. scipy.stats.pearsonr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.spearmanr.html">5.8.6.48. scipy.stats.spearmanr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.pointbiserialr.html">5.8.6.49. scipy.stats.pointbiserialr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kendalltau.html">5.8.6.50. scipy.stats.kendalltau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.linregress.html">5.8.6.51. scipy.stats.linregress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.theilslopes.html">5.8.6.52. scipy.stats.theilslopes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.f_value.html">5.8.6.53. scipy.stats.f_value</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_1samp.html">5.8.6.54. scipy.stats.ttest_1samp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_ind.html">5.8.6.55. scipy.stats.ttest_ind</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_ind_from_stats.html">5.8.6.56. scipy.stats.ttest_ind_from_stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ttest_rel.html">5.8.6.57. scipy.stats.ttest_rel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kstest.html">5.8.6.58. scipy.stats.kstest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chisquare.html">5.8.6.59. scipy.stats.chisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.power_divergence.html">5.8.6.60. scipy.stats.power_divergence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ks_2samp.html">5.8.6.61. scipy.stats.ks_2samp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mannwhitneyu.html">5.8.6.62. scipy.stats.mannwhitneyu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.tiecorrect.html">5.8.6.63. scipy.stats.tiecorrect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.rankdata.html">5.8.6.64. scipy.stats.rankdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ranksums.html">5.8.6.65. scipy.stats.ranksums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.wilcoxon.html">5.8.6.66. scipy.stats.wilcoxon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.kruskal.html">5.8.6.67. scipy.stats.kruskal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.friedmanchisquare.html">5.8.6.68. scipy.stats.friedmanchisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.combine_pvalues.html">5.8.6.69. scipy.stats.combine_pvalues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ss.html">5.8.6.70. scipy.stats.ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.square_of_sums.html">5.8.6.71. scipy.stats.square_of_sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.jarque_bera.html">5.8.6.72. scipy.stats.jarque_bera</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ansari.html">5.8.6.73. scipy.stats.ansari</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.bartlett.html">5.8.6.74. scipy.stats.bartlett</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.levene.html">5.8.6.75. scipy.stats.levene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.shapiro.html">5.8.6.76. scipy.stats.shapiro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anderson.html">5.8.6.77. scipy.stats.anderson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.anderson_ksamp.html">5.8.6.78. scipy.stats.anderson_ksamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.binom_test.html">5.8.6.79. scipy.stats.binom_test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fligner.html">5.8.6.80. scipy.stats.fligner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.median_test.html">5.8.6.81. scipy.stats.median_test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.mood.html">5.8.6.82. scipy.stats.mood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox.html">5.8.6.83. scipy.stats.boxcox</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_normmax.html">5.8.6.84. scipy.stats.boxcox_normmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_llf.html">5.8.6.85. scipy.stats.boxcox_llf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.entropy.html">5.8.6.86. scipy.stats.entropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chisqprob.html">5.8.6.87. scipy.stats.chisqprob</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.betai.html">5.8.6.88. scipy.stats.betai</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#circular-statistical-functions">5.8.7. Circular statistical functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circmean.html">5.8.7.1. scipy.stats.circmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circvar.html">5.8.7.2. scipy.stats.circvar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.circstd.html">5.8.7.3. scipy.stats.circstd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#contingency-table-functions">5.8.8. Contingency table functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.chi2_contingency.html">5.8.8.1. scipy.stats.chi2_contingency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.contingency.expected_freq.html">5.8.8.2. scipy.stats.contingency.expected_freq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.contingency.margins.html">5.8.8.3. scipy.stats.contingency.margins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.fisher_exact.html">5.8.8.4. scipy.stats.fisher_exact</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#plot-tests">5.8.9. Plot-tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ppcc_max.html">5.8.9.1. scipy.stats.ppcc_max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.ppcc_plot.html">5.8.9.2. scipy.stats.ppcc_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.probplot.html">5.8.9.3. scipy.stats.probplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.boxcox_normplot.html">5.8.9.4. scipy.stats.boxcox_normplot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#masked-statistics-functions">5.8.10. Masked statistics functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../stats.mstats.html">5.8.10.1. Statistical functions for masked arrays (<code class="docutils literal"><span class="pre">scipy.stats.mstats</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stats.html#univariate-and-multivariate-kernel-density-estimation-scipy-stats-kde">5.8.11. Univariate and multivariate kernel density estimation (<code class="docutils literal"><span class="pre">scipy.stats.kde</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/scipy.stats.gaussian_kde.html">5.8.11.1. scipy.stats.gaussian_kde</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../stats.mstats.html">5.8.10.1. Statistical functions for masked arrays (<code class="docutils literal"><span class="pre">scipy.stats.mstats</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.argstoarray.html">5.8.10.1.1. scipy.stats.mstats.argstoarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.betai.html">5.8.10.1.2. scipy.stats.mstats.betai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.chisquare.html">5.8.10.1.3. scipy.stats.mstats.chisquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.count_tied_groups.html">5.8.10.1.4. scipy.stats.mstats.count_tied_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.describe.html">5.8.10.1.5. scipy.stats.mstats.describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.f_oneway.html">5.8.10.1.6. scipy.stats.mstats.f_oneway</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.f_value_wilks_lambda.html">5.8.10.1.7. scipy.stats.mstats.f_value_wilks_lambda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.find_repeats.html">5.8.10.1.8. scipy.stats.mstats.find_repeats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.friedmanchisquare.html">5.8.10.1.9. scipy.stats.mstats.friedmanchisquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kendalltau.html">5.8.10.1.10. scipy.stats.mstats.kendalltau</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kendalltau_seasonal.html">5.8.10.1.11. scipy.stats.mstats.kendalltau_seasonal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kruskalwallis.html">5.8.10.1.12. scipy.stats.mstats.kruskalwallis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ks_twosamp.html">5.8.10.1.13. scipy.stats.mstats.ks_twosamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kurtosis.html">5.8.10.1.14. scipy.stats.mstats.kurtosis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kurtosistest.html">5.8.10.1.15. scipy.stats.mstats.kurtosistest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.linregress.html">5.8.10.1.16. scipy.stats.mstats.linregress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mannwhitneyu.html">5.8.10.1.17. scipy.stats.mstats.mannwhitneyu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.plotting_positions.html">5.8.10.1.18. scipy.stats.mstats.plotting_positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mode.html">5.8.10.1.19. scipy.stats.mstats.mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.moment.html">5.8.10.1.20. scipy.stats.mstats.moment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mquantiles.html">5.8.10.1.21. scipy.stats.mstats.mquantiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.msign.html">5.8.10.1.22. scipy.stats.mstats.msign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.normaltest.html">5.8.10.1.23. scipy.stats.mstats.normaltest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.obrientransform.html">5.8.10.1.24. scipy.stats.mstats.obrientransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.pearsonr.html">5.8.10.1.25. scipy.stats.mstats.pearsonr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.plotting_positions.html">5.8.10.1.18. scipy.stats.mstats.plotting_positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.pointbiserialr.html">5.8.10.1.26. scipy.stats.mstats.pointbiserialr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.rankdata.html">5.8.10.1.27. scipy.stats.mstats.rankdata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.scoreatpercentile.html">5.8.10.1.28. scipy.stats.mstats.scoreatpercentile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.sem.html">5.8.10.1.29. scipy.stats.mstats.sem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.signaltonoise.html">5.8.10.1.30. scipy.stats.mstats.signaltonoise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.skew.html">5.8.10.1.31. scipy.stats.mstats.skew</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.skewtest.html">5.8.10.1.32. scipy.stats.mstats.skewtest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.spearmanr.html">5.8.10.1.33. scipy.stats.mstats.spearmanr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.theilslopes.html">5.8.10.1.34. scipy.stats.mstats.theilslopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.threshold.html">5.8.10.1.35. scipy.stats.mstats.threshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmax.html">5.8.10.1.36. scipy.stats.mstats.tmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmean.html">5.8.10.1.37. scipy.stats.mstats.tmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tmin.html">5.8.10.1.38. scipy.stats.mstats.tmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trim.html">5.8.10.1.39. scipy.stats.mstats.trim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trima.html">5.8.10.1.40. scipy.stats.mstats.trima</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimboth.html">5.8.10.1.41. scipy.stats.mstats.trimboth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_stde.html">5.8.10.1.42. scipy.stats.mstats.trimmed_stde</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimr.html">5.8.10.1.43. scipy.stats.mstats.trimr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimtail.html">5.8.10.1.44. scipy.stats.mstats.trimtail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tsem.html">5.8.10.1.45. scipy.stats.mstats.tsem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_onesamp.html">5.8.10.1.46. scipy.stats.mstats.ttest_onesamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_ind.html">5.8.10.1.47. scipy.stats.mstats.ttest_ind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_onesamp.html">5.8.10.1.46. scipy.stats.mstats.ttest_onesamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_rel.html">5.8.10.1.48. scipy.stats.mstats.ttest_rel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.tvar.html">5.8.10.1.49. scipy.stats.mstats.tvar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.variation.html">5.8.10.1.50. scipy.stats.mstats.variation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.winsorize.html">5.8.10.1.51. scipy.stats.mstats.winsorize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.zmap.html">5.8.10.1.52. scipy.stats.mstats.zmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.zscore.html">5.8.10.1.53. scipy.stats.mstats.zscore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.compare_medians_ms.html">5.8.10.1.54. scipy.stats.mstats.compare_medians_ms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.gmean.html">5.8.10.1.55. scipy.stats.mstats.gmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdmedian.html">5.8.10.1.56. scipy.stats.mstats.hdmedian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdquantiles.html">5.8.10.1.57. scipy.stats.mstats.hdquantiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hdquantiles_sd.html">5.8.10.1.58. scipy.stats.mstats.hdquantiles_sd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.hmean.html">5.8.10.1.59. scipy.stats.mstats.hmean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.idealfourths.html">5.8.10.1.60. scipy.stats.mstats.idealfourths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.kruskal.html">5.8.10.1.61. scipy.stats.mstats.kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ks_2samp.html">5.8.10.1.62. scipy.stats.mstats.ks_2samp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.median_cihs.html">5.8.10.1.63. scipy.stats.mstats.median_cihs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.meppf.html">5.8.10.1.64. scipy.stats.mstats.meppf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mjci.html">5.8.10.1.65. scipy.stats.mstats.mjci</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.mquantiles_cimj.html">5.8.10.1.66. scipy.stats.mstats.mquantiles_cimj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.rsh.html">5.8.10.1.67. scipy.stats.mstats.rsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.sen_seasonal_slopes.html">5.8.10.1.68. scipy.stats.mstats.sen_seasonal_slopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_mean.html">5.8.10.1.69. scipy.stats.mstats.trimmed_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_mean_ci.html">5.8.10.1.70. scipy.stats.mstats.trimmed_mean_ci</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_std.html">5.8.10.1.71. scipy.stats.mstats.trimmed_std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.trimmed_var.html">5.8.10.1.72. scipy.stats.mstats.trimmed_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.stats.mstats.ttest_1samp.html">5.8.10.1.73. scipy.stats.mstats.ttest_1samp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../weave.html">5.9. C/C++ integration (<code class="docutils literal"><span class="pre">scipy.weave</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../weave.html#c-c-integration">5.9.1. C/C++ integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.inline.html">5.9.2. scipy.weave.inline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.blitz.html">5.9.3. scipy.weave.blitz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/scipy.weave.ext_tools.html">5.9.4. scipy.weave.ext_tools</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Scipy API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>scipy.stats.stats</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for scipy.stats.stats</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) Gary Strangman.  All rights reserved</span>
<span class="c1">#</span>
<span class="c1"># Disclaimer</span>
<span class="c1">#</span>
<span class="c1"># This software is provided &quot;as-is&quot;.  There are no expressed or implied</span>
<span class="c1"># warranties of any kind, including, but not limited to, the warranties</span>
<span class="c1"># of merchantability and fitness for a given application.  In no event</span>
<span class="c1"># shall Gary Strangman be liable for any direct, indirect, incidental,</span>
<span class="c1"># special, exemplary or consequential damages (including, but not limited</span>
<span class="c1"># to, loss of use, data or profits, or business interruption) however</span>
<span class="c1"># caused and on any theory of liability, whether in contract, strict</span>
<span class="c1"># liability or tort (including negligence or otherwise) arising in any way</span>
<span class="c1"># out of the use of this software, even if advised of the possibility of</span>
<span class="c1"># such damage.</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="c1"># Heavily adapted for use by SciPy 2002 by Travis Oliphant</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A collection of basic statistical functions for python.  The function</span>
<span class="sd">names appear below.</span>

<span class="sd"> Some scalar functions defined here are also available in the scipy.special</span>
<span class="sd"> package where they work on arbitrary sized arrays.</span>

<span class="sd">Disclaimers:  The function list is obviously incomplete and, worse, the</span>
<span class="sd">functions are not optimized.  All functions have been tested (some more</span>
<span class="sd">so than others), but they are far from bulletproof.  Thus, as with any</span>
<span class="sd">free software, no warranty or guarantee is expressed or implied. :-)  A</span>
<span class="sd">few extra functions that don&#39;t appear in the list below can be found by</span>
<span class="sd">interested treasure-hunters.  These functions don&#39;t necessarily have</span>
<span class="sd">both list and array versions but were deemed useful.</span>

<span class="sd">Central Tendency</span>
<span class="sd">----------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">    gmean</span>
<span class="sd">    hmean</span>
<span class="sd">    mode</span>

<span class="sd">Moments</span>
<span class="sd">-------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">    moment</span>
<span class="sd">    variation</span>
<span class="sd">    skew</span>
<span class="sd">    kurtosis</span>
<span class="sd">    normaltest</span>

<span class="sd">Moments Handling NaN:</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">    nanmean</span>
<span class="sd">    nanmedian</span>
<span class="sd">    nanstd</span>

<span class="sd">Altered Versions</span>
<span class="sd">----------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">    tmean</span>
<span class="sd">    tvar</span>
<span class="sd">    tstd</span>
<span class="sd">    tsem</span>
<span class="sd">    describe</span>

<span class="sd">Frequency Stats</span>
<span class="sd">---------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">    itemfreq</span>
<span class="sd">    scoreatpercentile</span>
<span class="sd">    percentileofscore</span>
<span class="sd">    histogram</span>
<span class="sd">    cumfreq</span>
<span class="sd">    relfreq</span>

<span class="sd">Variability</span>
<span class="sd">-----------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">    obrientransform</span>
<span class="sd">    signaltonoise</span>
<span class="sd">    sem</span>

<span class="sd">Trimming Functions</span>
<span class="sd">------------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   threshold</span>
<span class="sd">   trimboth</span>
<span class="sd">   trim1</span>

<span class="sd">Correlation Functions</span>
<span class="sd">---------------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   pearsonr</span>
<span class="sd">   fisher_exact</span>
<span class="sd">   spearmanr</span>
<span class="sd">   pointbiserialr</span>
<span class="sd">   kendalltau</span>
<span class="sd">   linregress</span>
<span class="sd">   theilslopes</span>

<span class="sd">Inferential Stats</span>
<span class="sd">-----------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   ttest_1samp</span>
<span class="sd">   ttest_ind</span>
<span class="sd">   ttest_ind_from_stats</span>
<span class="sd">   ttest_rel</span>
<span class="sd">   chisquare</span>
<span class="sd">   power_divergence</span>
<span class="sd">   ks_2samp</span>
<span class="sd">   mannwhitneyu</span>
<span class="sd">   ranksums</span>
<span class="sd">   wilcoxon</span>
<span class="sd">   kruskal</span>
<span class="sd">   friedmanchisquare</span>
<span class="sd">   combine_pvalues</span>

<span class="sd">Probability Calculations</span>
<span class="sd">------------------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   chisqprob</span>
<span class="sd">   betai</span>

<span class="sd">ANOVA Functions</span>
<span class="sd">---------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   f_oneway</span>
<span class="sd">   f_value</span>

<span class="sd">Support Functions</span>
<span class="sd">-----------------</span>
<span class="sd">.. autosummary::</span>
<span class="sd">   :toctree: generated/</span>

<span class="sd">   ss</span>
<span class="sd">   square_of_sums</span>
<span class="sd">   rankdata</span>

<span class="sd">References</span>
<span class="sd">----------</span>
<span class="sd">.. [CRCProbStat2000] Zwillinger, D. and Kokoska, S. (2000). CRC Standard</span>
<span class="sd">   Probability and Statistics Tables and Formulae. Chapman &amp; Hall: New</span>
<span class="sd">   York. 2000.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="kn">from</span> <span class="nn">scipy._lib.six</span> <span class="kn">import</span> <span class="nb">xrange</span>

<span class="c1"># Scipy imports.</span>
<span class="kn">from</span> <span class="nn">scipy._lib.six</span> <span class="kn">import</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">string_types</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">asarray</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">zeros</span>
<span class="kn">import</span> <span class="nn">scipy.special</span> <span class="kn">as</span> <span class="nn">special</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="kn">as</span> <span class="nn">linalg</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">distributions</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mstats_basic</span>
<span class="kn">from</span> <span class="nn">._distn_infrastructure</span> <span class="kn">import</span> <span class="n">_lazywhere</span>
<span class="kn">from</span> <span class="nn">._stats_mstats_common</span> <span class="kn">import</span> <span class="n">_find_repeats</span><span class="p">,</span> <span class="n">linregress</span><span class="p">,</span> <span class="n">theilslopes</span>

<span class="kn">from</span> <span class="nn">._rank</span> <span class="kn">import</span> <span class="n">tiecorrect</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;find_repeats&#39;</span><span class="p">,</span> <span class="s1">&#39;gmean&#39;</span><span class="p">,</span> <span class="s1">&#39;hmean&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="s1">&#39;tmean&#39;</span><span class="p">,</span> <span class="s1">&#39;tvar&#39;</span><span class="p">,</span>
           <span class="s1">&#39;tmin&#39;</span><span class="p">,</span> <span class="s1">&#39;tmax&#39;</span><span class="p">,</span> <span class="s1">&#39;tstd&#39;</span><span class="p">,</span> <span class="s1">&#39;tsem&#39;</span><span class="p">,</span> <span class="s1">&#39;moment&#39;</span><span class="p">,</span> <span class="s1">&#39;variation&#39;</span><span class="p">,</span>
           <span class="s1">&#39;skew&#39;</span><span class="p">,</span> <span class="s1">&#39;kurtosis&#39;</span><span class="p">,</span> <span class="s1">&#39;describe&#39;</span><span class="p">,</span> <span class="s1">&#39;skewtest&#39;</span><span class="p">,</span> <span class="s1">&#39;kurtosistest&#39;</span><span class="p">,</span>
           <span class="s1">&#39;normaltest&#39;</span><span class="p">,</span> <span class="s1">&#39;jarque_bera&#39;</span><span class="p">,</span> <span class="s1">&#39;itemfreq&#39;</span><span class="p">,</span>
           <span class="s1">&#39;scoreatpercentile&#39;</span><span class="p">,</span> <span class="s1">&#39;percentileofscore&#39;</span><span class="p">,</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span>
           <span class="s1">&#39;histogram2&#39;</span><span class="p">,</span> <span class="s1">&#39;cumfreq&#39;</span><span class="p">,</span> <span class="s1">&#39;relfreq&#39;</span><span class="p">,</span> <span class="s1">&#39;obrientransform&#39;</span><span class="p">,</span>
           <span class="s1">&#39;signaltonoise&#39;</span><span class="p">,</span> <span class="s1">&#39;sem&#39;</span><span class="p">,</span> <span class="s1">&#39;zmap&#39;</span><span class="p">,</span> <span class="s1">&#39;zscore&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span>
           <span class="s1">&#39;sigmaclip&#39;</span><span class="p">,</span> <span class="s1">&#39;trimboth&#39;</span><span class="p">,</span> <span class="s1">&#39;trim1&#39;</span><span class="p">,</span> <span class="s1">&#39;trim_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;f_oneway&#39;</span><span class="p">,</span>
           <span class="s1">&#39;pearsonr&#39;</span><span class="p">,</span> <span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span> <span class="s1">&#39;spearmanr&#39;</span><span class="p">,</span> <span class="s1">&#39;pointbiserialr&#39;</span><span class="p">,</span>
           <span class="s1">&#39;kendalltau&#39;</span><span class="p">,</span> <span class="s1">&#39;linregress&#39;</span><span class="p">,</span> <span class="s1">&#39;theilslopes&#39;</span><span class="p">,</span> <span class="s1">&#39;ttest_1samp&#39;</span><span class="p">,</span>
           <span class="s1">&#39;ttest_ind&#39;</span><span class="p">,</span> <span class="s1">&#39;ttest_ind_from_stats&#39;</span><span class="p">,</span> <span class="s1">&#39;ttest_rel&#39;</span><span class="p">,</span> <span class="s1">&#39;kstest&#39;</span><span class="p">,</span>
           <span class="s1">&#39;chisquare&#39;</span><span class="p">,</span> <span class="s1">&#39;power_divergence&#39;</span><span class="p">,</span> <span class="s1">&#39;ks_2samp&#39;</span><span class="p">,</span> <span class="s1">&#39;mannwhitneyu&#39;</span><span class="p">,</span>
           <span class="s1">&#39;tiecorrect&#39;</span><span class="p">,</span> <span class="s1">&#39;ranksums&#39;</span><span class="p">,</span> <span class="s1">&#39;kruskal&#39;</span><span class="p">,</span> <span class="s1">&#39;friedmanchisquare&#39;</span><span class="p">,</span>
           <span class="s1">&#39;chisqprob&#39;</span><span class="p">,</span> <span class="s1">&#39;betai&#39;</span><span class="p">,</span>
           <span class="s1">&#39;f_value_wilks_lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;f_value&#39;</span><span class="p">,</span> <span class="s1">&#39;f_value_multivariate&#39;</span><span class="p">,</span>
           <span class="s1">&#39;ss&#39;</span><span class="p">,</span> <span class="s1">&#39;square_of_sums&#39;</span><span class="p">,</span> <span class="s1">&#39;fastsort&#39;</span><span class="p">,</span> <span class="s1">&#39;rankdata&#39;</span><span class="p">,</span> <span class="s1">&#39;nanmean&#39;</span><span class="p">,</span>
           <span class="s1">&#39;nanstd&#39;</span><span class="p">,</span> <span class="s1">&#39;nanmedian&#39;</span><span class="p">,</span> <span class="s1">&#39;combine_pvalues&#39;</span><span class="p">,</span> <span class="p">]</span>


<span class="k">def</span> <span class="nf">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">outaxis</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">outaxis</span> <span class="o">=</span> <span class="n">axis</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">outaxis</span>


<span class="k">def</span> <span class="nf">_chk2_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">outaxis</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">outaxis</span> <span class="o">=</span> <span class="n">axis</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">outaxis</span>


<span class="k">def</span> <span class="nf">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">nan_policy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;propagate&#39;</span><span class="p">,</span> <span class="s1">&#39;raise&#39;</span><span class="p">,</span> <span class="s1">&#39;omit&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nan_policy must be either &#39;propagate&#39;, &#39;raise&#39;, or &quot;</span>
                         <span class="s2">&quot;&#39;ignore&#39;&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Calling np.sum to avoid creating a huge array into memory</span>
        <span class="c1"># e.g. np.isnan(a).any()</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="n">contains_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1"># If the check cannot be properly performed we fallback to omiting</span>
        <span class="c1"># nan values and raising a warning. This can happen when attempting to</span>
        <span class="c1"># sum things that are not numbers (e.g. as in the function `mode`).</span>
        <span class="n">contains_nan</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">nan_policy</span> <span class="o">=</span> <span class="s1">&#39;omit&#39;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The input array could not be properly checked for nan &quot;</span>
                      <span class="s2">&quot;values. nan values will be ignored.&quot;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;raise&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input contains nan values&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>


<span class="c1">#######</span>
<span class="c1">#  NAN friendly functions</span>
<span class="c1">########</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;scipy.stats.nanmean is deprecated in scipy 0.15.0 &quot;</span>
                   <span class="s2">&quot;in favour of numpy.nanmean.&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">nanmean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the mean over the given axis ignoring nans.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        Input array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which the mean is computed. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `x`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    m : float</span>
<span class="sd">        The mean of `x`, ignoring nans.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    nanstd, nanmedian</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.linspace(0, 4, 3)</span>
<span class="sd">    &gt;&gt;&gt; a</span>
<span class="sd">    array([ 0.,  2.,  4.])</span>
<span class="sd">    &gt;&gt;&gt; a[-1] = np.nan</span>
<span class="sd">    &gt;&gt;&gt; stats.nanmean(a)</span>
<span class="sd">    1.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">Norig</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">Norig</span>

    <span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">factor</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;scipy.stats.nanstd is deprecated in scipy 0.15 &quot;</span>
                      <span class="s2">&quot;in favour of numpy.nanstd.</span><span class="se">\n</span><span class="s2">Note that numpy.nanstd &quot;</span>
                      <span class="s2">&quot;has a different signature.&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">nanstd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the standard deviation over the given axis, ignoring nans.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which the standard deviation is computed. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `x`.</span>
<span class="sd">    bias : bool, optional</span>
<span class="sd">        If True, the biased (normalized by N) definition is used. If False</span>
<span class="sd">        (default), the unbiased definition is used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    s : float</span>
<span class="sd">        The standard deviation.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    nanmean, nanmedian</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.arange(10, dtype=float)</span>
<span class="sd">    &gt;&gt;&gt; a[1:3] = np.nan</span>
<span class="sd">    &gt;&gt;&gt; np.std(a)</span>
<span class="sd">    nan</span>
<span class="sd">    &gt;&gt;&gt; stats.nanstd(a)</span>
<span class="sd">    2.9154759474226504</span>
<span class="sd">    &gt;&gt;&gt; stats.nanstd(a.reshape(2, 5), axis=1)</span>
<span class="sd">    array([ 2.0817,  1.5811])</span>
<span class="sd">    &gt;&gt;&gt; stats.nanstd(a.reshape(2, 5), axis=None)</span>
<span class="sd">    2.9154759474226504</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">Norig</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Nnan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Norig</span> <span class="o">-</span> <span class="n">Nnan</span>

    <span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>

    <span class="k">if</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">m1</span>

    <span class="n">d</span> <span class="o">*=</span> <span class="n">d</span>

    <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">-</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">Nnan</span>

    <span class="k">if</span> <span class="n">bias</span><span class="p">:</span>
        <span class="n">m2c</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">/</span> <span class="n">n</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">m2c</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m2c</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_nanmedian</span><span class="p">(</span><span class="n">arr1d</span><span class="p">):</span>  <span class="c1"># This only works on 1d arrays</span>
    <span class="sd">&quot;&quot;&quot;Private function for rank a arrays. Compute the median ignoring Nan.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr1d : ndarray</span>
<span class="sd">        Input array, of rank 1.</span>

<span class="sd">    Results</span>
<span class="sd">    -------</span>
<span class="sd">    m : float</span>
<span class="sd">        The median.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">arr1d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;All-NaN slice encountered&quot;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># select non-nans at end of array</span>
        <span class="n">enonan</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">:][</span><span class="o">~</span><span class="n">c</span><span class="p">[</span><span class="o">-</span><span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">:]]</span>
        <span class="c1"># fill nans in beginning of array with non-nans of end</span>
        <span class="n">x</span><span class="p">[</span><span class="n">s</span><span class="p">[:</span><span class="n">enonan</span><span class="o">.</span><span class="n">size</span><span class="p">]]</span> <span class="o">=</span> <span class="n">enonan</span>
        <span class="c1"># slice nans away</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">overwrite_input</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;scipy.stats.nanmedian is deprecated in scipy 0.15 &quot;</span>
                      <span class="s2">&quot;in favour of numpy.nanmedian.&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">nanmedian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the median along the given axis ignoring nan values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which the median is computed. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `x`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    m : float</span>
<span class="sd">        The median of `x` along `axis`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    nanstd, nanmean, numpy.nanmedian</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([0, 3, 1, 5, 5, np.nan])</span>
<span class="sd">    &gt;&gt;&gt; stats.nanmedian(a)</span>
<span class="sd">    array(3.0)</span>

<span class="sd">    &gt;&gt;&gt; b = np.array([0, 3, 1, 5, 5, np.nan, 5])</span>
<span class="sd">    &gt;&gt;&gt; stats.nanmedian(b)</span>
<span class="sd">    array(4.0)</span>

<span class="sd">    Example with axis:</span>

<span class="sd">    &gt;&gt;&gt; c = np.arange(30.).reshape(5,6)</span>
<span class="sd">    &gt;&gt;&gt; idx = np.array([False, False, False, True, False] * 6).reshape(5,6)</span>
<span class="sd">    &gt;&gt;&gt; c[idx] = np.nan</span>
<span class="sd">    &gt;&gt;&gt; c</span>
<span class="sd">    array([[  0.,   1.,   2.,  nan,   4.,   5.],</span>
<span class="sd">           [  6.,   7.,  nan,   9.,  10.,  11.],</span>
<span class="sd">           [ 12.,  nan,  14.,  15.,  16.,  17.],</span>
<span class="sd">           [ nan,  19.,  20.,  21.,  22.,  nan],</span>
<span class="sd">           [ 24.,  25.,  26.,  27.,  nan,  29.]])</span>
<span class="sd">    &gt;&gt;&gt; stats.nanmedian(c, axis=1)</span>
<span class="sd">    array([  2. ,   9. ,  15. ,  20.5,  26. ])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="s1">&#39;nanmedian&#39;</span><span class="p">):</span>  <span class="c1"># numpy 1.9 faster for some cases</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">_nanmedian</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="c1">#####################################</span>
<span class="c1">#         CENTRAL TENDENCY          #</span>
<span class="c1">#####################################</span>


<div class="viewcode-block" id="gmean"><a class="viewcode-back" href="../../../generated/scipy.stats.mstats.gmean.html#scipy.stats.gmean">[docs]</a><span class="k">def</span> <span class="nf">gmean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the geometric mean along the specified axis.</span>

<span class="sd">    Returns the geometric average of the array elements.</span>
<span class="sd">    That is:  n-th root of (x1 * x2 * ... * xn)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array or object that can be converted to an array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which the geometric mean is computed. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `a`.</span>
<span class="sd">    dtype : dtype, optional</span>
<span class="sd">        Type of the returned array and of the accumulator in which the</span>
<span class="sd">        elements are summed. If dtype is not specified, it defaults to the</span>
<span class="sd">        dtype of a, unless a has an integer dtype with a precision less than</span>
<span class="sd">        that of the default platform integer. In that case, the default</span>
<span class="sd">        platform integer is used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gmean : ndarray</span>
<span class="sd">        see dtype parameter above</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.mean : Arithmetic average</span>
<span class="sd">    numpy.average : Weighted average</span>
<span class="sd">    hmean : Harmonic mean</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The geometric average is computed over a single dimension of the input</span>
<span class="sd">    array, axis=0 by default, or all values in the array if axis=None.</span>
<span class="sd">    float64 intermediate and return values are used for integer inputs.</span>

<span class="sd">    Use masked arrays to ignore any non-finite values in the input or that</span>
<span class="sd">    arise in the calculations such as Not a Number and infinity because masked</span>
<span class="sd">    arrays automatically mask any non-finite values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>  <span class="c1"># if not an ndarray object attempt to convert it</span>
        <span class="n">log_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">dtype</span><span class="p">:</span>  <span class="c1"># Must change the default dtype allowing array type</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">):</span>
            <span class="n">log_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span></div>


<div class="viewcode-block" id="hmean"><a class="viewcode-back" href="../../../generated/scipy.stats.mstats.hmean.html#scipy.stats.hmean">[docs]</a><span class="k">def</span> <span class="nf">hmean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the harmonic mean along the specified axis.</span>

<span class="sd">    That is:  n / (1/x1 + 1/x2 + ... + 1/xn)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array, masked array or object that can be converted to an array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which the harmonic mean is computed. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `a`.</span>
<span class="sd">    dtype : dtype, optional</span>
<span class="sd">        Type of the returned array and of the accumulator in which the</span>
<span class="sd">        elements are summed. If `dtype` is not specified, it defaults to the</span>
<span class="sd">        dtype of `a`, unless `a` has an integer `dtype` with a precision less</span>
<span class="sd">        than that of the default platform integer. In that case, the default</span>
<span class="sd">        platform integer is used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hmean : ndarray</span>
<span class="sd">        see `dtype` parameter above</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.mean : Arithmetic average</span>
<span class="sd">    numpy.average : Weighted average</span>
<span class="sd">    gmean : Geometric mean</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The harmonic mean is computed over a single dimension of the input</span>
<span class="sd">    array, axis=0 by default, or all values in the array if axis=None.</span>
<span class="sd">    float64 intermediate and return values are used for integer inputs.</span>

<span class="sd">    Use masked arrays to ignore any non-finite values in the input or that</span>
<span class="sd">    arise in the calculations such as Not a Number and infinity.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>  <span class="c1"># Harmonic mean only defined if greater than zero</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
                <span class="n">size</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">size</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Harmonic mean only defined if all elements greater than zero&quot;</span><span class="p">)</span></div>

<span class="n">ModeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;ModeResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="mode"><a class="viewcode-back" href="../../../generated/scipy.stats.mode.html#scipy.stats.mode">[docs]</a><span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an array of the modal (most common) value in the passed array.</span>

<span class="sd">    If there is more than one such value, only the first is returned.</span>
<span class="sd">    The bin-count for the modal bins is also returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        n-dimensional array of which to find mode(s).</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mode : ndarray</span>
<span class="sd">        Array of modal values.</span>
<span class="sd">    count : ndarray</span>
<span class="sd">        Array of counts for each mode.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([[6, 8, 3, 0],</span>
<span class="sd">    ...               [3, 2, 1, 7],</span>
<span class="sd">    ...               [8, 1, 8, 4],</span>
<span class="sd">    ...               [5, 3, 0, 5],</span>
<span class="sd">    ...               [4, 7, 5, 9]])</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; stats.mode(a)</span>
<span class="sd">    (array([[3, 1, 0, 0]]), array([[1, 1, 1, 1]]))</span>

<span class="sd">    To get mode of whole array, specify ``axis=None``:</span>

<span class="sd">    &gt;&gt;&gt; stats.mode(a, axis=None)</span>
<span class="sd">    (array([3]), array([3]))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>       <span class="c1"># get ALL unique values</span>
    <span class="n">testshape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">testshape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">oldmostfreq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">testshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">oldcounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">testshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">score</span><span class="p">)</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">axis</span><span class="p">),</span> <span class="n">axis</span><span class="p">)</span>
        <span class="n">mostfrequent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="n">oldcounts</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">oldmostfreq</span><span class="p">)</span>
        <span class="n">oldcounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">oldcounts</span><span class="p">)</span>
        <span class="n">oldmostfreq</span> <span class="o">=</span> <span class="n">mostfrequent</span>

    <span class="k">return</span> <span class="n">ModeResult</span><span class="p">(</span><span class="n">mostfrequent</span><span class="p">,</span> <span class="n">oldcounts</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_mask_to_limits</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">inclusive</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mask an array for values outside of given limits.</span>

<span class="sd">    This is primarily a utility function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array</span>
<span class="sd">    limits : (float or None, float or None)</span>
<span class="sd">        A tuple consisting of the (lower limit, upper limit).  Values in the</span>
<span class="sd">        input array less than the lower limit or greater than the upper limit</span>
<span class="sd">        will be masked out. None implies no limit.</span>
<span class="sd">    inclusive : (bool, bool)</span>
<span class="sd">        A tuple consisting of the (lower flag, upper flag).  These flags</span>
<span class="sd">        determine whether values exactly equal to lower or upper are allowed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A MaskedArray.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    A ValueError if there are no values within the given limits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span> <span class="o">=</span> <span class="n">limits</span>
    <span class="n">lower_include</span><span class="p">,</span> <span class="n">upper_include</span> <span class="o">=</span> <span class="n">inclusive</span>
    <span class="n">am</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lower_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lower_include</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_less</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_less_equal</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">upper_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">upper_include</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_greater_equal</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">am</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No array values within given limits&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">am</span>


<div class="viewcode-block" id="tmean"><a class="viewcode-back" href="../../../generated/scipy.stats.tmean.html#scipy.stats.tmean">[docs]</a><span class="k">def</span> <span class="nf">tmean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the trimmed mean.</span>

<span class="sd">    This function finds the arithmetic mean of given values, ignoring values</span>
<span class="sd">    outside the given `limits`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Array of values.</span>
<span class="sd">    limits : None or (lower limit, upper limit), optional</span>
<span class="sd">        Values in the input array less than the lower limit or greater than the</span>
<span class="sd">        upper limit will be ignored.  When limits is None (default), then all</span>
<span class="sd">        values are used.  Either of the limit values in the tuple can also be</span>
<span class="sd">        None representing a half-open interval.</span>
<span class="sd">    inclusive : (bool, bool), optional</span>
<span class="sd">        A tuple consisting of the (lower flag, upper flag).  These flags</span>
<span class="sd">        determine whether values exactly equal to the lower or upper limits</span>
<span class="sd">        are included.  The default value is (True, True).</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to compute test. Default is None.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tmean : float</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    trim_mean : returns mean after trimming a proportion from both tails.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; stats.tmean(x)</span>
<span class="sd">    9.5</span>
<span class="sd">    &gt;&gt;&gt; stats.tmean(x, (3,17))</span>
<span class="sd">    10.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="n">am</span> <span class="o">=</span> <span class="n">_mask_to_limits</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">limits</span><span class="p">,</span> <span class="n">inclusive</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">am</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>


<div class="viewcode-block" id="tvar"><a class="viewcode-back" href="../../../generated/scipy.stats.tvar.html#scipy.stats.tvar">[docs]</a><span class="k">def</span> <span class="nf">tvar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the trimmed variance</span>

<span class="sd">    This function computes the sample variance of an array of values,</span>
<span class="sd">    while ignoring values which are outside of given `limits`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Array of values.</span>
<span class="sd">    limits : None or (lower limit, upper limit), optional</span>
<span class="sd">        Values in the input array less than the lower limit or greater than the</span>
<span class="sd">        upper limit will be ignored. When limits is None, then all values are</span>
<span class="sd">        used. Either of the limit values in the tuple can also be None</span>
<span class="sd">        representing a half-open interval.  The default value is None.</span>
<span class="sd">    inclusive : (bool, bool), optional</span>
<span class="sd">        A tuple consisting of the (lower flag, upper flag).  These flags</span>
<span class="sd">        determine whether values exactly equal to the lower or upper limits</span>
<span class="sd">        are included.  The default value is (True, True).</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over the</span>
<span class="sd">        whole array `a`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Delta degrees of freedom.  Default is 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tvar : float</span>
<span class="sd">        Trimmed variance.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    `tvar` computes the unbiased sample variance, i.e. it uses a correction</span>
<span class="sd">    factor ``n / (n - 1)``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; stats.tvar(x)</span>
<span class="sd">    35.0</span>
<span class="sd">    &gt;&gt;&gt; stats.tvar(x, (3,17))</span>
<span class="sd">    20.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">*</span> <span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">am</span> <span class="o">=</span> <span class="n">_mask_to_limits</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">inclusive</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>


<div class="viewcode-block" id="tmin"><a class="viewcode-back" href="../../../generated/scipy.stats.tmin.html#scipy.stats.tmin">[docs]</a><span class="k">def</span> <span class="nf">tmin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lowerlimit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the trimmed minimum</span>

<span class="sd">    This function finds the miminum value of an array `a` along the</span>
<span class="sd">    specified axis, but only considering values greater than a specified</span>
<span class="sd">    lower limit.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        array of values</span>
<span class="sd">    lowerlimit : None or float, optional</span>
<span class="sd">        Values in the input array less than the given limit will be ignored.</span>
<span class="sd">        When lowerlimit is None, then all values are used. The default value</span>
<span class="sd">        is None.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over the</span>
<span class="sd">        whole array `a`.</span>
<span class="sd">    inclusive : {True, False}, optional</span>
<span class="sd">        This flag determines whether values exactly equal to the lower limit</span>
<span class="sd">        are included.  The default value is True.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tmin : float, int or ndarray</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; stats.tmin(x)</span>
<span class="sd">    0</span>

<span class="sd">    &gt;&gt;&gt; stats.tmin(x, 13)</span>
<span class="sd">    13</span>

<span class="sd">    &gt;&gt;&gt; stats.tmin(x, 13, inclusive=False)</span>
<span class="sd">    14</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">am</span> <span class="o">=</span> <span class="n">_mask_to_limits</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">lowerlimit</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="n">inclusive</span><span class="p">,</span> <span class="bp">False</span><span class="p">))</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">am</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">am</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[()]</span>
    <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="tmax"><a class="viewcode-back" href="../../../generated/scipy.stats.tmax.html#scipy.stats.tmax">[docs]</a><span class="k">def</span> <span class="nf">tmax</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">upperlimit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the trimmed maximum</span>

<span class="sd">    This function computes the maximum value of an array along a given axis,</span>
<span class="sd">    while ignoring values larger than a specified upper limit.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        array of values</span>
<span class="sd">    upperlimit : None or float, optional</span>
<span class="sd">        Values in the input array greater than the given limit will be ignored.</span>
<span class="sd">        When upperlimit is None, then all values are used. The default value</span>
<span class="sd">        is None.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over the</span>
<span class="sd">        whole array `a`.</span>
<span class="sd">    inclusive : {True, False}, optional</span>
<span class="sd">        This flag determines whether values exactly equal to the upper limit</span>
<span class="sd">        are included.  The default value is True.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tmax : float, int or ndarray</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; stats.tmax(x)</span>
<span class="sd">    19</span>

<span class="sd">    &gt;&gt;&gt; stats.tmax(x, 13)</span>
<span class="sd">    13</span>

<span class="sd">    &gt;&gt;&gt; stats.tmax(x, 13, inclusive=False)</span>
<span class="sd">    12</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">am</span> <span class="o">=</span> <span class="n">_mask_to_limits</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">upperlimit</span><span class="p">),</span> <span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">inclusive</span><span class="p">))</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">am</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">am</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">maximum</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[()]</span>
    <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="tstd"><a class="viewcode-back" href="../../../generated/scipy.stats.tstd.html#scipy.stats.tstd">[docs]</a><span class="k">def</span> <span class="nf">tstd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the trimmed sample standard deviation</span>

<span class="sd">    This function finds the sample standard deviation of given values,</span>
<span class="sd">    ignoring values outside the given `limits`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        array of values</span>
<span class="sd">    limits : None or (lower limit, upper limit), optional</span>
<span class="sd">        Values in the input array less than the lower limit or greater than the</span>
<span class="sd">        upper limit will be ignored. When limits is None, then all values are</span>
<span class="sd">        used. Either of the limit values in the tuple can also be None</span>
<span class="sd">        representing a half-open interval.  The default value is None.</span>
<span class="sd">    inclusive : (bool, bool), optional</span>
<span class="sd">        A tuple consisting of the (lower flag, upper flag).  These flags</span>
<span class="sd">        determine whether values exactly equal to the lower or upper limits</span>
<span class="sd">        are included.  The default value is (True, True).</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over the</span>
<span class="sd">        whole array `a`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Delta degrees of freedom.  Default is 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tstd : float</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    `tstd` computes the unbiased sample standard deviation, i.e. it uses a</span>
<span class="sd">    correction factor ``n / (n - 1)``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; stats.tstd(x)</span>
<span class="sd">    5.9160797830996161</span>
<span class="sd">    &gt;&gt;&gt; stats.tstd(x, (3,17))</span>
<span class="sd">    4.4721359549995796</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tvar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">inclusive</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="p">))</span></div>


<div class="viewcode-block" id="tsem"><a class="viewcode-back" href="../../../generated/scipy.stats.tsem.html#scipy.stats.tsem">[docs]</a><span class="k">def</span> <span class="nf">tsem</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the trimmed standard error of the mean.</span>

<span class="sd">    This function finds the standard error of the mean for given</span>
<span class="sd">    values, ignoring values outside the given `limits`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        array of values</span>
<span class="sd">    limits : None or (lower limit, upper limit), optional</span>
<span class="sd">        Values in the input array less than the lower limit or greater than the</span>
<span class="sd">        upper limit will be ignored. When limits is None, then all values are</span>
<span class="sd">        used. Either of the limit values in the tuple can also be None</span>
<span class="sd">        representing a half-open interval.  The default value is None.</span>
<span class="sd">    inclusive : (bool, bool), optional</span>
<span class="sd">        A tuple consisting of the (lower flag, upper flag).  These flags</span>
<span class="sd">        determine whether values exactly equal to the lower or upper limits</span>
<span class="sd">        are included.  The default value is (True, True).</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over the</span>
<span class="sd">        whole array `a`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Delta degrees of freedom.  Default is 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tsem : float</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    `tsem` uses unbiased sample standard deviation, i.e. it uses a</span>
<span class="sd">    correction factor ``n / (n - 1)``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; stats.tsem(x)</span>
<span class="sd">    1.3228756555322954</span>
<span class="sd">    &gt;&gt;&gt; stats.tsem(x, (3,17))</span>
<span class="sd">    1.1547005383792515</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">am</span> <span class="o">=</span> <span class="n">_mask_to_limits</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">inclusive</span><span class="p">)</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">count</span><span class="p">())</span></div>


<span class="c1">#####################################</span>
<span class="c1">#              MOMENTS              #</span>
<span class="c1">#####################################</span>

<div class="viewcode-block" id="moment"><a class="viewcode-back" href="../../../generated/scipy.stats.moment.html#scipy.stats.moment">[docs]</a><span class="k">def</span> <span class="nf">moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">moment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Calculates the nth moment about the mean for a sample.</span>

<span class="sd">    A moment is a specific quantitative measure of the shape of a set of points.</span>
<span class="sd">    It is often used to calculate coefficients of skewness and kurtosis due</span>
<span class="sd">    to its close relationship with them.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">       data</span>
<span class="sd">    moment : int or array_like of ints, optional</span>
<span class="sd">       order of central moment that is returned. Default is 1.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">       Axis along which the central moment is computed. Default is 0.</span>
<span class="sd">       If None, compute over the whole array `a`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n-th central moment : ndarray or float</span>
<span class="sd">       The appropriate moment along the given axis or over all values if axis</span>
<span class="sd">       is None. The denominator for the moment calculation is the number of</span>
<span class="sd">       observations, no degrees of freedom correction is done.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    kurtosis, skew, describe</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The k-th central moment of a data sample is:</span>

<span class="sd">    .. math::</span>

<span class="sd">        m_k = \frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})^k</span>

<span class="sd">    Where n is the number of samples and x-bar is the mean. This function uses</span>
<span class="sd">    exponentiation by squares [1]_ for efficiency.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] http://eli.thegreenplace.net/2009/03/21/efficient-integer-exponentiation-algorithms</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">moment</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># empty array, return nan(s) with shape matching `moment`</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">moment</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">moment</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># for array_like moment input, return a value for each.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">moment</span><span class="p">):</span>
        <span class="n">mmnt</span> <span class="o">=</span> <span class="p">[</span><span class="n">_moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moment</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mmnt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">moment</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">_moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">moment</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">moment</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">moment</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All moment parameters must be integers&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">moment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># When moment equals 0, the result is 1, by definition.</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
            <span class="c1"># return an actual array of the appropriate shape</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># the input was 1D, so return a scalar instead of a rank-0 array</span>
            <span class="k">return</span> <span class="mf">1.0</span>

    <span class="k">elif</span> <span class="n">moment</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># By definition the first moment about the mean is 0.</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
            <span class="c1"># return an actual array of the appropriate shape</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># the input was 1D, so return a scalar instead of a rank-0 array</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Exponentiation by squares: form exponent sequence</span>
        <span class="n">n_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">moment</span><span class="p">]</span>
        <span class="n">current_n</span> <span class="o">=</span> <span class="n">moment</span>
        <span class="k">while</span> <span class="n">current_n</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">current_n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">current_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">current_n</span> <span class="o">/=</span> <span class="mi">2</span>
            <span class="n">n_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_n</span><span class="p">)</span>

        <span class="c1"># Starting point for exponentiation by squares</span>
        <span class="n">a_zero_mean</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">),</span> <span class="n">axis</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">a_zero_mean</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">a_zero_mean</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Perform multiplications</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_list</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">*=</span> <span class="n">a_zero_mean</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>


<div class="viewcode-block" id="variation"><a class="viewcode-back" href="../../../generated/scipy.stats.variation.html#scipy.stats.variation">[docs]</a><span class="k">def</span> <span class="nf">variation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the coefficient of variation, the ratio of the biased standard</span>
<span class="sd">    deviation to the mean.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to calculate the coefficient of variation. Default</span>
<span class="sd">        is 0. If None, compute over the whole array `a`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    variation : ndarray</span>
<span class="sd">        The calculated variation along the requested axis.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Zwillinger, D. and Kokoska, S. (2000). CRC Standard</span>
<span class="sd">       Probability and Statistics Tables and Formulae. Chapman &amp; Hall: New</span>
<span class="sd">       York. 2000.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">variation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span></div>


<div class="viewcode-block" id="skew"><a class="viewcode-back" href="../../../generated/scipy.stats.skew.html#scipy.stats.skew">[docs]</a><span class="k">def</span> <span class="nf">skew</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the skewness of a data set.</span>

<span class="sd">    For normally distributed data, the skewness should be about 0. A skewness</span>
<span class="sd">    value &gt; 0 means that there is more weight in the left tail of the</span>
<span class="sd">    distribution. The function `skewtest` can be used to determine if the</span>
<span class="sd">    skewness value is close enough to 0, statistically speaking.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : ndarray</span>
<span class="sd">        data</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which skewness is calculated. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `a`.</span>
<span class="sd">    bias : bool, optional</span>
<span class="sd">        If False, then the calculations are corrected for statistical bias.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    skewness : ndarray</span>
<span class="sd">        The skewness of values along an axis, returning 0 where all values are</span>
<span class="sd">        equal.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    .. [1] Zwillinger, D. and Kokoska, S. (2000). CRC Standard</span>
<span class="sd">       Probability and Statistics Tables and Formulae. Chapman &amp; Hall: New</span>
<span class="sd">       York. 2000.</span>
<span class="sd">       Section 2.2.24.1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="n">m2</span> <span class="o">=</span> <span class="n">moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">m3</span> <span class="o">=</span> <span class="n">moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">m2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="o">~</span><span class="n">zero</span><span class="p">,</span> <span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">),</span>
                             <span class="k">lambda</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">:</span> <span class="n">m3</span> <span class="o">/</span> <span class="n">m2</span><span class="o">**</span><span class="mf">1.5</span><span class="p">,</span>
                             <span class="mf">0.</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">bias</span><span class="p">:</span>
        <span class="n">can_correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">can_correct</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">can_correct</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
            <span class="n">m3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">can_correct</span><span class="p">,</span> <span class="n">m3</span><span class="p">)</span>
            <span class="n">nval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">m3</span><span class="o">/</span><span class="n">m2</span><span class="o">**</span><span class="mf">1.5</span>
            <span class="n">np</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">can_correct</span><span class="p">,</span> <span class="n">nval</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">vals</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vals</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">vals</span></div>


<div class="viewcode-block" id="kurtosis"><a class="viewcode-back" href="../../../generated/scipy.stats.kurtosis.html#scipy.stats.kurtosis">[docs]</a><span class="k">def</span> <span class="nf">kurtosis</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fisher</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the kurtosis (Fisher or Pearson) of a dataset.</span>

<span class="sd">    Kurtosis is the fourth central moment divided by the square of the</span>
<span class="sd">    variance. If Fisher&#39;s definition is used, then 3.0 is subtracted from</span>
<span class="sd">    the result to give 0.0 for a normal distribution.</span>

<span class="sd">    If bias is False then the kurtosis is calculated using k statistics to</span>
<span class="sd">    eliminate bias coming from biased moment estimators</span>

<span class="sd">    Use `kurtosistest` to see if result is close enough to normal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array</span>
<span class="sd">        data for which the kurtosis is calculated</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which the kurtosis is calculated. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `a`.</span>
<span class="sd">    fisher : bool, optional</span>
<span class="sd">        If True, Fisher&#39;s definition is used (normal ==&gt; 0.0). If False,</span>
<span class="sd">        Pearson&#39;s definition is used (normal ==&gt; 3.0).</span>
<span class="sd">    bias : bool, optional</span>
<span class="sd">        If False, then the calculations are corrected for statistical bias.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kurtosis : array</span>
<span class="sd">        The kurtosis of values along an axis. If all values are equal,</span>
<span class="sd">        return -3 for Fisher&#39;s definition and 0 for Pearson&#39;s definition.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Zwillinger, D. and Kokoska, S. (2000). CRC Standard</span>
<span class="sd">       Probability and Statistics Tables and Formulae. Chapman &amp; Hall: New</span>
<span class="sd">       York. 2000.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">fisher</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">m4</span> <span class="o">=</span> <span class="n">moment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">m2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">olderr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zero</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m4</span> <span class="o">/</span> <span class="n">m2</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">olderr</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">bias</span><span class="p">:</span>
        <span class="n">can_correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">can_correct</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">can_correct</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
            <span class="n">m4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">can_correct</span><span class="p">,</span> <span class="n">m4</span><span class="p">)</span>
            <span class="n">nval</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">m4</span><span class="o">/</span><span class="n">m2</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">can_correct</span><span class="p">,</span> <span class="n">nval</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">vals</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># array scalar</span>

    <span class="k">if</span> <span class="n">fisher</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vals</span> <span class="o">-</span> <span class="mi">3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vals</span></div>

<span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;DescribeResult&#39;</span><span class="p">,</span>
                            <span class="p">(</span><span class="s1">&#39;nobs&#39;</span><span class="p">,</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;variance&#39;</span><span class="p">,</span> <span class="s1">&#39;skewness&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;kurtosis&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="describe"><a class="viewcode-back" href="../../../generated/scipy.stats.describe.html#scipy.stats.describe">[docs]</a><span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes several descriptive statistics of the passed array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">       Input data.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">       Axis along which statistics are calculated. Default is 0.</span>
<span class="sd">       If None, compute over the whole array `a`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Delta degrees of freedom (only for variance).  Default is 1.</span>
<span class="sd">    bias : bool, optional</span>
<span class="sd">        If False, then the skewness and kurtosis calculations are corrected for</span>
<span class="sd">        statistical bias.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nobs : int</span>
<span class="sd">       Number of observations (length of data along `axis`).</span>
<span class="sd">    minmax: tuple of ndarrays or floats</span>
<span class="sd">       Minimum and maximum value of data array.</span>
<span class="sd">    mean : ndarray or float</span>
<span class="sd">       Arithmetic mean of data along axis.</span>
<span class="sd">    variance : ndarray or float</span>
<span class="sd">       Unbiased variance of the data along axis, denominator is number of</span>
<span class="sd">       observations minus one.</span>
<span class="sd">    skewness : ndarray or float</span>
<span class="sd">       Skewness, based on moment calculations with denominator equal to</span>
<span class="sd">       the number of observations, i.e. no degrees of freedom correction.</span>
<span class="sd">    kurtosis : ndarray or float</span>
<span class="sd">       Kurtosis (Fisher).  The kurtosis is normalized so that it is</span>
<span class="sd">       zero for the normal distribution.  No degrees of freedom are used.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    skew, kurtosis</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.arange(10)</span>
<span class="sd">    &gt;&gt;&gt; stats.describe(a)</span>
<span class="sd">    DescribeResult(nobs=10, minmax=(0, 9), mean=4.5, variance=9.1666666666666661,</span>
<span class="sd">                   skewness=0.0, kurtosis=-1.2242424242424244)</span>
<span class="sd">    &gt;&gt;&gt; b = [[1, 2], [3, 4]]</span>
<span class="sd">    &gt;&gt;&gt; stats.describe(b)</span>
<span class="sd">    DescribeResult(nobs=2, minmax=(array([1, 2]), array([3, 4])),</span>
<span class="sd">                   mean=array([ 2., 3.]), variance=array([ 2., 2.]),</span>
<span class="sd">                   skewness=array([ 0., 0.]), kurtosis=array([-2., -2.]))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="o">*</span><span class="n">res</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input must not be empty.&quot;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span>
    <span class="n">sk</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">)</span>
    <span class="n">kurt</span> <span class="o">=</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">mm</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sk</span><span class="p">,</span> <span class="n">kurt</span><span class="p">)</span></div>

<span class="c1">#####################################</span>
<span class="c1">#         NORMALITY TESTS           #</span>
<span class="c1">#####################################</span>

<span class="n">SkewtestResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;SkewtestResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="skewtest"><a class="viewcode-back" href="../../../generated/scipy.stats.skewtest.html#scipy.stats.skewtest">[docs]</a><span class="k">def</span> <span class="nf">skewtest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests whether the skew is different from the normal distribution.</span>

<span class="sd">    This function tests the null hypothesis that the skewness of</span>
<span class="sd">    the population that the sample was drawn from is the same</span>
<span class="sd">    as that of a corresponding normal distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array</span>
<span class="sd">        The data to be tested</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">       Axis along which statistics are calculated. Default is 0.</span>
<span class="sd">       If None, compute over the whole array `a`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        The computed z-score for this test.</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        a 2-sided p-value for the hypothesis test</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The sample size must be at least 8.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">skewtest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SkewtestResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;skewtest is not valid with less than 8 samples; </span><span class="si">%i</span><span class="s2"> samples&quot;</span>
            <span class="s2">&quot; were given.&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">6.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">beta2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">70</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span>
             <span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">9</span><span class="p">)))</span>
    <span class="n">W2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">beta2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">W2</span><span class="p">))</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">W2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">y</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">SkewtestResult</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">distributions</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)))</span></div>

<span class="n">KurtosistestResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;KurtosistestResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="kurtosistest"><a class="viewcode-back" href="../../../generated/scipy.stats.kurtosistest.html#scipy.stats.kurtosistest">[docs]</a><span class="k">def</span> <span class="nf">kurtosistest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests whether a dataset has normal kurtosis</span>

<span class="sd">    This function tests the null hypothesis that the kurtosis</span>
<span class="sd">    of the population from which the sample was drawn is that</span>
<span class="sd">    of the normal distribution: ``kurtosis = 3(n-1)/(n+1)``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array</span>
<span class="sd">        array of the sample data</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">       Axis along which to compute test. Default is 0. If None,</span>
<span class="sd">       compute over the whole array `a`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        The computed z-score for this test.</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        The 2-sided p-value for the hypothesis test</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Valid only for n&gt;20.  The Z-score is set to 0 for bad entries.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">kurtosistest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">KurtosistestResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;kurtosistest requires at least 5 observations; </span><span class="si">%i</span><span class="s2"> observations&quot;</span>
            <span class="s2">&quot; were given.&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;</span>
                      <span class="s2">&quot;anyway, n=</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">fisher</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">E</span> <span class="o">=</span> <span class="mf">3.0</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">varb2</span> <span class="o">=</span> <span class="mf">24.0</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="n">E</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">varb2</span><span class="p">)</span>
    <span class="n">sqrtbeta1</span> <span class="o">=</span> <span class="mf">6.0</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">9</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">6.0</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">5</span><span class="p">))</span> <span class="o">/</span>
                                                        <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">3</span><span class="p">)))</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">+</span> <span class="mf">8.0</span><span class="o">/</span><span class="n">sqrtbeta1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">sqrtbeta1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">4.0</span><span class="o">/</span><span class="p">(</span><span class="n">sqrtbeta1</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mf">9.0</span><span class="o">*</span><span class="n">A</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mf">4.0</span><span class="p">))</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">denom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">denom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">term1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mf">2.0</span><span class="o">/</span><span class="n">A</span><span class="p">)</span><span class="o">/</span><span class="n">denom</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span><span class="p">))</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mf">9.0</span><span class="o">*</span><span class="n">A</span><span class="p">))</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">denom</span> <span class="o">==</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Z</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[()]</span>

    <span class="c1"># zprob uses upper tail, so Z needs to be positive</span>
    <span class="k">return</span> <span class="n">KurtosistestResult</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">distributions</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)))</span></div>

<span class="n">NormaltestResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;NormaltestResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="normaltest"><a class="viewcode-back" href="../../../generated/scipy.stats.normaltest.html#scipy.stats.normaltest">[docs]</a><span class="k">def</span> <span class="nf">normaltest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests whether a sample differs from a normal distribution.</span>

<span class="sd">    This function tests the null hypothesis that a sample comes</span>
<span class="sd">    from a normal distribution.  It is based on D&#39;Agostino and</span>
<span class="sd">    Pearson&#39;s [1]_, [2]_ test that combines skew and kurtosis to</span>
<span class="sd">    produce an omnibus test of normality.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        The array containing the data to be tested.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to compute test. Default is 0. If None,</span>
<span class="sd">        compute over the whole array `a`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float or array</span>
<span class="sd">        ``s^2 + k^2``, where ``s`` is the z-score returned by `skewtest` and</span>
<span class="sd">        ``k`` is the z-score returned by `kurtosistest`.</span>
<span class="sd">    pvalue : float or array</span>
<span class="sd">       A 2-sided chi squared probability for the hypothesis test.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] D&#39;Agostino, R. B. (1971), &quot;An omnibus test of normality for</span>
<span class="sd">           moderate and large sample size,&quot; Biometrika, 58, 341-348</span>

<span class="sd">    .. [2] D&#39;Agostino, R. and Pearson, E. S. (1973), &quot;Testing for</span>
<span class="sd">           departures from normality,&quot; Biometrika, 60, 613-622</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">NormaltestResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">s</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">skewtest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">kurtosistest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">k</span>

    <span class="k">return</span> <span class="n">NormaltestResult</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="n">distributions</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span></div>


<div class="viewcode-block" id="jarque_bera"><a class="viewcode-back" href="../../../generated/scipy.stats.jarque_bera.html#scipy.stats.jarque_bera">[docs]</a><span class="k">def</span> <span class="nf">jarque_bera</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform the Jarque-Bera goodness of fit test on sample data.</span>

<span class="sd">    The Jarque-Bera test tests whether the sample data has the skewness and</span>
<span class="sd">    kurtosis matching a normal distribution.</span>

<span class="sd">    Note that this test only works for a large enough number of data samples</span>
<span class="sd">    (&gt;2000) as the test statistic asymptotically has a Chi-squared distribution</span>
<span class="sd">    with 2 degrees of freedom.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        Observations of a random variable.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    jb_value : float</span>
<span class="sd">        The test statistic.</span>
<span class="sd">    p : float</span>
<span class="sd">        The p-value for the hypothesis test.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Jarque, C. and Bera, A. (1980) &quot;Efficient tests for normality,</span>
<span class="sd">           homoscedasticity and serial independence of regression residuals&quot;,</span>
<span class="sd">           6 Econometric Letters 255-259.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; np.random.seed(987654321)</span>
<span class="sd">    &gt;&gt;&gt; x = np.random.normal(0, 1, 100000)</span>
<span class="sd">    &gt;&gt;&gt; y = np.random.rayleigh(1, 100000)</span>
<span class="sd">    &gt;&gt;&gt; stats.jarque_bera(x)</span>
<span class="sd">    (4.7165707989581342, 0.09458225503041906)</span>
<span class="sd">    &gt;&gt;&gt; stats.jarque_bera(y)</span>
<span class="sd">    (6713.7098548143422, 0.0)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;At least one observation is required.&#39;</span><span class="p">)</span>

    <span class="n">mu</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">diffx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span>
    <span class="n">skewness</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diffx</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diffx</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
    <span class="n">kurtosis</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diffx</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diffx</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">jb_value</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">skewness</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">kurtosis</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">distributions</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">jb_value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jb_value</span><span class="p">,</span> <span class="n">p</span></div>


<span class="c1">#####################################</span>
<span class="c1">#        FREQUENCY FUNCTIONS        #</span>
<span class="c1">#####################################</span>

<div class="viewcode-block" id="itemfreq"><a class="viewcode-back" href="../../../generated/scipy.stats.itemfreq.html#scipy.stats.itemfreq">[docs]</a><span class="k">def</span> <span class="nf">itemfreq</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a 2-D array of item frequencies.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : (N,) array_like</span>
<span class="sd">        Input array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    itemfreq : (K, 2) ndarray</span>
<span class="sd">        A 2-D frequency table.  Column 1 contains sorted, unique values from</span>
<span class="sd">        `a`, column 2 contains their respective counts.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([1, 1, 5, 0, 1, 2, 2, 0, 1, 4])</span>
<span class="sd">    &gt;&gt;&gt; stats.itemfreq(a)</span>
<span class="sd">    array([[ 0.,  2.],</span>
<span class="sd">           [ 1.,  4.],</span>
<span class="sd">           [ 2.,  2.],</span>
<span class="sd">           [ 4.,  1.],</span>
<span class="sd">           [ 5.,  1.]])</span>
<span class="sd">    &gt;&gt;&gt; np.bincount(a)</span>
<span class="sd">    array([2, 4, 2, 0, 1, 1])</span>

<span class="sd">    &gt;&gt;&gt; stats.itemfreq(a/10.)</span>
<span class="sd">    array([[ 0. ,  2. ],</span>
<span class="sd">           [ 0.1,  4. ],</span>
<span class="sd">           [ 0.2,  2. ],</span>
<span class="sd">           [ 0.4,  1. ],</span>
<span class="sd">           [ 0.5,  1. ]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">items</span><span class="p">,</span> <span class="n">inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">items</span><span class="p">,</span> <span class="n">freq</span><span class="p">])</span><span class="o">.</span><span class="n">T</span></div>


<div class="viewcode-block" id="scoreatpercentile"><a class="viewcode-back" href="../../../generated/scipy.stats.scoreatpercentile.html#scipy.stats.scoreatpercentile">[docs]</a><span class="k">def</span> <span class="nf">scoreatpercentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="p">(),</span> <span class="n">interpolation_method</span><span class="o">=</span><span class="s1">&#39;fraction&#39;</span><span class="p">,</span>
                      <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the score at a given percentile of the input sequence.</span>

<span class="sd">    For example, the score at `per=50` is the median. If the desired quantile</span>
<span class="sd">    lies between two data points, we interpolate between them, according to</span>
<span class="sd">    the value of `interpolation`. If the parameter `limit` is provided, it</span>
<span class="sd">    should be a tuple (lower, upper) of two values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        A 1-D array of values from which to extract score.</span>
<span class="sd">    per : array_like</span>
<span class="sd">        Percentile(s) at which to extract score.  Values should be in range</span>
<span class="sd">        [0,100].</span>
<span class="sd">    limit : tuple, optional</span>
<span class="sd">        Tuple of two scalars, the lower and upper limits within which to</span>
<span class="sd">        compute the percentile. Values of `a` outside</span>
<span class="sd">        this (closed) interval will be ignored.</span>
<span class="sd">    interpolation_method : {&#39;fraction&#39;, &#39;lower&#39;, &#39;higher&#39;}, optional</span>
<span class="sd">        This optional parameter specifies the interpolation method to use,</span>
<span class="sd">        when the desired quantile lies between two data points `i` and `j`</span>

<span class="sd">          - fraction: ``i + (j - i) * fraction`` where ``fraction`` is the</span>
<span class="sd">            fractional part of the index surrounded by ``i`` and ``j``.</span>
<span class="sd">          - lower: ``i``.</span>
<span class="sd">          - higher: ``j``.</span>

<span class="sd">    axis : int, optional</span>
<span class="sd">        Axis along which the percentiles are computed. Default is None. If</span>
<span class="sd">        None, compute over the whole array `a`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    score : float or ndarray</span>
<span class="sd">        Score at percentile(s).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    percentileofscore, numpy.percentile</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function will become obsolete in the future.</span>
<span class="sd">    For Numpy 1.9 and higher, `numpy.percentile` provides all the functionality</span>
<span class="sd">    that `scoreatpercentile` provides.  And it&#39;s significantly faster.</span>
<span class="sd">    Therefore it&#39;s recommended to use `numpy.percentile` for users that have</span>
<span class="sd">    numpy &gt;= 1.9.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.arange(100)</span>
<span class="sd">    &gt;&gt;&gt; stats.scoreatpercentile(a, 50)</span>
<span class="sd">    49.5</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># adapted from NumPy&#39;s percentile function.  When we require numpy &gt;= 1.8,</span>
    <span class="c1"># the implementation of this function can be replaced by np.percentile.</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># empty array, return nan(s) with shape matching `per`</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">per</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">per</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[(</span><span class="n">limit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="nb">sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">_compute_qth_percentile</span><span class="p">(</span><span class="nb">sorted</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span></div>


<span class="c1"># handle sequence of per&#39;s without calling sort multiple times</span>
<span class="k">def</span> <span class="nf">_compute_qth_percentile</span><span class="p">(</span><span class="nb">sorted</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">per</span><span class="p">):</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">[</span><span class="n">_compute_qth_percentile</span><span class="p">(</span><span class="nb">sorted</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">per</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">per</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">per</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;percentile must be in the range [0, 100]&quot;</span><span class="p">)</span>

    <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">sorted</span><span class="o">.</span><span class="n">ndim</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">per</span> <span class="o">/</span> <span class="mf">100.</span> <span class="o">*</span> <span class="p">(</span><span class="nb">sorted</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">!=</span> <span class="n">idx</span><span class="p">:</span>
        <span class="c1"># round fractional indices according to interpolation method</span>
        <span class="k">if</span> <span class="n">interpolation_method</span> <span class="o">==</span> <span class="s1">&#39;lower&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">interpolation_method</span> <span class="o">==</span> <span class="s1">&#39;higher&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">interpolation_method</span> <span class="o">==</span> <span class="s1">&#39;fraction&#39;</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># keep idx as fraction and interpolate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;interpolation_method can only be &#39;fraction&#39;, &quot;</span>
                             <span class="s2">&quot;&#39;lower&#39; or &#39;higher&#39;&quot;</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">idx</span><span class="p">:</span>
        <span class="n">indexer</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sumval</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indexer</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">array</span><span class="p">([(</span><span class="n">j</span> <span class="o">-</span> <span class="n">idx</span><span class="p">),</span> <span class="p">(</span><span class="n">idx</span> <span class="o">-</span> <span class="n">i</span><span class="p">)],</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">wshape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">sorted</span><span class="o">.</span><span class="n">ndim</span>
        <span class="n">wshape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">weights</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">wshape</span>
        <span class="n">sumval</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># Use np.add.reduce (== np.sum but a little faster) to coerce data type</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="nb">sorted</span><span class="p">[</span><span class="n">indexer</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">sumval</span>


<div class="viewcode-block" id="percentileofscore"><a class="viewcode-back" href="../../../generated/scipy.stats.percentileofscore.html#scipy.stats.percentileofscore">[docs]</a><span class="k">def</span> <span class="nf">percentileofscore</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;rank&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The percentile rank of a score relative to a list of scores.</span>

<span class="sd">    A `percentileofscore` of, for example, 80% means that 80% of the</span>
<span class="sd">    scores in `a` are below the given score. In the case of gaps or</span>
<span class="sd">    ties, the exact definition depends on the optional keyword, `kind`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Array of scores to which `score` is compared.</span>
<span class="sd">    score : int or float</span>
<span class="sd">        Score that is compared to the elements in `a`.</span>
<span class="sd">    kind : {&#39;rank&#39;, &#39;weak&#39;, &#39;strict&#39;, &#39;mean&#39;}, optional</span>
<span class="sd">        This optional parameter specifies the interpretation of the</span>
<span class="sd">        resulting score:</span>

<span class="sd">        - &quot;rank&quot;: Average percentage ranking of score.  In case of</span>
<span class="sd">                  multiple matches, average the percentage rankings of</span>
<span class="sd">                  all matching scores.</span>
<span class="sd">        - &quot;weak&quot;: This kind corresponds to the definition of a cumulative</span>
<span class="sd">                  distribution function.  A percentileofscore of 80%</span>
<span class="sd">                  means that 80% of values are less than or equal</span>
<span class="sd">                  to the provided score.</span>
<span class="sd">        - &quot;strict&quot;: Similar to &quot;weak&quot;, except that only values that are</span>
<span class="sd">                    strictly less than the given score are counted.</span>
<span class="sd">        - &quot;mean&quot;: The average of the &quot;weak&quot; and &quot;strict&quot; scores, often used in</span>
<span class="sd">                  testing.  See</span>

<span class="sd">                  http://en.wikipedia.org/wiki/Percentile_rank</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pcos : float</span>
<span class="sd">        Percentile-position of score (0-100) relative to `a`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.percentile</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Three-quarters of the given values lie below a given score:</span>

<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; stats.percentileofscore([1, 2, 3, 4], 3)</span>
<span class="sd">    75.0</span>

<span class="sd">    With multiple matches, note how the scores of the two matches, 0.6</span>
<span class="sd">    and 0.8 respectively, are averaged:</span>

<span class="sd">    &gt;&gt;&gt; stats.percentileofscore([1, 2, 3, 3, 4], 3)</span>
<span class="sd">    70.0</span>

<span class="sd">    Only 2/5 values are strictly less than 3:</span>

<span class="sd">    &gt;&gt;&gt; stats.percentileofscore([1, 2, 3, 3, 4], 3, kind=&#39;strict&#39;)</span>
<span class="sd">    40.0</span>

<span class="sd">    But 4/5 values are less than or equal to 3:</span>

<span class="sd">    &gt;&gt;&gt; stats.percentileofscore([1, 2, 3, 3, 4], 3, kind=&#39;weak&#39;)</span>
<span class="sd">    80.0</span>

<span class="sd">    The average between the weak and the strict scores is</span>

<span class="sd">    &gt;&gt;&gt; stats.percentileofscore([1, 2, 3, 3, 4], 3, kind=&#39;mean&#39;)</span>
<span class="sd">    60.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;rank&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">score</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
            <span class="n">a_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))))</span> <span class="o">+</span> <span class="mf">1.0</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">==</span> <span class="n">score</span><span class="p">]</span>
        <span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a_len</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
        <span class="k">return</span> <span class="n">pct</span>

    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;strict&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">score</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;weak&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">score</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">score</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">score</span><span class="p">))</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;kind can only be &#39;rank&#39;, &#39;strict&#39;, &#39;weak&#39; or &#39;mean&#39;&quot;</span><span class="p">)</span></div>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;scipy.stats.histogram2 is deprecated in scipy 0.16.0; &quot;</span>
                       <span class="s2">&quot;use np.histogram2d instead&quot;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">histogram2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute histogram using divisions in bins.</span>

<span class="sd">    Count the number of times values from array `a` fall into</span>
<span class="sd">    numerical ranges defined by `bins`.  Range x is given by</span>
<span class="sd">    bins[x] &lt;= range_x &lt; bins[x+1] where x =0,N and N is the</span>
<span class="sd">    length of the `bins` array.  The last range is given by</span>
<span class="sd">    bins[N] &lt;= range_N &lt; infinity.  Values less than bins[0] are</span>
<span class="sd">    not included in the histogram.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like of rank 1</span>
<span class="sd">        The array of values to be assigned into bins</span>
<span class="sd">    bins : array_like of rank 1</span>
<span class="sd">        Defines the ranges of values to use during histogramming.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    histogram2 : ndarray of rank 1</span>
<span class="sd">        Each value represents the occurrences for a given bin (range) of</span>
<span class="sd">        values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># comment: probably obsoleted by numpy.histogram()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)]])</span>
    <span class="k">return</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">n</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">HistogramResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;HistogramResult&#39;</span><span class="p">,</span>
                             <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;lowerlimit&#39;</span><span class="p">,</span> <span class="s1">&#39;binsize&#39;</span><span class="p">,</span> <span class="s1">&#39;extrapoints&#39;</span><span class="p">))</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;scipy.stats.histogram is deprecated in scipy 0.17.0; &quot;</span>
                       <span class="s2">&quot;use np.histogram instead&quot;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">defaultlimits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">printextras</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="c1"># _histogram is used in relfreq/cumfreq, so need to keep it</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">_histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbins</span><span class="o">=</span><span class="n">numbins</span><span class="p">,</span> <span class="n">defaultlimits</span><span class="o">=</span><span class="n">defaultlimits</span><span class="p">,</span>
                     <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">printextras</span><span class="o">=</span><span class="n">printextras</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>


<span class="k">def</span> <span class="nf">_histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">defaultlimits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">printextras</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Separates the range into several bins and returns the number of instances</span>
<span class="sd">    in each bin.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Array of scores which will be put into bins.</span>
<span class="sd">    numbins : int, optional</span>
<span class="sd">        The number of bins to use for the histogram. Default is 10.</span>
<span class="sd">    defaultlimits : tuple (lower, upper), optional</span>
<span class="sd">        The lower and upper values for the range of the histogram.</span>
<span class="sd">        If no value is given, a range slightly larger than the range of the</span>
<span class="sd">        values in a is used. Specifically ``(a.min() - s, a.max() + s)``,</span>
<span class="sd">        where ``s = (1/2)(a.max() - a.min()) / (numbins - 1)``.</span>
<span class="sd">    weights : array_like, optional</span>
<span class="sd">        The weights for each value in `a`. Default is None, which gives each</span>
<span class="sd">        value a weight of 1.0</span>
<span class="sd">    printextras : bool, optional</span>
<span class="sd">        If True, if there are extra points (i.e. the points that fall outside</span>
<span class="sd">        the bin limits) a warning is raised saying how many of those points</span>
<span class="sd">        there are.  Default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    count : ndarray</span>
<span class="sd">        Number of points (or sum of weights) in each bin.</span>
<span class="sd">    lowerlimit : float</span>
<span class="sd">        Lowest value of histogram, the lower limit of the first bin.</span>
<span class="sd">    binsize : float</span>
<span class="sd">        The size of the bins (all bins have the same size).</span>
<span class="sd">    extrapoints : int</span>
<span class="sd">        The number of points outside the range of the histogram.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.histogram</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This histogram is based on numpy&#39;s histogram but has a larger range by</span>
<span class="sd">    default if default limits is not set.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">defaultlimits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># handle empty arrays. Undetermined range, so use 0-1.</span>
            <span class="n">defaultlimits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># no range given, so use values in `a`</span>
            <span class="n">data_min</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">data_max</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="c1"># Have bins extend past min and max values slightly</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_max</span> <span class="o">-</span> <span class="n">data_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">numbins</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">))</span>
            <span class="n">defaultlimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_min</span> <span class="o">-</span> <span class="n">s</span><span class="p">,</span> <span class="n">data_max</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>

    <span class="c1"># use numpy&#39;s histogram method to compute bins</span>
    <span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">numbins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">defaultlimits</span><span class="p">,</span>
                                   <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="c1"># hist are not always floats, convert to keep with old output</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="c1"># fixed width for bins is assumed, as numpy&#39;s histogram gives</span>
    <span class="c1"># fixed width bins for int values for &#39;bins&#39;</span>
    <span class="n">binsize</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># calculate number of extra points</span>
    <span class="n">extrapoints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">a</span>
                       <span class="k">if</span> <span class="n">defaultlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">v</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">defaultlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">extrapoints</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">printextras</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Points outside given histogram range = </span><span class="si">%s</span><span class="s2">&quot;</span>
                      <span class="o">%</span> <span class="n">extrapoints</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">HistogramResult</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">defaultlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">binsize</span><span class="p">,</span> <span class="n">extrapoints</span><span class="p">)</span>

<span class="n">CumfreqResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;CumfreqResult&#39;</span><span class="p">,</span>
                           <span class="p">(</span><span class="s1">&#39;cumcount&#39;</span><span class="p">,</span> <span class="s1">&#39;lowerlimit&#39;</span><span class="p">,</span> <span class="s1">&#39;binsize&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extrapoints&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="cumfreq"><a class="viewcode-back" href="../../../generated/scipy.stats.cumfreq.html#scipy.stats.cumfreq">[docs]</a><span class="k">def</span> <span class="nf">cumfreq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">defaultreallimits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a cumulative frequency histogram, using the histogram function.</span>

<span class="sd">    A cumulative histogram is a mapping that counts the cumulative number of</span>
<span class="sd">    observations in all of the bins up to the specified bin.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    numbins : int, optional</span>
<span class="sd">        The number of bins to use for the histogram. Default is 10.</span>
<span class="sd">    defaultreallimits : tuple (lower, upper), optional</span>
<span class="sd">        The lower and upper values for the range of the histogram.</span>
<span class="sd">        If no value is given, a range slightly larger than the range of the</span>
<span class="sd">        values in `a` is used. Specifically ``(a.min() - s, a.max() + s)``,</span>
<span class="sd">        where ``s = (1/2)(a.max() - a.min()) / (numbins - 1)``.</span>
<span class="sd">    weights : array_like, optional</span>
<span class="sd">        The weights for each value in `a`. Default is None, which gives each</span>
<span class="sd">        value a weight of 1.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cumcount : ndarray</span>
<span class="sd">        Binned values of cumulative frequency.</span>
<span class="sd">    lowerlimit : float</span>
<span class="sd">        Lower real limit</span>
<span class="sd">    binsize : float</span>
<span class="sd">        Width of each bin.</span>
<span class="sd">    extrapoints : int</span>
<span class="sd">        Extra points.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = [1, 4, 2, 1, 3, 1]</span>
<span class="sd">    &gt;&gt;&gt; res = stats.cumfreq(x, numbins=4, defaultreallimits=(1.5, 5))</span>
<span class="sd">    &gt;&gt;&gt; res.cumcount</span>
<span class="sd">    array([ 1.,  2.,  3.,  3.])</span>
<span class="sd">    &gt;&gt;&gt; res.extrapoints</span>
<span class="sd">    3</span>

<span class="sd">    Create a normal distribution with 1000 random values</span>

<span class="sd">    &gt;&gt;&gt; rng = np.random.RandomState(seed=12345)</span>
<span class="sd">    &gt;&gt;&gt; samples = stats.norm.rvs(size=1000, random_state=rng)</span>

<span class="sd">    Calculate cumulative frequencies</span>

<span class="sd">    &gt;&gt;&gt; res = stats.cumfreq(samples, numbins=25)</span>

<span class="sd">    Calculate space of values for x</span>

<span class="sd">    &gt;&gt;&gt; x = res.lowerlimit + np.linspace(0, res.binsize*res.cumcount.size,</span>
<span class="sd">    ...                                  res.cumcount.size)</span>

<span class="sd">    Plot histogram and cumulative histogram</span>

<span class="sd">    &gt;&gt;&gt; fig = plt.figure(figsize=(10, 4))</span>
<span class="sd">    &gt;&gt;&gt; ax1 = fig.add_subplot(1, 2, 1)</span>
<span class="sd">    &gt;&gt;&gt; ax2 = fig.add_subplot(1, 2, 2)</span>
<span class="sd">    &gt;&gt;&gt; ax1.hist(samples, bins=25)</span>
<span class="sd">    &gt;&gt;&gt; ax1.set_title(&#39;Histogram&#39;)</span>
<span class="sd">    &gt;&gt;&gt; ax2.bar(x, res.cumcount, width=res.binsize)</span>
<span class="sd">    &gt;&gt;&gt; ax2.set_title(&#39;Cumulative histogram&#39;)</span>
<span class="sd">    &gt;&gt;&gt; ax2.set_xlim([x.min(), x.max()])</span>

<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">_histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbins</span><span class="p">,</span> <span class="n">defaultreallimits</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">cumhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">CumfreqResult</span><span class="p">(</span><span class="n">cumhist</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>

<span class="n">RelfreqResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;RelfreqResult&#39;</span><span class="p">,</span>
                           <span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;lowerlimit&#39;</span><span class="p">,</span> <span class="s1">&#39;binsize&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extrapoints&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="relfreq"><a class="viewcode-back" href="../../../generated/scipy.stats.relfreq.html#scipy.stats.relfreq">[docs]</a><span class="k">def</span> <span class="nf">relfreq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">defaultreallimits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a relative frequency histogram, using the histogram function.</span>

<span class="sd">    A relative frequency  histogram is a mapping of the number of</span>
<span class="sd">    observations in each of the bins relative to the total of observations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    numbins : int, optional</span>
<span class="sd">        The number of bins to use for the histogram. Default is 10.</span>
<span class="sd">    defaultreallimits : tuple (lower, upper), optional</span>
<span class="sd">        The lower and upper values for the range of the histogram.</span>
<span class="sd">        If no value is given, a range slightly larger than the range of the</span>
<span class="sd">        values in a is used. Specifically ``(a.min() - s, a.max() + s)``,</span>
<span class="sd">        where ``s = (1/2)(a.max() - a.min()) / (numbins - 1)``.</span>
<span class="sd">    weights : array_like, optional</span>
<span class="sd">        The weights for each value in `a`. Default is None, which gives each</span>
<span class="sd">        value a weight of 1.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    frequency : ndarray</span>
<span class="sd">        Binned values of relative frequency.</span>
<span class="sd">    lowerlimit : float</span>
<span class="sd">        Lower real limit</span>
<span class="sd">    binsize : float</span>
<span class="sd">        Width of each bin.</span>
<span class="sd">    extrapoints : int</span>
<span class="sd">        Extra points.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([2, 4, 1, 2, 3, 2])</span>
<span class="sd">    &gt;&gt;&gt; res = stats.relfreq(a, numbins=4)</span>
<span class="sd">    &gt;&gt;&gt; res.frequency</span>
<span class="sd">    array([ 0.16666667, 0.5       , 0.16666667,  0.16666667])</span>
<span class="sd">    &gt;&gt;&gt; np.sum(res.frequency)  # relative frequencies should add up to 1</span>
<span class="sd">    1.0</span>

<span class="sd">    Create a normal distribution with 1000 random values</span>

<span class="sd">    &gt;&gt;&gt; rng = np.random.RandomState(seed=12345)</span>
<span class="sd">    &gt;&gt;&gt; samples = stats.norm.rvs(size=1000, random_state=rng)</span>

<span class="sd">    Calculate relative frequencies</span>

<span class="sd">    &gt;&gt;&gt; res = stats.relfreq(samples, numbins=25)</span>

<span class="sd">    Calculate space of values for x</span>

<span class="sd">    &gt;&gt;&gt; x = res.lowerlimit + np.linspace(0, res.binsize*res.frequency.size,</span>
<span class="sd">    ...                                  res.frequency.size)</span>

<span class="sd">    Plot relative frequency histogram</span>

<span class="sd">    &gt;&gt;&gt; fig = plt.figure(figsize=(5, 4))</span>
<span class="sd">    &gt;&gt;&gt; ax = fig.add_subplot(1, 1, 1)</span>
<span class="sd">    &gt;&gt;&gt; ax.bar(x, res.frequency, width=res.binsize)</span>
<span class="sd">    &gt;&gt;&gt; ax.set_title(&#39;Relative frequency histogram&#39;)</span>
<span class="sd">    &gt;&gt;&gt; ax.set_xlim([x.min(), x.max()])</span>

<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">_histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbins</span><span class="p">,</span> <span class="n">defaultreallimits</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">RelfreqResult</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<span class="c1">#####################################</span>
<span class="c1">#        VARIABILITY FUNCTIONS      #</span>
<span class="c1">#####################################</span>

<div class="viewcode-block" id="obrientransform"><a class="viewcode-back" href="../../../generated/scipy.stats.obrientransform.html#scipy.stats.obrientransform">[docs]</a><span class="k">def</span> <span class="nf">obrientransform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the O&#39;Brien transform on input data (any number of arrays).</span>

<span class="sd">    Used to test for homogeneity of variance prior to running one-way stats.</span>
<span class="sd">    Each array in ``*args`` is one level of a factor.</span>
<span class="sd">    If `f_oneway` is run on the transformed data and found significant,</span>
<span class="sd">    the variances are unequal.  From Maxwell and Delaney [1]_, p.112.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    args : tuple of array_like</span>
<span class="sd">        Any number of arrays.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    obrientransform : ndarray</span>
<span class="sd">        Transformed data for use in an ANOVA.  The first dimension</span>
<span class="sd">        of the result corresponds to the sequence of transformed</span>
<span class="sd">        arrays.  If the arrays given are all 1-D of the same length,</span>
<span class="sd">        the return value is a 2-D array; otherwise it is a 1-D array</span>
<span class="sd">        of type object, with each element being an ndarray.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] S. E. Maxwell and H. D. Delaney, &quot;Designing Experiments and</span>
<span class="sd">           Analyzing Data: A Model Comparison Perspective&quot;, Wadsworth, 1990.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    We&#39;ll test the following data sets for differences in their variance.</span>

<span class="sd">    &gt;&gt;&gt; x = [10, 11, 13, 9, 7, 12, 12, 9, 10]</span>
<span class="sd">    &gt;&gt;&gt; y = [13, 21, 5, 10, 8, 14, 10, 12, 7, 15]</span>

<span class="sd">    Apply the O&#39;Brien transform to the data.</span>

<span class="sd">    &gt;&gt;&gt; from scipy.stats import obrientransform</span>
<span class="sd">    &gt;&gt;&gt; tx, ty = obrientransform(x, y)</span>

<span class="sd">    Use `scipy.stats.f_oneway` to apply a one-way ANOVA test to the</span>
<span class="sd">    transformed data.</span>

<span class="sd">    &gt;&gt;&gt; from scipy.stats import f_oneway</span>
<span class="sd">    &gt;&gt;&gt; F, p = f_oneway(tx, ty)</span>
<span class="sd">    &gt;&gt;&gt; p</span>
<span class="sd">    0.1314139477040335</span>

<span class="sd">    If we require that ``p &lt; 0.05`` for significance, we cannot conclude</span>
<span class="sd">    that the variances are different.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TINY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>

    <span class="c1"># `arrays` will hold the transformed arguments.</span>
    <span class="n">arrays</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">sumsq</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="c1"># The O&#39;Brien transform.</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">sq</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sumsq</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>

        <span class="c1"># Check that the mean of the transformed data is equal to the</span>
        <span class="c1"># original variance.</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">sumsq</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">var</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">TINY</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Lack of convergence in obrientransform.&#39;</span><span class="p">)</span>

        <span class="n">arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># If the arrays are not all the same shape, calling np.array(arrays)</span>
    <span class="c1"># creates a 1-D array with dtype `object` in numpy 1.6+. In numpy</span>
    <span class="c1"># 1.5.x, it raises an exception.  To work around this, we explicitly</span>
    <span class="c1"># set the dtype to `object` when the arrays are not all the same shape.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="nb">object</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arrays</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span></div>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;scipy.stats.signaltonoise is deprecated in scipy 0.16.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">signaltonoise</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The signal-to-noise ratio of the input data.</span>

<span class="sd">    Returns the signal-to-noise ratio of `a`, here defined as the mean</span>
<span class="sd">    divided by the standard deviation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        An array_like object containing the sample data.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Degrees of freedom correction for standard deviation. Default is 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    s2n : ndarray</span>
<span class="sd">        The mean to standard deviation ratio(s) along `axis`, or 0 where the</span>
<span class="sd">        standard deviation is 0.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="o">/</span><span class="n">sd</span><span class="p">)</span>


<div class="viewcode-block" id="sem"><a class="viewcode-back" href="../../../generated/scipy.stats.sem.html#scipy.stats.sem">[docs]</a><span class="k">def</span> <span class="nf">sem</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the standard error of the mean (or standard error of</span>
<span class="sd">    measurement) of the values in the input array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        An array containing the values for which the standard error is</span>
<span class="sd">        returned.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Delta degrees-of-freedom. How many degrees of freedom to adjust</span>
<span class="sd">        for bias in limited samples relative to the population estimate</span>
<span class="sd">        of variance. Defaults to 1.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    s : ndarray or float</span>
<span class="sd">        The standard error of the mean in the sample(s), along the input axis.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The default value for `ddof` is different to the default (0) used by other</span>
<span class="sd">    ddof containing routines, such as np.std nd stats.nanstd.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Find standard error along the first axis:</span>

<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.arange(20).reshape(5,4)</span>
<span class="sd">    &gt;&gt;&gt; stats.sem(a)</span>
<span class="sd">    array([ 2.8284,  2.8284,  2.8284,  2.8284])</span>

<span class="sd">    Find standard error across the whole array, using n degrees of freedom:</span>

<span class="sd">    &gt;&gt;&gt; stats.sem(a, axis=None, ddof=0)</span>
<span class="sd">    1.2893796958227628</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="zscore"><a class="viewcode-back" href="../../../generated/scipy.stats.zscore.html#scipy.stats.zscore">[docs]</a><span class="k">def</span> <span class="nf">zscore</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the z score of each value in the sample, relative to the sample</span>
<span class="sd">    mean and standard deviation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        An array like object containing the sample data.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to operate. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Degrees of freedom correction in the calculation of the</span>
<span class="sd">        standard deviation. Default is 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    zscore : array_like</span>
<span class="sd">        The z-scores, standardized by mean and standard deviation of input</span>
<span class="sd">        array `a`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function preserves ndarray subclasses, and works also with</span>
<span class="sd">    matrices and masked arrays (it uses `asanyarray` instead of `asarray`</span>
<span class="sd">    for parameters).</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([ 0.7972,  0.0767,  0.4383,  0.7866,  0.8091,  0.1954,</span>
<span class="sd">    ...                0.6307, 0.6599,  0.1065,  0.0508])</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; stats.zscore(a)</span>
<span class="sd">    array([ 1.1273, -1.247 , -0.0552,  1.0923,  1.1664, -0.8559,  0.5786,</span>
<span class="sd">            0.6748, -1.1488, -1.3324])</span>

<span class="sd">    Computing along a specified axis, using n-1 degrees of freedom (``ddof=1``)</span>
<span class="sd">    to calculate the standard deviation:</span>

<span class="sd">    &gt;&gt;&gt; b = np.array([[ 0.3148,  0.0478,  0.6243,  0.4608],</span>
<span class="sd">    ...               [ 0.7149,  0.0775,  0.6072,  0.9656],</span>
<span class="sd">    ...               [ 0.6341,  0.1403,  0.9759,  0.4064],</span>
<span class="sd">    ...               [ 0.5918,  0.6948,  0.904 ,  0.3721],</span>
<span class="sd">    ...               [ 0.0921,  0.2481,  0.1188,  0.1366]])</span>
<span class="sd">    &gt;&gt;&gt; stats.zscore(b, axis=1, ddof=1)</span>
<span class="sd">    array([[-0.19264823, -1.28415119,  1.07259584,  0.40420358],</span>
<span class="sd">           [ 0.33048416, -1.37380874,  0.04251374,  1.00081084],</span>
<span class="sd">           [ 0.26796377, -1.12598418,  1.23283094, -0.37481053],</span>
<span class="sd">           [-0.22095197,  0.24468594,  1.19042819, -1.21416216],</span>
<span class="sd">           [-0.82780366,  1.4457416 , -0.43867764, -0.1792603 ]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">mns</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">sstd</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">and</span> <span class="n">mns</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span> <span class="o">/</span>
                <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sstd</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">mns</span><span class="p">)</span> <span class="o">/</span> <span class="n">sstd</span></div>


<div class="viewcode-block" id="zmap"><a class="viewcode-back" href="../../../generated/scipy.stats.zmap.html#scipy.stats.zmap">[docs]</a><span class="k">def</span> <span class="nf">zmap</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">compare</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the relative z-scores.</span>

<span class="sd">    Returns an array of z-scores, i.e., scores that are standardized to zero</span>
<span class="sd">    mean and unit variance, where mean and variance are calculated from the</span>
<span class="sd">    comparison array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scores : array_like</span>
<span class="sd">        The input for which z-scores are calculated.</span>
<span class="sd">    compare : array_like</span>
<span class="sd">        The input from which the mean and standard deviation of the</span>
<span class="sd">        normalization are taken; assumed to have the same dimension as</span>
<span class="sd">        `scores`.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis over which mean and variance of `compare` are calculated.</span>
<span class="sd">        Default is 0. If None, compute over the whole array `scores`.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        Degrees of freedom correction in the calculation of the</span>
<span class="sd">        standard deviation. Default is 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    zscore : array_like</span>
<span class="sd">        Z-scores, in the same shape as `scores`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function preserves ndarray subclasses, and works also with</span>
<span class="sd">    matrices and masked arrays (it uses `asanyarray` instead of `asarray`</span>
<span class="sd">    for parameters).</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy.stats import zmap</span>
<span class="sd">    &gt;&gt;&gt; a = [0.5, 2.0, 2.5, 3]</span>
<span class="sd">    &gt;&gt;&gt; b = [0, 1, 2, 3, 4]</span>
<span class="sd">    &gt;&gt;&gt; zmap(a, b)</span>
<span class="sd">    array([-1.06066017,  0.        ,  0.35355339,  0.70710678])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scores</span><span class="p">,</span> <span class="n">compare</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">,</span> <span class="p">[</span><span class="n">scores</span><span class="p">,</span> <span class="n">compare</span><span class="p">])</span>
    <span class="n">mns</span> <span class="o">=</span> <span class="n">compare</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">sstd</span> <span class="o">=</span> <span class="n">compare</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">and</span> <span class="n">mns</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="n">compare</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">scores</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span> <span class="o">/</span>
                <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sstd</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">scores</span> <span class="o">-</span> <span class="n">mns</span><span class="p">)</span> <span class="o">/</span> <span class="n">sstd</span></div>


<span class="c1">#####################################</span>
<span class="c1">#         TRIMMING FUNCTIONS        #</span>
<span class="c1">#####################################</span>

<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;stats.threshold is deprecated in scipy 0.17.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">threshold</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">threshmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">threshmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">newval</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clip array to a given value.</span>

<span class="sd">    Similar to numpy.clip(), except that values less than `threshmin` or</span>
<span class="sd">    greater than `threshmax` are replaced by `newval`, instead of by</span>
<span class="sd">    `threshmin` and `threshmax` respectively.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Data to threshold.</span>
<span class="sd">    threshmin : float, int or None, optional</span>
<span class="sd">        Minimum threshold, defaults to None.</span>
<span class="sd">    threshmax : float, int or None, optional</span>
<span class="sd">        Maximum threshold, defaults to None.</span>
<span class="sd">    newval : float or int, optional</span>
<span class="sd">        Value to put in place of values in `a` outside of bounds.</span>
<span class="sd">        Defaults to 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        The clipped input array, with values less than `threshmin` or</span>
<span class="sd">        greater than `threshmax` replaced with `newval`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([9, 9, 6, 3, 1, 6, 1, 0, 0, 8])</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; stats.threshold(a, threshmin=2, threshmax=8, newval=-1)</span>
<span class="sd">    array([-1, -1,  6,  3, -1,  6, -1, -1, -1,  8])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">threshmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">|=</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">threshmin</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">threshmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">|=</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">threshmax</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">newval</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="n">SigmaclipResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;SigmaclipResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;clipped&#39;</span><span class="p">,</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="sigmaclip"><a class="viewcode-back" href="../../../generated/scipy.stats.sigmaclip.html#scipy.stats.sigmaclip">[docs]</a><span class="k">def</span> <span class="nf">sigmaclip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">4.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterative sigma-clipping of array elements.</span>

<span class="sd">    The output array contains only those elements of the input array `c`</span>
<span class="sd">    that satisfy the conditions ::</span>

<span class="sd">        mean(c) - std(c)*low &lt; c &lt; mean(c) + std(c)*high</span>

<span class="sd">    Starting from the full sample, all elements outside the critical range are</span>
<span class="sd">    removed. The iteration continues with a new critical range until no</span>
<span class="sd">    elements are outside the range.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Data array, will be raveled if not 1-D.</span>
<span class="sd">    low : float, optional</span>
<span class="sd">        Lower bound factor of sigma clipping. Default is 4.</span>
<span class="sd">    high : float, optional</span>
<span class="sd">        Upper bound factor of sigma clipping. Default is 4.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    clipped : ndarray</span>
<span class="sd">        Input array with clipped elements removed.</span>
<span class="sd">    lower : float</span>
<span class="sd">        Lower threshold value use for clipping.</span>
<span class="sd">    upper : float</span>
<span class="sd">        Upper threshold value use for clipping.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy.stats import sigmaclip</span>
<span class="sd">    &gt;&gt;&gt; a = np.concatenate((np.linspace(9.5, 10.5, 31),</span>
<span class="sd">    ...                     np.linspace(0, 20, 5)))</span>
<span class="sd">    &gt;&gt;&gt; fact = 1.5</span>
<span class="sd">    &gt;&gt;&gt; c, low, upp = sigmaclip(a, fact, fact)</span>
<span class="sd">    &gt;&gt;&gt; c</span>
<span class="sd">    array([  9.96666667,  10.        ,  10.03333333,  10.        ])</span>
<span class="sd">    &gt;&gt;&gt; c.var(), c.std()</span>
<span class="sd">    (0.00055555555555555165, 0.023570226039551501)</span>
<span class="sd">    &gt;&gt;&gt; low, c.mean() - fact*c.std(), c.min()</span>
<span class="sd">    (9.9646446609406727, 9.9646446609406727, 9.9666666666666668)</span>
<span class="sd">    &gt;&gt;&gt; upp, c.mean() + fact*c.std(), c.max()</span>
<span class="sd">    (10.035355339059327, 10.035355339059327, 10.033333333333333)</span>

<span class="sd">    &gt;&gt;&gt; a = np.concatenate((np.linspace(9.5, 10.5, 11),</span>
<span class="sd">    ...                     np.linspace(-100, -50, 3)))</span>
<span class="sd">    &gt;&gt;&gt; c, low, upp = sigmaclip(a, 1.8, 1.8)</span>
<span class="sd">    &gt;&gt;&gt; (c == np.linspace(9.5, 10.5, 11)).all()</span>
<span class="sd">    True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">delta</span><span class="p">:</span>
        <span class="n">c_std</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">c_mean</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">size</span>
        <span class="n">critlower</span> <span class="o">=</span> <span class="n">c_mean</span> <span class="o">-</span> <span class="n">c_std</span><span class="o">*</span><span class="n">low</span>
        <span class="n">critupper</span> <span class="o">=</span> <span class="n">c_mean</span> <span class="o">+</span> <span class="n">c_std</span><span class="o">*</span><span class="n">high</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">[(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">critlower</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">critupper</span><span class="p">)]</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">size</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">size</span>

    <span class="k">return</span> <span class="n">SigmaclipResult</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">critlower</span><span class="p">,</span> <span class="n">critupper</span><span class="p">)</span></div>


<div class="viewcode-block" id="trimboth"><a class="viewcode-back" href="../../../generated/scipy.stats.trimboth.html#scipy.stats.trimboth">[docs]</a><span class="k">def</span> <span class="nf">trimboth</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">proportiontocut</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Slices off a proportion of items from both ends of an array.</span>

<span class="sd">    Slices off the passed proportion of items from both ends of the passed</span>
<span class="sd">    array (i.e., with `proportiontocut` = 0.1, slices leftmost 10% **and**</span>
<span class="sd">    rightmost 10% of scores). The trimmed values are the lowest and</span>
<span class="sd">    highest ones.</span>
<span class="sd">    Slices off less if proportion results in a non-integer slice index (i.e.,</span>
<span class="sd">    conservatively slices off`proportiontocut`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Data to trim.</span>
<span class="sd">    proportiontocut : float</span>
<span class="sd">        Proportion (in range 0-1) of total data set to trim of each end.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to trim data. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        Trimmed version of array `a`. The order of the trimmed content</span>
<span class="sd">        is undefined.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    trim_mean</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; b = stats.trimboth(a, 0.1)</span>
<span class="sd">    &gt;&gt;&gt; b.shape</span>
<span class="sd">    (16,)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">nobs</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">lowercut</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proportiontocut</span> <span class="o">*</span> <span class="n">nobs</span><span class="p">)</span>
    <span class="n">uppercut</span> <span class="o">=</span> <span class="n">nobs</span> <span class="o">-</span> <span class="n">lowercut</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lowercut</span> <span class="o">&gt;=</span> <span class="n">uppercut</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Proportion too big.&quot;</span><span class="p">)</span>

    <span class="c1"># np.partition is preferred but it only exist in numpy 1.8.0 and higher,</span>
    <span class="c1"># in those cases we use np.sort</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">atmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">lowercut</span><span class="p">,</span> <span class="n">uppercut</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">atmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">sl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">atmp</span><span class="o">.</span><span class="n">ndim</span>
    <span class="n">sl</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lowercut</span><span class="p">,</span> <span class="n">uppercut</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">atmp</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span></div>


<div class="viewcode-block" id="trim1"><a class="viewcode-back" href="../../../generated/scipy.stats.trim1.html#scipy.stats.trim1">[docs]</a><span class="k">def</span> <span class="nf">trim1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">proportiontocut</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Slices off a proportion from ONE end of the passed array distribution.</span>

<span class="sd">    If `proportiontocut` = 0.1, slices off &#39;leftmost&#39; or &#39;rightmost&#39;</span>
<span class="sd">    10% of scores. The lowest or highest values are trimmed (depending on</span>
<span class="sd">    the tail).</span>
<span class="sd">    Slices off less if proportion results in a non-integer slice index</span>
<span class="sd">    (i.e., conservatively slices off `proportiontocut` ).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array</span>
<span class="sd">    proportiontocut : float</span>
<span class="sd">        Fraction to cut off of &#39;left&#39; or &#39;right&#39; of distribution</span>
<span class="sd">    tail : {&#39;left&#39;, &#39;right&#39;}, optional</span>
<span class="sd">        Defaults to &#39;right&#39;.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to trim data. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    trim1 : ndarray</span>
<span class="sd">        Trimmed version of array `a`. The order of the trimmed content is</span>
<span class="sd">        undefined.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">nobs</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>

    <span class="c1"># avoid possible corner case</span>
    <span class="k">if</span> <span class="n">proportiontocut</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">tail</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
        <span class="n">lowercut</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">uppercut</span> <span class="o">=</span> <span class="n">nobs</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">proportiontocut</span> <span class="o">*</span> <span class="n">nobs</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">tail</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
        <span class="n">lowercut</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proportiontocut</span> <span class="o">*</span> <span class="n">nobs</span><span class="p">)</span>
        <span class="n">uppercut</span> <span class="o">=</span> <span class="n">nobs</span>

    <span class="c1"># np.partition is preferred but it only exist in numpy 1.8.0 and higher,</span>
    <span class="c1"># in those cases we use np.sort</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">atmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">lowercut</span><span class="p">,</span> <span class="n">uppercut</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">atmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">atmp</span><span class="p">[</span><span class="n">lowercut</span><span class="p">:</span><span class="n">uppercut</span><span class="p">]</span></div>


<div class="viewcode-block" id="trim_mean"><a class="viewcode-back" href="../../../generated/scipy.stats.trim_mean.html#scipy.stats.trim_mean">[docs]</a><span class="k">def</span> <span class="nf">trim_mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">proportiontocut</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return mean of array after trimming distribution from both tails.</span>

<span class="sd">    If `proportiontocut` = 0.1, slices off &#39;leftmost&#39; and &#39;rightmost&#39; 10% of</span>
<span class="sd">    scores. The input is sorted before slicing. Slices off less if proportion</span>
<span class="sd">    results in a non-integer slice index (i.e., conservatively slices off</span>
<span class="sd">    `proportiontocut` ).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array</span>
<span class="sd">    proportiontocut : float</span>
<span class="sd">        Fraction to cut off of both tails of the distribution</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which the trimmed means are computed. Default is 0.</span>
<span class="sd">        If None, compute over the whole array `a`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    trim_mean : ndarray</span>
<span class="sd">        Mean of trimmed array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    trimboth</span>
<span class="sd">    tmean : compute the trimmed mean ignoring values outside given `limits`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(20)</span>
<span class="sd">    &gt;&gt;&gt; stats.trim_mean(x, 0.1)</span>
<span class="sd">    9.5</span>
<span class="sd">    &gt;&gt;&gt; x2 = x.reshape(5, 4)</span>
<span class="sd">    &gt;&gt;&gt; x2</span>
<span class="sd">    array([[ 0,  1,  2,  3],</span>
<span class="sd">           [ 4,  5,  6,  7],</span>
<span class="sd">           [ 8,  9, 10, 11],</span>
<span class="sd">           [12, 13, 14, 15],</span>
<span class="sd">           [16, 17, 18, 19]])</span>
<span class="sd">    &gt;&gt;&gt; stats.trim_mean(x2, 0.25)</span>
<span class="sd">    array([  8.,   9.,  10.,  11.])</span>
<span class="sd">    &gt;&gt;&gt; stats.trim_mean(x2, 0.25, axis=1)</span>
<span class="sd">    array([  1.5,   5.5,   9.5,  13.5,  17.5])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">nobs</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">lowercut</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proportiontocut</span> <span class="o">*</span> <span class="n">nobs</span><span class="p">)</span>
    <span class="n">uppercut</span> <span class="o">=</span> <span class="n">nobs</span> <span class="o">-</span> <span class="n">lowercut</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lowercut</span> <span class="o">&gt;</span> <span class="n">uppercut</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Proportion too big.&quot;</span><span class="p">)</span>

    <span class="c1"># np.partition is preferred but it only exist in numpy 1.8.0 and higher,</span>
    <span class="c1"># in those cases we use np.sort</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">atmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">lowercut</span><span class="p">,</span> <span class="n">uppercut</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">atmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">sl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">atmp</span><span class="o">.</span><span class="n">ndim</span>
    <span class="n">sl</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lowercut</span><span class="p">,</span> <span class="n">uppercut</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">atmp</span><span class="p">[</span><span class="n">sl</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<span class="n">F_onewayResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;F_onewayResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="f_oneway"><a class="viewcode-back" href="../../../generated/scipy.stats.f_oneway.html#scipy.stats.f_oneway">[docs]</a><span class="k">def</span> <span class="nf">f_oneway</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a 1-way ANOVA.</span>

<span class="sd">    The one-way ANOVA tests the null hypothesis that two or more groups have</span>
<span class="sd">    the same population mean.  The test is applied to samples from two or</span>
<span class="sd">    more groups, possibly with differing sizes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sample1, sample2, ... : array_like</span>
<span class="sd">        The sample measurements for each group.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        The computed F-value of the test.</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        The associated p-value from the F-distribution.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The ANOVA test has important assumptions that must be satisfied in order</span>
<span class="sd">    for the associated p-value to be valid.</span>

<span class="sd">    1. The samples are independent.</span>
<span class="sd">    2. Each sample is from a normally distributed population.</span>
<span class="sd">    3. The population standard deviations of the groups are all equal.  This</span>
<span class="sd">       property is known as homoscedasticity.</span>

<span class="sd">    If these assumptions are not true for a given set of data, it may still be</span>
<span class="sd">    possible to use the Kruskal-Wallis H-test (`scipy.stats.kruskal`) although</span>
<span class="sd">    with some loss of power.</span>

<span class="sd">    The algorithm is from Heiman[2], pp.394-7.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Lowry, Richard.  &quot;Concepts and Applications of Inferential</span>
<span class="sd">           Statistics&quot;. Chapter 14.</span>
<span class="sd">           http://faculty.vassar.edu/lowry/ch14pt1.html</span>

<span class="sd">    .. [2] Heiman, G.W.  Research Methods in Statistics. 2002.</span>

<span class="sd">    .. [3] McDonald, G. H. &quot;Handbook of Biological Statistics&quot;, One-way ANOVA.</span>
<span class="sd">           http://http://www.biostathandbook.com/onewayanova.html</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import scipy.stats as stats</span>

<span class="sd">    [3]_ Here are some data on a shell measurement (the length of the anterior</span>
<span class="sd">    adductor muscle scar, standardized by dividing by length) in the mussel</span>
<span class="sd">    Mytilus trossulus from five locations: Tillamook, Oregon; Newport, Oregon;</span>
<span class="sd">    Petersburg, Alaska; Magadan, Russia; and Tvarminne, Finland, taken from a</span>
<span class="sd">    much larger data set used in McDonald et al. (1991).</span>

<span class="sd">    &gt;&gt;&gt; tillamook = [0.0571, 0.0813, 0.0831, 0.0976, 0.0817, 0.0859, 0.0735,</span>
<span class="sd">    ...              0.0659, 0.0923, 0.0836]</span>
<span class="sd">    &gt;&gt;&gt; newport = [0.0873, 0.0662, 0.0672, 0.0819, 0.0749, 0.0649, 0.0835,</span>
<span class="sd">    ...            0.0725]</span>
<span class="sd">    &gt;&gt;&gt; petersburg = [0.0974, 0.1352, 0.0817, 0.1016, 0.0968, 0.1064, 0.105]</span>
<span class="sd">    &gt;&gt;&gt; magadan = [0.1033, 0.0915, 0.0781, 0.0685, 0.0677, 0.0697, 0.0764,</span>
<span class="sd">    ...            0.0689]</span>
<span class="sd">    &gt;&gt;&gt; tvarminne = [0.0703, 0.1026, 0.0956, 0.0973, 0.1039, 0.1045]</span>
<span class="sd">    &gt;&gt;&gt; stats.f_oneway(tillamook, newport, petersburg, magadan, tvarminne)</span>
<span class="sd">    (7.1210194716424473, 0.00028122423145345439)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
    <span class="c1"># ANOVA on N groups, each in its own array</span>
    <span class="n">num_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">alldata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">bign</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alldata</span><span class="p">)</span>

    <span class="c1"># Determine the mean of the data, and subtract that from all inputs to a</span>
    <span class="c1"># variance (via sum_of_sq / sq_of_sum) calculation.  Variance is invariance</span>
    <span class="c1"># to a shift in location, and centering all data around zero vastly</span>
    <span class="c1"># improves numerical stability.</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">alldata</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">alldata</span> <span class="o">-=</span> <span class="n">offset</span>

    <span class="n">sstot</span> <span class="o">=</span> <span class="n">_sum_of_squares</span><span class="p">(</span><span class="n">alldata</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">_square_of_sums</span><span class="p">(</span><span class="n">alldata</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">bign</span><span class="p">))</span>
    <span class="n">ssbn</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">ssbn</span> <span class="o">+=</span> <span class="n">_square_of_sums</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

    <span class="c1"># Naming: variables ending in bn/b are for &quot;between treatments&quot;, wn/w are</span>
    <span class="c1"># for &quot;within treatments&quot;</span>
    <span class="n">ssbn</span> <span class="o">-=</span> <span class="p">(</span><span class="n">_square_of_sums</span><span class="p">(</span><span class="n">alldata</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">bign</span><span class="p">))</span>
    <span class="n">sswn</span> <span class="o">=</span> <span class="n">sstot</span> <span class="o">-</span> <span class="n">ssbn</span>
    <span class="n">dfbn</span> <span class="o">=</span> <span class="n">num_groups</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">dfwn</span> <span class="o">=</span> <span class="n">bign</span> <span class="o">-</span> <span class="n">num_groups</span>
    <span class="n">msb</span> <span class="o">=</span> <span class="n">ssbn</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfbn</span><span class="p">)</span>
    <span class="n">msw</span> <span class="o">=</span> <span class="n">sswn</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfwn</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">msb</span> <span class="o">/</span> <span class="n">msw</span>

    <span class="n">prob</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">fdtrc</span><span class="p">(</span><span class="n">dfbn</span><span class="p">,</span> <span class="n">dfwn</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>   <span class="c1"># equivalent to stats.f.sf</span>

    <span class="k">return</span> <span class="n">F_onewayResult</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>


<div class="viewcode-block" id="pearsonr"><a class="viewcode-back" href="../../../generated/scipy.stats.pearsonr.html#scipy.stats.pearsonr">[docs]</a><span class="k">def</span> <span class="nf">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates a Pearson correlation coefficient and the p-value for testing</span>
<span class="sd">    non-correlation.</span>

<span class="sd">    The Pearson correlation coefficient measures the linear relationship</span>
<span class="sd">    between two datasets. Strictly speaking, Pearson&#39;s correlation requires</span>
<span class="sd">    that each dataset be normally distributed, and not necessarily zero-mean.</span>
<span class="sd">    Like other correlation coefficients, this one varies between -1 and +1</span>
<span class="sd">    with 0 implying no correlation. Correlations of -1 or +1 imply an exact</span>
<span class="sd">    linear relationship. Positive correlations imply that as x increases, so</span>
<span class="sd">    does y. Negative correlations imply that as x increases, y decreases.</span>

<span class="sd">    The p-value roughly indicates the probability of an uncorrelated system</span>
<span class="sd">    producing datasets that have a Pearson correlation at least as extreme</span>
<span class="sd">    as the one computed from these datasets. The p-values are not entirely</span>
<span class="sd">    reliable but are probably reasonable for datasets larger than 500 or so.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : (N,) array_like</span>
<span class="sd">        Input</span>
<span class="sd">    y : (N,) array_like</span>
<span class="sd">        Input</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (Pearson&#39;s correlation coefficient,</span>
<span class="sd">     2-tailed p-value)</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    http://www.statsoft.com/textbook/glosp.html#Pearson%20Correlation</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># x and y should have same length.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">mx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">my</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">xm</span><span class="p">,</span> <span class="n">ym</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mx</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">my</span>
    <span class="n">r_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">xm</span> <span class="o">*</span> <span class="n">ym</span><span class="p">)</span>
    <span class="n">r_den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">_sum_of_squares</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span> <span class="o">*</span> <span class="n">_sum_of_squares</span><span class="p">(</span><span class="n">ym</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">r_num</span> <span class="o">/</span> <span class="n">r_den</span>

    <span class="c1"># Presumably, if abs(r) &gt; 1, then it is only some small artifact of floating</span>
    <span class="c1"># point arithmetic.</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t_squared</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">df</span> <span class="o">/</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">r</span><span class="p">)))</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">_betai</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">df</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">df</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="o">+</span><span class="n">t_squared</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">prob</span></div>


<div class="viewcode-block" id="fisher_exact"><a class="viewcode-back" href="../../../generated/scipy.stats.fisher_exact.html#scipy.stats.fisher_exact">[docs]</a><span class="k">def</span> <span class="nf">fisher_exact</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Fisher exact test on a 2x2 contingency table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table : array_like of ints</span>
<span class="sd">        A 2x2 contingency table.  Elements should be non-negative integers.</span>
<span class="sd">    alternative : {&#39;two-sided&#39;, &#39;less&#39;, &#39;greater&#39;}, optional</span>
<span class="sd">        Which alternative hypothesis to the null hypothesis the test uses.</span>
<span class="sd">        Default is &#39;two-sided&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    oddsratio : float</span>
<span class="sd">        This is prior odds ratio and not a posterior estimate.</span>
<span class="sd">    p_value : float</span>
<span class="sd">        P-value, the probability of obtaining a distribution at least as</span>
<span class="sd">        extreme as the one that was actually observed, assuming that the</span>
<span class="sd">        null hypothesis is true.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    chi2_contingency : Chi-square test of independence of variables in a</span>
<span class="sd">        contingency table.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The calculated odds ratio is different from the one R uses. This scipy</span>
<span class="sd">    implementation returns the (more common) &quot;unconditional Maximum</span>
<span class="sd">    Likelihood Estimate&quot;, while R uses the &quot;conditional Maximum Likelihood</span>
<span class="sd">    Estimate&quot;.</span>

<span class="sd">    For tables with large numbers, the (inexact) chi-square test implemented</span>
<span class="sd">    in the function `chi2_contingency` can also be used.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Say we spend a few days counting whales and sharks in the Atlantic and</span>
<span class="sd">    Indian oceans. In the Atlantic ocean we find 8 whales and 1 shark, in the</span>
<span class="sd">    Indian ocean 2 whales and 5 sharks. Then our contingency table is::</span>

<span class="sd">                Atlantic  Indian</span>
<span class="sd">        whales     8        2</span>
<span class="sd">        sharks     1        5</span>

<span class="sd">    We use this table to find the p-value:</span>

<span class="sd">    &gt;&gt;&gt; import scipy.stats as stats</span>
<span class="sd">    &gt;&gt;&gt; oddsratio, pvalue = stats.fisher_exact([[8, 2], [1, 5]])</span>
<span class="sd">    &gt;&gt;&gt; pvalue</span>
<span class="sd">    0.0349...</span>

<span class="sd">    The probability that we would observe this or an even more imbalanced ratio</span>
<span class="sd">    by chance is about 3.5%.  A commonly used significance level is 5%--if we</span>
<span class="sd">    adopt that, we can therefore conclude that our observed imbalance is</span>
<span class="sd">    statistically significant; whales prefer the Atlantic while sharks prefer</span>
<span class="sd">    the Indian ocean.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hypergeom</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">hypergeom</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>  <span class="c1"># int32 is not enough for the algorithm</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input `table` must be of shape (2, 2).&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All values in `table` must be nonnegative.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># If both values in a row or column are zero, the p-value is 1 and</span>
        <span class="c1"># the odds ratio is NaN.</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">1.0</span>

    <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">oddsratio</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">oddsratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="n">n1</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">binary_search</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">side</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Binary search for where to begin lower/upper halves in two-sided</span>
<span class="sd">        test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span>
            <span class="n">minval</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="n">maxval</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minval</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">maxval</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="n">guess</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">maxval</span> <span class="o">-</span> <span class="n">minval</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">maxval</span> <span class="o">==</span> <span class="n">minval</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">guess</span> <span class="o">==</span> <span class="n">minval</span><span class="p">:</span>
                <span class="n">guess</span> <span class="o">=</span> <span class="n">maxval</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxval</span> <span class="o">+</span> <span class="n">minval</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">pguess</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span>
                <span class="n">ng</span> <span class="o">=</span> <span class="n">guess</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ng</span> <span class="o">=</span> <span class="n">guess</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">pguess</span> <span class="o">&lt;=</span> <span class="n">pexact</span> <span class="o">&lt;</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">ng</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">pguess</span> <span class="o">&lt;</span> <span class="n">pexact</span><span class="p">:</span>
                <span class="n">maxval</span> <span class="o">=</span> <span class="n">guess</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minval</span> <span class="o">=</span> <span class="n">guess</span>
        <span class="k">if</span> <span class="n">guess</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">guess</span> <span class="o">=</span> <span class="n">minval</span>
        <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">guess</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pexact</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">:</span>
                <span class="n">guess</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pexact</span> <span class="o">/</span> <span class="n">epsilon</span><span class="p">:</span>
                <span class="n">guess</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pexact</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">:</span>
                <span class="n">guess</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">guess</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pexact</span> <span class="o">/</span> <span class="n">epsilon</span><span class="p">:</span>
                <span class="n">guess</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">guess</span>

    <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;less&#39;</span><span class="p">:</span>
        <span class="n">pvalue</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;greater&#39;</span><span class="p">:</span>
        <span class="c1"># Same formula as the &#39;less&#39; case, but with the second column.</span>
        <span class="n">pvalue</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">:</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">((</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">pexact</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">pmode</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="n">epsilon</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-4</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pexact</span> <span class="o">-</span> <span class="n">pmode</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">pexact</span><span class="p">,</span> <span class="n">pmode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">oddsratio</span><span class="p">,</span> <span class="mf">1.</span>

        <span class="k">elif</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mode</span><span class="p">:</span>
            <span class="n">plower</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pexact</span> <span class="o">/</span> <span class="n">epsilon</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">oddsratio</span><span class="p">,</span> <span class="n">plower</span>

            <span class="n">guess</span> <span class="o">=</span> <span class="n">binary_search</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
            <span class="n">pvalue</span> <span class="o">=</span> <span class="n">plower</span> <span class="o">+</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">guess</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pupper</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pexact</span> <span class="o">/</span> <span class="n">epsilon</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">oddsratio</span><span class="p">,</span> <span class="n">pupper</span>

            <span class="n">guess</span> <span class="o">=</span> <span class="n">binary_search</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">)</span>
            <span class="n">pvalue</span> <span class="o">=</span> <span class="n">pupper</span> <span class="o">+</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;`alternative` should be one of {&#39;two-sided&#39;, &#39;less&#39;, &#39;greater&#39;}&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pvalue</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="n">pvalue</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">oddsratio</span><span class="p">,</span> <span class="n">pvalue</span></div>

<span class="n">SpearmanrResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;SpearmanrResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;correlation&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="spearmanr"><a class="viewcode-back" href="../../../generated/scipy.stats.spearmanr.html#scipy.stats.spearmanr">[docs]</a><span class="k">def</span> <span class="nf">spearmanr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates a Spearman rank-order correlation coefficient and the p-value</span>
<span class="sd">    to test for non-correlation.</span>

<span class="sd">    The Spearman correlation is a nonparametric measure of the monotonicity</span>
<span class="sd">    of the relationship between two datasets. Unlike the Pearson correlation,</span>
<span class="sd">    the Spearman correlation does not assume that both datasets are normally</span>
<span class="sd">    distributed. Like other correlation coefficients, this one varies</span>
<span class="sd">    between -1 and +1 with 0 implying no correlation. Correlations of -1 or</span>
<span class="sd">    +1 imply an exact monotonic relationship. Positive correlations imply that</span>
<span class="sd">    as x increases, so does y. Negative correlations imply that as x</span>
<span class="sd">    increases, y decreases.</span>

<span class="sd">    The p-value roughly indicates the probability of an uncorrelated system</span>
<span class="sd">    producing datasets that have a Spearman correlation at least as extreme</span>
<span class="sd">    as the one computed from these datasets. The p-values are not entirely</span>
<span class="sd">    reliable but are probably reasonable for datasets larger than 500 or so.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a, b : 1D or 2D array_like, b is optional</span>
<span class="sd">        One or two 1-D or 2-D arrays containing multiple variables and</span>
<span class="sd">        observations. When these are 1-D, each represents a vector of</span>
<span class="sd">        observations of a single variable. For the behavior in the 2-D case,</span>
<span class="sd">        see under ``axis``, below.</span>
<span class="sd">        Both arrays need to have the same length in the ``axis`` dimension.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        If axis=0 (default), then each column represents a variable, with</span>
<span class="sd">        observations in the rows. If axis=1, the relationship is transposed:</span>
<span class="sd">        each row represents a variable, while the columns contain observations.</span>
<span class="sd">        If axis=None, then both arrays will be raveled.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    correlation : float or ndarray (2-D square)</span>
<span class="sd">        Spearman correlation matrix or correlation coefficient (if only 2</span>
<span class="sd">        variables are given as parameters. Correlation matrix is square with</span>
<span class="sd">        length equal to total number of variables (columns or rows) in a and b</span>
<span class="sd">        combined.</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        The two-sided p-value for a hypothesis test whose null hypothesis is</span>
<span class="sd">        that two sets of data are uncorrelated, has same dimension as rho.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Changes in scipy 0.8.0: rewrite to add tie-handling, and axis.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    .. [1] Zwillinger, D. and Kokoska, S. (2000). CRC Standard</span>
<span class="sd">       Probability and Statistics Tables and Formulae. Chapman &amp; Hall: New</span>
<span class="sd">       York. 2000.</span>
<span class="sd">       Section  14.7</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; stats.spearmanr([1,2,3,4,5], [5,6,7,8,7])</span>
<span class="sd">    (0.82078268166812329, 0.088587005313543798)</span>
<span class="sd">    &gt;&gt;&gt; np.random.seed(1234321)</span>
<span class="sd">    &gt;&gt;&gt; x2n = np.random.randn(100, 2)</span>
<span class="sd">    &gt;&gt;&gt; y2n = np.random.randn(100, 2)</span>
<span class="sd">    &gt;&gt;&gt; stats.spearmanr(x2n)</span>
<span class="sd">    (0.059969996999699973, 0.55338590803773591)</span>
<span class="sd">    &gt;&gt;&gt; stats.spearmanr(x2n[:,0], x2n[:,1])</span>
<span class="sd">    (0.059969996999699973, 0.55338590803773591)</span>
<span class="sd">    &gt;&gt;&gt; rho, pval = stats.spearmanr(x2n, y2n)</span>
<span class="sd">    &gt;&gt;&gt; rho</span>
<span class="sd">    array([[ 1.        ,  0.05997   ,  0.18569457,  0.06258626],</span>
<span class="sd">           [ 0.05997   ,  1.        ,  0.110003  ,  0.02534653],</span>
<span class="sd">           [ 0.18569457,  0.110003  ,  1.        ,  0.03488749],</span>
<span class="sd">           [ 0.06258626,  0.02534653,  0.03488749,  1.        ]])</span>
<span class="sd">    &gt;&gt;&gt; pval</span>
<span class="sd">    array([[ 0.        ,  0.55338591,  0.06435364,  0.53617935],</span>
<span class="sd">           [ 0.55338591,  0.        ,  0.27592895,  0.80234077],</span>
<span class="sd">           [ 0.06435364,  0.27592895,  0.        ,  0.73039992],</span>
<span class="sd">           [ 0.53617935,  0.80234077,  0.73039992,  0.        ]])</span>
<span class="sd">    &gt;&gt;&gt; rho, pval = stats.spearmanr(x2n.T, y2n.T, axis=1)</span>
<span class="sd">    &gt;&gt;&gt; rho</span>
<span class="sd">    array([[ 1.        ,  0.05997   ,  0.18569457,  0.06258626],</span>
<span class="sd">           [ 0.05997   ,  1.        ,  0.110003  ,  0.02534653],</span>
<span class="sd">           [ 0.18569457,  0.110003  ,  1.        ,  0.03488749],</span>
<span class="sd">           [ 0.06258626,  0.02534653,  0.03488749,  1.        ]])</span>
<span class="sd">    &gt;&gt;&gt; stats.spearmanr(x2n, y2n, axis=None)</span>
<span class="sd">    (0.10816770419260482, 0.1273562188027364)</span>
<span class="sd">    &gt;&gt;&gt; stats.spearmanr(x2n.ravel(), y2n.ravel())</span>
<span class="sd">    (0.10816770419260482, 0.1273562188027364)</span>

<span class="sd">    &gt;&gt;&gt; xint = np.random.randint(10, size=(100, 2))</span>
<span class="sd">    &gt;&gt;&gt; stats.spearmanr(xint)</span>
<span class="sd">    (0.052760927029710199, 0.60213045837062351)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axisout</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SpearmanrResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SpearmanrResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">rankdata</span><span class="p">,</span> <span class="n">axisout</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="n">br</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">axisout</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

        <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SpearmanrResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

        <span class="n">br</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">rankdata</span><span class="p">,</span> <span class="n">axisout</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axisout</span><span class="p">]</span>
    <span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">br</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="n">axisout</span><span class="p">)</span>

    <span class="n">olderr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>  <span class="c1"># rs can have elements equal to 1</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">rs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">rs</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">rs</span><span class="p">)))</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">olderr</span><span class="p">)</span>

    <span class="n">prob</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">distributions</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rs</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SpearmanrResult</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SpearmanrResult</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<span class="n">PointbiserialrResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;PointbiserialrResult&#39;</span><span class="p">,</span>
                                  <span class="p">(</span><span class="s1">&#39;correlation&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="pointbiserialr"><a class="viewcode-back" href="../../../generated/scipy.stats.pointbiserialr.html#scipy.stats.pointbiserialr">[docs]</a><span class="k">def</span> <span class="nf">pointbiserialr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Calculates a point biserial correlation coefficient and its p-value.</span>

<span class="sd">    The point biserial correlation is used to measure the relationship</span>
<span class="sd">    between a binary variable, x, and a continuous variable, y. Like other</span>
<span class="sd">    correlation coefficients, this one varies between -1 and +1 with 0</span>
<span class="sd">    implying no correlation. Correlations of -1 or +1 imply a determinative</span>
<span class="sd">    relationship.</span>

<span class="sd">    This function uses a shortcut formula but produces the same result as</span>
<span class="sd">    `pearsonr`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like of bools</span>
<span class="sd">        Input array.</span>
<span class="sd">    y : array_like</span>
<span class="sd">        Input array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    correlation : float</span>
<span class="sd">        R value</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        2-tailed p-value</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    `pointbiserialr` uses a t-test with ``n-1`` degrees of freedom.</span>
<span class="sd">    It is equivalent to `pearsonr.`</span>

<span class="sd">    The value of the point-biserial correlation can be calculated from:</span>

<span class="sd">    .. math::</span>

<span class="sd">        r_{pb} = \frac{\overline{Y_{1}} -</span>
<span class="sd">                 \overline{Y_{0}}}{s_{y}}\sqrt{\frac{N_{1} N_{2}}{N (N - 1))}}</span>

<span class="sd">    Where :math:`Y_{0}` and :math:`Y_{1}` are means of the metric</span>
<span class="sd">    observations coded 0 and 1 respectively; :math:`N_{0}` and :math:`N_{1}`</span>
<span class="sd">    are number of observations coded 0 and 1 respectively; :math:`N` is the</span>
<span class="sd">    total number of observations and :math:`s_{y}` is the standard</span>
<span class="sd">    deviation of all the metric observations.</span>

<span class="sd">    A value of :math:`r_{pb}` that is significantly different from zero is</span>
<span class="sd">    completely equivalent to a significant difference in means between the two</span>
<span class="sd">    groups. Thus, an independent groups t Test with :math:`N-2` degrees of</span>
<span class="sd">    freedom may be used to test whether :math:`r_{pb}` is nonzero. The</span>
<span class="sd">    relation between the t-statistic for comparing two independent groups and</span>
<span class="sd">    :math:`r_{pb}` is given by:</span>

<span class="sd">    .. math::</span>

<span class="sd">        t = \sqrt{N - 2}\frac{r_{pb}}{\sqrt{1 - r^{2}_{pb}}}</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] J. Lev, &quot;The Point Biserial Coefficient of Correlation&quot;, Ann. Math.</span>
<span class="sd">           Statist., Vol. 20, no.1, pp. 125-126, 1949.</span>

<span class="sd">    .. [2] R.F. Tate, &quot;Correlation Between a Discrete and a Continuous</span>
<span class="sd">           Variable. Point-Biserial Correlation.&quot;, Ann. Math. Statist., Vol. 25,</span>
<span class="sd">           np. 3, pp. 603-607, 1954.</span>

<span class="sd">    .. [3] http://onlinelibrary.wiley.com/doi/10.1002/9781118445112.stat06227/full</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([0, 0, 0, 1, 1, 1, 1])</span>
<span class="sd">    &gt;&gt;&gt; b = np.arange(7)</span>
<span class="sd">    &gt;&gt;&gt; stats.pointbiserialr(a, b)</span>
<span class="sd">    (0.8660254037844386, 0.011724811003954652)</span>
<span class="sd">    &gt;&gt;&gt; stats.pearsonr(a, b)</span>
<span class="sd">    (0.86602540378443871, 0.011724811003954626)</span>
<span class="sd">    &gt;&gt;&gt; np.corrcoef(a, b)</span>
<span class="sd">    array([[ 1.       ,  0.8660254],</span>
<span class="sd">           [ 0.8660254,  1.       ]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rpb</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">PointbiserialrResult</span><span class="p">(</span><span class="n">rpb</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<span class="n">KendalltauResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;KendalltauResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;correlation&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="kendalltau"><a class="viewcode-back" href="../../../generated/scipy.stats.kendalltau.html#scipy.stats.kendalltau">[docs]</a><span class="k">def</span> <span class="nf">kendalltau</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">initial_lexsort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Kendall&#39;s tau, a correlation measure for ordinal data.</span>

<span class="sd">    Kendall&#39;s tau is a measure of the correspondence between two rankings.</span>
<span class="sd">    Values close to 1 indicate strong agreement, values close to -1 indicate</span>
<span class="sd">    strong disagreement.  This is the tau-b version of Kendall&#39;s tau which</span>
<span class="sd">    accounts for ties.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x, y : array_like</span>
<span class="sd">        Arrays of rankings, of the same shape. If arrays are not 1-D, they will</span>
<span class="sd">        be flattened to 1-D.</span>
<span class="sd">    initial_lexsort : bool, optional</span>
<span class="sd">        Whether to use lexsort or quicksort as the sorting method for the</span>
<span class="sd">        initial sort of the inputs. Default is lexsort (True), for which</span>
<span class="sd">        `kendalltau` is of complexity O(n log(n)). If False, the complexity is</span>
<span class="sd">        O(n^2), but with a smaller pre-factor (so quicksort may be faster for</span>
<span class="sd">        small arrays).</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    correlation : float</span>
<span class="sd">       The tau statistic.</span>
<span class="sd">    pvalue : float</span>
<span class="sd">       The two-sided p-value for a hypothesis test whose null hypothesis is</span>
<span class="sd">       an absence of association, tau = 0.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    spearmanr : Calculates a Spearman rank-order correlation coefficient.</span>
<span class="sd">    theilslopes : Computes the Theil-Sen estimator for a set of points (x, y).</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The definition of Kendall&#39;s tau that is used is::</span>

<span class="sd">      tau = (P - Q) / sqrt((P + Q + T) * (P + Q + U))</span>

<span class="sd">    where P is the number of concordant pairs, Q the number of discordant</span>
<span class="sd">    pairs, T the number of ties only in `x`, and U the number of ties only in</span>
<span class="sd">    `y`.  If a tie occurs for the same pair in both `x` and `y`, it is not</span>
<span class="sd">    added to either T or U.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    W.R. Knight, &quot;A Computer Method for Calculating Kendall&#39;s Tau with</span>
<span class="sd">    Ungrouped Data&quot;, Journal of the American Statistical Association, Vol. 61,</span>
<span class="sd">    No. 314, Part 1, pp. 436-439, 1966.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x1 = [12, 2, 1, 12, 2]</span>
<span class="sd">    &gt;&gt;&gt; x2 = [1, 4, 7, 1, 0]</span>
<span class="sd">    &gt;&gt;&gt; tau, p_value = stats.kendalltau(x1, x2)</span>
<span class="sd">    &gt;&gt;&gt; tau</span>
<span class="sd">    -0.47140452079103173</span>
<span class="sd">    &gt;&gt;&gt; p_value</span>
<span class="sd">    0.24821309157521476</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All inputs to `kendalltau` must be of the same size, &quot;</span>
                         <span class="s2">&quot;found x-size </span><span class="si">%s</span><span class="s2"> and y-size </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">KendalltauResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>  <span class="c1"># Return NaN if arrays are empty</span>

    <span class="c1"># check both x and y</span>
    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="p">(</span><span class="n">_contains_nan</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span> <span class="ow">or</span>
                                <span class="n">_contains_nan</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">KendalltauResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">kendalltau</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>  <span class="c1"># support structure used by mergesort</span>
    <span class="c1"># this closure recursively sorts sections of perm[] by comparing</span>
    <span class="c1"># elements of y[perm[]] using temp[] as support</span>
    <span class="c1"># returns the number of swaps required by an equivalent bubble sort</span>

    <span class="k">def</span> <span class="nf">mergesort</span><span class="p">(</span><span class="n">offs</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="n">exchcnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">offs</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">offs</span><span class="o">+</span><span class="mi">1</span><span class="p">]]:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">offs</span><span class="p">]</span>
            <span class="n">perm</span><span class="p">[</span><span class="n">offs</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">offs</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">perm</span><span class="p">[</span><span class="n">offs</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="n">length0</span> <span class="o">=</span> <span class="n">length</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">length1</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="n">length0</span>
        <span class="n">middle</span> <span class="o">=</span> <span class="n">offs</span> <span class="o">+</span> <span class="n">length0</span>
        <span class="n">exchcnt</span> <span class="o">+=</span> <span class="n">mergesort</span><span class="p">(</span><span class="n">offs</span><span class="p">,</span> <span class="n">length0</span><span class="p">)</span>
        <span class="n">exchcnt</span> <span class="o">+=</span> <span class="n">mergesort</span><span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="n">length1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">middle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">middle</span><span class="p">]]:</span>
            <span class="k">return</span> <span class="n">exchcnt</span>

        <span class="c1"># merging</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">length0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">length1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="n">length1</span> <span class="ow">or</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">length0</span> <span class="ow">and</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">offs</span> <span class="o">+</span> <span class="n">j</span><span class="p">]]</span> <span class="o">&lt;=</span>
                                                <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">middle</span> <span class="o">+</span> <span class="n">k</span><span class="p">]]):</span>
                <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">offs</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">middle</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span>
                <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">offs</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">middle</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">exchcnt</span> <span class="o">+=</span> <span class="n">d</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">perm</span><span class="p">[</span><span class="n">offs</span><span class="p">:</span><span class="n">offs</span><span class="o">+</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">length</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">exchcnt</span>

    <span class="c1"># initial sort on values of x and, if tied, on values of y</span>
    <span class="k">if</span> <span class="n">initial_lexsort</span><span class="p">:</span>
        <span class="c1"># sort implemented as mergesort, worst case: O(n log(n))</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># sort implemented as quicksort, 30% faster but with worst case: O(n^2)</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">perm</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">a</span><span class="p">]))</span>

    <span class="c1"># compute joint ties</span>
    <span class="n">first</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">first</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="ow">or</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">first</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">first</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">first</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="c1"># compute ties in x</span>
    <span class="n">first</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">first</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span>
            <span class="n">u</span> <span class="o">+=</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">first</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">u</span> <span class="o">+=</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">first</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="c1"># count exchanges</span>
    <span class="n">exchanges</span> <span class="o">=</span> <span class="n">mergesort</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="c1"># compute ties in y after mergesort with counting</span>
    <span class="n">first</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">first</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span>
            <span class="n">v</span> <span class="o">+=</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">first</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">v</span> <span class="o">+=</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">first</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="n">tot</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">tot</span> <span class="o">==</span> <span class="n">u</span> <span class="ow">or</span> <span class="n">tot</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
        <span class="c1"># Special case for all ties in both ranks</span>
        <span class="k">return</span> <span class="n">KendalltauResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="c1"># Prevent overflow; equal to np.sqrt((tot - u) * (tot - v))</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tot</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tot</span> <span class="o">-</span> <span class="n">v</span><span class="p">)))</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="p">((</span><span class="n">tot</span> <span class="o">-</span> <span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="n">u</span> <span class="o">-</span> <span class="n">t</span><span class="p">))</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">exchanges</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>

    <span class="c1"># what follows reproduces the ending of Gary Strangman&#39;s original</span>
    <span class="c1"># stats.kendalltau() in SciPy</span>
    <span class="n">svar</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">9.0</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">tau</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">svar</span><span class="p">)</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.4142136</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">KendalltauResult</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>


<span class="c1">#####################################</span>
<span class="c1">#       INFERENTIAL STATISTICS      #</span>
<span class="c1">#####################################</span>

<span class="n">Ttest_1sampResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Ttest_1sampResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="ttest_1samp"><a class="viewcode-back" href="../../../generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp">[docs]</a><span class="k">def</span> <span class="nf">ttest_1samp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">popmean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the T-test for the mean of ONE group of scores.</span>

<span class="sd">    This is a two-sided test for the null hypothesis that the expected value</span>
<span class="sd">    (mean) of a sample of independent observations `a` is equal to the given</span>
<span class="sd">    population mean, `popmean`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        sample observation</span>
<span class="sd">    popmean : float or array_like</span>
<span class="sd">        expected value in null hypothesis, if array_like than it must have the</span>
<span class="sd">        same shape as `a` excluding the axis dimension</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to compute test. If None, compute over the whole</span>
<span class="sd">        array `a`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float or array</span>
<span class="sd">        t-statistic</span>
<span class="sd">    pvalue : float or array</span>
<span class="sd">        two-tailed p-value</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>

<span class="sd">    &gt;&gt;&gt; np.random.seed(7654567)  # fix seed to get the same result</span>
<span class="sd">    &gt;&gt;&gt; rvs = stats.norm.rvs(loc=5, scale=10, size=(50,2))</span>

<span class="sd">    Test if mean of random sample is equal to true mean, and different mean.</span>
<span class="sd">    We reject the null hypothesis in the second case and don&#39;t reject it in</span>
<span class="sd">    the first case.</span>

<span class="sd">    &gt;&gt;&gt; stats.ttest_1samp(rvs,5.0)</span>
<span class="sd">    (array([-0.68014479, -0.04323899]), array([ 0.49961383,  0.96568674]))</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_1samp(rvs,0.0)</span>
<span class="sd">    (array([ 2.77025808,  4.11038784]), array([ 0.00789095,  0.00014999]))</span>

<span class="sd">    Examples using axis and non-scalar dimension for population mean.</span>

<span class="sd">    &gt;&gt;&gt; stats.ttest_1samp(rvs,[5.0,0.0])</span>
<span class="sd">    (array([-0.68014479,  4.11038784]), array([  4.99613833e-01,   1.49986458e-04]))</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_1samp(rvs.T,[5.0,0.0],axis=1)</span>
<span class="sd">    (array([-0.68014479,  4.11038784]), array([  4.99613833e-01,   1.49986458e-04]))</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_1samp(rvs,[[5.0],[0.0]])</span>
<span class="sd">    (array([[-0.68014479, -0.04323899],</span>
<span class="sd">           [ 2.77025808,  4.11038784]]), array([[  4.99613833e-01,   9.65686743e-01],</span>
<span class="sd">           [  7.89094663e-03,   1.49986458e-04]]))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">popmean</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">-</span> <span class="n">popmean</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">_ttest_finish</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Ttest_1sampResult</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_ttest_finish</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Common code between all 3 t-test functions.&quot;&quot;&quot;</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># use np.abs to get upper tail</span>
    <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[()]</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">prob</span>


<span class="k">def</span> <span class="nf">_ttest_ind_from_stats</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">mean2</span><span class="p">,</span> <span class="n">denom</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">_ttest_finish</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_unequal_var_ttest_denom</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">n2</span><span class="p">):</span>
    <span class="n">vn1</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">/</span> <span class="n">n1</span>
    <span class="n">vn2</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">/</span> <span class="n">n2</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">vn1</span> <span class="o">+</span> <span class="n">vn2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">vn1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vn2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># If df is undefined, variances are zero (assumes n1 &gt; 0 &amp; n2 &gt; 0).</span>
    <span class="c1"># Hence it doesn&#39;t matter what df is as long as it&#39;s not NaN.</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vn1</span> <span class="o">+</span> <span class="n">vn2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">denom</span>


<span class="k">def</span> <span class="nf">_equal_var_ttest_denom</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">n2</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">svar</span> <span class="o">=</span> <span class="p">((</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">v1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">v2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">svar</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n1</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">denom</span>

<span class="n">Ttest_indResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Ttest_indResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="ttest_ind_from_stats"><a class="viewcode-back" href="../../../generated/scipy.stats.ttest_ind_from_stats.html#scipy.stats.ttest_ind_from_stats">[docs]</a><span class="k">def</span> <span class="nf">ttest_ind_from_stats</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">std1</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">,</span> <span class="n">mean2</span><span class="p">,</span> <span class="n">std2</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">,</span>
                         <span class="n">equal_var</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    T-test for means of two independent samples from descriptive statistics.</span>

<span class="sd">    This is a two-sided test for the null hypothesis that 2 independent samples</span>
<span class="sd">    have identical average (expected) values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mean1 : array_like</span>
<span class="sd">        The mean(s) of sample 1.</span>
<span class="sd">    std1 : array_like</span>
<span class="sd">        The standard deviation(s) of sample 1.</span>
<span class="sd">    nobs1 : array_like</span>
<span class="sd">        The number(s) of observations of sample 1.</span>
<span class="sd">    mean2 : array_like</span>
<span class="sd">        The mean(s) of sample 2</span>
<span class="sd">    std2 : array_like</span>
<span class="sd">        The standard deviations(s) of sample 2.</span>
<span class="sd">    nobs2 : array_like</span>
<span class="sd">        The number(s) of observations of sample 2.</span>
<span class="sd">    equal_var : bool, optional</span>
<span class="sd">        If True (default), perform a standard independent 2 sample test</span>
<span class="sd">        that assumes equal population variances [1]_.</span>
<span class="sd">        If False, perform Welch&#39;s t-test, which does not assume equal</span>
<span class="sd">        population variance [2]_.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float or array</span>
<span class="sd">        The calculated t-statistics</span>
<span class="sd">    pvalue : float or array</span>
<span class="sd">        The two-tailed p-value.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.stats.ttest_ind</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    .. versionadded:: 0.16.0</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] http://en.wikipedia.org/wiki/T-test#Independent_two-sample_t-test</span>

<span class="sd">    .. [2] http://en.wikipedia.org/wiki/Welch%27s_t_test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">_equal_var_ttest_denom</span><span class="p">(</span><span class="n">std1</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">,</span> <span class="n">std2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">_unequal_var_ttest_denom</span><span class="p">(</span><span class="n">std1</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">,</span>
                                             <span class="n">std2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">_ttest_ind_from_stats</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">mean2</span><span class="p">,</span> <span class="n">denom</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Ttest_indResult</span><span class="p">(</span><span class="o">*</span><span class="n">res</span><span class="p">)</span></div>


<div class="viewcode-block" id="ttest_ind"><a class="viewcode-back" href="../../../generated/scipy.stats.ttest_ind.html#scipy.stats.ttest_ind">[docs]</a><span class="k">def</span> <span class="nf">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the T-test for the means of TWO INDEPENDENT samples of scores.</span>

<span class="sd">    This is a two-sided test for the null hypothesis that 2 independent samples</span>
<span class="sd">    have identical average (expected) values. This test assumes that the</span>
<span class="sd">    populations have identical variances by default.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a, b : array_like</span>
<span class="sd">        The arrays must have the same shape, except in the dimension</span>
<span class="sd">        corresponding to `axis` (the first, by default).</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to compute test. If None, compute over the whole</span>
<span class="sd">        arrays, `a`, and `b`.</span>
<span class="sd">    equal_var : bool, optional</span>
<span class="sd">        If True (default), perform a standard independent 2 sample test</span>
<span class="sd">        that assumes equal population variances [1]_.</span>
<span class="sd">        If False, perform Welch&#39;s t-test, which does not assume equal</span>
<span class="sd">        population variance [2]_.</span>
<span class="sd">        .. versionadded:: 0.11.0</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float or array</span>
<span class="sd">        The calculated t-statistic.</span>
<span class="sd">    pvalue : float or array</span>
<span class="sd">        The two-tailed p-value.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    We can use this test, if we observe two independent samples from</span>
<span class="sd">    the same or different population, e.g. exam scores of boys and</span>
<span class="sd">    girls or of two ethnic groups. The test measures whether the</span>
<span class="sd">    average (expected) value differs significantly across samples. If</span>
<span class="sd">    we observe a large p-value, for example larger than 0.05 or 0.1,</span>
<span class="sd">    then we cannot reject the null hypothesis of identical average scores.</span>
<span class="sd">    If the p-value is smaller than the threshold, e.g. 1%, 5% or 10%,</span>
<span class="sd">    then we reject the null hypothesis of equal averages.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] http://en.wikipedia.org/wiki/T-test#Independent_two-sample_t-test</span>

<span class="sd">    .. [2] http://en.wikipedia.org/wiki/Welch%27s_t_test</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; np.random.seed(12345678)</span>

<span class="sd">    Test with sample with identical means:</span>

<span class="sd">    &gt;&gt;&gt; rvs1 = stats.norm.rvs(loc=5,scale=10,size=500)</span>
<span class="sd">    &gt;&gt;&gt; rvs2 = stats.norm.rvs(loc=5,scale=10,size=500)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1,rvs2)</span>
<span class="sd">    (0.26833823296239279, 0.78849443369564776)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1,rvs2, equal_var = False)</span>
<span class="sd">    (0.26833823296239279, 0.78849452749500748)</span>

<span class="sd">    `ttest_ind` underestimates p for unequal variances:</span>

<span class="sd">    &gt;&gt;&gt; rvs3 = stats.norm.rvs(loc=5, scale=20, size=500)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1, rvs3)</span>
<span class="sd">    (-0.46580283298287162, 0.64145827413436174)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1, rvs3, equal_var = False)</span>
<span class="sd">    (-0.46580283298287162, 0.64149646246569292)</span>

<span class="sd">    When n1 != n2, the equal variance t-statistic is no longer equal to the</span>
<span class="sd">    unequal variance t-statistic:</span>

<span class="sd">    &gt;&gt;&gt; rvs4 = stats.norm.rvs(loc=5, scale=20, size=100)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1, rvs4)</span>
<span class="sd">    (-0.99882539442782481, 0.3182832709103896)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1, rvs4, equal_var = False)</span>
<span class="sd">    (-0.69712570584654099, 0.48716927725402048)</span>

<span class="sd">    T-test with different means, variance, and n:</span>

<span class="sd">    &gt;&gt;&gt; rvs5 = stats.norm.rvs(loc=8, scale=20, size=100)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1, rvs5)</span>
<span class="sd">    (-1.4679669854490653, 0.14263895620529152)</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_ind(rvs1, rvs5, equal_var = False)</span>
<span class="sd">    (-0.94365973617132992, 0.34744170334794122)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk2_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="c1"># check both a and b</span>
    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="p">(</span><span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span> <span class="ow">or</span>
                                <span class="n">_contains_nan</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">equal_var</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Ttest_indResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">_equal_var_ttest_denom</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">_unequal_var_ttest_denom</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">_ttest_ind_from_stats</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">),</span> <span class="n">denom</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Ttest_indResult</span><span class="p">(</span><span class="o">*</span><span class="n">res</span><span class="p">)</span></div>

<span class="n">Ttest_relResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Ttest_relResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="ttest_rel"><a class="viewcode-back" href="../../../generated/scipy.stats.ttest_rel.html#scipy.stats.ttest_rel">[docs]</a><span class="k">def</span> <span class="nf">ttest_rel</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;propagate&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the T-test on TWO RELATED samples of scores, a and b.</span>

<span class="sd">    This is a two-sided test for the null hypothesis that 2 related or</span>
<span class="sd">    repeated samples have identical average (expected) values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a, b : array_like</span>
<span class="sd">        The arrays must have the same shape.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to compute test. If None, compute over the whole</span>
<span class="sd">        arrays, `a`, and `b`.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float or array</span>
<span class="sd">        t-statistic</span>
<span class="sd">    pvalue : float or array</span>
<span class="sd">        two-tailed p-value</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Examples for the use are scores of the same set of student in</span>
<span class="sd">    different exams, or repeated sampling from the same units. The</span>
<span class="sd">    test measures whether the average score differs significantly</span>
<span class="sd">    across samples (e.g. exams). If we observe a large p-value, for</span>
<span class="sd">    example greater than 0.05 or 0.1 then we cannot reject the null</span>
<span class="sd">    hypothesis of identical average scores. If the p-value is smaller</span>
<span class="sd">    than the threshold, e.g. 1%, 5% or 10%, then we reject the null</span>
<span class="sd">    hypothesis of equal averages. Small p-values are associated with</span>
<span class="sd">    large t-statistics.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    http://en.wikipedia.org/wiki/T-test#Dependent_t-test</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; np.random.seed(12345678) # fix random seed to get same numbers</span>

<span class="sd">    &gt;&gt;&gt; rvs1 = stats.norm.rvs(loc=5,scale=10,size=500)</span>
<span class="sd">    &gt;&gt;&gt; rvs2 = (stats.norm.rvs(loc=5,scale=10,size=500) +</span>
<span class="sd">    ...         stats.norm.rvs(scale=0.2,size=500))</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_rel(rvs1,rvs2)</span>
<span class="sd">    (0.24101764965300962, 0.80964043445811562)</span>
<span class="sd">    &gt;&gt;&gt; rvs3 = (stats.norm.rvs(loc=8,scale=10,size=500) +</span>
<span class="sd">    ...         stats.norm.rvs(scale=0.2,size=500))</span>
<span class="sd">    &gt;&gt;&gt; stats.ttest_rel(rvs1,rvs3)</span>
<span class="sd">    (-3.9995108708727933, 7.3082402191726459e-005)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk2_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="c1"># check both a and b</span>
    <span class="n">contains_nan</span><span class="p">,</span> <span class="n">nan_policy</span> <span class="o">=</span> <span class="p">(</span><span class="n">_contains_nan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span> <span class="ow">or</span>
                                <span class="n">_contains_nan</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unequal length arrays&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">_ttest_finish</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Ttest_relResult</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<span class="n">KstestResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;KstestResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="kstest"><a class="viewcode-back" href="../../../generated/scipy.stats.kstest.html#scipy.stats.kstest">[docs]</a><span class="k">def</span> <span class="nf">kstest</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">cdf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;approx&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform the Kolmogorov-Smirnov test for goodness of fit.</span>

<span class="sd">    This performs a test of the distribution G(x) of an observed</span>
<span class="sd">    random variable against a given distribution F(x). Under the null</span>
<span class="sd">    hypothesis the two distributions are identical, G(x)=F(x). The</span>
<span class="sd">    alternative hypothesis can be either &#39;two-sided&#39; (default), &#39;less&#39;</span>
<span class="sd">    or &#39;greater&#39;. The KS test is only valid for continuous distributions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rvs : str, array or callable</span>
<span class="sd">        If a string, it should be the name of a distribution in `scipy.stats`.</span>
<span class="sd">        If an array, it should be a 1-D array of observations of random</span>
<span class="sd">        variables.</span>
<span class="sd">        If a callable, it should be a function to generate random variables;</span>
<span class="sd">        it is required to have a keyword argument `size`.</span>
<span class="sd">    cdf : str or callable</span>
<span class="sd">        If a string, it should be the name of a distribution in `scipy.stats`.</span>
<span class="sd">        If `rvs` is a string then `cdf` can be False or the same as `rvs`.</span>
<span class="sd">        If a callable, that callable is used to calculate the cdf.</span>
<span class="sd">    args : tuple, sequence, optional</span>
<span class="sd">        Distribution parameters, used if `rvs` or `cdf` are strings.</span>
<span class="sd">    N : int, optional</span>
<span class="sd">        Sample size if `rvs` is string or callable.  Default is 20.</span>
<span class="sd">    alternative : {&#39;two-sided&#39;, &#39;less&#39;,&#39;greater&#39;}, optional</span>
<span class="sd">        Defines the alternative hypothesis (see explanation above).</span>
<span class="sd">        Default is &#39;two-sided&#39;.</span>
<span class="sd">    mode : &#39;approx&#39; (default) or &#39;asymp&#39;, optional</span>
<span class="sd">        Defines the distribution used for calculating the p-value.</span>

<span class="sd">          - &#39;approx&#39; : use approximation to exact distribution of test statistic</span>
<span class="sd">          - &#39;asymp&#39; : use asymptotic distribution of test statistic</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        KS test statistic, either D, D+ or D-.</span>
<span class="sd">    pvalue :  float</span>
<span class="sd">        One-tailed or two-tailed p-value.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    In the one-sided test, the alternative is that the empirical</span>
<span class="sd">    cumulative distribution function of the random variable is &quot;less&quot;</span>
<span class="sd">    or &quot;greater&quot; than the cumulative distribution function F(x) of the</span>
<span class="sd">    hypothesis, ``G(x)&lt;=F(x)``, resp. ``G(x)&gt;=F(x)``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>

<span class="sd">    &gt;&gt;&gt; x = np.linspace(-15, 15, 9)</span>
<span class="sd">    &gt;&gt;&gt; stats.kstest(x, &#39;norm&#39;)</span>
<span class="sd">    (0.44435602715924361, 0.038850142705171065)</span>

<span class="sd">    &gt;&gt;&gt; np.random.seed(987654321) # set random seed to get the same result</span>
<span class="sd">    &gt;&gt;&gt; stats.kstest(&#39;norm&#39;, False, N=100)</span>
<span class="sd">    (0.058352892479417884, 0.88531190944151261)</span>

<span class="sd">    The above lines are equivalent to:</span>

<span class="sd">    &gt;&gt;&gt; np.random.seed(987654321)</span>
<span class="sd">    &gt;&gt;&gt; stats.kstest(stats.norm.rvs(size=100), &#39;norm&#39;)</span>
<span class="sd">    (0.058352892479417884, 0.88531190944151261)</span>

<span class="sd">    *Test against one-sided alternative hypothesis*</span>

<span class="sd">    Shift distribution to larger values, so that ``cdf_dgp(x) &lt; norm.cdf(x)``:</span>

<span class="sd">    &gt;&gt;&gt; np.random.seed(987654321)</span>
<span class="sd">    &gt;&gt;&gt; x = stats.norm.rvs(loc=0.2, size=100)</span>
<span class="sd">    &gt;&gt;&gt; stats.kstest(x,&#39;norm&#39;, alternative = &#39;less&#39;)</span>
<span class="sd">    (0.12464329735846891, 0.040989164077641749)</span>

<span class="sd">    Reject equal distribution against alternative hypothesis: less</span>

<span class="sd">    &gt;&gt;&gt; stats.kstest(x,&#39;norm&#39;, alternative = &#39;greater&#39;)</span>
<span class="sd">    (0.0072115233216311081, 0.98531158590396395)</span>

<span class="sd">    Don&#39;t reject equal distribution against alternative hypothesis: greater</span>

<span class="sd">    &gt;&gt;&gt; stats.kstest(x,&#39;norm&#39;, mode=&#39;asymp&#39;)</span>
<span class="sd">    (0.12464329735846891, 0.08944488871182088)</span>

<span class="sd">    *Testing t distributed random variables against normal distribution*</span>

<span class="sd">    With 100 degrees of freedom the t distribution looks close to the normal</span>
<span class="sd">    distribution, and the K-S test does not reject the hypothesis that the</span>
<span class="sd">    sample came from the normal distribution:</span>

<span class="sd">    &gt;&gt;&gt; np.random.seed(987654321)</span>
<span class="sd">    &gt;&gt;&gt; stats.kstest(stats.t.rvs(100,size=100),&#39;norm&#39;)</span>
<span class="sd">    (0.072018929165471257, 0.67630062862479168)</span>

<span class="sd">    With 3 degrees of freedom the t distribution looks sufficiently different</span>
<span class="sd">    from the normal distribution, that we can reject the hypothesis that the</span>
<span class="sd">    sample came from the normal distribution at the 10% level:</span>

<span class="sd">    &gt;&gt;&gt; np.random.seed(987654321)</span>
<span class="sd">    &gt;&gt;&gt; stats.kstest(stats.t.rvs(3,size=100),&#39;norm&#39;)</span>
<span class="sd">    (0.131016895759829, 0.058826222555312224)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">cdf</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cdf</span> <span class="o">==</span> <span class="n">rvs</span><span class="p">):</span>
            <span class="n">cdf</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">distributions</span><span class="p">,</span> <span class="n">rvs</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span>
            <span class="n">rvs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">distributions</span><span class="p">,</span> <span class="n">rvs</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;if rvs is string, cdf has to be the &quot;</span>
                                 <span class="s2">&quot;same distribution&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cdf</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
        <span class="n">cdf</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">distributions</span><span class="p">,</span> <span class="n">cdf</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">rvs</span><span class="p">):</span>
        <span class="n">kwds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">}</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">rvs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">cdfvals</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># to not break compatibility with existing code</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;two_sided&#39;</span><span class="p">:</span>
        <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span>

    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="s1">&#39;greater&#39;</span><span class="p">]:</span>
        <span class="n">Dplus</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">N</span> <span class="o">-</span> <span class="n">cdfvals</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;greater&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">KstestResult</span><span class="p">(</span><span class="n">Dplus</span><span class="p">,</span> <span class="n">distributions</span><span class="o">.</span><span class="n">ksone</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">Dplus</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="s1">&#39;less&#39;</span><span class="p">]:</span>
        <span class="n">Dmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">cdfvals</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;less&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">KstestResult</span><span class="p">(</span><span class="n">Dmin</span><span class="p">,</span> <span class="n">distributions</span><span class="o">.</span><span class="n">ksone</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">Dmin</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">:</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">Dplus</span><span class="p">,</span> <span class="n">Dmin</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;asymp&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">KstestResult</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">distributions</span><span class="o">.</span><span class="n">kstwobign</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;approx&#39;</span><span class="p">:</span>
            <span class="n">pval_two</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">kstwobign</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">N</span> <span class="o">&gt;</span> <span class="mi">2666</span> <span class="ow">or</span> <span class="n">pval_two</span> <span class="o">&gt;</span> <span class="mf">0.80</span> <span class="o">-</span> <span class="n">N</span><span class="o">*</span><span class="mf">0.3</span><span class="o">/</span><span class="mi">1000</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">KstestResult</span><span class="p">(</span><span class="n">D</span><span class="p">,</span>
                                    <span class="n">distributions</span><span class="o">.</span><span class="n">kstwobign</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">KstestResult</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">distributions</span><span class="o">.</span><span class="n">ksone</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span></div>


<span class="c1"># Map from names to lambda_ values used in power_divergence().</span>
<span class="n">_power_div_lambda_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;pearson&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;log-likelihood&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;freeman-tukey&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="s2">&quot;mod-log-likelihood&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;neyman&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;cressie-read&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_count</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Count the number of non-masked elements of an array.</span>

<span class="sd">    This function behaves like np.ma.count(), but is much faster</span>
<span class="sd">    for ndarrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">):</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">num</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># In some cases, the `count` method returns a scalar array (e.g.</span>
            <span class="c1"># np.array(3)), but we want a plain integer.</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">num</span>

<span class="n">Power_divergenceResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Power_divergenceResult&#39;</span><span class="p">,</span>
                                    <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="power_divergence"><a class="viewcode-back" href="../../../generated/scipy.stats.power_divergence.html#scipy.stats.power_divergence">[docs]</a><span class="k">def</span> <span class="nf">power_divergence</span><span class="p">(</span><span class="n">f_obs</span><span class="p">,</span> <span class="n">f_exp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cressie-Read power divergence statistic and goodness of fit test.</span>

<span class="sd">    This function tests the null hypothesis that the categorical data</span>
<span class="sd">    has the given frequencies, using the Cressie-Read power divergence</span>
<span class="sd">    statistic.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f_obs : array_like</span>
<span class="sd">        Observed frequencies in each category.</span>
<span class="sd">    f_exp : array_like, optional</span>
<span class="sd">        Expected frequencies in each category.  By default the categories are</span>
<span class="sd">        assumed to be equally likely.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        &quot;Delta degrees of freedom&quot;: adjustment to the degrees of freedom</span>
<span class="sd">        for the p-value.  The p-value is computed using a chi-squared</span>
<span class="sd">        distribution with ``k - 1 - ddof`` degrees of freedom, where `k`</span>
<span class="sd">        is the number of observed frequencies.  The default value of `ddof`</span>
<span class="sd">        is 0.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        The axis of the broadcast result of `f_obs` and `f_exp` along which to</span>
<span class="sd">        apply the test.  If axis is None, all values in `f_obs` are treated</span>
<span class="sd">        as a single data set.  Default is 0.</span>
<span class="sd">    lambda_ : float or str, optional</span>
<span class="sd">        `lambda_` gives the power in the Cressie-Read power divergence</span>
<span class="sd">        statistic.  The default is 1.  For convenience, `lambda_` may be</span>
<span class="sd">        assigned one of the following strings, in which case the</span>
<span class="sd">        corresponding numerical value is used::</span>

<span class="sd">            String              Value   Description</span>
<span class="sd">            &quot;pearson&quot;             1     Pearson&#39;s chi-squared statistic.</span>
<span class="sd">                                        In this case, the function is</span>
<span class="sd">                                        equivalent to `stats.chisquare`.</span>
<span class="sd">            &quot;log-likelihood&quot;      0     Log-likelihood ratio. Also known as</span>
<span class="sd">                                        the G-test [3]_.</span>
<span class="sd">            &quot;freeman-tukey&quot;      -1/2   Freeman-Tukey statistic.</span>
<span class="sd">            &quot;mod-log-likelihood&quot; -1     Modified log-likelihood ratio.</span>
<span class="sd">            &quot;neyman&quot;             -2     Neyman&#39;s statistic.</span>
<span class="sd">            &quot;cressie-read&quot;        2/3   The power recommended in [5]_.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float or ndarray</span>
<span class="sd">        The Cressie-Read power divergence test statistic.  The value is</span>
<span class="sd">        a float if `axis` is None or if` `f_obs` and `f_exp` are 1-D.</span>
<span class="sd">    pvalue : float or ndarray</span>
<span class="sd">        The p-value of the test.  The value is a float if `ddof` and the</span>
<span class="sd">        return value `stat` are scalars.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    chisquare</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This test is invalid when the observed or expected frequencies in each</span>
<span class="sd">    category are too small.  A typical rule is that all of the observed</span>
<span class="sd">    and expected frequencies should be at least 5.</span>

<span class="sd">    When `lambda_` is less than zero, the formula for the statistic involves</span>
<span class="sd">    dividing by `f_obs`, so a warning or error may be generated if any value</span>
<span class="sd">    in `f_obs` is 0.</span>

<span class="sd">    Similarly, a warning or error may be generated if any value in `f_exp` is</span>
<span class="sd">    zero when `lambda_` &gt;= 0.</span>

<span class="sd">    The default degrees of freedom, k-1, are for the case when no parameters</span>
<span class="sd">    of the distribution are estimated. If p parameters are estimated by</span>
<span class="sd">    efficient maximum likelihood then the correct degrees of freedom are</span>
<span class="sd">    k-1-p. If the parameters are estimated in a different way, then the</span>
<span class="sd">    dof can be between k-1-p and k-1. However, it is also possible that</span>
<span class="sd">    the asymptotic distribution is not a chisquare, in which case this</span>
<span class="sd">    test is not appropriate.</span>

<span class="sd">    This function handles masked arrays.  If an element of `f_obs` or `f_exp`</span>
<span class="sd">    is masked, then data at that position is ignored, and does not count</span>
<span class="sd">    towards the size of the data set.</span>

<span class="sd">    .. versionadded:: 0.13.0</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Lowry, Richard.  &quot;Concepts and Applications of Inferential</span>
<span class="sd">           Statistics&quot;. Chapter 8. http://faculty.vassar.edu/lowry/ch8pt1.html</span>
<span class="sd">    .. [2] &quot;Chi-squared test&quot;, http://en.wikipedia.org/wiki/Chi-squared_test</span>
<span class="sd">    .. [3] &quot;G-test&quot;, http://en.wikipedia.org/wiki/G-test</span>
<span class="sd">    .. [4] Sokal, R. R. and Rohlf, F. J. &quot;Biometry: the principles and</span>
<span class="sd">           practice of statistics in biological research&quot;, New York: Freeman</span>
<span class="sd">           (1981)</span>
<span class="sd">    .. [5] Cressie, N. and Read, T. R. C., &quot;Multinomial Goodness-of-Fit</span>
<span class="sd">           Tests&quot;, J. Royal Stat. Soc. Series B, Vol. 46, No. 3 (1984),</span>
<span class="sd">           pp. 440-464.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    (See `chisquare` for more examples.)</span>

<span class="sd">    When just `f_obs` is given, it is assumed that the expected frequencies</span>
<span class="sd">    are uniform and given by the mean of the observed frequencies.  Here we</span>
<span class="sd">    perform a G-test (i.e. use the log-likelihood ratio statistic):</span>

<span class="sd">    &gt;&gt;&gt; from scipy.stats import power_divergence</span>
<span class="sd">    &gt;&gt;&gt; power_divergence([16, 18, 16, 14, 12, 12], lambda_=&#39;log-likelihood&#39;)</span>
<span class="sd">    (2.006573162632538, 0.84823476779463769)</span>

<span class="sd">    The expected frequencies can be given with the `f_exp` argument:</span>

<span class="sd">    &gt;&gt;&gt; power_divergence([16, 18, 16, 14, 12, 12],</span>
<span class="sd">    ...                  f_exp=[16, 16, 16, 16, 16, 8],</span>
<span class="sd">    ...                  lambda_=&#39;log-likelihood&#39;)</span>
<span class="sd">    (3.3281031458963746, 0.6495419288047497)</span>

<span class="sd">    When `f_obs` is 2-D, by default the test is applied to each column.</span>

<span class="sd">    &gt;&gt;&gt; obs = np.array([[16, 18, 16, 14, 12, 12], [32, 24, 16, 28, 20, 24]]).T</span>
<span class="sd">    &gt;&gt;&gt; obs.shape</span>
<span class="sd">    (6, 2)</span>
<span class="sd">    &gt;&gt;&gt; power_divergence(obs, lambda_=&quot;log-likelihood&quot;)</span>
<span class="sd">    (array([ 2.00657316,  6.77634498]), array([ 0.84823477,  0.23781225]))</span>

<span class="sd">    By setting ``axis=None``, the test is applied to all data in the array,</span>
<span class="sd">    which is equivalent to applying the test to the flattened array.</span>

<span class="sd">    &gt;&gt;&gt; power_divergence(obs, axis=None)</span>
<span class="sd">    (23.31034482758621, 0.015975692534127565)</span>
<span class="sd">    &gt;&gt;&gt; power_divergence(obs.ravel())</span>
<span class="sd">    (23.31034482758621, 0.015975692534127565)</span>

<span class="sd">    `ddof` is the change to make to the default degrees of freedom.</span>

<span class="sd">    &gt;&gt;&gt; power_divergence([16, 18, 16, 14, 12, 12], ddof=1)</span>
<span class="sd">    (2.0, 0.73575888234288467)</span>

<span class="sd">    The calculation of the p-values is done by broadcasting the</span>
<span class="sd">    test statistic with `ddof`.</span>

<span class="sd">    &gt;&gt;&gt; power_divergence([16, 18, 16, 14, 12, 12], ddof=[0,1,2])</span>
<span class="sd">    (2.0, array([ 0.84914504,  0.73575888,  0.5724067 ]))</span>

<span class="sd">    `f_obs` and `f_exp` are also broadcast.  In the following, `f_obs` has</span>
<span class="sd">    shape (6,) and `f_exp` has shape (2, 6), so the result of broadcasting</span>
<span class="sd">    `f_obs` and `f_exp` has shape (2, 6).  To compute the desired chi-squared</span>
<span class="sd">    statistics, we must use ``axis=1``:</span>

<span class="sd">    &gt;&gt;&gt; power_divergence([16, 18, 16, 14, 12, 12],</span>
<span class="sd">    ...                  f_exp=[[16, 16, 16, 16, 16, 8],</span>
<span class="sd">    ...                         [8, 20, 20, 16, 12, 12]],</span>
<span class="sd">    ...                  axis=1)</span>
<span class="sd">    (array([ 3.5 ,  9.25]), array([ 0.62338763,  0.09949846]))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert the input argument `lambda_` to a numerical value.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lambda_</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lambda_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_power_div_lambda_names</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">_power_div_lambda_names</span><span class="o">.</span><span class="n">keys</span><span class="p">()))[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid string for lambda_: {0!r}.  Valid strings &quot;</span>
                             <span class="s2">&quot;are {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lambda_</span><span class="p">,</span> <span class="n">names</span><span class="p">))</span>
        <span class="n">lambda_</span> <span class="o">=</span> <span class="n">_power_div_lambda_names</span><span class="p">[</span><span class="n">lambda_</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">lambda_</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">lambda_</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">f_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">f_obs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">f_exp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">f_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">f_exp</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Compute the equivalent of</span>
        <span class="c1">#   f_exp = f_obs.mean(axis=axis, keepdims=True)</span>
        <span class="c1"># Older versions of numpy do not have the &#39;keepdims&#39; argument, so</span>
        <span class="c1"># we have to do a little work to achieve the same result.</span>
        <span class="c1"># Ignore &#39;invalid&#39; errors so the edge case of a data set with length 0</span>
        <span class="c1"># is handled without spurious warnings.</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="n">f_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">f_obs</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">reduced_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f_obs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">reduced_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">f_exp</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">reduced_shape</span>

    <span class="c1"># `terms` is the array of terms that are summed along `axis` to create</span>
    <span class="c1"># the test statistic.  We use some specialized code for a few special</span>
    <span class="c1"># cases of lambda_.</span>
    <span class="k">if</span> <span class="n">lambda_</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Pearson&#39;s chi-squared statistic</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_obs</span> <span class="o">-</span> <span class="n">f_exp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">f_exp</span>
    <span class="k">elif</span> <span class="n">lambda_</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Log-likelihood ratio (i.e. G-test)</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">f_obs</span><span class="p">,</span> <span class="n">f_obs</span> <span class="o">/</span> <span class="n">f_exp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">lambda_</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Modified log-likelihood ratio</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">f_exp</span><span class="p">,</span> <span class="n">f_exp</span> <span class="o">/</span> <span class="n">f_obs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># General Cressie-Read power divergence.</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">f_obs</span> <span class="o">*</span> <span class="p">((</span><span class="n">f_obs</span> <span class="o">/</span> <span class="n">f_exp</span><span class="p">)</span><span class="o">**</span><span class="n">lambda_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">terms</span> <span class="o">/=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">stat</span> <span class="o">=</span> <span class="n">terms</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="n">num_obs</span> <span class="o">=</span> <span class="n">_count</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">ddof</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">ddof</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">num_obs</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ddof</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Power_divergenceResult</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>


<div class="viewcode-block" id="chisquare"><a class="viewcode-back" href="../../../generated/scipy.stats.mstats.chisquare.html#scipy.stats.chisquare">[docs]</a><span class="k">def</span> <span class="nf">chisquare</span><span class="p">(</span><span class="n">f_obs</span><span class="p">,</span> <span class="n">f_exp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates a one-way chi square test.</span>

<span class="sd">    The chi square test tests the null hypothesis that the categorical data</span>
<span class="sd">    has the given frequencies.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f_obs : array_like</span>
<span class="sd">        Observed frequencies in each category.</span>
<span class="sd">    f_exp : array_like, optional</span>
<span class="sd">        Expected frequencies in each category.  By default the categories are</span>
<span class="sd">        assumed to be equally likely.</span>
<span class="sd">    ddof : int, optional</span>
<span class="sd">        &quot;Delta degrees of freedom&quot;: adjustment to the degrees of freedom</span>
<span class="sd">        for the p-value.  The p-value is computed using a chi-squared</span>
<span class="sd">        distribution with ``k - 1 - ddof`` degrees of freedom, where `k`</span>
<span class="sd">        is the number of observed frequencies.  The default value of `ddof`</span>
<span class="sd">        is 0.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        The axis of the broadcast result of `f_obs` and `f_exp` along which to</span>
<span class="sd">        apply the test.  If axis is None, all values in `f_obs` are treated</span>
<span class="sd">        as a single data set.  Default is 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chisq : float or ndarray</span>
<span class="sd">        The chi-squared test statistic.  The value is a float if `axis` is</span>
<span class="sd">        None or `f_obs` and `f_exp` are 1-D.</span>
<span class="sd">    p : float or ndarray</span>
<span class="sd">        The p-value of the test.  The value is a float if `ddof` and the</span>
<span class="sd">        return value `chisq` are scalars.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    power_divergence</span>
<span class="sd">    mstats.chisquare</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This test is invalid when the observed or expected frequencies in each</span>
<span class="sd">    category are too small.  A typical rule is that all of the observed</span>
<span class="sd">    and expected frequencies should be at least 5.</span>

<span class="sd">    The default degrees of freedom, k-1, are for the case when no parameters</span>
<span class="sd">    of the distribution are estimated. If p parameters are estimated by</span>
<span class="sd">    efficient maximum likelihood then the correct degrees of freedom are</span>
<span class="sd">    k-1-p. If the parameters are estimated in a different way, then the</span>
<span class="sd">    dof can be between k-1-p and k-1. However, it is also possible that</span>
<span class="sd">    the asymptotic distribution is not a chisquare, in which case this</span>
<span class="sd">    test is not appropriate.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Lowry, Richard.  &quot;Concepts and Applications of Inferential</span>
<span class="sd">           Statistics&quot;. Chapter 8. http://faculty.vassar.edu/lowry/ch8pt1.html</span>
<span class="sd">    .. [2] &quot;Chi-squared test&quot;, http://en.wikipedia.org/wiki/Chi-squared_test</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    When just `f_obs` is given, it is assumed that the expected frequencies</span>
<span class="sd">    are uniform and given by the mean of the observed frequencies.</span>

<span class="sd">    &gt;&gt;&gt; from scipy.stats import chisquare</span>
<span class="sd">    &gt;&gt;&gt; chisquare([16, 18, 16, 14, 12, 12])</span>
<span class="sd">    (2.0, 0.84914503608460956)</span>

<span class="sd">    With `f_exp` the expected frequencies can be given.</span>

<span class="sd">    &gt;&gt;&gt; chisquare([16, 18, 16, 14, 12, 12], f_exp=[16, 16, 16, 16, 16, 8])</span>
<span class="sd">    (3.5, 0.62338762774958223)</span>

<span class="sd">    When `f_obs` is 2-D, by default the test is applied to each column.</span>

<span class="sd">    &gt;&gt;&gt; obs = np.array([[16, 18, 16, 14, 12, 12], [32, 24, 16, 28, 20, 24]]).T</span>
<span class="sd">    &gt;&gt;&gt; obs.shape</span>
<span class="sd">    (6, 2)</span>
<span class="sd">    &gt;&gt;&gt; chisquare(obs)</span>
<span class="sd">    (array([ 2.        ,  6.66666667]), array([ 0.84914504,  0.24663415]))</span>

<span class="sd">    By setting ``axis=None``, the test is applied to all data in the array,</span>
<span class="sd">    which is equivalent to applying the test to the flattened array.</span>

<span class="sd">    &gt;&gt;&gt; chisquare(obs, axis=None)</span>
<span class="sd">    (23.31034482758621, 0.015975692534127565)</span>
<span class="sd">    &gt;&gt;&gt; chisquare(obs.ravel())</span>
<span class="sd">    (23.31034482758621, 0.015975692534127565)</span>

<span class="sd">    `ddof` is the change to make to the default degrees of freedom.</span>

<span class="sd">    &gt;&gt;&gt; chisquare([16, 18, 16, 14, 12, 12], ddof=1)</span>
<span class="sd">    (2.0, 0.73575888234288467)</span>

<span class="sd">    The calculation of the p-values is done by broadcasting the</span>
<span class="sd">    chi-squared statistic with `ddof`.</span>

<span class="sd">    &gt;&gt;&gt; chisquare([16, 18, 16, 14, 12, 12], ddof=[0,1,2])</span>
<span class="sd">    (2.0, array([ 0.84914504,  0.73575888,  0.5724067 ]))</span>

<span class="sd">    `f_obs` and `f_exp` are also broadcast.  In the following, `f_obs` has</span>
<span class="sd">    shape (6,) and `f_exp` has shape (2, 6), so the result of broadcasting</span>
<span class="sd">    `f_obs` and `f_exp` has shape (2, 6).  To compute the desired chi-squared</span>
<span class="sd">    statistics, we use ``axis=1``:</span>

<span class="sd">    &gt;&gt;&gt; chisquare([16, 18, 16, 14, 12, 12],</span>
<span class="sd">    ...           f_exp=[[16, 16, 16, 16, 16, 8], [8, 20, 20, 16, 12, 12]],</span>
<span class="sd">    ...           axis=1)</span>
<span class="sd">    (array([ 3.5 ,  9.25]), array([ 0.62338763,  0.09949846]))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">power_divergence</span><span class="p">(</span><span class="n">f_obs</span><span class="p">,</span> <span class="n">f_exp</span><span class="o">=</span><span class="n">f_exp</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                            <span class="n">lambda_</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">)</span></div>

<span class="n">Ks_2sampResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Ks_2sampResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="ks_2samp"><a class="viewcode-back" href="../../../generated/scipy.stats.ks_2samp.html#scipy.stats.ks_2samp">[docs]</a><span class="k">def</span> <span class="nf">ks_2samp</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the Kolmogorov-Smirnov statistic on 2 samples.</span>

<span class="sd">    This is a two-sided test for the null hypothesis that 2 independent samples</span>
<span class="sd">    are drawn from the same continuous distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data1, data2 : sequence of 1-D ndarrays</span>
<span class="sd">        two arrays of sample observations assumed to be drawn from a continuous</span>
<span class="sd">        distribution, sample sizes can be different</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        KS statistic</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        two-tailed p-value</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This tests whether 2 samples are drawn from the same distribution. Note</span>
<span class="sd">    that, like in the case of the one-sample K-S test, the distribution is</span>
<span class="sd">    assumed to be continuous.</span>

<span class="sd">    This is the two-sided test, one-sided tests are not implemented.</span>
<span class="sd">    The test uses the two-sided asymptotic Kolmogorov-Smirnov distribution.</span>

<span class="sd">    If the K-S statistic is small or the p-value is high, then we cannot</span>
<span class="sd">    reject the hypothesis that the distributions of the two samples</span>
<span class="sd">    are the same.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; np.random.seed(12345678)  #fix random seed to get the same result</span>
<span class="sd">    &gt;&gt;&gt; n1 = 200  # size of first sample</span>
<span class="sd">    &gt;&gt;&gt; n2 = 300  # size of second sample</span>

<span class="sd">    For a different distribution, we can reject the null hypothesis since the</span>
<span class="sd">    pvalue is below 1%:</span>

<span class="sd">    &gt;&gt;&gt; rvs1 = stats.norm.rvs(size=n1, loc=0., scale=1)</span>
<span class="sd">    &gt;&gt;&gt; rvs2 = stats.norm.rvs(size=n2, loc=0.5, scale=1.5)</span>
<span class="sd">    &gt;&gt;&gt; stats.ks_2samp(rvs1, rvs2)</span>
<span class="sd">    (0.20833333333333337, 4.6674975515806989e-005)</span>

<span class="sd">    For a slightly different distribution, we cannot reject the null hypothesis</span>
<span class="sd">    at a 10% or lower alpha since the p-value at 0.144 is higher than 10%</span>

<span class="sd">    &gt;&gt;&gt; rvs3 = stats.norm.rvs(size=n2, loc=0.01, scale=1.0)</span>
<span class="sd">    &gt;&gt;&gt; stats.ks_2samp(rvs1, rvs3)</span>
<span class="sd">    (0.10333333333333333, 0.14498781825751686)</span>

<span class="sd">    For an identical distribution, we cannot reject the null hypothesis since</span>
<span class="sd">    the p-value is high, 41%:</span>

<span class="sd">    &gt;&gt;&gt; rvs4 = stats.norm.rvs(size=n2, loc=0.0, scale=1.0)</span>
<span class="sd">    &gt;&gt;&gt; stats.ks_2samp(rvs1, rvs4)</span>
<span class="sd">    (0.07999999999999996, 0.41126949729859719)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
    <span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">data_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">])</span>
    <span class="n">cdf1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data_all</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">n1</span><span class="p">)</span>
    <span class="n">cdf2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">data_all</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">cdf1</span> <span class="o">-</span> <span class="n">cdf2</span><span class="p">))</span>
    <span class="c1"># Note: d absolute not signed distance</span>
    <span class="n">en</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span> <span class="o">*</span> <span class="n">n2</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">kstwobign</span><span class="o">.</span><span class="n">sf</span><span class="p">((</span><span class="n">en</span> <span class="o">+</span> <span class="mf">0.12</span> <span class="o">+</span> <span class="mf">0.11</span> <span class="o">/</span> <span class="n">en</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">Ks_2sampResult</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<span class="n">MannwhitneyuResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;MannwhitneyuResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="mannwhitneyu"><a class="viewcode-back" href="../../../generated/scipy.stats.mannwhitneyu.html#scipy.stats.mannwhitneyu">[docs]</a><span class="k">def</span> <span class="nf">mannwhitneyu</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">use_continuity</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the Mann-Whitney rank test on samples x and y.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x, y : array_like</span>
<span class="sd">        Array of samples, should be one-dimensional.</span>
<span class="sd">    use_continuity : bool, optional</span>
<span class="sd">            Whether a continuity correction (1/2.) should be taken into</span>
<span class="sd">            account. Default is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        The Mann-Whitney statistics.</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        One-sided p-value assuming a asymptotic normal distribution.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Use only when the number of observation in each sample is &gt; 20 and</span>
<span class="sd">    you have 2 independent samples of ranks. Mann-Whitney U is</span>
<span class="sd">    significant if the u-obtained is LESS THAN or equal to the critical</span>
<span class="sd">    value of U.</span>

<span class="sd">    This test corrects for ties and by default uses a continuity correction.</span>
<span class="sd">    The reported p-value is for a one-sided hypothesis, to get the two-sided</span>
<span class="sd">    p-value multiply the returned p-value by 2.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ranked</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
    <span class="n">rankx</span> <span class="o">=</span> <span class="n">ranked</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n1</span><span class="p">]</span>  <span class="c1"># get the x-ranks</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2</span> <span class="o">+</span> <span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rankx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># calc U for x</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2</span> <span class="o">-</span> <span class="n">u1</span>  <span class="c1"># remainder is U for y</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">tiecorrect</span><span class="p">(</span><span class="n">ranked</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">T</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All numbers are identical in amannwhitneyu&#39;</span><span class="p">)</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">n2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">)</span>

    <span class="n">fact2</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">meanrank</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">use_continuity</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;less&#39;</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">u1</span> <span class="o">-</span> <span class="n">meanrank</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;greater&#39;</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">u2</span> <span class="o">-</span> <span class="n">meanrank</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">:</span>
        <span class="n">bigu</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bigu</span> <span class="o">-</span> <span class="n">meanrank</span><span class="p">)</span>
        <span class="n">fact2</span> <span class="o">=</span> <span class="mf">2.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;alternative should be &#39;less&#39;, &#39;greater&#39;&quot;</span>
                         <span class="s2">&quot;or &#39;two-sided&#39;&quot;</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="n">sd</span>

    <span class="k">return</span> <span class="n">MannwhitneyuResult</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span> <span class="n">distributions</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">fact2</span><span class="p">)</span></div>

<span class="n">RanksumsResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;RanksumsResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="ranksums"><a class="viewcode-back" href="../../../generated/scipy.stats.ranksums.html#scipy.stats.ranksums">[docs]</a><span class="k">def</span> <span class="nf">ranksums</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the Wilcoxon rank-sum statistic for two samples.</span>

<span class="sd">    The Wilcoxon rank-sum test tests the null hypothesis that two sets</span>
<span class="sd">    of measurements are drawn from the same distribution.  The alternative</span>
<span class="sd">    hypothesis is that values in one sample are more likely to be</span>
<span class="sd">    larger than the values in the other sample.</span>

<span class="sd">    This test should be used to compare two samples from continuous</span>
<span class="sd">    distributions.  It does not handle ties between measurements</span>
<span class="sd">    in x and y.  For tie-handling and an optional continuity correction</span>
<span class="sd">    see `scipy.stats.mannwhitneyu`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x,y : array_like</span>
<span class="sd">        The data from the two samples</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        The test statistic under the large-sample approximation that the</span>
<span class="sd">        rank sum statistic is normally distributed</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        The two-sided p-value of the test</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Wilcoxon_rank-sum_test</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">alldata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">ranked</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">alldata</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">ranked</span><span class="p">[:</span><span class="n">n1</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">*</span> <span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">12.0</span><span class="p">)</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">distributions</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">RanksumsResult</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<span class="n">KruskalResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;KruskalResult&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="kruskal"><a class="viewcode-back" href="../../../generated/scipy.stats.kruskal.html#scipy.stats.kruskal">[docs]</a><span class="k">def</span> <span class="nf">kruskal</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the Kruskal-Wallis H-test for independent samples</span>

<span class="sd">    The Kruskal-Wallis H-test tests the null hypothesis that the population</span>
<span class="sd">    median of all of the groups are equal.  It is a non-parametric version of</span>
<span class="sd">    ANOVA.  The test works on 2 or more independent samples, which may have</span>
<span class="sd">    different sizes.  Note that rejecting the null hypothesis does not</span>
<span class="sd">    indicate which of the groups differs.  Post-hoc comparisons between</span>
<span class="sd">    groups are required to determine which groups are different.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sample1, sample2, ... : array_like</span>
<span class="sd">       Two or more arrays with the sample measurements can be given as</span>
<span class="sd">       arguments.</span>
<span class="sd">    nan_policy : {&#39;propagate&#39;, &#39;raise&#39;, &#39;omit&#39;}, optional</span>
<span class="sd">        Defines how to handle when input contains nan. &#39;propagate&#39; returns nan,</span>
<span class="sd">        &#39;raise&#39; throws an error, &#39;omit&#39; performs the calculations ignoring nan</span>
<span class="sd">        values. Default is &#39;propagate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">       The Kruskal-Wallis H statistic, corrected for ties</span>
<span class="sd">    pvalue : float</span>
<span class="sd">       The p-value for the test using the assumption that H has a chi</span>
<span class="sd">       square distribution</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    f_oneway : 1-way ANOVA</span>
<span class="sd">    mannwhitneyu : Mann-Whitney rank test on two samples.</span>
<span class="sd">    friedmanchisquare : Friedman test for repeated measurements</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Due to the assumption that H has a chi square distribution, the number</span>
<span class="sd">    of samples in each group must not be too small.  A typical rule is</span>
<span class="sd">    that each sample must have at least 5 measurements.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] W. H. Kruskal &amp; W. W. Wallis, &quot;Use of Ranks in</span>
<span class="sd">       One-Criterion Variance Analysis&quot;, Journal of the American Statistical</span>
<span class="sd">       Association, Vol. 47, Issue 260, pp. 583-621, 1952.</span>
<span class="sd">    .. [2] http://en.wikipedia.org/wiki/Kruskal-Wallis_one-way_analysis_of_variance</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; x = [1, 3, 5, 7, 9]</span>
<span class="sd">    &gt;&gt;&gt; y = [2, 4, 6, 8, 10]</span>
<span class="sd">    &gt;&gt;&gt; stats.kruskal(x, y)</span>
<span class="sd">    KruskalResult(statistic=0.27272727272727337, pvalue=0.60150813444058948)</span>

<span class="sd">    &gt;&gt;&gt; x = [1, 1, 1]</span>
<span class="sd">    &gt;&gt;&gt; y = [2, 2, 2]</span>
<span class="sd">    &gt;&gt;&gt; z = [2, 2]</span>
<span class="sd">    &gt;&gt;&gt; stats.kruskal(x, y, z)</span>
<span class="sd">    KruskalResult(statistic=7.0, pvalue=0.030197383422318501)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
    <span class="n">num_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_groups</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least two groups in stats.kruskal()&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">KruskalResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">args</span><span class="p">)))</span>

    <span class="k">if</span> <span class="s1">&#39;nan_policy&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;nan_policy&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;propagate&#39;</span><span class="p">,</span> <span class="s1">&#39;raise&#39;</span><span class="p">,</span> <span class="s1">&#39;omit&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nan_policy must be &#39;propagate&#39;, &quot;</span>
                             <span class="s2">&quot;&#39;raise&#39; or&#39;omit&#39;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nan_policy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;nan_policy&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nan_policy</span> <span class="o">=</span> <span class="s1">&#39;propagate&#39;</span>

    <span class="n">contains_nan</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">cn</span> <span class="o">=</span> <span class="n">_contains_nan</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">nan_policy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cn</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">contains_nan</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;omit&#39;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mstats_basic</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains_nan</span> <span class="ow">and</span> <span class="n">nan_policy</span> <span class="o">==</span> <span class="s1">&#39;propagate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">KruskalResult</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">alldata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">ranked</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">alldata</span><span class="p">)</span>
    <span class="n">ties</span> <span class="o">=</span> <span class="n">tiecorrect</span><span class="p">(</span><span class="n">ranked</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ties</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All numbers are identical in kruskal&#39;</span><span class="p">)</span>

    <span class="c1"># Compute sum^2/n for each group and sum</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ssbn</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_groups</span><span class="p">):</span>
        <span class="n">ssbn</span> <span class="o">+=</span> <span class="n">_square_of_sums</span><span class="p">(</span><span class="n">ranked</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">j</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">totaln</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">12.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">totaln</span> <span class="o">*</span> <span class="p">(</span><span class="n">totaln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">ssbn</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">totaln</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">num_groups</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">h</span> <span class="o">/=</span> <span class="n">ties</span>

    <span class="k">return</span> <span class="n">KruskalResult</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">distributions</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">df</span><span class="p">))</span></div>


<span class="n">FriedmanchisquareResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;FriedmanchisquareResult&#39;</span><span class="p">,</span>
                                     <span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="friedmanchisquare"><a class="viewcode-back" href="../../../generated/scipy.stats.friedmanchisquare.html#scipy.stats.friedmanchisquare">[docs]</a><span class="k">def</span> <span class="nf">friedmanchisquare</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the Friedman test for repeated measurements</span>

<span class="sd">    The Friedman test tests the null hypothesis that repeated measurements of</span>
<span class="sd">    the same individuals have the same distribution.  It is often used</span>
<span class="sd">    to test for consistency among measurements obtained in different ways.</span>
<span class="sd">    For example, if two measurement techniques are used on the same set of</span>
<span class="sd">    individuals, the Friedman test can be used to determine if the two</span>
<span class="sd">    measurement techniques are consistent.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    measurements1, measurements2, measurements3... : array_like</span>
<span class="sd">        Arrays of measurements.  All of the arrays must have the same number</span>
<span class="sd">        of elements.  At least 3 sets of measurements must be given.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic : float</span>
<span class="sd">        the test statistic, correcting for ties</span>
<span class="sd">    pvalue : float</span>
<span class="sd">        the associated p-value assuming that the test statistic has a chi</span>
<span class="sd">        squared distribution</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Due to the assumption that the test statistic has a chi squared</span>
<span class="sd">    distribution, the p-value is only reliable for n &gt; 10 and more than</span>
<span class="sd">    6 repeated measurements.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Friedman_test</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Less than 3 levels.  Friedman test not appropriate.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unequal N in friedmanchisquare.  Aborting.&#39;</span><span class="p">)</span>

    <span class="c1"># Rank data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># Handle ties</span>
    <span class="n">ties</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">replist</span><span class="p">,</span> <span class="n">repnum</span> <span class="o">=</span> <span class="n">find_repeats</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">repnum</span><span class="p">:</span>
            <span class="n">ties</span> <span class="o">+=</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ties</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>

    <span class="n">ssbn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">chisq</span> <span class="o">=</span> <span class="p">(</span><span class="mf">12.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">ssbn</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">FriedmanchisquareResult</span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">distributions</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span></div>


<div class="viewcode-block" id="combine_pvalues"><a class="viewcode-back" href="../../../generated/scipy.stats.combine_pvalues.html#scipy.stats.combine_pvalues">[docs]</a><span class="k">def</span> <span class="nf">combine_pvalues</span><span class="p">(</span><span class="n">pvalues</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fisher&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Methods for combining the p-values of independent tests bearing upon the</span>
<span class="sd">    same hypothesis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pvalues : array_like, 1-D</span>
<span class="sd">        Array of p-values assumed to come from independent tests.</span>
<span class="sd">    method : {&#39;fisher&#39;, &#39;stouffer&#39;}, optional</span>
<span class="sd">        Name of method to use to combine p-values. The following methods are</span>
<span class="sd">        available:</span>

<span class="sd">        - &quot;fisher&quot;: Fisher&#39;s method (Fisher&#39;s combined probability test),</span>
<span class="sd">          the default.</span>
<span class="sd">        - &quot;stouffer&quot;: Stouffer&#39;s Z-score method.</span>
<span class="sd">    weights : array_like, 1-D, optional</span>
<span class="sd">        Optional array of weights used only for Stouffer&#39;s Z-score method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    statistic: float</span>
<span class="sd">        The statistic calculated by the specified method:</span>
<span class="sd">        - &quot;fisher&quot;: The chi-squared statistic</span>
<span class="sd">        - &quot;stouffer&quot;: The Z-score</span>
<span class="sd">    pval: float</span>
<span class="sd">        The combined p-value.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Fisher&#39;s method (also known as Fisher&#39;s combined probability test) [1]_ uses</span>
<span class="sd">    a chi-squared statistic to compute a combined p-value. The closely related</span>
<span class="sd">    Stouffer&#39;s Z-score method [2]_ uses Z-scores rather than p-values. The</span>
<span class="sd">    advantage of Stouffer&#39;s method is that it is straightforward to introduce</span>
<span class="sd">    weights, which can make Stouffer&#39;s method more powerful than Fisher&#39;s</span>
<span class="sd">    method when the p-values are from studies of different size [3]_ [4]_.</span>

<span class="sd">    Fisher&#39;s method may be extended to combine p-values from dependent tests</span>
<span class="sd">    [5]_. Extensions such as Brown&#39;s method and Kost&#39;s method are not currently</span>
<span class="sd">    implemented.</span>

<span class="sd">    .. versionadded:: 0.15.0</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Fisher%27s_method</span>
<span class="sd">    .. [2] http://en.wikipedia.org/wiki/Fisher&#39;s_method#Relation_to_Stouffer.27s_Z-score_method</span>
<span class="sd">    .. [3] Whitlock, M. C. &quot;Combining probability from independent tests: the</span>
<span class="sd">           weighted Z-method is superior to Fisher&#39;s approach.&quot; Journal of</span>
<span class="sd">           Evolutionary Biology 18, no. 5 (2005): 1368-1373.</span>
<span class="sd">    .. [4] Zaykin, Dmitri V. &quot;Optimally weighted Z-test is a powerful method</span>
<span class="sd">           for combining probabilities in meta-analysis.&quot; Journal of</span>
<span class="sd">           Evolutionary Biology 24, no. 8 (2011): 1836-1841.</span>
<span class="sd">    .. [5] https://en.wikipedia.org/wiki/Extensions_of_Fisher%27s_method</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pvalues</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pvalues</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;pvalues is not 1-D&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;fisher&#39;</span><span class="p">:</span>
        <span class="n">Xsq</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pvalues</span><span class="p">))</span>
        <span class="n">pval</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">Xsq</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pvalues</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Xsq</span><span class="p">,</span> <span class="n">pval</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;stouffer&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">pvalues</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pvalues</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;pvalues and weights must be of the same size.&quot;</span><span class="p">)</span>

        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weights</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;weights is not 1-D&quot;</span><span class="p">)</span>

        <span class="n">Zi</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">pvalues</span><span class="p">)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">Zi</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">pval</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">pval</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid method &#39;</span><span class="si">%s</span><span class="s2">&#39;. Options are &#39;fisher&#39; or &#39;stouffer&#39;&quot;</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span></div>

<span class="c1">#####################################</span>
<span class="c1">#      PROBABILITY CALCULATIONS     #</span>
<span class="c1">#####################################</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;stats.chisqprob is deprecated in scipy 0.17.0; &quot;</span>
              <span class="s2">&quot;use stats.distributions.chi2.sf instead.&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">chisqprob</span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Probability value (1-tail) for the Chi^2 probability distribution.</span>

<span class="sd">    Broadcasting rules apply.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    chisq : array_like or float &gt; 0</span>

<span class="sd">    df : array_like or float, probably int &gt;= 1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chisqprob : ndarray</span>
<span class="sd">        The area from `chisq` to infinity under the Chi^2 probability</span>
<span class="sd">        distribution with degrees of freedom `df`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">distributions</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;stats.betai is deprecated in scipy 0.17.0; &quot;</span>
              <span class="s2">&quot;use special.betainc instead&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">betai</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the incomplete beta function.</span>

<span class="sd">    I_x(a,b) = 1/B(a,b)*(Integral(0,x) of t^(a-1)(1-t)^(b-1) dt)</span>

<span class="sd">    where a,b&gt;0 and B(a,b) = G(a)*G(b)/(G(a+b)) where G(a) is the gamma</span>
<span class="sd">    function of a.</span>

<span class="sd">    The standard broadcasting rules apply to a, b, and x.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like or float &gt; 0</span>

<span class="sd">    b : array_like or float &gt; 0</span>

<span class="sd">    x : array_like or float</span>
<span class="sd">        x will be clipped to be no greater than 1.0 .</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    betai : ndarray</span>
<span class="sd">        Incomplete beta function.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_betai</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_betai</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># if x &gt; 1 then return 1.0</span>
    <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">betainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>


<span class="c1">#####################################</span>
<span class="c1">#         ANOVA CALCULATIONS        #</span>
<span class="c1">#####################################</span>

<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;stats.f_value_wilks_lambda deprecated in scipy 0.17.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f_value_wilks_lambda</span><span class="p">(</span><span class="n">ER</span><span class="p">,</span> <span class="n">EF</span><span class="p">,</span> <span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculation of Wilks lambda F-statistic for multivarite data, per</span>
<span class="sd">    Maxwell &amp; Delaney p.657.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ER</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">ER</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="n">ER</span><span class="p">]])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">EF</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">EF</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="n">EF</span><span class="p">]])</span>
    <span class="n">lmbda</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">EF</span><span class="p">)</span> <span class="o">/</span> <span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">ER</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">n_um</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lmbda</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">q</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">d_en</span> <span class="o">=</span> <span class="n">lmbda</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_um</span><span class="o">*</span><span class="n">q</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n_um</span> <span class="o">/</span> <span class="n">d_en</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;stats.f_value deprecated in scipy 0.17.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f_value</span><span class="p">(</span><span class="n">ER</span><span class="p">,</span> <span class="n">EF</span><span class="p">,</span> <span class="n">dfR</span><span class="p">,</span> <span class="n">dfF</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an F-statistic for a restricted vs. unrestricted model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ER : float</span>
<span class="sd">         `ER` is the sum of squared residuals for the restricted model</span>
<span class="sd">          or null hypothesis</span>

<span class="sd">    EF : float</span>
<span class="sd">         `EF` is the sum of squared residuals for the unrestricted model</span>
<span class="sd">          or alternate hypothesis</span>

<span class="sd">    dfR : int</span>
<span class="sd">          `dfR` is the degrees of freedom in the restricted model</span>

<span class="sd">    dfF : int</span>
<span class="sd">          `dfF` is the degrees of freedom in the unrestricted model</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    F-statistic : float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ER</span> <span class="o">-</span> <span class="n">EF</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfR</span> <span class="o">-</span> <span class="n">dfF</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">EF</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfF</span><span class="p">))</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;stats.f_value_multivariate deprecated in scipy 0.17.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f_value_multivariate</span><span class="p">(</span><span class="n">ER</span><span class="p">,</span> <span class="n">EF</span><span class="p">,</span> <span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a multivariate F-statistic.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ER : ndarray</span>
<span class="sd">        Error associated with the null hypothesis (the Restricted model).</span>
<span class="sd">        From a multivariate F calculation.</span>
<span class="sd">    EF : ndarray</span>
<span class="sd">        Error associated with the alternate hypothesis (the Full model)</span>
<span class="sd">        From a multivariate F calculation.</span>
<span class="sd">    dfnum : int</span>
<span class="sd">        Degrees of freedom the Restricted model.</span>
<span class="sd">    dfden : int</span>
<span class="sd">        Degrees of freedom associated with the Restricted model.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fstat : float</span>
<span class="sd">        The computed F-statistic.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ER</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">ER</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="n">ER</span><span class="p">]])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">EF</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">EF</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="n">EF</span><span class="p">]])</span>
    <span class="n">n_um</span> <span class="o">=</span> <span class="p">(</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">ER</span><span class="p">)</span> <span class="o">-</span> <span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">EF</span><span class="p">))</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfnum</span><span class="p">)</span>
    <span class="n">d_en</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">EF</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfden</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n_um</span> <span class="o">/</span> <span class="n">d_en</span>


<span class="c1">#####################################</span>
<span class="c1">#         SUPPORT FUNCTIONS         #</span>
<span class="c1">#####################################</span>

<span class="n">RepeatedResults</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;RepeatedResults&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;counts&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="find_repeats"><a class="viewcode-back" href="../../../generated/scipy.stats.find_repeats.html#scipy.stats.find_repeats">[docs]</a><span class="k">def</span> <span class="nf">find_repeats</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find repeats and repeat counts.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr : array_like</span>
<span class="sd">        Input array. This is cast to float64.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    values : ndarray</span>
<span class="sd">        The unique values from the (flattened) input that are repeated.</span>

<span class="sd">    counts : ndarray</span>
<span class="sd">        Number of times the corresponding &#39;value&#39; is repeated.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    In numpy &gt;= 1.9 `numpy.unique` provides similar functionality. The main</span>
<span class="sd">    difference is that `find_repeats` only returns repeated values.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy import stats</span>
<span class="sd">    &gt;&gt;&gt; stats.find_repeats([2, 1, 2, 3, 2, 2, 5])</span>
<span class="sd">    RepeatedResults(values=array([ 2.]), counts=array([4]))</span>

<span class="sd">    &gt;&gt;&gt; stats.find_repeats([[10, 20, 1, 2], [5, 5, 4, 4]])</span>
<span class="sd">    RepeatedResults(values=array([ 4.,  5.]), counts=array([2, 2]))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note: always copies.</span>
    <span class="k">return</span> <span class="n">RepeatedResults</span><span class="p">(</span><span class="o">*</span><span class="n">_find_repeats</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)))</span></div>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;scipy.stats.ss is deprecated in scipy 0.17.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ss</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_sum_of_squares</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_sum_of_squares</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Squares each element of the input array, and returns the sum(s) of that.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to calculate. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sum_of_squares : ndarray</span>
<span class="sd">        The sum along the given axis for (a**2).</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    _square_of_sums : The square(s) of the sum(s) (the opposite of</span>
<span class="sd">    `_sum_of_squares`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;scipy.stats.square_of_sums is deprecated &quot;</span>
              <span class="s2">&quot;in scipy 0.17.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">square_of_sums</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_square_of_sums</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_square_of_sums</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sums elements of the input array, and returns the square(s) of that sum.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array.</span>
<span class="sd">    axis : int or None, optional</span>
<span class="sd">        Axis along which to calculate. Default is 0. If None, compute over</span>
<span class="sd">        the whole array `a`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    square_of_sums : float or ndarray</span>
<span class="sd">        The square of the sum over `axis`.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    _sum_of_squares : The sum of squares (the opposite of `square_of_sums`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">_chk_asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">*</span> <span class="n">s</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">s</span>


<span class="nd">@np.deprecate</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;scipy.stats.fastsort is deprecated in scipy 0.16.0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fastsort</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sort an array and provide the argsort.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Input array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fastsort : ndarray of type int</span>
<span class="sd">        sorted indices into the original array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: the wording in the docstring is nonsense.</span>
    <span class="n">it</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">as_</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">as_</span><span class="p">,</span> <span class="n">it</span>


<div class="viewcode-block" id="rankdata"><a class="viewcode-back" href="../../../generated/scipy.stats.rankdata.html#scipy.stats.rankdata">[docs]</a><span class="k">def</span> <span class="nf">rankdata</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    rankdata(a, method=&#39;average&#39;)</span>

<span class="sd">    Assign ranks to data, dealing with ties appropriately.</span>

<span class="sd">    Ranks begin at 1.  The `method` argument controls how ranks are assigned</span>
<span class="sd">    to equal values.  See [1]_ for further discussion of ranking methods.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        The array of values to be ranked.  The array is first flattened.</span>
<span class="sd">    method : str, optional</span>
<span class="sd">        The method used to assign ranks to tied elements.</span>
<span class="sd">        The options are &#39;average&#39;, &#39;min&#39;, &#39;max&#39;, &#39;dense&#39; and &#39;ordinal&#39;.</span>

<span class="sd">        &#39;average&#39;:</span>
<span class="sd">            The average of the ranks that would have been assigned to</span>
<span class="sd">            all the tied values is assigned to each value.</span>
<span class="sd">        &#39;min&#39;:</span>
<span class="sd">            The minimum of the ranks that would have been assigned to all</span>
<span class="sd">            the tied values is assigned to each value.  (This is also</span>
<span class="sd">            referred to as &quot;competition&quot; ranking.)</span>
<span class="sd">        &#39;max&#39;:</span>
<span class="sd">            The maximum of the ranks that would have been assigned to all</span>
<span class="sd">            the tied values is assigned to each value.</span>
<span class="sd">        &#39;dense&#39;:</span>
<span class="sd">            Like &#39;min&#39;, but the rank of the next highest element is assigned</span>
<span class="sd">            the rank immediately after those assigned to the tied elements.</span>
<span class="sd">        &#39;ordinal&#39;:</span>
<span class="sd">            All values are given a distinct rank, corresponding to the order</span>
<span class="sd">            that the values occur in `a`.</span>

<span class="sd">        The default is &#39;average&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ranks : ndarray</span>
<span class="sd">         An array of length equal to the size of `a`, containing rank</span>
<span class="sd">         scores.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] &quot;Ranking&quot;, http://en.wikipedia.org/wiki/Ranking</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from scipy.stats import rankdata</span>
<span class="sd">    &gt;&gt;&gt; rankdata([0, 2, 3, 2])</span>
<span class="sd">    array([ 1. ,  2.5,  4. ,  2.5])</span>
<span class="sd">    &gt;&gt;&gt; rankdata([0, 2, 3, 2], method=&#39;min&#39;)</span>
<span class="sd">    array([ 1,  2,  4,  2])</span>
<span class="sd">    &gt;&gt;&gt; rankdata([0, 2, 3, 2], method=&#39;max&#39;)</span>
<span class="sd">    array([ 1,  3,  4,  3])</span>
<span class="sd">    &gt;&gt;&gt; rankdata([0, 2, 3, 2], method=&#39;dense&#39;)</span>
<span class="sd">    array([ 1,  2,  3,  2])</span>
<span class="sd">    &gt;&gt;&gt; rankdata([0, 2, 3, 2], method=&#39;ordinal&#39;)</span>
<span class="sd">    array([ 1,  2,  4,  3])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;dense&#39;</span><span class="p">,</span> <span class="s1">&#39;ordinal&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unknown method &quot;{0}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">algo</span> <span class="o">=</span> <span class="s1">&#39;mergesort&#39;</span> <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;ordinal&#39;</span> <span class="k">else</span> <span class="s1">&#39;quicksort&#39;</span>
    <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>

    <span class="n">inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">sorter</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>
    <span class="n">inv</span><span class="p">[</span><span class="n">sorter</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sorter</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;ordinal&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">inv</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">sorter</span><span class="p">]</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">dense</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()[</span><span class="n">inv</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;dense&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dense</span>

    <span class="c1"># cumulative counts of each unique value</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">obs</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">count</span><span class="p">[</span><span class="n">dense</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">count</span><span class="p">[</span><span class="n">dense</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># average method</span>
    <span class="k">return</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="n">count</span><span class="p">[</span><span class="n">dense</span><span class="p">]</span> <span class="o">+</span> <span class="n">count</span><span class="p">[</span><span class="n">dense</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>